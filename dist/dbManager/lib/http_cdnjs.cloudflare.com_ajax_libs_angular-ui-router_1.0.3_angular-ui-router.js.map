{"version":3,"sources":["../../../dbManager/lib/http_cdnjs.cloudflare.com_ajax_libs_angular-ui-router_1.0.3_angular-ui-router.js"],"names":["global","factory","exports","module","require","define","amd","angular","ng_from_import","curry","fn","initial_args","slice","apply","arguments","func_args_length","length","curried","args","concat","compose","start","i","result","call","pipe","funcs","_i","reverse","prop","name","obj","propEq","val","parse","split","map","not","and","fn1","fn2","or","all","arr","reduce","b","x","any","is","ctor","constructor","eq","other","v","invoke","fnName","pattern","struct","Glob","text","glob","regexpString","seg","join","regexp","RegExp","prototype","matches","test","exec","fromString","StateObject","config","create","stateDecl","isStateClass","state","inherit","$$state","self","__stateObjectCache","nameGlob","ref","fqn","parent","root","parameters","opts","defaults","matchingKeys","inherited","values","params","filter","param","hasOwnProperty","id","parameter","url","find","toString","isFunction","isState","isObject","toStr","Object","tis","t","isUndefined","isDefined","isNull","o","isNullOrUndefined","isNumber","isString","isArray","Array","isDate","isRegExp","isInjectable","val$$1","head","tail","isPromise","notImplemented","fnname","Error","services","$q","undefined","$injector","w","window","angular$1","fromJson","JSON","bind","toJson","stringify","copy","_copy","forEach","_forEach","extend","assign","_extend","equals","_equals","identity","noop$1","createProxyFunctions","source","target","fnNames","latebind","bindFunction","makeLateRebindFn","lateRebindFunction","keys","acc","extra","inArray","_inArray","array","indexOf","removeFrom","_removeFrom","idx","splice","pushTo","_pushTo","push","deregAll","functions","defaultsList","_defaultsList","defaultVals","pick","mergeR","memo","item","ancestors","first","second","path","n","propNames","objCopy","prop_1","omit","key","pluck","collection","propName","callback","accept","mapObj","allTrueR","elem","anyTrueR","unnestR","flattenR","pushR","uniqR","token","unnest","flatten","assertPredicate","assertFn","assertMap","predicateOrMap","errMsg","pairs","arrayTuples","maxArrayLen","min","Math","applyPairs","keyValTuple","value","src","dest","cb","_this","toObj","j","o1","o2","t1","t2","tup","_arraysEq","getTime","predicates","a1","a2","sortBy","propFn","checkFn","a","composeSort","sortFns","composedSort","prev","silenceUncaughtInPromise","promise","catch","e","silentRejection","error","reject","Queue","_items","_limit","enqueue","items","shift","dequeue","size","clear","current","remove","peekTail","peekHead","RejectType","Rejection","type","message","detail","$id","detailString","d","_a","toPromise","_transitionRejection","isRejectionPromise","then","superseded","options","rejection","SUPERSEDED","redirected","invalid","INVALID","ignored","IGNORED","aborted","ABORTED","errored","ERROR","normalize","uiViewString","viewData","creationContext","viewConfigString","viewConfig","viewDecl","$context","$uiViewName","$uiViewContextAnchor","normalizedCat","input","Category","_tid","_rid","transLbl","trans","Trace","_enabled","approximateDigests","_set","enabled","categories","k","parseInt","isNaN","category","enable","disable","traceTransitionStart","TRANSITION","console","log","traceTransitionIgnored","traceHookInvocation","step","HOOK","event","context","functionToString","registeredHook","maxLength","traceHookResult","hookResult","transitionOptions","traceResolvePath","when","RESOLVE","traceResolvableResolved","resolvable","data","traceError","reason","traceSuccess","finalState","traceUIViewEvent","UIVIEW","padString","traceUIViewConfigUpdated","traceUIViewFill","html","traceViewServiceEvent","VIEWCONFIG","traceViewServiceUIViewEvent","trace","TransitionHookPhase","TransitionHookScope","TargetState","_identifier","_definition","_params","_options","identifier","$state","exists","valid","base","relative","stateName","isDef","defaultOptions","transition","traceData","TransitionHook","stateContext","isSuperseded","hookPhase","RUN","isActive","eventType","logError","err","router","stateService","defaultErrorHandler","invokeHook","hook","_deregistered","notCurrent","getNotCurrentRejection","invokeCallback","normalizeErr","handleError","getErrorHandler","handleResult","getResultHandler","synchronous","handleHookResult","isTargetState","_disposed","_aborted","fnToString","chain","hooks","waitFor","createHookChainR","nextHook","invokeHooks","doneCallback","remainingHooks","runAllHooks","HANDLE_RESULT","LOG_REJECTED_RESULT","LOG_ERROR","REJECT_ERROR","THROW_ERROR","matchState","criterion","toMatch","matchGlobs","_state","globStrings","matchFn","RegisteredHook","tranSvc","matchCriteria","priority","_matchingNodes","nodes","matching","node","_getDefaultMatchCriteria","_pluginapi","_getPathTypes","_getMatchingNodes","treeChanges","criteria","paths","mn","pathtype","isStateHook","scope","STATE","allMatched","every","makeEvent","registry","transitionService","_registeredHooks","hookRegistrationFn","matchObject","deregisterEventHook","HookBuilder","buildHooksForPhase","phase","$transitions","_getEvents","buildHooks","hookType","matchingHooks","getMatchingHooks","baseHookOptions","makeTransitionHooks","matchingNodes","criteriaMatchPath","transitionHook","sort","tupleSort","reverseSort","tuple","isCreate","CREATE","registries","reg","getHooks","reverseDepthSort","nodeDepthThenPriority","l","r","factor","depthDelta","ParamType","def","encode","decode","$subPattern","sub","substr","$normalize","$asArray","mode","isSearch","ArrayType","arrayWrap","arrayUnwrap","arrayHandler","allTruthyMode","handleArray","arrayEqualsHandler","val1","val2","left","right","paramTypeFn","wrapperFn","dynamic","$arrayMode","hasOwn","isShorthand","cfg","DefType","unwrapShorthand","getStaticDefaultValue","$$fn","getType","urlType","location","paramTypes","CONFIG","PATH","SEARCH","getSquashPolicy","isOptional","defaultPolicy","squash","getReplace","arrayMode","replace","configuredKeys","from","to","Param","urlMatcherFactory","getArrayMode","raw","defaultSquashPolicy","inherit$$1","arrayDefaults","arrayParamNomenclature","match","isDefaultValue","getDefaultValue","_defaultValueCache","defaultValue","replaceSpecialValues","validates","normalized","encoded","values$$1","paramValues","params_1","changed","values1","values2","PathNode","stateOrNode","paramSchema","resolvables","views","res","clone","applyRawParams","getParamVal","paramDef","pDef","paramsFn","diff","PathUtils","makeTargetState","buildPath","targetState","toParams","buildToPath","fromPath","toPath","inheritParams","applyViewConfigs","$view","states","viewDecls","subPath","viewConfigs","view","createViewConfig","toKeys","nodeParamVals","noInherit","makeInheritedParamsNode","toNode","toParamVals","incomingParamVals","fromParamVals","ownParamVals","reloadState","keep","max","nodesMatch","node1","node2","nonDynamicParams","applyToParams","retainedNode","cloned","retained","exiting","entering","retainedWithToParams","pathA","pathB","done","tuples","nodeA","nodeB","predicate","elementIdx","defaultResolvePolicy","async","Resolvable","arg1","resolveFn","deps","policy","resolved","literal","getPolicy","thisPolicy","statePolicy","resolvePolicy","resolve","resolveContext","getResolvableDependencies","getDependencies","get","invokeResolveFn","resolvedDeps","waitForRx","observable$","cached","cache","take","findNode","maybeWaitForRx","applyResolvedValue","resolvedValue","fromData","resolvePolicies","LAZY","EAGER","WAIT","NOWAIT","RXWAIT","ALL_WHENS","EAGER_WHENS","NATIVE_INJECTOR_TOKEN","ResolveContext","_path","getTokens","getResolvable","subContext","addResolvables","newResolvables","resolvePath","whenOption","matchedWhens","matchesPolicy","acceptedVals","whenOrAsync","promises","nodeResolvables","nowait","wait","getResult","injector","_injector","UIInjectorImpl","availableResolvables","getDependency","fromInjector","getNative","native","getAsync","stateSelf","Transition","_deferred","defer","_hookBuilder","globals","_targetState","_transitionCount","_treeChanges","createTransitionHookRegFns","onCreateHooks","onBefore","onStart","onExit","onRetain","onEnter","onFinish","onSuccess","onError","hookName","enteringStates","$from","$to","compare","pathname","freeze","pathName","getResolveTokens","addResolvable","topath","targetNode","redirectedFrom","originalTransition","rf","redirect","redirects","redirectOpts","newOptions","newTransition","originalEnteringNodes","redirectEnteringNodes","nodeIsReloading","includes","matchingEnteringNodes","_changedParams","tc","reload","pathsDiffer","nodeSchemas","toValues","fromValues","schema","toVals","fromVals","changes","_ignoredReason","pending","same","newTC","pendTC","run","getHooksFor","transitionSuccess","success","SUCCESS","transitionError","_error","runTransition","allRunHooks","startTransition","lastStartedTransitionId","transitionHistory","allBeforeHooks","BEFORE","abort","abstract","fromStateOrName","toStateOrName","avoidEmptyHash","fromParams","toValid","diToken","str","kebobString","camelCase","$1","toLowerCase","fnStr","namedFunctionMatch","_fn","stringifyPatternFn","stringifyPattern","isRejection","seen","format","beforeAfterSubstr","char","splitOnDelim","delim","re","joinNeighborsR","ParamTypes","typeQueue","defaultTypes","makeType","definition","types","dispose","definitionFn","_flushTypeQueue","initDefaultTypes","makeDefaultType","valToString","defaultTypeBase","String","string","query","hash","int","bool","Boolean","date","getFullYear","getMonth","getDate","capture","Date","valueOf","json","StateParams","$inherit","newParams","$current","parents","parentParams","inheritList","parseUrl","charAt","substring","nameBuilder","selfBuilder","dataBuilder","getUrlBuilder","$urlMatcherFactoryProvider","urlBuilder","stateDec","parsed","compile","paramMap","paramConfig","reloadOnSearch","isMatcher","navigable","append","getNavigableBuilder","isRoot","navigableBuilder","getParamsBuilder","paramFactory","paramsBuilder","makeConfigParam","fromConfig","urlParams","nonUrlParams","p","pathBuilder","includesBuilder","resolvablesBuilder","objects2Tuples","resolveObj","annotate","strictDi","isResolveLiteral","isLikeNg2Provider","provide","useValue","useFactory","useExisting","useClass","isTupleFromObj","literal2Resolvable","dependencies","tuple2Resolvable","item2Resolvable","decl","StateBuilder","matcher","parentBuilder","parentName","builders","builder","build","parentFn","segments","lastSegment","pop","StateMatcher","_states","isRelative","stateOrName","matchGlob","isStr","baseState","splitName","pathLength","relName","StateQueueManager","$registry","$urlRouter","listeners","queue","register","flush","registered","orphans","previousQueueLength","getState","name_1","orphanIdx","existingState","existingFutureState","deregister","attachRoute","listener","s","rule","urlRuleFactory","StateRegistry","_router","stateQueue","urlRouter","_registerRoot","rootStateDef","_root","onStatesChanged","deregisterListener","stateDefinition","_deregisterTree","all$$1","getChildren","children","deregistered","$ur","rules","removeRule","deregisteredStates","found","decorator","func","quoteRegExp","surroundPattern","memoizeTo","prop$$1","splitOnSlash","UrlMatcher","pattern$$1","_cache","_children","_segments","_compiled","strict","caseInsensitive","placeholder","searchPlaceholder","last","m","patterns","checkParamErrors","nameValidator","matchDetails","makeRegexpType","segment","index","lastIndex","search","fromSearch","allParams","pathParams","searchParams","nPathSegments","urlm","decodePathArray","reverseString","unquoteDashes","allReversed","findParam","validParamVal","urlMatchers","pathSegmentsAndParams","getDetails","queryParams","isInvalid","isValid","pathString","encodeDashes","encodeURIComponent","queryString","paramDetails","c","charCodeAt","toUpperCase","staticSegments","weights","cmp","pairs$$1","UrlMatcherFactory","_isCaseInsensitive","_isStrictMode","_defaultSquashPolicy","_getConfig","strictMode","object","$get","UrlRuleFactory","what","handler","makeRule","_what","fromUrlMatcher","fromState","fromRegExp","BaseUrlRule","urlMatcher","_handler","matchPriority","optional","matched","details","href","transitionTo","sticky","redirectUrlTo","Number","isUrlRule","appendBasePath","isHtml5","absolute","baseHref","getMatcher","defaultRuleSortFn","UrlRouter","_sortFn","_rules","interceptDeferred","_id","_sorted","listen","_otherwiseFn","compareFn","ensureSorted","checkRule","weight","best","sync","evt","defaultPrevented","$url","urlService","applyResult","newurl","go","_stopFn","onChange","update","read","locationService","html5Mode","hashPrefix","slash","port","protocol","host","otherwise","handlerFn","getHandlerFn","initial","urlParts","deferIntercept","ViewService","_uiViews","_viewConfigs","_viewConfigFactories","_rootViewContext","_viewConfigFactory","_registeredUIViews","_activeViewConfigs","_rootContext","viewType","cfgFactory","$type","cfgs","deactivateViewConfig","activateViewConfig","uiViewsByFqn","uiv","uiViewDepth","uiView","stateDepth","viewConfigDepth","count","depthCompare","depthFn","posNeg","matchingConfigPair","matchingConfigs","configureUIView","configUpdated","registerUIView","uiViews","fqnMatches","available","active","normalizeUIViewTarget","rawViewName","viewAtContext","uiViewName","uiViewContextAnchor","relativeViewNameSugar","relativeMatch","anchor","vc","vcSegments","uivSegments","negOffset","fqnToFirstSegment","uiViewContext","UIRouterGlobals","successfulTransitions","makeStub","locationServicesFns","locationConfigFns","umfFns","rulesFns","syncFns","UrlService","lateBind","locationServices","locationConfig","umf","parts","locationServiceStub","locationConfigStub","_routerInstance","UIRouter","_disposables","viewService","TransitionService","stateRegistry","StateService","_plugins","disposable","plugin","pluginInstance","getPlugin","pluginName","addCoreResolvables","registerAddCoreResolvables","onCreate","redirectToHook","redirectTo","registerRedirectToHook","makeEnterExitRetainHook","hookFn","onExitHook","registerOnExitHook","onRetainHook","registerOnRetainHook","onEnterHook","registerOnEnterHook","eagerResolvePath","registerEagerResolvePath","lazyResolveState","registerLazyResolveState","loadEnteringViews","enteringViews","load","registerLoadEnteringViews","activateViews","exitingViews","registerActivateViews","updateGlobalState","transitionSuccessful","clearCurrentTransition","registerUpdateGlobalState","updateUrl","urlOptions","registerUpdateUrl","lazyLoadHook","retryTransition","orig","lazyLoad","lazyLoadState","registerLazyLoadHook","lazyLoadFn","updateStateRegistry","TransitionEventType","hookOrder","ignoredHook","ignoredReason","registerIgnoredTransitionHook","invalidTransitionHook","registerInvalidTransitionHook","defaultTransOpts","notify","custom","_eventTypes","_criteriaPaths","_deregisterHookFns","_defineCorePaths","_defineCoreEvents","_registerCoreTransitionHooks","hooksArray","Phase","TH","NORMAL_SORT","REVERSE_SORT","ASYNCHRONOUS","SYNCHRONOUS","_defineEvent","_definePathType","transitionHookTypes","cmpByPhase","hookScope","fns","addCoreResolves","eagerResolve","lazyResolve","loadViews","updateGlobals","invalidCallbacks","_defaultErrorHandler","$defaultErrorHandler","$error$","stack","getters","boundFns","defineProperty","enumerable","configurable","_handleInvalidTargetState","toState","latestThing","latest","callbackQueue","checkForRedirect","invokeNextCallback","nextCallback","callbackResult","onInvalid","defautGoOpts","transOpts","getCurrentPath","latestSuccess","rootPath","getCurrent","currentPath","rejectedTransitionHandler","isLatest","errorHandler","transitionToPromise","include","defaultHrefOpts","lossy","nav","Promise","deferred","STRIP_COMMENTS","ARGUMENT_NAMES","has","locals","ensureExist","$inject","beforeAfterSubstr$1","splitHash","splitQuery","splitEqual","trimHashVal","keyValsToObjectR","accum","getParams","parseUrl$1","orEmptyString","beforehash","_b","buildUrl","loc","searchObject","vals","locationPluginFactory","serviceClass","configurationClass","service","configuration","BaseLocationServices","fireAfterUpdate","_listener","_listeners","_get","_location","_history","history","evt_1","Event","__extends","extendStatics","setPrototypeOf","__proto__","__","HashLocationService","_super","addEventListener","title","removeEventListener","__extends$1","MemoryLocationService","_url","__extends$2","PushStateLocationService","_config","fullUrl","replaceState","pushState","MemoryLocationConfig","_baseHref","_port","_protocol","_host","_hashPrefix","newval","BrowserLocationConfig","_isHtml5","newprefix","applyDocumentBaseHref","baseTags","document","getElementsByTagName","origin","servicesPlugin","hashLocationPlugin","pushStateLocationPlugin","memoryLocationPlugin","UIRouterPluginBase","index$1","noop","ng_from_global","ng","getNg1ViewConfigFactory","templateFactory","Ng1ViewConfig","hasAnyKey","ng1ViewsBuilder","tplKeys","ctrlKeys","compKeys","nonCompKeys","allViewKeys","viewsObject","component","resolveAs","$name","id$1","loaded","getTemplate","makeComponentTemplate","bindings","template","$q$$1","controller","getController","results","provider","controllerProvider","providerFn","TemplateFactory","_useHttp","version","minor","$http","$templateCache","$injector$$1","$templateRequest","useHttpService","defaultTemplate","asTemplate","asComponent","templateUrl","fromUrl","templateProvider","fromProvider","componentProvider","fromComponentProvider","headers","Accept","response","prefix","kebob","kebobed","attributeTpl","attrName","attr","resolveName","arrayIdxStr","attrs","getComponentBindings","kebobName","cmpDefs","getBindings","bindToController","scopeBindings","bindingsObj","StateProvider","getStateHookBuilder","stateHookBuilder","decoratedNg1Hook","getLocals","$state$","$transition$","Ng1LocationServices","$locationProvider","_urlListeners","_lp","$sniffer","newUrl","$location","_runtimeServices","$rootScope","$browser","$on","_loc","_browser","monkeyPatchPathParameterType","pathType","UrlRouterProvider","_urlRouter","ruleFn","injectableHandler","$match","$stateParams","mod_init","mod_util","mod_rtr","mod_state","mod_main","mod_cmpt","$uiRouter","stateProvider","ng1LocationService","getProviderFor","serviceName","$urp","runBlock","getUrlRouterProvider","uiRouter","urlRouterProvider","getStateProvider","watchDigests","$watch","$urlMatcherFactory","ctx","tokens","waitPolicy","parseStateRef","paramsOnly","paramExpr","el","$uiView","inheritedData","processedDef","$element","uiState","uiStateOpts","defaultOpts","uiStateParams","getTypeInfo","isSvg","isForm","nodeName","isAnchor","clickable","clickHook","$timeout","getDef","button","which","ctrlKey","metaKey","shiftKey","preventDefault","ignorePreventDefaultCount","cancel","bindEvents","element","events","on","events_1","event_1","off","events_2","event_2","uiSref","$StateRefDirective","restrict","link","uiSrefActive","unlinkInfoFn","rawDef","uiSrefOpts","$eval","$$addStateInfo","$set","$StateRefDynamicDirective","inputAttrs","watchDeregFns","field","$observe","expr","$StateRefActiveDirective","$interpolate","$scope","$attrs","activeEqClass","uiSrefActiveEq","activeClass","addState","newState","updateAfterTransition","stateParams","stateInfo","removeState","splitClasses","getClasses","stateList","allClasses","fuzzyClasses","exactlyMatchesAny","exactClasses","addClasses","removeClasses","cls","$evalAsync","className","addClass","removeClass","directive","$IsStateFilter","isFilter","$stateful","$IncludedByStateFilter","includesFilter","$ViewDirective","$animate","$uiViewScroll","getRenderer","enter","leave","configsEqual","config1","config2","rootData","$cfg","terminal","transclude","tElement","tAttrs","$transclude","previousEl","currentEl","currentScope","unregister","onloadExp","autoScrollExp","renderer","activeUIView","configUpdatedCallback","fromParentTagConfig","fromParentTag","updateView","cleanupLastView","$destroy","_viewData_1","$$animLeave","newScope","$new","animEnter","animLeave","$uiViewData","$uiViewAnim","$animEnter","$animLeave","$emit","onUIViewEnter","$ViewDirectiveFill","$compile","$controller","getControllerAs","getResolveAs","empty","contents","resolveCtx","controllerAs","controllerInstance","registerControllerCallbacks","cmp_1","tagRegexp_1","getComponentController","directiveEl","tagName","deregisterWatch_1","ctrlInstance","hasComponentImpl","_uiCanExitId","$onInit","viewState","hookOptions","uiOnParamsChanged","viewCreationTrans_1","paramsUpdated","toSchema","fromSchema","changedToParams","changedKeys_1","newValues","uiCanExit","id_1","cacheProp_1","prevTruthyAnswer_1","wrappedHook","ids","$ViewScrollProvider","useAnchorScroll","$anchorScroll","scrollIntoView","core"],"mappings":";;;;AAAA;;;;;;;;;;AAUC,WAAUA,MAAV,EAAkBC,OAAlB,EAA2B;AACxB,YAAOC,OAAP,yCAAOA,OAAP,OAAmB,QAAnB,IAA+B,OAAOC,MAAP,KAAkB,WAAjD,GAA+DF,QAAQC,OAAR,EAAiBE,QAAQ,SAAR,CAAjB,CAA/D,GACA,OAAOC,MAAP,KAAkB,UAAlB,IAAgCA,OAAOC,GAAvC,GAA6CD,OAAO,CAAC,SAAD,EAAY,SAAZ,CAAP,EAA+BJ,OAA/B,CAA7C,GACCA,QAASD,OAAO,qBAAP,IAAgCA,OAAO,qBAAP,KAAiC,EAA1E,EAA8EA,OAAOO,OAArF,CAFD;AAGH,CAJA,aAIQ,UAAUL,OAAV,EAAkBM,cAAlB,EAAkC;AAAE;;AAE7C;;;;;;OAF2C,CAQvC;AACJ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA2CA,aAASC,KAAT,CAAeC,EAAf,EAAmB;AACf,YAAIC,eAAe,GAAGC,KAAH,CAASC,KAAT,CAAeC,SAAf,EAA0B,CAAC,CAAD,CAA1B,CAAnB;AACA,YAAIC,mBAAmBL,GAAGM,MAA1B;AACA,iBAASC,OAAT,CAAiBC,IAAjB,EAAuB;AACnB,gBAAIA,KAAKF,MAAL,IAAeD,gBAAnB,EACI,OAAOL,GAAGG,KAAH,CAAS,IAAT,EAAeK,IAAf,CAAP;AACJ,mBAAO,YAAY;AACf,uBAAOD,QAAQC,KAAKC,MAAL,CAAY,GAAGP,KAAH,CAASC,KAAT,CAAeC,SAAf,CAAZ,CAAR,CAAP;AACH,aAFD;AAGH;AACD,eAAOG,QAAQN,YAAR,CAAP;AACH;AACD;;;;;;AAMA,aAASS,OAAT,GAAmB;AACf,YAAIF,OAAOJ,SAAX;AACA,YAAIO,QAAQH,KAAKF,MAAL,GAAc,CAA1B;AACA,eAAO,YAAY;AACf,gBAAIM,IAAID,KAAR;AAAA,gBAAeE,SAASL,KAAKG,KAAL,EAAYR,KAAZ,CAAkB,IAAlB,EAAwBC,SAAxB,CAAxB;AACA,mBAAOQ,GAAP;AACIC,yBAASL,KAAKI,CAAL,EAAQE,IAAR,CAAa,IAAb,EAAmBD,MAAnB,CAAT;AADJ,aAEA,OAAOA,MAAP;AACH,SALD;AAMH;AACD;;;;;;AAMA,aAASE,IAAT,GAAgB;AACZ,YAAIC,QAAQ,EAAZ;AACA,aAAK,IAAIC,KAAK,CAAd,EAAiBA,KAAKb,UAAUE,MAAhC,EAAwCW,IAAxC,EAA8C;AAC1CD,kBAAMC,EAAN,IAAYb,UAAUa,EAAV,CAAZ;AACH;AACD,eAAOP,QAAQP,KAAR,CAAc,IAAd,EAAoB,GAAGD,KAAH,CAASY,IAAT,CAAcV,SAAd,EAAyBc,OAAzB,EAApB,CAAP;AACH;AACD;;;;;;AAMA,QAAIC,OAAO,SAAPA,IAAO,CAAUC,IAAV,EAAgB;AACvB,eAAO,UAAUC,GAAV,EAAe;AAAE,mBAAOA,OAAOA,IAAID,IAAJ,CAAd;AAA0B,SAAlD;AACH,KAFD;AAGA;;;;;;;AAOA,QAAIE,SAASvB,MAAM,UAAUqB,IAAV,EAAgBG,GAAhB,EAAqBF,GAArB,EAA0B;AAAE,eAAOA,OAAOA,IAAID,IAAJ,MAAcG,GAA5B;AAAkC,KAApE,CAAb;AACA;;;;;;;;AAQA,QAAIC,QAAQ,SAARA,KAAQ,CAAUJ,IAAV,EAAgB;AACxB,eAAOL,KAAKZ,KAAL,CAAW,IAAX,EAAiBiB,KAAKK,KAAL,CAAW,GAAX,EAAgBC,GAAhB,CAAoBP,IAApB,CAAjB,CAAP;AACH,KAFD;AAGA;;;;AAIA,QAAIQ,MAAM,SAANA,GAAM,CAAU3B,EAAV,EAAc;AACpB,eAAO,YAAY;AACf,gBAAIQ,OAAO,EAAX;AACA,iBAAK,IAAIS,KAAK,CAAd,EAAiBA,KAAKb,UAAUE,MAAhC,EAAwCW,IAAxC,EAA8C;AAC1CT,qBAAKS,EAAL,IAAWb,UAAUa,EAAV,CAAX;AACH;AACD,mBAAO,CAACjB,GAAGG,KAAH,CAAS,IAAT,EAAeK,IAAf,CAAR;AACH,SAND;AAOH,KARD;AASA;;;;AAIA,aAASoB,GAAT,CAAaC,GAAb,EAAkBC,GAAlB,EAAuB;AACnB,eAAO,YAAY;AACf,gBAAItB,OAAO,EAAX;AACA,iBAAK,IAAIS,KAAK,CAAd,EAAiBA,KAAKb,UAAUE,MAAhC,EAAwCW,IAAxC,EAA8C;AAC1CT,qBAAKS,EAAL,IAAWb,UAAUa,EAAV,CAAX;AACH;AACD,mBAAOY,IAAI1B,KAAJ,CAAU,IAAV,EAAgBK,IAAhB,KAAyBsB,IAAI3B,KAAJ,CAAU,IAAV,EAAgBK,IAAhB,CAAhC;AACH,SAND;AAOH;AACD;;;;AAIA,aAASuB,EAAT,CAAYF,GAAZ,EAAiBC,GAAjB,EAAsB;AAClB,eAAO,YAAY;AACf,gBAAItB,OAAO,EAAX;AACA,iBAAK,IAAIS,KAAK,CAAd,EAAiBA,KAAKb,UAAUE,MAAhC,EAAwCW,IAAxC,EAA8C;AAC1CT,qBAAKS,EAAL,IAAWb,UAAUa,EAAV,CAAX;AACH;AACD,mBAAOY,IAAI1B,KAAJ,CAAU,IAAV,EAAgBK,IAAhB,KAAyBsB,IAAI3B,KAAJ,CAAU,IAAV,EAAgBK,IAAhB,CAAhC;AACH,SAND;AAOH;AACD;;;;;;AAMA,QAAIwB,MAAM,SAANA,GAAM,CAAUH,GAAV,EAAe;AACrB,eAAO,UAAUI,GAAV,EAAe;AAAE,mBAAOA,IAAIC,MAAJ,CAAW,UAAUC,CAAV,EAAaC,CAAb,EAAgB;AAAE,uBAAOD,KAAK,CAAC,CAACN,IAAIO,CAAJ,CAAd;AAAuB,aAApD,EAAsD,IAAtD,CAAP;AAAqE,SAA7F;AACH,KAFD;AAGA,QAAIC,MAAM,SAANA,GAAM,CAAUR,GAAV,EAAe;AACrB,eAAO,UAAUI,GAAV,EAAe;AAAE,mBAAOA,IAAIC,MAAJ,CAAW,UAAUC,CAAV,EAAaC,CAAb,EAAgB;AAAE,uBAAOD,KAAK,CAAC,CAACN,IAAIO,CAAJ,CAAd;AAAuB,aAApD,EAAsD,KAAtD,CAAP;AAAsE,SAA9F;AACH,KAFD;AAGA;AACA,QAAIE,KAAK,SAALA,EAAK,CAAUC,IAAV,EAAgB;AACrB,eAAO,UAAUlB,GAAV,EAAe;AAClB,mBAAQA,OAAO,IAAP,IAAeA,IAAImB,WAAJ,KAAoBD,IAAnC,IAA2ClB,eAAekB,IAAlE;AACH,SAFD;AAGH,KAJD;AAKA;AACA,QAAIE,KAAK,SAALA,EAAK,CAAUlB,GAAV,EAAe;AAAE,eAAO,UAAUmB,KAAV,EAAiB;AAC9C,mBAAOnB,QAAQmB,KAAf;AACH,SAFyB;AAEtB,KAFJ;AAGA;AACA,QAAInB,MAAM,SAANA,GAAM,CAAUoB,CAAV,EAAa;AAAE,eAAO,YAAY;AAAE,mBAAOA,CAAP;AAAW,SAAhC;AAAmC,KAA5D;AACA,aAASC,MAAT,CAAgBC,MAAhB,EAAwBrC,IAAxB,EAA8B;AAC1B,eAAO,UAAUa,GAAV,EAAe;AAClB,mBAAOA,IAAIwB,MAAJ,EAAY1C,KAAZ,CAAkBkB,GAAlB,EAAuBb,IAAvB,CAAP;AACH,SAFD;AAGH;AACD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwCA,aAASsC,OAAT,CAAiBC,MAAjB,EAAyB;AACrB,eAAO,UAAUX,CAAV,EAAa;AAChB,iBAAK,IAAIxB,IAAI,CAAb,EAAgBA,IAAImC,OAAOzC,MAA3B,EAAmCM,GAAnC,EAAwC;AACpC,oBAAImC,OAAOnC,CAAP,EAAU,CAAV,EAAawB,CAAb,CAAJ,EACI,OAAOW,OAAOnC,CAAP,EAAU,CAAV,EAAawB,CAAb,CAAP;AACP;AACJ,SALD;AAMH;;AAED;;;;AAIA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgDA,QAAIY,OAAQ,YAAY;AACpB,iBAASA,IAAT,CAAcC,IAAd,EAAoB;AAChB,iBAAKA,IAAL,GAAYA,IAAZ;AACA,iBAAKC,IAAL,GAAYD,KAAKxB,KAAL,CAAW,GAAX,CAAZ;AACA,gBAAI0B,eAAe,KAAKF,IAAL,CAAUxB,KAAV,CAAgB,GAAhB,EACdC,GADc,CACV,UAAU0B,GAAV,EAAe;AACpB,oBAAIA,QAAQ,IAAZ,EACI,OAAO,oBAAP;AACJ,oBAAIA,QAAQ,GAAZ,EACI,OAAO,UAAP;AACJ,uBAAO,QAAQA,GAAf;AACH,aAPkB,EAOhBC,IAPgB,CAOX,EAPW,CAAnB;AAQA,iBAAKC,MAAL,GAAc,IAAIC,MAAJ,CAAW,MAAMJ,YAAN,GAAqB,GAAhC,CAAd;AACH;AACDH,aAAKQ,SAAL,CAAeC,OAAf,GAAyB,UAAUrC,IAAV,EAAgB;AACrC,mBAAO,KAAKkC,MAAL,CAAYI,IAAZ,CAAiB,MAAMtC,IAAvB,CAAP;AACH,SAFD;AAGA;AACA4B,aAAKV,EAAL,GAAU,UAAUW,IAAV,EAAgB;AACtB,mBAAO,CAAC,CAAC,SAASU,IAAT,CAAcV,IAAd,CAAT;AACH,SAFD;AAGA;AACAD,aAAKY,UAAL,GAAkB,UAAUX,IAAV,EAAgB;AAC9B,mBAAOD,KAAKV,EAAL,CAAQW,IAAR,IAAgB,IAAID,IAAJ,CAASC,IAAT,CAAhB,GAAiC,IAAxC;AACH,SAFD;AAGA,eAAOD,IAAP;AACH,KA1BW,EAAZ;;AA4BA;;;;;;;;;;AAUA,QAAIa,cAAe,YAAY;AAC3B;AACA,iBAASA,WAAT,CAAqBC,MAArB,EAA6B;AACzB,mBAAOD,YAAYE,MAAZ,CAAmBD,UAAU,EAA7B,CAAP;AACH;AACD;;;;;;;;AAQAD,oBAAYE,MAAZ,GAAqB,UAAUC,SAAV,EAAqB;AACtCA,wBAAYH,YAAYI,YAAZ,CAAyBD,SAAzB,IAAsC,IAAIA,SAAJ,EAAtC,GAAwDA,SAApE;AACA,gBAAIE,QAAQC,QAAQA,QAAQH,SAAR,EAAmBH,YAAYL,SAA/B,CAAR,CAAZ;AACAQ,sBAAUI,OAAV,GAAoB,YAAY;AAAE,uBAAOF,KAAP;AAAe,aAAjD;AACAA,kBAAMG,IAAN,GAAaL,SAAb;AACAE,kBAAMI,kBAAN,GAA2B;AACvBC,0BAAUvB,KAAKY,UAAL,CAAgBM,MAAM9C,IAAtB,CADa,CACe;AADf,aAA3B;AAGA,mBAAO8C,KAAP;AACH,SATD;AAUA;;;;;;;;;;;AAWAL,oBAAYL,SAAZ,CAAsBlB,EAAtB,GAA2B,UAAUkC,GAAV,EAAe;AACtC,mBAAO,SAASA,GAAT,IAAgB,KAAKH,IAAL,KAAcG,GAA9B,IAAqC,KAAKC,GAAL,OAAeD,GAA3D;AACH,SAFD;AAGA;;;;AAIAX,oBAAYL,SAAZ,CAAsBiB,GAAtB,GAA4B,YAAY;AACpC,gBAAI,CAAC,KAAKC,MAAN,IAAgB,EAAE,KAAKA,MAAL,YAAuB,KAAKlC,WAA9B,CAApB,EACI,OAAO,KAAKpB,IAAZ;AACJ,gBAAIA,OAAO,KAAKsD,MAAL,CAAYD,GAAZ,EAAX;AACA,mBAAOrD,OAAOA,OAAO,GAAP,GAAa,KAAKA,IAAzB,GAAgC,KAAKA,IAA5C;AACH,SALD;AAMA;;;;;AAKAyC,oBAAYL,SAAZ,CAAsBmB,IAAtB,GAA6B,YAAY;AACrC,mBAAO,KAAKD,MAAL,IAAe,KAAKA,MAAL,CAAYC,IAAZ,EAAf,IAAqC,IAA5C;AACH,SAFD;AAGA;;;;;;;;;AASAd,oBAAYL,SAAZ,CAAsBoB,UAAtB,GAAmC,UAAUC,IAAV,EAAgB;AAC/CA,mBAAOC,SAASD,IAAT,EAAe,EAAEV,SAAS,IAAX,EAAiBY,cAAc,IAA/B,EAAf,CAAP;AACA,gBAAIC,YAAYH,KAAKV,OAAL,IAAgB,KAAKO,MAArB,IAA+B,KAAKA,MAAL,CAAYE,UAAZ,EAA/B,IAA2D,EAA3E;AACA,mBAAOI,UAAUvE,MAAV,CAAiBwE,OAAO,KAAKC,MAAZ,CAAjB,EACFC,MADE,CACK,UAAUC,KAAV,EAAiB;AAAE,uBAAO,CAACP,KAAKE,YAAN,IAAsBF,KAAKE,YAAL,CAAkBM,cAAlB,CAAiCD,MAAME,EAAvC,CAA7B;AAA0E,aADlG,CAAP;AAEH,SALD;AAMA;;;;;;;AAOAzB,oBAAYL,SAAZ,CAAsB+B,SAAtB,GAAkC,UAAUD,EAAV,EAAcT,IAAd,EAAoB;AAClD,gBAAIA,SAAS,KAAK,CAAlB,EAAqB;AAAEA,uBAAO,EAAP;AAAY;AACnC,mBAAQ,KAAKW,GAAL,IAAY,KAAKA,GAAL,CAASD,SAAT,CAAmBD,EAAnB,EAAuBT,IAAvB,CAAZ,IACJY,KAAKR,OAAO,KAAKC,MAAZ,CAAL,EAA0B5D,OAAO,IAAP,EAAagE,EAAb,CAA1B,CADI,IAEJT,KAAKV,OAAL,IAAgB,KAAKO,MAArB,IAA+B,KAAKA,MAAL,CAAYa,SAAZ,CAAsBD,EAAtB,CAFnC;AAGH,SALD;AAMAzB,oBAAYL,SAAZ,CAAsBkC,QAAtB,GAAiC,YAAY;AACzC,mBAAO,KAAKjB,GAAL,EAAP;AACH,SAFD;AAGA,eAAOZ,WAAP;AACH,KAvFkB,EAAnB;AAwFA;AACAA,gBAAYI,YAAZ,GAA2B,UAAUD,SAAV,EAAqB;AAC5C,eAAO2B,WAAW3B,SAAX,KAAyBA,UAAU,iBAAV,MAAiC,IAAjE;AACH,KAFD;AAGA;AACAH,gBAAY+B,OAAZ,GAAsB,UAAUvE,GAAV,EAAe;AACjC,eAAOwE,SAASxE,IAAI,oBAAJ,CAAT,CAAP;AACH,KAFD;;AAIA;;;;;;;AAOA;AACA,QAAIyE,QAAQC,OAAOvC,SAAP,CAAiBkC,QAA7B;AACA,QAAIM,MAAM,SAANA,GAAM,CAAUC,CAAV,EAAa;AAAE,eAAO,UAAU7D,CAAV,EAAa;AAAE,mBAAO,QAAQA,CAAR,yCAAQA,CAAR,OAAe6D,CAAtB;AAA0B,SAAhD;AAAmD,KAA5E;AACA,QAAIC,cAAcF,IAAI,WAAJ,CAAlB;AACA,QAAIG,YAAYxE,IAAIuE,WAAJ,CAAhB;AACA,QAAIE,SAAS,SAATA,MAAS,CAAUC,CAAV,EAAa;AAAE,eAAOA,MAAM,IAAb;AAAoB,KAAhD;AACA,QAAIC,oBAAoBvE,GAAGqE,MAAH,EAAWF,WAAX,CAAxB;AACA,QAAIP,aAAaK,IAAI,UAAJ,CAAjB;AACA,QAAIO,WAAWP,IAAI,QAAJ,CAAf;AACA,QAAIQ,WAAWR,IAAI,QAAJ,CAAf;AACA,QAAIH,WAAW,SAAXA,QAAW,CAAUzD,CAAV,EAAa;AAAE,eAAOA,MAAM,IAAN,IAAc,QAAOA,CAAP,yCAAOA,CAAP,OAAa,QAAlC;AAA6C,KAA3E;AACA,QAAIqE,UAAUC,MAAMD,OAApB;AACA,QAAIE,SAAU,SAAVA,MAAU,CAAUvE,CAAV,EAAa;AAAE,eAAO0D,MAAMhF,IAAN,CAAWsB,CAAX,MAAkB,eAAzB;AAA2C,KAAxE;AACA,QAAIwE,WAAY,SAAZA,QAAY,CAAUxE,CAAV,EAAa;AAAE,eAAO0D,MAAMhF,IAAN,CAAWsB,CAAX,MAAkB,iBAAzB;AAA6C,KAA5E;AACA,QAAIwD,UAAU/B,YAAY+B,OAA1B;AACA;;;;;;AAMA,aAASiB,YAAT,CAAsBC,MAAtB,EAA8B;AAC1B,YAAIL,QAAQK,MAAR,KAAmBA,OAAOxG,MAA9B,EAAsC;AAClC,gBAAIyG,OAAOD,OAAO5G,KAAP,CAAa,CAAb,EAAgB,CAAC,CAAjB,CAAX;AAAA,gBAAgC8G,OAAOF,OAAO5G,KAAP,CAAa,CAAC,CAAd,CAAvC;AACA,mBAAO,EAAE6G,KAAK5B,MAAL,CAAYxD,IAAI6E,QAAJ,CAAZ,EAA2BlG,MAA3B,IAAqC0G,KAAK7B,MAAL,CAAYxD,IAAIgE,UAAJ,CAAZ,EAA6BrF,MAApE,CAAP;AACH;AACD,eAAOqF,WAAWmB,MAAX,CAAP;AACH;AACD;;;;;AAKA,QAAIG,YAAYrF,IAAIiE,QAAJ,EAAc9E,KAAKI,KAAK,MAAL,CAAL,EAAmBwE,UAAnB,CAAd,CAAhB;;AAEA,QAAIuB,iBAAiB,SAAjBA,cAAiB,CAAUC,MAAV,EAAkB;AAAE,eAAO,YAAY;AACxD,kBAAM,IAAIC,KAAJ,CAAUD,SAAS,6DAAnB,CAAN;AACH,SAFwC;AAErC,KAFJ;AAGA,QAAIE,WAAW;AACXC,YAAIC,SADO;AAEXC,mBAAWD;AAFA,KAAf;;AAKA;;;;;;;;AAQA;AACA,QAAIE,IAAI,OAAOC,MAAP,KAAkB,WAAlB,GAAgC,EAAhC,GAAqCA,MAA7C;AACA,QAAIC,YAAYF,EAAE5H,OAAF,IAAa,EAA7B;AACA,QAAI+H,WAAWD,UAAUC,QAAV,IAAsBC,KAAKrG,KAAL,CAAWsG,IAAX,CAAgBD,IAAhB,CAArC;AACA,QAAIE,SAASJ,UAAUI,MAAV,IAAoBF,KAAKG,SAAL,CAAeF,IAAf,CAAoBD,IAApB,CAAjC;AACA,QAAII,OAAON,UAAUM,IAAV,IAAkBC,KAA7B;AACA,QAAIC,UAAUR,UAAUQ,OAAV,IAAqBC,QAAnC;AACA,QAAIC,SAAStC,OAAOuC,MAAP,IAAiBC,OAA9B;AACA,QAAIC,SAASb,UAAUa,MAAV,IAAoBC,OAAjC;AACA,aAASC,QAAT,CAAkBtG,CAAlB,EAAqB;AAAE,eAAOA,CAAP;AAAW;AAClC,aAASuG,MAAT,GAAkB,CAAG;AACrB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwDA,aAASC,oBAAT,CAA8BC,MAA9B,EAAsCC,MAAtC,EAA8ChB,IAA9C,EAAoDiB,OAApD,EAA6DC,QAA7D,EAAuE;AACnE,YAAIA,aAAa,KAAK,CAAtB,EAAyB;AAAEA,uBAAW,KAAX;AAAmB;AAC9C,YAAIC,eAAe,SAAfA,YAAe,CAAUpG,MAAV,EAAkB;AACjC,mBAAOgG,SAAShG,MAAT,EAAiBiF,IAAjB,CAAsBA,MAAtB,CAAP;AACH,SAFD;AAGA,YAAIoB,mBAAmB,SAAnBA,gBAAmB,CAAUrG,MAAV,EAAkB;AAAE,mBAAO,SAASsG,kBAAT,GAA8B;AAC5EL,uBAAOjG,MAAP,IAAiBoG,aAAapG,MAAb,CAAjB;AACA,uBAAOiG,OAAOjG,MAAP,EAAe1C,KAAf,CAAqB,IAArB,EAA2BC,SAA3B,CAAP;AACH,aAH0C;AAGvC,SAHJ;AAIA2I,kBAAUA,WAAWhD,OAAOqD,IAAP,CAAYP,QAAZ,CAArB;AACA,eAAOE,QAAQ7G,MAAR,CAAe,UAAUmH,GAAV,EAAejI,IAAf,EAAqB;AACvCiI,gBAAIjI,IAAJ,IAAY4H,WAAWE,iBAAiB9H,IAAjB,CAAX,GAAoC6H,aAAa7H,IAAb,CAAhD;AACA,mBAAOiI,GAAP;AACH,SAHM,EAGJP,MAHI,CAAP;AAIH;AACD;;;;AAIA,QAAI3E,UAAU,SAAVA,OAAU,CAAUO,MAAV,EAAkB4E,KAAlB,EAAyB;AACnC,eAAOjB,OAAOtC,OAAOhC,MAAP,CAAcW,MAAd,CAAP,EAA8B4E,KAA9B,CAAP;AACH,KAFD;AAGA;AACA,QAAIC,UAAUxJ,MAAMyJ,QAAN,CAAd;AACA,aAASA,QAAT,CAAkBC,KAAlB,EAAyBpI,GAAzB,EAA8B;AAC1B,eAAOoI,MAAMC,OAAN,CAAcrI,GAAd,MAAuB,CAAC,CAA/B;AACH;AACD;;;;AAIA,QAAIsI,aAAa5J,MAAM6J,WAAN,CAAjB;AACA,aAASA,WAAT,CAAqBH,KAArB,EAA4BpI,GAA5B,EAAiC;AAC7B,YAAIwI,MAAMJ,MAAMC,OAAN,CAAcrI,GAAd,CAAV;AACA,YAAIwI,OAAO,CAAX,EACIJ,MAAMK,MAAN,CAAaD,GAAb,EAAkB,CAAlB;AACJ,eAAOJ,KAAP;AACH;AACD;AACA,QAAIM,SAAShK,MAAMiK,OAAN,CAAb;AACA,aAASA,OAAT,CAAiB/H,GAAjB,EAAsB6E,MAAtB,EAA8B;AAC1B,eAAQ7E,IAAIgI,IAAJ,CAASnD,MAAT,GAAkBA,MAA1B;AACH;AACD;AACA,QAAIoD,WAAW,SAAXA,QAAW,CAAUC,SAAV,EAAqB;AAChC,eAAOA,UAAUjK,KAAV,GAAkBiI,OAAlB,CAA0B,UAAUnI,EAAV,EAAc;AAC3C,mBAAOA,EAAP,KAAc,UAAd,IAA4BA,IAA5B;AACA2J,uBAAWQ,SAAX,EAAsBnK,EAAtB;AACH,SAHM,CAAP;AAIH,KALD;AAMA;;;;;AAKA,aAAS8E,QAAT,CAAkBD,IAAlB,EAAwB;AACpB,YAAIuF,eAAe,EAAnB;AACA,aAAK,IAAInJ,KAAK,CAAd,EAAiBA,KAAKb,UAAUE,MAAhC,EAAwCW,IAAxC,EAA8C;AAC1CmJ,yBAAanJ,KAAK,CAAlB,IAAuBb,UAAUa,EAAV,CAAvB;AACH;AACD,YAAIoJ,gBAAgBD,aAAa3J,MAAb,CAAoB,EAApB,EAAwBS,OAAxB,EAApB;AACA,YAAIoJ,cAAcjC,OAAOlI,KAAP,CAAa,IAAb,EAAmBkK,aAAnB,CAAlB;AACA,eAAOhC,OAAO,EAAP,EAAWiC,WAAX,EAAwBC,KAAK1F,QAAQ,EAAb,EAAiBkB,OAAOqD,IAAP,CAAYkB,WAAZ,CAAjB,CAAxB,CAAP;AACH;AACD;AACA,QAAIE,SAAS,SAATA,MAAS,CAAUC,IAAV,EAAgBC,IAAhB,EAAsB;AAAE,eAAOrC,OAAOoC,IAAP,EAAaC,IAAb,CAAP;AAA4B,KAAjE;AACA;;;;;;;AAOA,aAASC,SAAT,CAAmBC,KAAnB,EAA0BC,MAA1B,EAAkC;AAC9B,YAAIC,OAAO,EAAX;AACA,aAAK,IAAIC,CAAT,IAAcH,MAAME,IAApB,EAA0B;AACtB,gBAAIF,MAAME,IAAN,CAAWC,CAAX,MAAkBF,OAAOC,IAAP,CAAYC,CAAZ,CAAtB,EACI;AACJD,iBAAKb,IAAL,CAAUW,MAAME,IAAN,CAAWC,CAAX,CAAV;AACH;AACD,eAAOD,IAAP;AACH;AACD;;;;;;;;;;;AAWA,aAASP,IAAT,CAAclJ,GAAd,EAAmB2J,SAAnB,EAA8B;AAC1B,YAAIC,UAAU,EAAd;AACA,aAAK,IAAIC,MAAT,IAAmB7J,GAAnB,EAAwB;AACpB,gBAAI2J,UAAUtB,OAAV,CAAkBwB,MAAlB,MAA8B,CAAC,CAAnC,EAAsC;AAClCD,wBAAQC,MAAR,IAAkB7J,IAAI6J,MAAJ,CAAlB;AACH;AACJ;AACD,eAAOD,OAAP;AACH;AACD;;;;;;;;;;;;AAYA,aAASE,IAAT,CAAc9J,GAAd,EAAmB2J,SAAnB,EAA8B;AAC1B,eAAOjF,OAAOqD,IAAP,CAAY/H,GAAZ,EACF8D,MADE,CACKxD,IAAI4H,QAAQyB,SAAR,CAAJ,CADL,EAEF9I,MAFE,CAEK,UAAUmH,GAAV,EAAe+B,GAAf,EAAoB;AAAE,mBAAQ/B,IAAI+B,GAAJ,IAAW/J,IAAI+J,GAAJ,CAAX,EAAqB/B,GAA7B;AAAoC,SAF/D,EAEiE,EAFjE,CAAP;AAGH;AACD;;;AAGA,aAASgC,KAAT,CAAeC,UAAf,EAA2BC,QAA3B,EAAqC;AACjC,eAAO7J,IAAI4J,UAAJ,EAAgBnK,KAAKoK,QAAL,CAAhB,CAAP;AACH;AACD;AACA,aAASpG,MAAT,CAAgBmG,UAAhB,EAA4BE,QAA5B,EAAsC;AAClC,YAAIvJ,MAAMwE,QAAQ6E,UAAR,CAAV;AAAA,YAA+BzK,SAASoB,MAAM,EAAN,GAAW,EAAnD;AACA,YAAIwJ,SAASxJ,MAAM,UAAUG,CAAV,EAAa;AAAE,mBAAOvB,OAAOoJ,IAAP,CAAY7H,CAAZ,CAAP;AAAwB,SAA7C,GAAgD,UAAUA,CAAV,EAAagJ,GAAb,EAAkB;AAAE,mBAAOvK,OAAOuK,GAAP,IAAchJ,CAArB;AAAyB,SAA1G;AACA+F,gBAAQmD,UAAR,EAAoB,UAAUZ,IAAV,EAAgB9J,CAAhB,EAAmB;AACnC,gBAAI4K,SAASd,IAAT,EAAe9J,CAAf,CAAJ,EACI6K,OAAOf,IAAP,EAAa9J,CAAb;AACP,SAHD;AAIA,eAAOC,MAAP;AACH;AACD;AACA,aAAS4E,IAAT,CAAc6F,UAAd,EAA0BE,QAA1B,EAAoC;AAChC,YAAI3K,MAAJ;AACAsH,gBAAQmD,UAAR,EAAoB,UAAUZ,IAAV,EAAgB9J,CAAhB,EAAmB;AACnC,gBAAIC,MAAJ,EACI;AACJ,gBAAI2K,SAASd,IAAT,EAAe9J,CAAf,CAAJ,EACIC,SAAS6J,IAAT;AACP,SALD;AAMA,eAAO7J,MAAP;AACH;AACD;AACA,QAAI6K,SAAShK,GAAb;AACA;AACA,aAASA,GAAT,CAAa4J,UAAb,EAAyBE,QAAzB,EAAmC;AAC/B,YAAI3K,SAAS4F,QAAQ6E,UAAR,IAAsB,EAAtB,GAA2B,EAAxC;AACAnD,gBAAQmD,UAAR,EAAoB,UAAUZ,IAAV,EAAgB9J,CAAhB,EAAmB;AAAE,mBAAOC,OAAOD,CAAP,IAAY4K,SAASd,IAAT,EAAe9J,CAAf,CAAnB;AAAuC,SAAhF;AACA,eAAOC,MAAP;AACH;AACD;;;;;;;;;;AAUA,QAAIoE,SAAS,SAATA,MAAS,CAAU5D,GAAV,EAAe;AACxB,eAAO0E,OAAOqD,IAAP,CAAY/H,GAAZ,EAAiBK,GAAjB,CAAqB,UAAU0J,GAAV,EAAe;AAAE,mBAAO/J,IAAI+J,GAAJ,CAAP;AAAkB,SAAxD,CAAP;AACH,KAFD;AAGA;;;;;;;;;;;;;AAaA,QAAIO,WAAW,SAAXA,QAAW,CAAUlB,IAAV,EAAgBmB,IAAhB,EAAsB;AAAE,eAAOnB,QAAQmB,IAAf;AAAsB,KAA7D;AACA;;;;;;;;;;;;;AAaA,QAAIC,WAAW,SAAXA,QAAW,CAAUpB,IAAV,EAAgBmB,IAAhB,EAAsB;AAAE,eAAOnB,QAAQmB,IAAf;AAAsB,KAA7D;AACA;;;;;;;;;AASA,QAAIE,UAAU,SAAVA,OAAU,CAAUrB,IAAV,EAAgBmB,IAAhB,EAAsB;AAAE,eAAOnB,KAAKhK,MAAL,CAAYmL,IAAZ,CAAP;AAA2B,KAAjE;AACA;;;;;;;;;;AAUA,QAAIG,WAAW,SAAXA,QAAW,CAAUtB,IAAV,EAAgBmB,IAAhB,EAAsB;AACjC,eAAOnF,QAAQmF,IAAR,IAAgBnB,KAAKhK,MAAL,CAAYmL,KAAK1J,MAAL,CAAY6J,QAAZ,EAAsB,EAAtB,CAAZ,CAAhB,GAAyDC,MAAMvB,IAAN,EAAYmB,IAAZ,CAAhE;AACH,KAFD;AAGA;;;;AAIA,aAASI,KAAT,CAAe/J,GAAf,EAAoBZ,GAApB,EAAyB;AACrBY,YAAIgI,IAAJ,CAAS5I,GAAT;AACA,eAAOY,GAAP;AACH;AACD;AACA,QAAIgK,QAAQ,SAARA,KAAQ,CAAU5C,GAAV,EAAe6C,KAAf,EAAsB;AAC9B,eAAO3C,QAAQF,GAAR,EAAa6C,KAAb,IAAsB7C,GAAtB,GAA4B2C,MAAM3C,GAAN,EAAW6C,KAAX,CAAnC;AACH,KAFD;AAGA;;;;;;;;;;AAUA,QAAIC,SAAS,SAATA,MAAS,CAAUlK,GAAV,EAAe;AAAE,eAAOA,IAAIC,MAAJ,CAAW4J,OAAX,EAAoB,EAApB,CAAP;AAAiC,KAA/D;AACA;;;;;;;;;;AAUA,QAAIM,UAAU,SAAVA,OAAU,CAAUnK,GAAV,EAAe;AAAE,eAAOA,IAAIC,MAAJ,CAAW6J,QAAX,EAAqB,EAArB,CAAP;AAAkC,KAAjE;AACA;;;;;;;;;;;;;AAaA,QAAIM,kBAAkBC,QAAtB;AACA;;;;;;;;;;;;;;;;AAgBA,QAAIC,YAAYD,QAAhB;AACA,aAASA,QAAT,CAAkBE,cAAlB,EAAkCC,MAAlC,EAA0C;AACtC,YAAIA,WAAW,KAAK,CAApB,EAAuB;AAAEA,qBAAS,gBAAT;AAA4B;AACrD,eAAO,UAAUpL,GAAV,EAAe;AAClB,gBAAIR,SAAS2L,eAAenL,GAAf,CAAb;AACA,gBAAI,CAACR,MAAL,EAAa;AACT,sBAAM,IAAIuG,KAAJ,CAAUzB,WAAW8G,MAAX,IAAqBA,OAAOpL,GAAP,CAArB,GAAmCoL,MAA7C,CAAN;AACH;AACD,mBAAO5L,MAAP;AACH,SAND;AAOH;AACD;;;;;;;;;AASA,QAAI6L,QAAQ,SAARA,KAAQ,CAAUrL,GAAV,EAAe;AACvB,eAAO0E,OAAOqD,IAAP,CAAY/H,GAAZ,EAAiBK,GAAjB,CAAqB,UAAU0J,GAAV,EAAe;AAAE,mBAAO,CAACA,GAAD,EAAM/J,IAAI+J,GAAJ,CAAN,CAAP;AAAyB,SAA/D,CAAP;AACH,KAFD;AAGA;;;;;;;;;;;;;;AAcA,aAASuB,WAAT,GAAuB;AACnB,YAAInM,OAAO,EAAX;AACA,aAAK,IAAIS,KAAK,CAAd,EAAiBA,KAAKb,UAAUE,MAAhC,EAAwCW,IAAxC,EAA8C;AAC1CT,iBAAKS,EAAL,IAAWb,UAAUa,EAAV,CAAX;AACH;AACD,YAAIT,KAAKF,MAAL,KAAgB,CAApB,EACI,OAAO,EAAP;AACJ,YAAIsM,cAAcpM,KAAK0B,MAAL,CAAY,UAAU2K,GAAV,EAAe5K,GAAf,EAAoB;AAAE,mBAAO6K,KAAKD,GAAL,CAAS5K,IAAI3B,MAAb,EAAqBuM,GAArB,CAAP;AAAmC,SAArE,EAAuE,gBAAvE,CAAlB,CAPmB,CAOyF;AAC5G,YAAIjM,CAAJ;AAAA,YAAOC,SAAS,EAAhB;AACA,aAAKD,IAAI,CAAT,EAAYA,IAAIgM,WAAhB,EAA6BhM,GAA7B,EAAkC;AAC9B;AACA;AACA,oBAAQJ,KAAKF,MAAb;AACI,qBAAK,CAAL;AACIO,2BAAOoJ,IAAP,CAAY,CAACzJ,KAAK,CAAL,EAAQI,CAAR,CAAD,CAAZ;AACA;AACJ,qBAAK,CAAL;AACIC,2BAAOoJ,IAAP,CAAY,CAACzJ,KAAK,CAAL,EAAQI,CAAR,CAAD,EAAaJ,KAAK,CAAL,EAAQI,CAAR,CAAb,CAAZ;AACA;AACJ,qBAAK,CAAL;AACIC,2BAAOoJ,IAAP,CAAY,CAACzJ,KAAK,CAAL,EAAQI,CAAR,CAAD,EAAaJ,KAAK,CAAL,EAAQI,CAAR,CAAb,EAAyBJ,KAAK,CAAL,EAAQI,CAAR,CAAzB,CAAZ;AACA;AACJ,qBAAK,CAAL;AACIC,2BAAOoJ,IAAP,CAAY,CAACzJ,KAAK,CAAL,EAAQI,CAAR,CAAD,EAAaJ,KAAK,CAAL,EAAQI,CAAR,CAAb,EAAyBJ,KAAK,CAAL,EAAQI,CAAR,CAAzB,EAAqCJ,KAAK,CAAL,EAAQI,CAAR,CAArC,CAAZ;AACA;AACJ;AACIC,2BAAOoJ,IAAP,CAAYzJ,KAAKkB,GAAL,CAAS,UAAU+H,KAAV,EAAiB;AAAE,+BAAOA,MAAM7I,CAAN,CAAP;AAAkB,qBAA9C,CAAZ;AACA;AAfR;AAiBH;AACD,eAAOC,MAAP;AACH;AACD;;;;;;;;;;;;;;;;;;;;AAoBA,aAASkM,UAAT,CAAoBtC,IAApB,EAA0BuC,WAA1B,EAAuC;AACnC,YAAI5B,GAAJ,EAAS6B,KAAT;AACA,YAAIxG,QAAQuG,WAAR,CAAJ,EACI5B,MAAM4B,YAAY,CAAZ,CAAN,EAAsBC,QAAQD,YAAY,CAAZ,CAA9B;AACJ,YAAI,CAACxG,SAAS4E,GAAT,CAAL,EACI,MAAM,IAAIhE,KAAJ,CAAU,kCAAV,CAAN;AACJqD,aAAKW,GAAL,IAAY6B,KAAZ;AACA,eAAOxC,IAAP;AACH;AACD;AACA,aAASzD,IAAT,CAAc/E,GAAd,EAAmB;AACf,eAAOA,IAAI3B,MAAJ,IAAc2B,IAAIA,IAAI3B,MAAJ,GAAa,CAAjB,CAAd,IAAqCiH,SAA5C;AACH;AACD;;;;;;AAMA,aAASW,KAAT,CAAegF,GAAf,EAAoBC,IAApB,EAA0B;AACtB,YAAIA,IAAJ,EACIpH,OAAOqD,IAAP,CAAY+D,IAAZ,EAAkBhF,OAAlB,CAA0B,UAAUiD,GAAV,EAAe;AAAE,mBAAO,OAAO+B,KAAK/B,GAAL,CAAd;AAA0B,SAArE;AACJ,YAAI,CAAC+B,IAAL,EACIA,OAAO,EAAP;AACJ,eAAO9E,OAAO8E,IAAP,EAAaD,GAAb,CAAP;AACH;AACD;AACA,aAAS9E,QAAT,CAAkB/G,GAAlB,EAAuB+L,EAAvB,EAA2BC,KAA3B,EAAkC;AAC9B,YAAI5G,QAAQpF,GAAR,CAAJ,EACI,OAAOA,IAAI8G,OAAJ,CAAYiF,EAAZ,EAAgBC,KAAhB,CAAP;AACJtH,eAAOqD,IAAP,CAAY/H,GAAZ,EAAiB8G,OAAjB,CAAyB,UAAUiD,GAAV,EAAe;AAAE,mBAAOgC,GAAG/L,IAAI+J,GAAJ,CAAH,EAAaA,GAAb,CAAP;AAA2B,SAArE;AACH;AACD,aAAS7C,OAAT,CAAiB+E,KAAjB,EAAwB;AACpB,aAAK,IAAI1M,IAAI,CAAb,EAAgBA,IAAIR,UAAUE,MAA9B,EAAsCM,GAAtC,EAA2C;AACvC,gBAAIS,MAAMjB,UAAUQ,CAAV,CAAV;AACA,gBAAI,CAACS,GAAL,EACI;AACJ,gBAAI+H,OAAOrD,OAAOqD,IAAP,CAAY/H,GAAZ,CAAX;AACA,iBAAK,IAAIkM,IAAI,CAAb,EAAgBA,IAAInE,KAAK9I,MAAzB,EAAiCiN,GAAjC,EAAsC;AAClCD,sBAAMlE,KAAKmE,CAAL,CAAN,IAAiBlM,IAAI+H,KAAKmE,CAAL,CAAJ,CAAjB;AACH;AACJ;AACD,eAAOD,KAAP;AACH;AACD,aAAS7E,OAAT,CAAiB+E,EAAjB,EAAqBC,EAArB,EAAyB;AACrB,YAAID,OAAOC,EAAX,EACI,OAAO,IAAP;AACJ,YAAID,OAAO,IAAP,IAAeC,OAAO,IAA1B,EACI,OAAO,KAAP;AACJ,YAAID,OAAOA,EAAP,IAAaC,OAAOA,EAAxB,EACI,OAAO,IAAP,CANiB,CAMJ;AACjB,YAAIC,YAAYF,EAAZ,yCAAYA,EAAZ,CAAJ;AAAA,YAAoBG,YAAYF,EAAZ,yCAAYA,EAAZ,CAApB;AACA,YAAIC,OAAOC,EAAP,IAAaD,OAAO,QAAxB,EACI,OAAO,KAAP;AACJ,YAAIE,MAAM,CAACJ,EAAD,EAAKC,EAAL,CAAV;AACA,YAAIzL,IAAIyE,OAAJ,EAAamH,GAAb,CAAJ,EACI,OAAOC,UAAUL,EAAV,EAAcC,EAAd,CAAP;AACJ,YAAIzL,IAAI2E,MAAJ,EAAYiH,GAAZ,CAAJ,EACI,OAAOJ,GAAGM,OAAH,OAAiBL,GAAGK,OAAH,EAAxB;AACJ,YAAI9L,IAAI4E,QAAJ,EAAcgH,GAAd,CAAJ,EACI,OAAOJ,GAAG9H,QAAH,OAAkB+H,GAAG/H,QAAH,EAAzB;AACJ,YAAI1D,IAAI2D,UAAJ,EAAgBiI,GAAhB,CAAJ,EACI,OAAO,IAAP,CAlBiB,CAkBJ;AACjB,YAAIG,aAAa,CAACpI,UAAD,EAAac,OAAb,EAAsBE,MAAtB,EAA8BC,QAA9B,CAAjB;AACA,YAAImH,WAAWrM,GAAX,CAAeW,GAAf,EAAoBH,MAApB,CAA2B,UAAUC,CAAV,EAAanC,EAAb,EAAiB;AAAE,mBAAOmC,KAAK,CAAC,CAACnC,GAAG4N,GAAH,CAAd;AAAwB,SAAtE,EAAwE,KAAxE,CAAJ,EACI,OAAO,KAAP;AACJ,YAAIxC,GAAJ;AAAA,YAAShC,OAAO,EAAhB;AACA,aAAKgC,GAAL,IAAYoC,EAAZ,EAAgB;AACZ,gBAAI,CAAC/E,QAAQ+E,GAAGpC,GAAH,CAAR,EAAiBqC,GAAGrC,GAAH,CAAjB,CAAL,EACI,OAAO,KAAP;AACJhC,iBAAKgC,GAAL,IAAY,IAAZ;AACH;AACD,aAAKA,GAAL,IAAYqC,EAAZ,EAAgB;AACZ,gBAAI,CAACrE,KAAKgC,GAAL,CAAL,EACI,OAAO,KAAP;AACP;AACD,eAAO,IAAP;AACH;AACD,aAASyC,SAAT,CAAmBG,EAAnB,EAAuBC,EAAvB,EAA2B;AACvB,YAAID,GAAG1N,MAAH,KAAc2N,GAAG3N,MAArB,EACI,OAAO,KAAP;AACJ,eAAOqM,YAAYqB,EAAZ,EAAgBC,EAAhB,EAAoB/L,MAApB,CAA2B,UAAUC,CAAV,EAAa8D,CAAb,EAAgB;AAAE,mBAAO9D,KAAKsG,QAAQxC,EAAE,CAAF,CAAR,EAAcA,EAAE,CAAF,CAAd,CAAZ;AAAkC,SAA/E,EAAiF,IAAjF,CAAP;AACH;AACD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkCA,QAAIiI,SAAS,SAATA,MAAS,CAAUC,MAAV,EAAkBC,OAAlB,EAA2B;AACpC,YAAIA,YAAY,KAAK,CAArB,EAAwB;AAAEA,sBAAU7M,IAAI,IAAJ,CAAV;AAAsB;AAChD,eAAO,UAAU8M,CAAV,EAAalM,CAAb,EAAgB;AACnB,mBAAQiM,QAAQC,CAAR,KAAcD,QAAQjM,CAAR,CAAf,GAA6BgM,OAAOE,CAAP,IAAYF,OAAOhM,CAAP,CAAzC,GAAqD,CAA5D;AACH,SAFD;AAGH,KALD;AAMA;;;;;;;;;AASA,QAAImM,cAAc,SAAdA,WAAc,GAAY;AAC1B,YAAIC,UAAU,EAAd;AACA,aAAK,IAAItN,KAAK,CAAd,EAAiBA,KAAKb,UAAUE,MAAhC,EAAwCW,IAAxC,EAA8C;AAC1CsN,oBAAQtN,EAAR,IAAcb,UAAUa,EAAV,CAAd;AACH;AACD,eAAO,SAASuN,YAAT,CAAsBH,CAAtB,EAAyBlM,CAAzB,EAA4B;AAC/B,mBAAOoM,QAAQrM,MAAR,CAAe,UAAUuM,IAAV,EAAgBzO,EAAhB,EAAoB;AAAE,uBAAOyO,QAAQzO,GAAGqO,CAAH,EAAMlM,CAAN,CAAf;AAA0B,aAA/D,EAAiE,CAAjE,CAAP;AACH,SAFD;AAGH,KARD;AASA;AACA,QAAIuM,2BAA2B,SAA3BA,wBAA2B,CAAUC,OAAV,EAAmB;AAC9C,eAAOA,QAAQC,KAAR,CAAc,UAAUC,CAAV,EAAa;AAAE,mBAAO,CAAP;AAAW,SAAxC,KAA6CF,OAApD;AACH,KAFD;AAGA,QAAIG,kBAAkB,SAAlBA,eAAkB,CAAUC,KAAV,EAAiB;AACnC,eAAOL,yBAAyBrH,SAASC,EAAT,CAAY0H,MAAZ,CAAmBD,KAAnB,CAAzB,CAAP;AACH,KAFD;;AAIA;;OA9iC2C,CAgjCvC;AACJ,QAAIE,QAAS,YAAY;AACrB,iBAASA,KAAT,CAAeC,MAAf,EAAuBC,MAAvB,EAA+B;AAC3B,gBAAID,WAAW,KAAK,CAApB,EAAuB;AAAEA,yBAAS,EAAT;AAAc;AACvC,gBAAIC,WAAW,KAAK,CAApB,EAAuB;AAAEA,yBAAS,IAAT;AAAgB;AACzC,iBAAKD,MAAL,GAAcA,MAAd;AACA,iBAAKC,MAAL,GAAcA,MAAd;AACH;AACDF,cAAMzL,SAAN,CAAgB4L,OAAhB,GAA0B,UAAU1E,IAAV,EAAgB;AACtC,gBAAI2E,QAAQ,KAAKH,MAAjB;AACAG,kBAAMpF,IAAN,CAAWS,IAAX;AACA,gBAAI,KAAKyE,MAAL,IAAeE,MAAM/O,MAAN,GAAe,KAAK6O,MAAvC,EACIE,MAAMC,KAAN;AACJ,mBAAO5E,IAAP;AACH,SAND;AAOAuE,cAAMzL,SAAN,CAAgB+L,OAAhB,GAA0B,YAAY;AAClC,gBAAI,KAAKC,IAAL,EAAJ,EACI,OAAO,KAAKN,MAAL,CAAYpF,MAAZ,CAAmB,CAAnB,EAAsB,CAAtB,EAAyB,CAAzB,CAAP;AACP,SAHD;AAIAmF,cAAMzL,SAAN,CAAgBiM,KAAhB,GAAwB,YAAY;AAChC,gBAAIC,UAAU,KAAKR,MAAnB;AACA,iBAAKA,MAAL,GAAc,EAAd;AACA,mBAAOQ,OAAP;AACH,SAJD;AAKAT,cAAMzL,SAAN,CAAgBgM,IAAhB,GAAuB,YAAY;AAC/B,mBAAO,KAAKN,MAAL,CAAY5O,MAAnB;AACH,SAFD;AAGA2O,cAAMzL,SAAN,CAAgBmM,MAAhB,GAAyB,UAAUjF,IAAV,EAAgB;AACrC,gBAAIb,MAAM,KAAKqF,MAAL,CAAYxF,OAAZ,CAAoBgB,IAApB,CAAV;AACA,mBAAOb,MAAM,CAAC,CAAP,IAAY,KAAKqF,MAAL,CAAYpF,MAAZ,CAAmBD,GAAnB,EAAwB,CAAxB,EAA2B,CAA3B,CAAnB;AACH,SAHD;AAIAoF,cAAMzL,SAAN,CAAgBoM,QAAhB,GAA2B,YAAY;AACnC,mBAAO,KAAKV,MAAL,CAAY,KAAKA,MAAL,CAAY5O,MAAZ,GAAqB,CAAjC,CAAP;AACH,SAFD;AAGA2O,cAAMzL,SAAN,CAAgBqM,QAAhB,GAA2B,YAAY;AACnC,gBAAI,KAAKL,IAAL,EAAJ,EACI,OAAO,KAAKN,MAAL,CAAY,CAAZ,CAAP;AACP,SAHD;AAIA,eAAOD,KAAP;AACH,KAtCY,EAAb;;AAwCA;;;OAzlC2C,CA4lCvC;;AAEJ,KAAC,UAAUa,UAAV,EAAsB;AACnBA,mBAAWA,WAAW,YAAX,IAA2B,CAAtC,IAA2C,YAA3C;AACAA,mBAAWA,WAAW,SAAX,IAAwB,CAAnC,IAAwC,SAAxC;AACAA,mBAAWA,WAAW,SAAX,IAAwB,CAAnC,IAAwC,SAAxC;AACAA,mBAAWA,WAAW,SAAX,IAAwB,CAAnC,IAAwC,SAAxC;AACAA,mBAAWA,WAAW,OAAX,IAAsB,CAAjC,IAAsC,OAAtC;AACH,KAND,EAMGtQ,QAAQsQ,UAAR,KAAuBtQ,QAAQsQ,UAAR,GAAqB,EAA5C,CANH;AAOA,kBAAe,IAAIxK,KAAK,CAAT;AACf,QAAIyK,YAAa,YAAY;AACzB,iBAASA,SAAT,CAAmBC,IAAnB,EAAyBC,OAAzB,EAAkCC,MAAlC,EAA0C;AACtC,iBAAKC,GAAL,GAAW7K,IAAX;AACA,iBAAK0K,IAAL,GAAYA,IAAZ;AACA,iBAAKC,OAAL,GAAeA,OAAf;AACA,iBAAKC,MAAL,GAAcA,MAAd;AACH;AACDH,kBAAUvM,SAAV,CAAoBkC,QAApB,GAA+B,YAAY;AACvC,gBAAI0K,eAAe,SAAfA,YAAe,CAAUC,CAAV,EAAa;AAC5B,uBAAOA,KAAKA,EAAE3K,QAAF,KAAeK,OAAOvC,SAAP,CAAiBkC,QAArC,GAAgD2K,EAAE3K,QAAF,EAAhD,GAA+DsC,UAAUqI,CAAV,CAAtE;AACH,aAFD;AAGA,gBAAIH,SAASE,aAAa,KAAKF,MAAlB,CAAb;AACA,gBAAII,KAAK,IAAT;AAAA,gBAAeH,MAAMG,GAAGH,GAAxB;AAAA,gBAA6BH,OAAOM,GAAGN,IAAvC;AAAA,gBAA6CC,UAAUK,GAAGL,OAA1D;AACA,mBAAO,+BAA+BE,GAA/B,GAAqC,SAArC,GAAiDH,IAAjD,GAAwD,aAAxD,GAAwEC,OAAxE,GAAkF,YAAlF,GAAiGC,MAAjG,GAA0G,GAAjH;AACH,SAPD;AAQAH,kBAAUvM,SAAV,CAAoB+M,SAApB,GAAgC,YAAY;AACxC,mBAAOlI,OAAOyG,gBAAgB,IAAhB,CAAP,EAA8B,EAAE0B,sBAAsB,IAAxB,EAA9B,CAAP;AACH,SAFD;AAGA;AACAT,kBAAUU,kBAAV,GAA+B,UAAUpP,GAAV,EAAe;AAC1C,mBAAOA,OAAQ,OAAOA,IAAIqP,IAAX,KAAoB,UAA5B,IAA2CpO,GAAGyN,SAAH,EAAc1O,IAAImP,oBAAlB,CAAlD;AACH,SAFD;AAGA;AACAT,kBAAUY,UAAV,GAAuB,UAAUT,MAAV,EAAkBU,OAAlB,EAA2B;AAC9C,gBAAIX,UAAU,8DAAd;AACA,gBAAIY,YAAY,IAAId,SAAJ,CAAcvQ,QAAQsQ,UAAR,CAAmBgB,UAAjC,EAA6Cb,OAA7C,EAAsDC,MAAtD,CAAhB;AACA,gBAAIU,WAAWA,QAAQG,UAAvB,EAAmC;AAC/BF,0BAAUE,UAAV,GAAuB,IAAvB;AACH;AACD,mBAAOF,SAAP;AACH,SAPD;AAQA;AACAd,kBAAUgB,UAAV,GAAuB,UAAUb,MAAV,EAAkB;AACrC,mBAAOH,UAAUY,UAAV,CAAqBT,MAArB,EAA6B,EAAEa,YAAY,IAAd,EAA7B,CAAP;AACH,SAFD;AAGA;AACAhB,kBAAUiB,OAAV,GAAoB,UAAUd,MAAV,EAAkB;AAClC,gBAAID,UAAU,4BAAd;AACA,mBAAO,IAAIF,SAAJ,CAAcvQ,QAAQsQ,UAAR,CAAmBmB,OAAjC,EAA0ChB,OAA1C,EAAmDC,MAAnD,CAAP;AACH,SAHD;AAIA;AACAH,kBAAUmB,OAAV,GAAoB,UAAUhB,MAAV,EAAkB;AAClC,gBAAID,UAAU,4BAAd;AACA,mBAAO,IAAIF,SAAJ,CAAcvQ,QAAQsQ,UAAR,CAAmBqB,OAAjC,EAA0ClB,OAA1C,EAAmDC,MAAnD,CAAP;AACH,SAHD;AAIA;AACAH,kBAAUqB,OAAV,GAAoB,UAAUlB,MAAV,EAAkB;AAClC,gBAAID,UAAU,iCAAd;AACA,mBAAO,IAAIF,SAAJ,CAAcvQ,QAAQsQ,UAAR,CAAmBuB,OAAjC,EAA0CpB,OAA1C,EAAmDC,MAAnD,CAAP;AACH,SAHD;AAIA;AACAH,kBAAUuB,OAAV,GAAoB,UAAUpB,MAAV,EAAkB;AAClC,gBAAID,UAAU,wBAAd;AACA,mBAAO,IAAIF,SAAJ,CAAcvQ,QAAQsQ,UAAR,CAAmByB,KAAjC,EAAwCtB,OAAxC,EAAiDC,MAAjD,CAAP;AACH,SAHD;AAIA;;;;;;;;;AASAH,kBAAUyB,SAAV,GAAsB,UAAUtB,MAAV,EAAkB;AACpC,mBAAO5N,GAAGyN,SAAH,EAAcG,MAAd,IAAwBA,MAAxB,GAAiCH,UAAUuB,OAAV,CAAkBpB,MAAlB,CAAxC;AACH,SAFD;AAGA,eAAOH,SAAP;AACH,KApEgB,EAAjB;;AAsEA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;OA5qC2C,CA8sCvC;AACJ;AACA,aAAS0B,YAAT,CAAsBC,QAAtB,EAAgC;AAC5B,YAAI,CAACA,QAAL,EACI,OAAO,mBAAP;AACJ,eAAO,cAAcA,SAASpM,EAAvB,GAA4B,OAA5B,IACF,wBAAwBoM,SAASC,eAAT,IAA4BD,SAASC,eAAT,CAAyBvQ,IAArD,IAA6D,QAArF,IAAiG,YAD/F,KAEF,WAAWsQ,SAASjN,GAApB,GAA0B,KAFxB,KAGF,YAAYiN,SAAStQ,IAArB,GAA4B,GAA5B,GAAkCsQ,SAASC,eAA3C,GAA6D,IAH3D,CAAP;AAIH;AACD;AACA,QAAIC,mBAAmB,SAAnBA,gBAAmB,CAAUC,UAAV,EAAsB;AACzC,eAAO,iBAAiBA,WAAW1B,GAA5B,GAAkC,SAAlC,IAA+C0B,WAAWC,QAAX,CAAoBC,QAApB,CAA6B3Q,IAA7B,IAAqC,QAApF,IAAgG,6BAAhG,GAAgIyQ,WAAWC,QAAX,CAAoBE,WAApJ,GAAkK,GAAlK,GAAwKH,WAAWC,QAAX,CAAoBG,oBAA5L,GAAmN,GAA1N;AACH,KAFD;AAGA;AACA,aAASC,aAAT,CAAuBC,KAAvB,EAA8B;AAC1B,eAAO5L,SAAS4L,KAAT,IAAkB3S,QAAQ4S,QAAR,CAAiBD,KAAjB,CAAlB,GAA4C3S,QAAQ4S,QAAR,CAAiB5S,QAAQ4S,QAAR,CAAiBD,KAAjB,CAAjB,CAAnD;AACH;AACD;;;;;;;;;;;;;;AAcA,KAAC,UAAUC,QAAV,EAAoB;AACjBA,iBAASA,SAAS,SAAT,IAAsB,CAA/B,IAAoC,SAApC;AACAA,iBAASA,SAAS,YAAT,IAAyB,CAAlC,IAAuC,YAAvC;AACAA,iBAASA,SAAS,MAAT,IAAmB,CAA5B,IAAiC,MAAjC;AACAA,iBAASA,SAAS,QAAT,IAAqB,CAA9B,IAAmC,QAAnC;AACAA,iBAASA,SAAS,YAAT,IAAyB,CAAlC,IAAuC,YAAvC;AACH,KAND,EAMG5S,QAAQ4S,QAAR,KAAqB5S,QAAQ4S,QAAR,GAAmB,EAAxC,CANH;AAOA,kBAAe,IAAIC,OAAO7Q,MAAM,KAAN,CAAX;AACf,kBAAe,IAAI8Q,OAAO9Q,MAAM,YAAN,CAAX;AACf,kBAAe,IAAI+Q,WAAW,SAAXA,QAAW,CAAUC,KAAV,EAAiB;AAAE,eAAO,iBAAiBH,KAAKG,KAAL,CAAjB,GAA+B,GAA/B,GAAqCF,KAAKE,KAAL,CAA5C;AAA0D,KAA5F;AACf;;;AAGA,QAAIC,QAAS,YAAY;AACrB;AACA,iBAASA,KAAT,GAAiB;AACb;AACA,iBAAKC,QAAL,GAAgB,EAAhB;AACA,iBAAKC,kBAAL,GAA0B,CAA1B;AACH;AACD;AACAF,cAAMjP,SAAN,CAAgBoP,IAAhB,GAAuB,UAAUC,OAAV,EAAmBC,UAAnB,EAA+B;AAClD,gBAAIzF,QAAQ,IAAZ;AACA,gBAAI,CAACyF,WAAWxS,MAAhB,EAAwB;AACpBwS,6BAAa/M,OAAOqD,IAAP,CAAY5J,QAAQ4S,QAApB,EACR1Q,GADQ,CACJ,UAAUqR,CAAV,EAAa;AAAE,2BAAOC,SAASD,CAAT,EAAY,EAAZ,CAAP;AAAyB,iBADpC,EAER5N,MAFQ,CAED,UAAU4N,CAAV,EAAa;AAAE,2BAAO,CAACE,MAAMF,CAAN,CAAR;AAAmB,iBAFjC,EAGRrR,GAHQ,CAGJ,UAAU0J,GAAV,EAAe;AAAE,2BAAO5L,QAAQ4S,QAAR,CAAiBhH,GAAjB,CAAP;AAA+B,iBAH5C,CAAb;AAIH;AACD0H,uBAAWpR,GAAX,CAAewQ,aAAf,EAA8B/J,OAA9B,CAAsC,UAAU+K,QAAV,EAAoB;AAAE,uBAAO7F,MAAMqF,QAAN,CAAeQ,QAAf,IAA2BL,OAAlC;AAA4C,aAAxG;AACH,SATD;AAUA;;;;;;;;;;AAUAJ,cAAMjP,SAAN,CAAgB2P,MAAhB,GAAyB,YAAY;AACjC,gBAAIL,aAAa,EAAjB;AACA,iBAAK,IAAI7R,KAAK,CAAd,EAAiBA,KAAKb,UAAUE,MAAhC,EAAwCW,IAAxC,EAA8C;AAC1C6R,2BAAW7R,EAAX,IAAiBb,UAAUa,EAAV,CAAjB;AACH;AACD,iBAAK2R,IAAL,CAAU,IAAV,EAAgBE,UAAhB;AACH,SAND;AAOA;;;;;;;;;;AAUAL,cAAMjP,SAAN,CAAgB4P,OAAhB,GAA0B,YAAY;AAClC,gBAAIN,aAAa,EAAjB;AACA,iBAAK,IAAI7R,KAAK,CAAd,EAAiBA,KAAKb,UAAUE,MAAhC,EAAwCW,IAAxC,EAA8C;AAC1C6R,2BAAW7R,EAAX,IAAiBb,UAAUa,EAAV,CAAjB;AACH;AACD,iBAAK2R,IAAL,CAAU,KAAV,EAAiBE,UAAjB;AACH,SAND;AAOA;;;;;;;;;AASAL,cAAMjP,SAAN,CAAgBqP,OAAhB,GAA0B,UAAUK,QAAV,EAAoB;AAC1C,mBAAO,CAAC,CAAC,KAAKR,QAAL,CAAcR,cAAcgB,QAAd,CAAd,CAAT;AACH,SAFD;AAGA;AACAT,cAAMjP,SAAN,CAAgB6P,oBAAhB,GAAuC,UAAUb,KAAV,EAAiB;AACpD,gBAAI,CAAC,KAAKK,OAAL,CAAarT,QAAQ4S,QAAR,CAAiBkB,UAA9B,CAAL,EACI;AACJC,oBAAQC,GAAR,CAAYjB,SAASC,KAAT,IAAkB,gBAAlB,GAAqCxK,UAAUwK,KAAV,CAAjD;AACH,SAJD;AAKA;AACAC,cAAMjP,SAAN,CAAgBiQ,sBAAhB,GAAyC,UAAUjB,KAAV,EAAiB;AACtD,gBAAI,CAAC,KAAKK,OAAL,CAAarT,QAAQ4S,QAAR,CAAiBkB,UAA9B,CAAL,EACI;AACJC,oBAAQC,GAAR,CAAYjB,SAASC,KAAT,IAAkB,gBAAlB,GAAqCxK,UAAUwK,KAAV,CAAjD;AACH,SAJD;AAKA;AACAC,cAAMjP,SAAN,CAAgBkQ,mBAAhB,GAAsC,UAAUC,IAAV,EAAgBnB,KAAhB,EAAuB5B,OAAvB,EAAgC;AAClE,gBAAI,CAAC,KAAKiC,OAAL,CAAarT,QAAQ4S,QAAR,CAAiBwB,IAA9B,CAAL,EACI;AACJ,gBAAIC,QAAQrS,MAAM,oBAAN,EAA4BoP,OAA5B,KAAwC,UAApD;AAAA,gBAAgEkD,UAAUtS,MAAM,8BAAN,EAAsCoP,OAAtC,KAAkDpP,MAAM,mBAAN,EAA2BoP,OAA3B,CAAlD,IAAyF,SAAnK;AAAA,gBAA8KxP,OAAO2S,iBAAiBJ,KAAKK,cAAL,CAAoBxI,QAArC,CAArL;AACA+H,oBAAQC,GAAR,CAAYjB,SAASC,KAAT,IAAkB,cAAlB,GAAmCqB,KAAnC,GAA2C,YAA3C,GAA0DC,OAA1D,GAAoE,IAApE,GAA2EG,UAAU,GAAV,EAAe7S,IAAf,CAAvF;AACH,SALD;AAMA;AACAqR,cAAMjP,SAAN,CAAgB0Q,eAAhB,GAAkC,UAAUC,UAAV,EAAsB3B,KAAtB,EAA6B4B,iBAA7B,EAAgD;AAC9E,gBAAI,CAAC,KAAKvB,OAAL,CAAarT,QAAQ4S,QAAR,CAAiBwB,IAA9B,CAAL,EACI;AACJL,oBAAQC,GAAR,CAAYjB,SAASC,KAAT,IAAkB,wBAAlB,GAA6CyB,UAAU,GAAV,EAAejM,UAAUmM,UAAV,CAAf,CAAzD;AACH,SAJD;AAKA;AACA1B,cAAMjP,SAAN,CAAgB6Q,gBAAhB,GAAmC,UAAUvJ,IAAV,EAAgBwJ,IAAhB,EAAsB9B,KAAtB,EAA6B;AAC5D,gBAAI,CAAC,KAAKK,OAAL,CAAarT,QAAQ4S,QAAR,CAAiBmC,OAA9B,CAAL,EACI;AACJhB,oBAAQC,GAAR,CAAYjB,SAASC,KAAT,IAAkB,sBAAlB,GAA2C1H,IAA3C,GAAkD,IAAlD,GAAyDwJ,IAAzD,GAAgE,GAA5E;AACH,SAJD;AAKA;AACA7B,cAAMjP,SAAN,CAAgBgR,uBAAhB,GAA0C,UAAUC,UAAV,EAAsBjC,KAAtB,EAA6B;AACnE,gBAAI,CAAC,KAAKK,OAAL,CAAarT,QAAQ4S,QAAR,CAAiBmC,OAA9B,CAAL,EACI;AACJhB,oBAAQC,GAAR,CAAYjB,SAASC,KAAT,IAAkB,+BAAlB,GAAoDiC,UAApD,GAAiE,OAAjE,GAA2ER,UAAU,GAAV,EAAejM,UAAUyM,WAAWC,IAArB,CAAf,CAAvF;AACH,SAJD;AAKA;AACAjC,cAAMjP,SAAN,CAAgBmR,UAAhB,GAA6B,UAAUC,MAAV,EAAkBpC,KAAlB,EAAyB;AAClD,gBAAI,CAAC,KAAKK,OAAL,CAAarT,QAAQ4S,QAAR,CAAiBkB,UAA9B,CAAL,EACI;AACJC,oBAAQC,GAAR,CAAYjB,SAASC,KAAT,IAAkB,gBAAlB,GAAqCxK,UAAUwK,KAAV,CAArC,GAAwD,YAAxD,GAAuEoC,MAAnF;AACH,SAJD;AAKA;AACAnC,cAAMjP,SAAN,CAAgBqR,YAAhB,GAA+B,UAAUC,UAAV,EAAsBtC,KAAtB,EAA6B;AACxD,gBAAI,CAAC,KAAKK,OAAL,CAAarT,QAAQ4S,QAAR,CAAiBkB,UAA9B,CAAL,EACI;AACJC,oBAAQC,GAAR,CAAYjB,SAASC,KAAT,IAAkB,gBAAlB,GAAqCxK,UAAUwK,KAAV,CAArC,GAAwD,iBAAxD,GAA4EsC,WAAW1T,IAAnG;AACH,SAJD;AAKA;AACAqR,cAAMjP,SAAN,CAAgBuR,gBAAhB,GAAmC,UAAUlB,KAAV,EAAiBnC,QAAjB,EAA2BpI,KAA3B,EAAkC;AACjE,gBAAIA,UAAU,KAAK,CAAnB,EAAsB;AAAEA,wBAAQ,EAAR;AAAa;AACrC,gBAAI,CAAC,KAAKuJ,OAAL,CAAarT,QAAQ4S,QAAR,CAAiB4C,MAA9B,CAAL,EACI;AACJzB,oBAAQC,GAAR,CAAY,cAAcyB,UAAU,EAAV,EAAcpB,KAAd,CAAd,GAAqC,GAArC,GAA2CpC,aAAaC,QAAb,CAA3C,GAAoEpI,KAAhF;AACH,SALD;AAMA;AACAmJ,cAAMjP,SAAN,CAAgB0R,wBAAhB,GAA2C,UAAUxD,QAAV,EAAoBoC,OAApB,EAA6B;AACpE,gBAAI,CAAC,KAAKjB,OAAL,CAAarT,QAAQ4S,QAAR,CAAiB4C,MAA9B,CAAL,EACI;AACJ,iBAAKD,gBAAL,CAAsB,UAAtB,EAAkCrD,QAAlC,EAA4C,oCAAoCoC,OAApC,GAA8C,GAA1F;AACH,SAJD;AAKA;AACArB,cAAMjP,SAAN,CAAgB2R,eAAhB,GAAkC,UAAUzD,QAAV,EAAoB0D,IAApB,EAA0B;AACxD,gBAAI,CAAC,KAAKvC,OAAL,CAAarT,QAAQ4S,QAAR,CAAiB4C,MAA9B,CAAL,EACI;AACJ,iBAAKD,gBAAL,CAAsB,MAAtB,EAA8BrD,QAA9B,EAAwC,YAAYuC,UAAU,GAAV,EAAemB,IAAf,CAApD;AACH,SAJD;AAKA;AACA3C,cAAMjP,SAAN,CAAgB6R,qBAAhB,GAAwC,UAAUxB,KAAV,EAAiBhC,UAAjB,EAA6B;AACjE,gBAAI,CAAC,KAAKgB,OAAL,CAAarT,QAAQ4S,QAAR,CAAiBkD,UAA9B,CAAL,EACI;AACJ/B,oBAAQC,GAAR,CAAY,iBAAiBK,KAAjB,GAAyB,GAAzB,GAA+BjC,iBAAiBC,UAAjB,CAA3C;AACH,SAJD;AAKA;AACAY,cAAMjP,SAAN,CAAgB+R,2BAAhB,GAA8C,UAAU1B,KAAV,EAAiBnC,QAAjB,EAA2B;AACrE,gBAAI,CAAC,KAAKmB,OAAL,CAAarT,QAAQ4S,QAAR,CAAiBkD,UAA9B,CAAL,EACI;AACJ/B,oBAAQC,GAAR,CAAY,iBAAiBK,KAAjB,GAAyB,GAAzB,GAA+BpC,aAAaC,QAAb,CAA3C;AACH,SAJD;AAKA,eAAOe,KAAP;AACH,KAjJY,EAAb;AAkJA;;;;;;;;;AASA,QAAI+C,QAAQ,IAAI/C,KAAJ,EAAZ;;AAEA,KAAC,UAAUgD,mBAAV,EAA+B;AAC5BA,4BAAoBA,oBAAoB,QAApB,IAAgC,CAApD,IAAyD,QAAzD;AACAA,4BAAoBA,oBAAoB,QAApB,IAAgC,CAApD,IAAyD,QAAzD;AACAA,4BAAoBA,oBAAoB,KAApB,IAA6B,CAAjD,IAAsD,KAAtD;AACAA,4BAAoBA,oBAAoB,SAApB,IAAiC,CAArD,IAA0D,SAA1D;AACAA,4BAAoBA,oBAAoB,OAApB,IAA+B,CAAnD,IAAwD,OAAxD;AACH,KAND,EAMGjW,QAAQiW,mBAAR,KAAgCjW,QAAQiW,mBAAR,GAA8B,EAA9D,CANH;;AAQA,KAAC,UAAUC,mBAAV,EAA+B;AAC5BA,4BAAoBA,oBAAoB,YAApB,IAAoC,CAAxD,IAA6D,YAA7D;AACAA,4BAAoBA,oBAAoB,OAApB,IAA+B,CAAnD,IAAwD,OAAxD;AACH,KAHD,EAGGlW,QAAQkW,mBAAR,KAAgClW,QAAQkW,mBAAR,GAA8B,EAA9D,CAHH;;AAKA;;;OAr6C2C,CAw6CvC;AACJ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6BA,QAAIC,cAAe,YAAY;AAC3B;;;;;;;;;;;;;;AAcA,iBAASA,WAAT,CAAqBC,WAArB,EAAkCC,WAAlC,EAA+CC,OAA/C,EAAwDC,QAAxD,EAAkE;AAC9D,gBAAIA,aAAa,KAAK,CAAtB,EAAyB;AAAEA,2BAAW,EAAX;AAAgB;AAC3C,iBAAKH,WAAL,GAAmBA,WAAnB;AACA,iBAAKC,WAAL,GAAmBA,WAAnB;AACA,iBAAKE,QAAL,GAAgBA,QAAhB;AACA,iBAAKD,OAAL,GAAeA,WAAW,EAA1B;AACH;AACD;AACAH,oBAAYnS,SAAZ,CAAsBpC,IAAtB,GAA6B,YAAY;AACrC,mBAAO,KAAKyU,WAAL,IAAoB,KAAKA,WAAL,CAAiBzU,IAArC,IAA6C,KAAKwU,WAAzD;AACH,SAFD;AAGA;AACAD,oBAAYnS,SAAZ,CAAsBwS,UAAtB,GAAmC,YAAY;AAC3C,mBAAO,KAAKJ,WAAZ;AACH,SAFD;AAGA;AACAD,oBAAYnS,SAAZ,CAAsB0B,MAAtB,GAA+B,YAAY;AACvC,mBAAO,KAAK4Q,OAAZ;AACH,SAFD;AAGA;AACAH,oBAAYnS,SAAZ,CAAsByS,MAAtB,GAA+B,YAAY;AACvC,mBAAO,KAAKJ,WAAZ;AACH,SAFD;AAGA;AACAF,oBAAYnS,SAAZ,CAAsBU,KAAtB,GAA8B,YAAY;AACtC,mBAAO,KAAK2R,WAAL,IAAoB,KAAKA,WAAL,CAAiBxR,IAA5C;AACH,SAFD;AAGA;AACAsR,oBAAYnS,SAAZ,CAAsBoN,OAAtB,GAAgC,YAAY;AACxC,mBAAO,KAAKmF,QAAZ;AACH,SAFD;AAGA;AACAJ,oBAAYnS,SAAZ,CAAsB0S,MAAtB,GAA+B,YAAY;AACvC,mBAAO,CAAC,EAAE,KAAKL,WAAL,IAAoB,KAAKA,WAAL,CAAiBxR,IAAvC,CAAR;AACH,SAFD;AAGA;AACAsR,oBAAYnS,SAAZ,CAAsB2S,KAAtB,GAA8B,YAAY;AACtC,mBAAO,CAAC,KAAKpH,KAAL,EAAR;AACH,SAFD;AAGA;AACA4G,oBAAYnS,SAAZ,CAAsBuL,KAAtB,GAA8B,YAAY;AACtC,gBAAIqH,OAAO,KAAKxF,OAAL,GAAeyF,QAA1B;AACA,gBAAI,CAAC,KAAKR,WAAN,IAAqB,CAAC,CAACO,IAA3B,EAAiC;AAC7B,oBAAIE,YAAYF,KAAKhV,IAAL,GAAYgV,KAAKhV,IAAjB,GAAwBgV,IAAxC;AACA,uBAAO,wBAAwB,KAAKhV,IAAL,EAAxB,GAAsC,gBAAtC,GAAyDkV,SAAzD,GAAqE,GAA5E;AACH;AACD,gBAAI,CAAC,KAAKT,WAAV,EACI,OAAO,oBAAoB,KAAKzU,IAAL,EAApB,GAAkC,GAAzC;AACJ,gBAAI,CAAC,KAAKyU,WAAL,CAAiBxR,IAAtB,EACI,OAAO,YAAY,KAAKjD,IAAL,EAAZ,GAA0B,6BAAjC;AACP,SAVD;AAWAuU,oBAAYnS,SAAZ,CAAsBkC,QAAtB,GAAiC,YAAY;AACzC,mBAAO,MAAM,KAAKtE,IAAL,EAAN,GAAoB,GAApB,GAA0B2G,OAAO,KAAK7C,MAAL,EAAP,CAAjC;AACH,SAFD;AAGA,eAAOyQ,WAAP;AACH,KAtEkB,EAAnB;AAuEA;AACAA,gBAAYY,KAAZ,GAAoB,UAAUlV,GAAV,EAAe;AAC/B,eAAOA,OAAOA,IAAI6C,KAAX,KAAqBsC,SAASnF,IAAI6C,KAAb,KAAuBsC,SAASnF,IAAI6C,KAAJ,CAAU9C,IAAnB,CAA5C,CAAP;AACH,KAFD;;AAIA;;;;AAIA;AACA,QAAIoV,iBAAiB;AACjB9G,iBAAS/G,MADQ;AAEjB8N,oBAAY,IAFK;AAGjBC,mBAAW,EAHM;AAIjB5O,cAAM;AAJW,KAArB;AAMA;AACA,QAAI6O,iBAAkB,YAAY;AAC9B,iBAASA,cAAT,CAAwBF,UAAxB,EAAoCG,YAApC,EAAkD5C,cAAlD,EAAkEpD,OAAlE,EAA2E;AACvE,gBAAIvD,QAAQ,IAAZ;AACA,iBAAKoJ,UAAL,GAAkBA,UAAlB;AACA,iBAAKG,YAAL,GAAoBA,YAApB;AACA,iBAAK5C,cAAL,GAAsBA,cAAtB;AACA,iBAAKpD,OAAL,GAAeA,OAAf;AACA,iBAAKiG,YAAL,GAAoB,YAAY;AAC5B,uBAAOxJ,MAAM2C,IAAN,CAAW8G,SAAX,KAAyBtX,QAAQiW,mBAAR,CAA4BsB,GAArD,IAA4D,CAAC1J,MAAMuD,OAAN,CAAc6F,UAAd,CAAyBO,QAAzB,EAApE;AACH,aAFD;AAGA,iBAAKpG,OAAL,GAAe9L,SAAS8L,OAAT,EAAkB4F,cAAlB,CAAf;AACA,iBAAKxG,IAAL,GAAYgE,eAAeiD,SAA3B;AACH;AACDN,uBAAenT,SAAf,CAAyB0T,QAAzB,GAAoC,UAAUC,GAAV,EAAe;AAC/C,iBAAKV,UAAL,CAAgBW,MAAhB,CAAuBC,YAAvB,CAAoCC,mBAApC,GAA0DH,GAA1D;AACH,SAFD;AAGAR,uBAAenT,SAAf,CAAyB+T,UAAzB,GAAsC,YAAY;AAC9C,gBAAIlK,QAAQ,IAAZ;AACA,gBAAImK,OAAO,KAAKxD,cAAhB;AACA,gBAAIwD,KAAKC,aAAT,EACI;AACJ,gBAAIC,aAAa,KAAKC,sBAAL,EAAjB;AACA,gBAAID,UAAJ,EACI,OAAOA,UAAP;AACJ,gBAAI9G,UAAU,KAAKA,OAAnB;AACA4E,kBAAM9B,mBAAN,CAA0B,IAA1B,EAAgC,KAAK+C,UAArC,EAAiD7F,OAAjD;AACA,gBAAIgH,iBAAiB,SAAjBA,cAAiB,GAAY;AAC7B,uBAAOJ,KAAKhM,QAAL,CAAc1K,IAAd,CAAmB8P,QAAQ9I,IAA3B,EAAiCuF,MAAMoJ,UAAvC,EAAmDpJ,MAAMuJ,YAAzD,CAAP;AACH,aAFD;AAGA,gBAAIiB,eAAe,SAAfA,YAAe,CAAUV,GAAV,EAAe;AAC9B,uBAAOpH,UAAUyB,SAAV,CAAoB2F,GAApB,EAAyB5G,SAAzB,EAAP;AACH,aAFD;AAGA,gBAAIuH,cAAc,SAAdA,WAAc,CAAUX,GAAV,EAAe;AAC7B,uBAAOK,KAAKP,SAAL,CAAec,eAAf,CAA+B1K,KAA/B,EAAsC8J,GAAtC,CAAP;AACH,aAFD;AAGA,gBAAIa,eAAe,SAAfA,YAAe,CAAUnX,MAAV,EAAkB;AACjC,uBAAO2W,KAAKP,SAAL,CAAegB,gBAAf,CAAgC5K,KAAhC,EAAuCxM,MAAvC,CAAP;AACH,aAFD;AAGA,gBAAI;AACA,oBAAIA,SAAS+W,gBAAb;AACA,oBAAI,CAAC,KAAK5H,IAAL,CAAUkI,WAAX,IAA0BjR,UAAUpG,MAAV,CAA9B,EAAiD;AAC7C,2BAAOA,OAAO+N,KAAP,CAAaiJ,YAAb,EACFnH,IADE,CACGsH,YADH,EACiBF,WADjB,CAAP;AAEH,iBAHD,MAIK;AACD,2BAAOE,aAAanX,MAAb,CAAP;AACH;AACJ,aATD,CAUA,OAAOsW,GAAP,EAAY;AACR;AACA,uBAAOW,YAAY/H,UAAUyB,SAAV,CAAoB2F,GAApB,CAAZ,CAAP;AACH;AACJ,SApCD;AAqCA;;;;;;;;;AASAR,uBAAenT,SAAf,CAAyB2U,gBAAzB,GAA4C,UAAUtX,MAAV,EAAkB;AAC1D,gBAAIwM,QAAQ,IAAZ;AACA,gBAAIqK,aAAa,KAAKC,sBAAL,EAAjB;AACA,gBAAID,UAAJ,EACI,OAAOA,UAAP;AACJ;AACA,gBAAIzQ,UAAUpG,MAAV,CAAJ,EAAuB;AACnB;AACA,uBAAOA,OAAO6P,IAAP,CAAY,UAAU5J,MAAV,EAAkB;AAAE,2BAAOuG,MAAM8K,gBAAN,CAAuBrR,MAAvB,CAAP;AAAwC,iBAAxE,CAAP;AACH;AACD0O,kBAAMtB,eAAN,CAAsBrT,MAAtB,EAA8B,KAAK4V,UAAnC,EAA+C,KAAK7F,OAApD;AACA;AACA,gBAAI/P,WAAW,KAAf,EAAsB;AAClB;AACA,uBAAOkP,UAAUqB,OAAV,CAAkB,yBAAlB,EAA6Cb,SAA7C,EAAP;AACH;AACD,gBAAI6H,gBAAgB9V,GAAGqT,WAAH,CAApB;AACA;AACA,gBAAIyC,cAAcvX,MAAd,CAAJ,EAA2B;AACvB;AACA,uBAAOkP,UAAUgB,UAAV,CAAqBlQ,MAArB,EAA6B0P,SAA7B,EAAP;AACH;AACJ,SAtBD;AAuBA;;;;AAIAoG,uBAAenT,SAAf,CAAyBmU,sBAAzB,GAAkD,YAAY;AAC1D,gBAAIP,SAAS,KAAKX,UAAL,CAAgBW,MAA7B;AACA;AACA,gBAAIA,OAAOiB,SAAX,EAAsB;AAClB,uBAAOtI,UAAUqB,OAAV,CAAkB,wBAAwBgG,OAAOjH,GAA/B,GAAqC,8BAAvD,EAAuFI,SAAvF,EAAP;AACH;AACD,gBAAI,KAAKkG,UAAL,CAAgB6B,QAApB,EAA8B;AAC1B,uBAAOvI,UAAUqB,OAAV,GAAoBb,SAApB,EAAP;AACH;AACD;AACA;AACA,gBAAI,KAAKsG,YAAL,EAAJ,EAAyB;AACrB;AACA,uBAAO9G,UAAUY,UAAV,CAAqB,KAAKC,OAAL,CAAalB,OAAb,EAArB,EAA6Ca,SAA7C,EAAP;AACH;AACJ,SAfD;AAgBAoG,uBAAenT,SAAf,CAAyBkC,QAAzB,GAAoC,YAAY;AAC5C,gBAAI4K,KAAK,IAAT;AAAA,gBAAeM,UAAUN,GAAGM,OAA5B;AAAA,gBAAqCoD,iBAAiB1D,GAAG0D,cAAzD;AACA,gBAAIH,QAAQrS,MAAM,oBAAN,EAA4BoP,OAA5B,KAAwC,UAApD;AAAA,gBAAgEkD,UAAUtS,MAAM,8BAAN,EAAsCoP,OAAtC,KAAkDpP,MAAM,mBAAN,EAA2BoP,OAA3B,CAAlD,IAAyF,SAAnK;AAAA,gBAA8KxP,OAAOmX,WAAWvE,eAAexI,QAA1B,CAArL;AACA,mBAAOqI,QAAQ,YAAR,GAAuBC,OAAvB,GAAiC,IAAjC,GAAwCG,UAAU,GAAV,EAAe7S,IAAf,CAA/C;AACH,SAJD;AAKA;;;;;;;;;;;;;;;;;;AAkBAuV,uBAAe6B,KAAf,GAAuB,UAAUC,KAAV,EAAiBC,OAAjB,EAA0B;AAC7C;AACA,gBAAIC,mBAAmB,SAAnBA,gBAAmB,CAAUlK,IAAV,EAAgBmK,QAAhB,EAA0B;AAC7C,uBAAOnK,KAAKiC,IAAL,CAAU,YAAY;AAAE,2BAAOkI,SAASrB,UAAT,EAAP;AAA+B,iBAAvD,CAAP;AACH,aAFD;AAGA,mBAAOkB,MAAMvW,MAAN,CAAayW,gBAAb,EAA+BD,WAAWrR,SAASC,EAAT,CAAYgN,IAAZ,EAA1C,CAAP;AACH,SAND;AAOA;;;;;;;;;;;AAWAqC,uBAAekC,WAAf,GAA6B,UAAUJ,KAAV,EAAiBK,YAAjB,EAA+B;AACxD,iBAAK,IAAIjP,MAAM,CAAf,EAAkBA,MAAM4O,MAAMnY,MAA9B,EAAsCuJ,KAAtC,EAA6C;AACzC,oBAAIsK,aAAasE,MAAM5O,GAAN,EAAW0N,UAAX,EAAjB;AACA,oBAAItQ,UAAUkN,UAAV,CAAJ,EAA2B;AACvB,wBAAI4E,iBAAiBN,MAAMvY,KAAN,CAAY2J,MAAM,CAAlB,CAArB;AACA,2BAAO8M,eAAe6B,KAAf,CAAqBO,cAArB,EAAqC5E,UAArC,EACFzD,IADE,CACGoI,YADH,CAAP;AAEH;AACJ;AACD,mBAAOA,cAAP;AACH,SAVD;AAWA;;;AAGAnC,uBAAeqC,WAAf,GAA6B,UAAUP,KAAV,EAAiB;AAC1CA,kBAAMtQ,OAAN,CAAc,UAAUqP,IAAV,EAAgB;AAAE,uBAAOA,KAAKD,UAAL,EAAP;AAA2B,aAA3D;AACH,SAFD;AAGA,eAAOZ,cAAP;AACH,KApKqB,EAAtB;AAqKA;;;;AAIAA,mBAAesC,aAAf,GAA+B,UAAUzB,IAAV,EAAgB;AAAE,eAAO,UAAU3W,MAAV,EAAkB;AACtE,mBAAO2W,KAAKW,gBAAL,CAAsBtX,MAAtB,CAAP;AACH,SAFgD;AAE7C,KAFJ;AAGA;;;;AAIA8V,mBAAeuC,mBAAf,GAAqC,UAAU1B,IAAV,EAAgB;AAAE,eAAO,UAAU3W,MAAV,EAAkB;AAC5EoG,sBAAUpG,MAAV,KAAqBA,OAAO+N,KAAP,CAAa,UAAUuI,GAAV,EAAe;AAC7C,uBAAOK,KAAKN,QAAL,CAAcnH,UAAUyB,SAAV,CAAoB2F,GAApB,CAAd,CAAP;AACH,aAFoB,CAArB;AAGA,mBAAO5P,SAAP;AACH,SALsD;AAKnD,KALJ;AAMA;;;;AAIAoP,mBAAewC,SAAf,GAA2B,UAAU3B,IAAV,EAAgB;AAAE,eAAO,UAAUzI,KAAV,EAAiB;AACjE,mBAAOyI,KAAKN,QAAL,CAAcnI,KAAd,CAAP;AACH,SAF4C;AAEzC,KAFJ;AAGA4H,mBAAeyC,YAAf,GAA8B,UAAU5B,IAAV,EAAgB;AAAE,eAAO,UAAUzI,KAAV,EAAiB;AACpE,mBAAOD,gBAAgBC,KAAhB,CAAP;AACH,SAF+C;AAE5C,KAFJ;AAGA4H,mBAAe0C,WAAf,GAA6B,UAAU7B,IAAV,EAAgB;AAAE,eAAO,UAAUzI,KAAV,EAAiB;AACnE,kBAAMA,KAAN;AACH,SAF8C;AAE3C,KAFJ;;AAIA;;;OAluD2C,CAquDvC;AACJ;;;;;;;;;;;;;AAaA,aAASuK,UAAT,CAAoBpV,KAApB,EAA2BqV,SAA3B,EAAsC;AAClC,YAAIC,UAAUhT,SAAS+S,SAAT,IAAsB,CAACA,SAAD,CAAtB,GAAoCA,SAAlD;AACA,iBAASE,UAAT,CAAoBC,MAApB,EAA4B;AACxB,gBAAIC,cAAcH,OAAlB;AACA,iBAAK,IAAI5Y,IAAI,CAAb,EAAgBA,IAAI+Y,YAAYrZ,MAAhC,EAAwCM,GAAxC,EAA6C;AACzC,oBAAIsC,OAAO,IAAIF,IAAJ,CAAS2W,YAAY/Y,CAAZ,CAAT,CAAX;AACA,oBAAKsC,QAAQA,KAAKO,OAAL,CAAaiW,OAAOtY,IAApB,CAAT,IAAwC,CAAC8B,IAAD,IAASyW,YAAY/Y,CAAZ,MAAmB8Y,OAAOtY,IAA/E,EAAsF;AAClF,2BAAO,IAAP;AACH;AACJ;AACD,mBAAO,KAAP;AACH;AACD,YAAIwY,UAAWjU,WAAW6T,OAAX,IAAsBA,OAAtB,GAAgCC,UAA/C;AACA,eAAO,CAAC,CAACG,QAAQ1V,KAAR,CAAT;AACH;AACD;;;;AAIA,QAAI2V,iBAAkB,YAAY;AAC9B,iBAASA,cAAT,CAAwBC,OAAxB,EAAiC7C,SAAjC,EAA4CzL,QAA5C,EAAsDuO,aAAtD,EAAqEnJ,OAArE,EAA8E;AAC1E,gBAAIA,YAAY,KAAK,CAArB,EAAwB;AAAEA,0BAAU,EAAV;AAAe;AACzC,iBAAKkJ,OAAL,GAAeA,OAAf;AACA,iBAAK7C,SAAL,GAAiBA,SAAjB;AACA,iBAAKzL,QAAL,GAAgBA,QAAhB;AACA,iBAAKuO,aAAL,GAAqBA,aAArB;AACA,iBAAKC,QAAL,GAAgBpJ,QAAQoJ,QAAR,IAAoB,CAApC;AACA,iBAAKlS,IAAL,GAAY8I,QAAQ9I,IAAR,IAAgB,IAA5B;AACA,iBAAK2P,aAAL,GAAqB,KAArB;AACH;AACD;;;;;;;;;;;;;;;AAeAoC,uBAAerW,SAAf,CAAyByW,cAAzB,GAA0C,UAAUC,KAAV,EAAiBX,SAAjB,EAA4B;AAClE,gBAAIA,cAAc,IAAlB,EACI,OAAOW,KAAP;AACJ,gBAAIC,WAAWD,MAAM/U,MAAN,CAAa,UAAUiV,IAAV,EAAgB;AAAE,uBAAOd,WAAWc,KAAKlW,KAAhB,EAAuBqV,SAAvB,CAAP;AAA2C,aAA1E,CAAf;AACA,mBAAOY,SAAS7Z,MAAT,GAAkB6Z,QAAlB,GAA6B,IAApC;AACH,SALD;AAMA;;;;;;;;;;;;;;AAcAN,uBAAerW,SAAf,CAAyB6W,wBAAzB,GAAoD,YAAY;AAC5D,mBAAO3Y,IAAI,KAAKoY,OAAL,CAAaQ,UAAb,CAAwBC,aAAxB,EAAJ,EAA6C,YAAY;AAAE,uBAAO,IAAP;AAAc,aAAzE,CAAP;AACH,SAFD;AAGA;;;;;;;;;;;;;;;AAeAV,uBAAerW,SAAf,CAAyBgX,iBAAzB,GAA6C,UAAUC,WAAV,EAAuB;AAChE,gBAAIpN,QAAQ,IAAZ;AACA,gBAAIqN,WAAWrS,OAAO,KAAKgS,wBAAL,EAAP,EAAwC,KAAKN,aAA7C,CAAf;AACA,gBAAIY,QAAQ1V,OAAO,KAAK6U,OAAL,CAAaQ,UAAb,CAAwBC,aAAxB,EAAP,CAAZ;AACA,mBAAOI,MAAMzY,MAAN,CAAa,UAAU0Y,EAAV,EAAcC,QAAd,EAAwB;AACxC;AACA;AACA,oBAAIC,cAAcD,SAASE,KAAT,KAAmBvb,QAAQkW,mBAAR,CAA4BsF,KAAjE;AACA,oBAAIlQ,OAAO2P,YAAYI,SAASzZ,IAArB,KAA8B,EAAzC;AACA,oBAAI8Y,QAAQY,cAAchQ,IAAd,GAAqB,CAAC9D,KAAK8D,IAAL,CAAD,CAAjC;AACA8P,mBAAGC,SAASzZ,IAAZ,IAAoBiM,MAAM4M,cAAN,CAAqBC,KAArB,EAA4BQ,SAASG,SAASzZ,IAAlB,CAA5B,CAApB;AACA,uBAAOwZ,EAAP;AACH,aARM,EAQJ,EARI,CAAP;AASH,SAbD;AAcA;;;;;;AAMAf,uBAAerW,SAAf,CAAyBC,OAAzB,GAAmC,UAAUgX,WAAV,EAAuB;AACtD,gBAAIhX,UAAU,KAAK+W,iBAAL,CAAuBC,WAAvB,CAAd;AACA;AACA,gBAAIQ,aAAahW,OAAOxB,OAAP,EAAgByX,KAAhB,CAAsBxS,QAAtB,CAAjB;AACA,mBAAOuS,aAAaxX,OAAb,GAAuB,IAA9B;AACH,SALD;AAMA,eAAOoW,cAAP;AACH,KA3FqB,EAAtB;AA4FA;AACA,aAASsB,SAAT,CAAmBC,QAAnB,EAA6BC,iBAA7B,EAAgDpE,SAAhD,EAA2D;AACvD;AACA,YAAIqE,mBAAmBF,SAASE,gBAAT,GAA6BF,SAASE,gBAAT,IAA6B,EAAjF;AACA,YAAI7C,QAAQ6C,iBAAiBrE,UAAU7V,IAA3B,IAAmC,EAA/C;AACA;AACAga,iBAASnE,UAAU7V,IAAnB,IAA2Bma,kBAA3B;AACA,iBAASA,kBAAT,CAA4BC,WAA5B,EAAyChQ,QAAzC,EAAmDoF,OAAnD,EAA4D;AACxD,gBAAIA,YAAY,KAAK,CAArB,EAAwB;AAAEA,0BAAU,EAAV;AAAe;AACzC,gBAAIoD,iBAAiB,IAAI6F,cAAJ,CAAmBwB,iBAAnB,EAAsCpE,SAAtC,EAAiDzL,QAAjD,EAA2DgQ,WAA3D,EAAwE5K,OAAxE,CAArB;AACA6H,kBAAMxO,IAAN,CAAW+J,cAAX;AACA,mBAAO,SAASyH,mBAAT,GAA+B;AAClCzH,+BAAeyD,aAAf,GAA+B,IAA/B;AACA9N,2BAAW8O,KAAX,EAAkBzE,cAAlB;AACH,aAHD;AAIH;AACD,eAAOuH,kBAAP;AACH;;AAED;;;OAr3D2C,CAw3DvC;AACJ;;;;;;;;;;;;;;AAcA,QAAIG,cAAe,YAAY;AAC3B,iBAASA,WAAT,CAAqBjF,UAArB,EAAiC;AAC7B,iBAAKA,UAAL,GAAkBA,UAAlB;AACH;AACDiF,oBAAYlY,SAAZ,CAAsBmY,kBAAtB,GAA2C,UAAUC,KAAV,EAAiB;AACxD,gBAAIvO,QAAQ,IAAZ;AACA,gBAAIwO,eAAe,KAAKpF,UAAL,CAAgBW,MAAhB,CAAuBiE,iBAA1C;AACA,mBAAOQ,aAAavB,UAAb,CAAwBwB,UAAxB,CAAmCF,KAAnC,EACFla,GADE,CACE,UAAUsO,IAAV,EAAgB;AAAE,uBAAO3C,MAAM0O,UAAN,CAAiB/L,IAAjB,CAAP;AAAgC,aADpD,EAEF9N,MAFE,CAEK4J,OAFL,EAEc,EAFd,EAGF3G,MAHE,CAGKuD,QAHL,CAAP;AAIH,SAPD;AAQA;;;;;;;;;AASAgT,oBAAYlY,SAAZ,CAAsBuY,UAAtB,GAAmC,UAAUC,QAAV,EAAoB;AACnD,gBAAIvF,aAAa,KAAKA,UAAtB;AACA,gBAAIgE,cAAchE,WAAWgE,WAAX,EAAlB;AACA;AACA,gBAAIwB,gBAAgB,KAAKC,gBAAL,CAAsBF,QAAtB,EAAgCvB,WAAhC,CAApB;AACA,gBAAI,CAACwB,aAAL,EACI,OAAO,EAAP;AACJ,gBAAIE,kBAAkB;AAClB1F,4BAAYA,UADM;AAElB/G,yBAAS+G,WAAW7F,OAAX,GAAqBlB;AAFZ,aAAtB;AAIA,gBAAI0M,sBAAsB,SAAtBA,mBAAsB,CAAU5E,IAAV,EAAgB;AACtC;AACA,oBAAI/T,UAAU+T,KAAK/T,OAAL,CAAagX,WAAb,CAAd;AACA;AACA,oBAAI4B,gBAAgB5Y,QAAQuY,SAASM,iBAAT,CAA2Blb,IAAnC,CAApB;AACA;AACA,uBAAOib,cAAc3a,GAAd,CAAkB,UAAU0Y,IAAV,EAAgB;AACrC,wBAAIrE,WAAW1N,OAAO;AAClBP,8BAAM0P,KAAK1P,IADO;AAElB4O,mCAAW,EAAEsF,UAAUA,SAAS5a,IAArB,EAA2B0S,SAASsG,IAApC;AAFO,qBAAP,EAGZ+B,eAHY,CAAf;AAIA,wBAAIjY,QAAQ8X,SAASM,iBAAT,CAA2BvB,KAA3B,KAAqCvb,QAAQkW,mBAAR,CAA4BsF,KAAjE,GAAyEZ,KAAKlW,KAAL,CAAWG,IAApF,GAA2F,IAAvG;AACA,wBAAIkY,iBAAiB,IAAI5F,cAAJ,CAAmBF,UAAnB,EAA+BvS,KAA/B,EAAsCsT,IAAtC,EAA4CzB,QAA5C,CAArB;AACA,2BAAO,EAAEyB,MAAMA,IAAR,EAAc4C,MAAMA,IAApB,EAA0BmC,gBAAgBA,cAA1C,EAAP;AACH,iBARM,CAAP;AASH,aAfD;AAgBA,mBAAON,cAAcva,GAAd,CAAkB0a,mBAAlB,EACFla,MADE,CACK4J,OADL,EACc,EADd,EAEF0Q,IAFE,CAEGC,UAAUT,SAASU,WAAnB,CAFH,EAGFhb,GAHE,CAGE,UAAUib,KAAV,EAAiB;AAAE,uBAAOA,MAAMJ,cAAb;AAA8B,aAHnD,CAAP;AAIH,SA/BD;AAgCA;;;;;;;;;;;AAWAb,oBAAYlY,SAAZ,CAAsB0Y,gBAAtB,GAAyC,UAAUF,QAAV,EAAoBvB,WAApB,EAAiC;AACtE,gBAAImC,WAAWZ,SAASlF,SAAT,KAAuBtX,QAAQiW,mBAAR,CAA4BoH,MAAlE;AACA;AACA,gBAAIhB,eAAe,KAAKpF,UAAL,CAAgBW,MAAhB,CAAuBiE,iBAA1C;AACA,gBAAIyB,aAAaF,WAAW,CAACf,YAAD,CAAX,GAA4B,CAAC,KAAKpF,UAAN,EAAkBoF,YAAlB,CAA7C;AACA,mBAAOiB,WAAWpb,GAAX,CAAe,UAAUqb,GAAV,EAAe;AAAE,uBAAOA,IAAIC,QAAJ,CAAahB,SAAS5a,IAAtB,CAAP;AAAqC,aAArE,EAAuE;AAAvE,aACF+D,MADE,CACKkH,gBAAgB5F,OAAhB,EAAyB,yBAAyBuV,SAAS5a,IAA3D,CADL,EACuE;AADvE,aAEFc,MAFE,CAEK4J,OAFL,EAEc,EAFd,EAEkB;AAFlB,aAGF3G,MAHE,CAGK,UAAUqS,IAAV,EAAgB;AAAE,uBAAOA,KAAK/T,OAAL,CAAagX,WAAb,CAAP;AAAmC,aAH1D,CAAP,CALsE,CAQF;AACvE,SATD;AAUA,eAAOiB,WAAP;AACH,KA3EkB,EAAnB;AA4EA;;;;;;;;;AASA,aAASe,SAAT,CAAmBQ,gBAAnB,EAAqC;AACjC,YAAIA,qBAAqB,KAAK,CAA9B,EAAiC;AAAEA,+BAAmB,KAAnB;AAA2B;AAC9D,eAAO,SAASC,qBAAT,CAA+BC,CAA/B,EAAkCC,CAAlC,EAAqC;AACxC,gBAAIC,SAASJ,mBAAmB,CAAC,CAApB,GAAwB,CAArC;AACA,gBAAIK,aAAa,CAACH,EAAE/C,IAAF,CAAOlW,KAAP,CAAa4G,IAAb,CAAkBxK,MAAlB,GAA2B8c,EAAEhD,IAAF,CAAOlW,KAAP,CAAa4G,IAAb,CAAkBxK,MAA9C,IAAwD+c,MAAzE;AACA,mBAAOC,eAAe,CAAf,GAAmBA,UAAnB,GAAgCF,EAAE5F,IAAF,CAAOwC,QAAP,GAAkBmD,EAAE3F,IAAF,CAAOwC,QAAhE;AACH,SAJD;AAKH;;AAED;;;;AAIA;AACA;;;;;;;;;;;;;;;;;;;;;;;;AAwBA,QAAIuD,YAAa,YAAY;AACzB;;;;;AAKA,iBAASA,SAAT,CAAmBC,GAAnB,EAAwB;AACpB;AACA,iBAAK1a,OAAL,GAAe,IAAf;AACA;AACA,iBAAKqB,OAAL,GAAe,IAAf;AACAkE,mBAAO,IAAP,EAAamV,GAAb;AACH;AACD;AACA;AACAD,kBAAU/Z,SAAV,CAAoBlB,EAApB,GAAyB,UAAUf,GAAV,EAAe6J,GAAf,EAAoB;AAAE,mBAAO,IAAP;AAAc,SAA7D;AACA;AACAmS,kBAAU/Z,SAAV,CAAoBia,MAApB,GAA6B,UAAUlc,GAAV,EAAe6J,GAAf,EAAoB;AAAE,mBAAO7J,GAAP;AAAa,SAAhE;AACA;AACAgc,kBAAU/Z,SAAV,CAAoBka,MAApB,GAA6B,UAAUnc,GAAV,EAAe6J,GAAf,EAAoB;AAAE,mBAAO7J,GAAP;AAAa,SAAhE;AACA;AACAgc,kBAAU/Z,SAAV,CAAoBgF,MAApB,GAA6B,UAAU6F,CAAV,EAAalM,CAAb,EAAgB;AAAE,mBAAOkM,KAAKlM,CAAZ;AAAgB,SAA/D;AACAob,kBAAU/Z,SAAV,CAAoBma,WAApB,GAAkC,YAAY;AAC1C,gBAAIC,MAAM,KAAK9a,OAAL,CAAa4C,QAAb,EAAV;AACA,mBAAOkY,IAAIC,MAAJ,CAAW,CAAX,EAAcD,IAAItd,MAAJ,GAAa,CAA3B,CAAP;AACH,SAHD;AAIAid,kBAAU/Z,SAAV,CAAoBkC,QAApB,GAA+B,YAAY;AACvC,mBAAO,gBAAgB,KAAKtE,IAArB,GAA4B,GAAnC;AACH,SAFD;AAGA;AACAmc,kBAAU/Z,SAAV,CAAoBsa,UAApB,GAAiC,UAAUvc,GAAV,EAAe;AAC5C,mBAAO,KAAKe,EAAL,CAAQf,GAAR,IAAeA,GAAf,GAAqB,KAAKmc,MAAL,CAAYnc,GAAZ,CAA5B;AACH,SAFD;AAGA;;;;;;;;;;AAUAgc,kBAAU/Z,SAAV,CAAoBua,QAApB,GAA+B,UAAUC,IAAV,EAAgBC,QAAhB,EAA0B;AACrD,gBAAI,CAACD,IAAL,EACI,OAAO,IAAP;AACJ,gBAAIA,SAAS,MAAT,IAAmB,CAACC,QAAxB,EACI,MAAM,IAAI7W,KAAJ,CAAU,gDAAV,CAAN;AACJ,mBAAO,IAAI8W,SAAJ,CAAc,IAAd,EAAoBF,IAApB,CAAP;AACH,SAND;AAOA,eAAOT,SAAP;AACH,KAnDgB,EAAjB;AAoDA;;;;AAIA,aAASW,SAAT,CAAmBlO,IAAnB,EAAyBgO,IAAzB,EAA+B;AAC3B,YAAI3Q,QAAQ,IAAZ;AACA;AACA,iBAAS8Q,SAAT,CAAmB5c,GAAnB,EAAwB;AACpB,mBAAOkF,QAAQlF,GAAR,IAAeA,GAAf,GAAsB4E,UAAU5E,GAAV,IAAiB,CAACA,GAAD,CAAjB,GAAyB,EAAtD;AACH;AACD;AACA,iBAAS6c,WAAT,CAAqB7c,GAArB,EAA0B;AACtB,oBAAQA,IAAIjB,MAAZ;AACI,qBAAK,CAAL;AAAQ,2BAAOiH,SAAP;AACR,qBAAK,CAAL;AAAQ,2BAAOyW,SAAS,MAAT,GAAkBzc,IAAI,CAAJ,CAAlB,GAA2BA,GAAlC;AACR;AAAS,2BAAOA,GAAP;AAHb;AAKH;AACD;AACA,iBAAS8c,YAAT,CAAsB7S,QAAtB,EAAgC8S,aAAhC,EAA+C;AAC3C,mBAAO,SAASC,WAAT,CAAqBhd,GAArB,EAA0B;AAC7B,oBAAIkF,QAAQlF,GAAR,KAAgBA,IAAIjB,MAAJ,KAAe,CAAnC,EACI,OAAOiB,GAAP;AACJ,oBAAIU,MAAMkc,UAAU5c,GAAV,CAAV;AACA,oBAAIV,SAASa,IAAIO,GAAJ,EAASuJ,QAAT,CAAb;AACA,uBAAQ8S,kBAAkB,IAAnB,GAA2BnZ,OAAOtE,MAAP,EAAe,UAAUuB,CAAV,EAAa;AAAE,2BAAO,CAACA,CAAR;AAAY,iBAA1C,EAA4C9B,MAA5C,KAAuD,CAAlF,GAAsF8d,YAAYvd,MAAZ,CAA7F;AACH,aAND;AAOH;AACD;AACA,iBAAS2d,kBAAT,CAA4BhT,QAA5B,EAAsC;AAClC,mBAAO,SAAS+S,WAAT,CAAqBE,IAArB,EAA2BC,IAA3B,EAAiC;AACpC,oBAAIC,OAAOR,UAAUM,IAAV,CAAX;AAAA,oBAA4BG,QAAQT,UAAUO,IAAV,CAApC;AACA,oBAAIC,KAAKre,MAAL,KAAgBse,MAAMte,MAA1B,EACI,OAAO,KAAP;AACJ,qBAAK,IAAIM,IAAI,CAAb,EAAgBA,IAAI+d,KAAKre,MAAzB,EAAiCM,GAAjC,EAAsC;AAClC,wBAAI,CAAC4K,SAASmT,KAAK/d,CAAL,CAAT,EAAkBge,MAAMhe,CAAN,CAAlB,CAAL,EACI,OAAO,KAAP;AACP;AACD,uBAAO,IAAP;AACH,aATD;AAUH;AACD,SAAC,QAAD,EAAW,QAAX,EAAqB,QAArB,EAA+B,YAA/B,EAA6CuH,OAA7C,CAAqD,UAAU/G,IAAV,EAAgB;AACjE,gBAAIyd,cAAc7O,KAAK5O,IAAL,EAAW0G,IAAX,CAAgBkI,IAAhB,CAAlB;AACA,gBAAI8O,YAAY1d,SAAS,QAAT,GAAoBod,kBAApB,GAAyCH,YAAzD;AACAhR,kBAAMjM,IAAN,IAAc0d,UAAUD,WAAV,CAAd;AACH,SAJD;AAKAxW,eAAO,IAAP,EAAa;AACT0W,qBAAS/O,KAAK+O,OADL;AAET3d,kBAAM4O,KAAK5O,IAFF;AAGT0B,qBAASkN,KAAKlN,OAHL;AAITqB,qBAAS6L,KAAK7L,OAJL;AAKT7B,gBAAI+b,aAAarO,KAAK1N,EAAL,CAAQwF,IAAR,CAAakI,IAAb,CAAb,EAAiC,IAAjC,CALK;AAMTgP,wBAAYhB;AANH,SAAb;AAQH;;AAED;;;OA9mE2C,CAinEvC;AACJ,kBAAe,IAAIiB,SAASlZ,OAAOvC,SAAP,CAAiB6B,cAA9B;AACf,kBAAe,IAAI6Z,cAAc,SAAdA,WAAc,CAAUC,GAAV,EAAe;AAC5C,eAAO,CAAC,OAAD,EAAU,MAAV,EAAkB,QAAlB,EAA4B,OAA5B,EAAqC,SAArC,EAAgDha,MAAhD,CAAuD8Z,OAAOnX,IAAP,CAAYqX,OAAO,EAAnB,CAAvD,EAA+E7e,MAA/E,KAA0F,CAAjG;AACH,KAFc;AAGf;;AAEA,KAAC,UAAU8e,OAAV,EAAmB;AAChBA,gBAAQA,QAAQ,MAAR,IAAkB,CAA1B,IAA+B,MAA/B;AACAA,gBAAQA,QAAQ,QAAR,IAAoB,CAA5B,IAAiC,QAAjC;AACAA,gBAAQA,QAAQ,QAAR,IAAoB,CAA5B,IAAiC,QAAjC;AACH,KAJD,EAIG5f,QAAQ4f,OAAR,KAAoB5f,QAAQ4f,OAAR,GAAkB,EAAtC,CAJH;AAKA;AACA,aAASC,eAAT,CAAyBF,GAAzB,EAA8B;AAC1BA,cAAMD,YAAYC,GAAZ,KAAoB,EAAElS,OAAOkS,GAAT,EAApB,IAAsCA,GAA5C;AACAG,8BAAsB,aAAtB,IAAuC,IAAvC;AACA,iBAASA,qBAAT,GAAiC;AAC7B,mBAAOH,IAAIlS,KAAX;AACH;AACD,eAAO5E,OAAO8W,GAAP,EAAY;AACfI,kBAAM1Y,aAAasY,IAAIlS,KAAjB,IAA0BkS,IAAIlS,KAA9B,GAAsCqS;AAD7B,SAAZ,CAAP;AAGH;AACD;AACA,aAASE,OAAT,CAAiBL,GAAjB,EAAsBM,OAAtB,EAA+BC,QAA/B,EAAyCpa,EAAzC,EAA6Cqa,UAA7C,EAAyD;AACrD,YAAIR,IAAInP,IAAJ,IAAYyP,OAAZ,IAAuBA,QAAQre,IAAR,KAAiB,QAA5C,EACI,MAAM,IAAIgG,KAAJ,CAAU,YAAY9B,EAAZ,GAAiB,gCAA3B,CAAN;AACJ,YAAI6Z,IAAInP,IAAJ,IAAYyP,OAAZ,IAAuBA,QAAQre,IAAR,KAAiB,QAAxC,IAAoDue,WAAW3P,IAAX,CAAgBmP,IAAInP,IAApB,CAAxD,EACI,OAAO2P,WAAW3P,IAAX,CAAgBmP,IAAInP,IAApB,CAAP;AACJ,YAAIyP,OAAJ,EACI,OAAOA,OAAP;AACJ,YAAI,CAACN,IAAInP,IAAT,EAAe;AACX,gBAAIA,OAAO0P,aAAalgB,QAAQ4f,OAAR,CAAgBQ,MAA7B,GAAsC,KAAtC,GACPF,aAAalgB,QAAQ4f,OAAR,CAAgBS,IAA7B,GAAoC,MAApC,GACIH,aAAalgB,QAAQ4f,OAAR,CAAgBU,MAA7B,GAAsC,OAAtC,GAAgD,QAFxD;AAGA,mBAAOH,WAAW3P,IAAX,CAAgBA,IAAhB,CAAP;AACH;AACD,eAAOmP,IAAInP,IAAJ,YAAoBuN,SAApB,GAAgC4B,IAAInP,IAApC,GAA2C2P,WAAW3P,IAAX,CAAgBmP,IAAInP,IAApB,CAAlD;AACH;AACD;;;;AAIA,aAAS+P,eAAT,CAAyBjc,MAAzB,EAAiCkc,UAAjC,EAA6CC,aAA7C,EAA4D;AACxD,YAAIC,SAASpc,OAAOoc,MAApB;AACA,YAAI,CAACF,UAAD,IAAeE,WAAW,KAA9B,EACI,OAAO,KAAP;AACJ,YAAI,CAAC/Z,UAAU+Z,MAAV,CAAD,IAAsBA,UAAU,IAApC,EACI,OAAOD,aAAP;AACJ,YAAIC,WAAW,IAAX,IAAmB1Z,SAAS0Z,MAAT,CAAvB,EACI,OAAOA,MAAP;AACJ,cAAM,IAAI9Y,KAAJ,CAAU,6BAA6B8Y,MAA7B,GAAsC,qDAAhD,CAAN;AACH;AACD;AACA,aAASC,UAAT,CAAoBrc,MAApB,EAA4Bsc,SAA5B,EAAuCJ,UAAvC,EAAmDE,MAAnD,EAA2D;AACvD,YAAIG,OAAJ;AAAA,YAAaC,cAAb;AAAA,YAA6BL,gBAAgB,CACzC,EAAEM,MAAM,EAAR,EAAYC,IAAKR,cAAcI,SAAd,GAA0B7Y,SAA1B,GAAsC,EAAvD,EADyC,EAEzC,EAAEgZ,MAAM,IAAR,EAAcC,IAAKR,cAAcI,SAAd,GAA0B7Y,SAA1B,GAAsC,EAAzD,EAFyC,CAA7C;AAIA8Y,kBAAU5Z,QAAQ3C,OAAOuc,OAAf,IAA0Bvc,OAAOuc,OAAjC,GAA2C,EAArD;AACA,YAAI7Z,SAAS0Z,MAAT,CAAJ,EACIG,QAAQpW,IAAR,CAAa,EAAEsW,MAAML,MAAR,EAAgBM,IAAIjZ,SAApB,EAAb;AACJ+Y,yBAAiB5e,IAAI2e,OAAJ,EAAalf,KAAK,MAAL,CAAb,CAAjB;AACA,eAAOgE,OAAO8a,aAAP,EAAsB,UAAUvV,IAAV,EAAgB;AAAE,mBAAO4V,eAAe5W,OAAf,CAAuBgB,KAAK6V,IAA5B,MAAsC,CAAC,CAA9C;AAAkD,SAA1F,EAA4F9f,MAA5F,CAAmG4f,OAAnG,CAAP;AACH;AACD;AACA,QAAII,QAAS,YAAY;AACrB,iBAASA,KAAT,CAAenb,EAAf,EAAmB0K,IAAnB,EAAyBlM,MAAzB,EAAiC4b,QAAjC,EAA2CgB,iBAA3C,EAA8D;AAC1D5c,qBAASub,gBAAgBvb,MAAhB,CAAT;AACAkM,mBAAOwP,QAAQ1b,MAAR,EAAgBkM,IAAhB,EAAsB0P,QAAtB,EAAgCpa,EAAhC,EAAoCob,kBAAkBf,UAAtD,CAAP;AACA,gBAAIS,YAAYO,cAAhB;AACA3Q,mBAAOoQ,YAAYpQ,KAAK+N,QAAL,CAAcqC,SAAd,EAAyBV,aAAalgB,QAAQ4f,OAAR,CAAgBU,MAAtD,CAAZ,GAA4E9P,IAAnF;AACA,gBAAIgQ,aAAalc,OAAOmJ,KAAP,KAAiB1F,SAAjB,IAA8BmY,aAAalgB,QAAQ4f,OAAR,CAAgBU,MAA5E;AACA,gBAAIf,UAAU5Y,UAAUrC,OAAOib,OAAjB,IAA4B,CAAC,CAACjb,OAAOib,OAArC,GAA+C,CAAC,CAAC/O,KAAK+O,OAApE;AACA,gBAAI6B,MAAMza,UAAUrC,OAAO8c,GAAjB,IAAwB,CAAC,CAAC9c,OAAO8c,GAAjC,GAAuC,CAAC,CAAC5Q,KAAK4Q,GAAxD;AACA,gBAAIV,SAASH,gBAAgBjc,MAAhB,EAAwBkc,UAAxB,EAAoCU,kBAAkBG,mBAAlB,EAApC,CAAb;AACA,gBAAIR,UAAUF,WAAWrc,MAAX,EAAmBsc,SAAnB,EAA8BJ,UAA9B,EAA0CE,MAA1C,CAAd;AACA,gBAAIY,aAAa3a,UAAUrC,OAAOK,OAAjB,IAA4B,CAAC,CAACL,OAAOK,OAArC,GAA+C,CAAC,CAAC6L,KAAK7L,OAAvE;AACA;AACA,qBAASwc,YAAT,GAAwB;AACpB,oBAAII,gBAAgB,EAAEtX,OAAQiW,aAAalgB,QAAQ4f,OAAR,CAAgBU,MAA7B,GAAsC,MAAtC,GAA+C,KAAzD,EAApB;AACA,oBAAIkB,yBAAyB1b,GAAG2b,KAAH,CAAS,OAAT,IAAoB,EAAExX,OAAO,IAAT,EAApB,GAAsC,EAAnE;AACA,uBAAOpB,OAAO0Y,aAAP,EAAsBC,sBAAtB,EAA8Cld,MAA9C,EAAsD2F,KAA7D;AACH;AACDpB,mBAAO,IAAP,EAAa,EAAE/C,IAAIA,EAAN,EAAU0K,MAAMA,IAAhB,EAAsB0P,UAAUA,QAAhC,EAA0CM,YAAYA,UAAtD,EAAkEjB,SAASA,OAA3E,EAAoF6B,KAAKA,GAAzF,EAA8FV,QAAQA,MAAtG,EAA8GG,SAASA,OAAvH,EAAgIlc,SAAS2c,UAAzI,EAAqJrX,OAAO2W,SAA5J,EAAuKtc,QAAQA,MAA/K,EAAb;AACH;AACD2c,cAAMjd,SAAN,CAAgB0d,cAAhB,GAAiC,UAAUjU,KAAV,EAAiB;AAC9C,mBAAO,KAAK+S,UAAL,IAAmB,KAAKhQ,IAAL,CAAUxH,MAAV,CAAiB,KAAKyE,KAAL,EAAjB,EAA+BA,KAA/B,CAA1B;AACH,SAFD;AAGA;;;;AAIAwT,cAAMjd,SAAN,CAAgByJ,KAAhB,GAAwB,UAAUA,KAAV,EAAiB;AACrC,gBAAII,QAAQ,IAAZ;AACA;;;AAGA,gBAAI8T,kBAAkB,SAAlBA,eAAkB,GAAY;AAC9B,oBAAI9T,MAAM+T,kBAAV,EACI,OAAO/T,MAAM+T,kBAAN,CAAyBC,YAAhC;AACJ,oBAAI,CAACha,SAASG,SAAd,EACI,MAAM,IAAIJ,KAAJ,CAAU,6DAAV,CAAN;AACJ,oBAAIia,eAAeha,SAASG,SAAT,CAAmB5E,MAAnB,CAA0ByK,MAAMvJ,MAAN,CAAayb,IAAvC,CAAnB;AACA,oBAAI8B,iBAAiB,IAAjB,IAAyBA,iBAAiB9Z,SAA1C,IAAuD,CAAC8F,MAAM2C,IAAN,CAAW1N,EAAX,CAAc+e,YAAd,CAA5D,EACI,MAAM,IAAIja,KAAJ,CAAU,oBAAoBia,YAApB,GAAmC,mBAAnC,GAAyDhU,MAAM/H,EAA/D,GAAoE,qCAApE,GAA4G+H,MAAM2C,IAAN,CAAW5O,IAAvH,GAA8H,GAAxI,CAAN;AACJ,oBAAIiM,MAAMvJ,MAAN,CAAayb,IAAb,CAAkB,aAAlB,CAAJ,EAAsC;AAClClS,0BAAM+T,kBAAN,GAA2B,EAAEC,cAAcA,YAAhB,EAA3B;AACH;AACD,uBAAOA,YAAP;AACH,aAZD;AAaA,gBAAIC,uBAAuB,SAAvBA,oBAAuB,CAAUxa,MAAV,EAAkB;AACzC,qBAAK,IAAI7F,KAAK,CAAT,EAAYqP,KAAKjD,MAAMgT,OAA5B,EAAqCpf,KAAKqP,GAAGhQ,MAA7C,EAAqDW,IAArD,EAA2D;AACvD,wBAAI0b,QAAQrM,GAAGrP,EAAH,CAAZ;AACA,wBAAI0b,MAAM4D,IAAN,KAAezZ,MAAnB,EACI,OAAO6V,MAAM6D,EAAb;AACP;AACD,uBAAO1Z,MAAP;AACH,aAPD;AAQAmG,oBAAQqU,qBAAqBrU,KAArB,CAAR;AACA,mBAAO/G,YAAY+G,KAAZ,IAAqBkU,iBAArB,GAAyC,KAAKnR,IAAL,CAAU8N,UAAV,CAAqB7Q,KAArB,CAAhD;AACH,SA5BD;AA6BAwT,cAAMjd,SAAN,CAAgBya,QAAhB,GAA2B,YAAY;AACnC,mBAAO,KAAKyB,QAAL,KAAkBlgB,QAAQ4f,OAAR,CAAgBU,MAAzC;AACH,SAFD;AAGAW,cAAMjd,SAAN,CAAgB+d,SAAhB,GAA4B,UAAUtU,KAAV,EAAiB;AACzC;AACA,gBAAI,CAAC/G,YAAY+G,KAAZ,KAAsBA,UAAU,IAAjC,KAA0C,KAAK+S,UAAnD,EACI,OAAO,IAAP;AACJ;AACA,gBAAIwB,aAAa,KAAKxR,IAAL,CAAU8N,UAAV,CAAqB7Q,KAArB,CAAjB;AACA,gBAAI,CAAC,KAAK+C,IAAL,CAAU1N,EAAV,CAAakf,UAAb,CAAL,EACI,OAAO,KAAP;AACJ;AACA,gBAAIC,UAAU,KAAKzR,IAAL,CAAUyN,MAAV,CAAiB+D,UAAjB,CAAd;AACA,mBAAO,EAAEhb,SAASib,OAAT,KAAqB,CAAC,KAAKzR,IAAL,CAAUlN,OAAV,CAAkBa,IAAlB,CAAuB8d,OAAvB,CAAxB,CAAP;AACH,SAXD;AAYAhB,cAAMjd,SAAN,CAAgBkC,QAAhB,GAA2B,YAAY;AACnC,mBAAO,YAAY,KAAKJ,EAAjB,GAAsB,GAAtB,GAA4B,KAAK0K,IAAjC,GAAwC,YAAxC,GAAuD,KAAKkQ,MAA5D,GAAqE,cAArE,GAAsF,KAAKF,UAA3F,GAAwG,GAA/G;AACH,SAFD;AAGAS,cAAMxb,MAAN,GAAe,UAAUC,MAAV,EAAkBwc,SAAlB,EAA6B;AACxC,gBAAIA,cAAc,KAAK,CAAvB,EAA0B;AAAEA,4BAAY,EAAZ;AAAiB;AAC7C,gBAAIC,cAAc,EAAlB;AACA,iBAAK,IAAI1gB,KAAK,CAAT,EAAY2gB,WAAW1c,MAA5B,EAAoCjE,KAAK2gB,SAASthB,MAAlD,EAA0DW,IAA1D,EAAgE;AAC5D,oBAAImE,QAAQwc,SAAS3gB,EAAT,CAAZ;AACA0gB,4BAAYvc,MAAME,EAAlB,IAAwBF,MAAM6H,KAAN,CAAYyU,UAAUtc,MAAME,EAAhB,CAAZ,CAAxB;AACH;AACD,mBAAOqc,WAAP;AACH,SARD;AASA;;;;;;;;;;;AAWAlB,cAAMoB,OAAN,GAAgB,UAAU3c,MAAV,EAAkB4c,OAAlB,EAA2BC,OAA3B,EAAoC;AAChD,gBAAID,YAAY,KAAK,CAArB,EAAwB;AAAEA,0BAAU,EAAV;AAAe;AACzC,gBAAIC,YAAY,KAAK,CAArB,EAAwB;AAAEA,0BAAU,EAAV;AAAe;AACzC,mBAAO7c,OAAOC,MAAP,CAAc,UAAUC,KAAV,EAAiB;AAAE,uBAAO,CAACA,MAAM4K,IAAN,CAAWxH,MAAX,CAAkBsZ,QAAQ1c,MAAME,EAAd,CAAlB,EAAqCyc,QAAQ3c,MAAME,EAAd,CAArC,CAAR;AAAkE,aAAnG,CAAP;AACH,SAJD;AAKA;;;;;;;;;AASAmb,cAAMjY,MAAN,GAAe,UAAUtD,MAAV,EAAkB4c,OAAlB,EAA2BC,OAA3B,EAAoC;AAC/C,gBAAID,YAAY,KAAK,CAArB,EAAwB;AAAEA,0BAAU,EAAV;AAAe;AACzC,gBAAIC,YAAY,KAAK,CAArB,EAAwB;AAAEA,0BAAU,EAAV;AAAe;AACzC,mBAAOtB,MAAMoB,OAAN,CAAc3c,MAAd,EAAsB4c,OAAtB,EAA+BC,OAA/B,EAAwCzhB,MAAxC,KAAmD,CAA1D;AACH,SAJD;AAKA;AACAmgB,cAAMc,SAAN,GAAkB,UAAUrc,MAAV,EAAkBwc,SAAlB,EAA6B;AAC3C,gBAAIA,cAAc,KAAK,CAAvB,EAA0B;AAAEA,4BAAY,EAAZ;AAAiB;AAC7C,mBAAOxc,OAAOxD,GAAP,CAAW,UAAU0D,KAAV,EAAiB;AAAE,uBAAOA,MAAMmc,SAAN,CAAgBG,UAAUtc,MAAME,EAAhB,CAAhB,CAAP;AAA8C,aAA5E,EAA8EpD,MAA9E,CAAqFyJ,QAArF,EAA+F,IAA/F,CAAP;AACH,SAHD;AAIA,eAAO8U,KAAP;AACH,KAvHY,EAAb;;AAyHA,uBA5yE2C,CA4yEvB;AACpB;;;;;;;;;AASA,QAAIuB,WAAY,YAAY;AACxB,iBAASA,QAAT,CAAkBC,WAAlB,EAA+B;AAC3B,gBAAIA,uBAAuBD,QAA3B,EAAqC;AACjC,oBAAI5H,OAAO6H,WAAX;AACA,qBAAK/d,KAAL,GAAakW,KAAKlW,KAAlB;AACA,qBAAKge,WAAL,GAAmB9H,KAAK8H,WAAL,CAAiBhiB,KAAjB,EAAnB;AACA,qBAAKyhB,WAAL,GAAmBtZ,OAAO,EAAP,EAAW+R,KAAKuH,WAAhB,CAAnB;AACA,qBAAKQ,WAAL,GAAmB/H,KAAK+H,WAAL,CAAiBjiB,KAAjB,EAAnB;AACA,qBAAKkiB,KAAL,GAAahI,KAAKgI,KAAL,IAAchI,KAAKgI,KAAL,CAAWliB,KAAX,EAA3B;AACH,aAPD,MAQK;AACD,oBAAIgE,QAAQ+d,WAAZ;AACA,qBAAK/d,KAAL,GAAaA,KAAb;AACA,qBAAKge,WAAL,GAAmBhe,MAAMU,UAAN,CAAiB,EAAET,SAAS,KAAX,EAAjB,CAAnB;AACA,qBAAKwd,WAAL,GAAmB,EAAnB;AACA,qBAAKQ,WAAL,GAAmBje,MAAMie,WAAN,CAAkBzgB,GAAlB,CAAsB,UAAU2gB,GAAV,EAAe;AAAE,2BAAOA,IAAIC,KAAJ,EAAP;AAAqB,iBAA5D,CAAnB;AACH;AACJ;AACD;AACAN,iBAASxe,SAAT,CAAmB+e,cAAnB,GAAoC,UAAUrd,MAAV,EAAkB;AAClD,gBAAIsd,cAAc,SAAdA,WAAc,CAAUC,QAAV,EAAoB;AAAE,uBAAO,CAACA,SAASnd,EAAV,EAAcmd,SAASxV,KAAT,CAAe/H,OAAOud,SAASnd,EAAhB,CAAf,CAAd,CAAP;AAA4D,aAApG;AACA,iBAAKqc,WAAL,GAAmB,KAAKO,WAAL,CAAiBhgB,MAAjB,CAAwB,UAAUuI,IAAV,EAAgBiY,IAAhB,EAAsB;AAAE,uBAAO3V,WAAWtC,IAAX,EAAiB+X,YAAYE,IAAZ,CAAjB,CAAP;AAA6C,aAA7F,EAA+F,EAA/F,CAAnB;AACA,mBAAO,IAAP;AACH,SAJD;AAKA;AACAV,iBAASxe,SAAT,CAAmB+B,SAAnB,GAA+B,UAAUnE,IAAV,EAAgB;AAC3C,mBAAOqE,KAAK,KAAKyc,WAAV,EAAuB5gB,OAAO,IAAP,EAAaF,IAAb,CAAvB,CAAP;AACH,SAFD;AAGA;;;;AAIA4gB,iBAASxe,SAAT,CAAmBgF,MAAnB,GAA4B,UAAU4R,IAAV,EAAgBuI,QAAhB,EAA0B;AAClD,gBAAIC,OAAO,KAAKA,IAAL,CAAUxI,IAAV,EAAgBuI,QAAhB,CAAX;AACA,mBAAOC,QAAQA,KAAKtiB,MAAL,KAAgB,CAA/B;AACH,SAHD;AAIA;;;;;;;;;;;;AAYA0hB,iBAASxe,SAAT,CAAmBof,IAAnB,GAA0B,UAAUxI,IAAV,EAAgBuI,QAAhB,EAA0B;AAChD,gBAAI,KAAKze,KAAL,KAAekW,KAAKlW,KAAxB,EACI,OAAO,KAAP;AACJ,gBAAIgB,SAASyd,WAAWA,SAAS,IAAT,CAAX,GAA4B,KAAKT,WAA9C;AACA,mBAAOzB,MAAMoB,OAAN,CAAc3c,MAAd,EAAsB,KAAKyc,WAA3B,EAAwCvH,KAAKuH,WAA7C,CAAP;AACH,SALD;AAMA;AACAK,iBAASM,KAAT,GAAiB,UAAUlI,IAAV,EAAgB;AAC7B,mBAAO,IAAI4H,QAAJ,CAAa5H,IAAb,CAAP;AACH,SAFD;AAGA,eAAO4H,QAAP;AACH,KA3De,EAAhB;;AA6DA,uBAn3E2C,CAm3EvB;AACpB;;;AAGA,QAAIa,YAAa,YAAY;AACzB,iBAASA,SAAT,GAAqB,CACpB;AACD;AACAA,kBAAUC,eAAV,GAA4B,UAAUhY,IAAV,EAAgB;AACxC,gBAAI5G,QAAQ8C,KAAK8D,IAAL,EAAW5G,KAAvB;AACA,mBAAO,IAAIyR,WAAJ,CAAgBzR,KAAhB,EAAuBA,KAAvB,EAA8B4G,KAAKpJ,GAAL,CAASP,KAAK,aAAL,CAAT,EAA8Be,MAA9B,CAAqCsI,MAArC,EAA6C,EAA7C,CAA9B,CAAP;AACH,SAHD;AAIAqY,kBAAUE,SAAV,GAAsB,UAAUC,WAAV,EAAuB;AACzC,gBAAIC,WAAWD,YAAY9d,MAAZ,EAAf;AACA,mBAAO8d,YAAY/M,MAAZ,GAAqBnL,IAArB,CAA0BpJ,GAA1B,CAA8B,UAAUwC,KAAV,EAAiB;AAAE,uBAAO,IAAI8d,QAAJ,CAAa9d,KAAb,EAAoBqe,cAApB,CAAmCU,QAAnC,CAAP;AAAsD,aAAvG,CAAP;AACH,SAHD;AAIA;AACAJ,kBAAUK,WAAV,GAAwB,UAAUC,QAAV,EAAoBH,WAApB,EAAiC;AACrD,gBAAII,SAASP,UAAUE,SAAV,CAAoBC,WAApB,CAAb;AACA,gBAAIA,YAAYpS,OAAZ,GAAsBzM,OAA1B,EAAmC;AAC/B,uBAAO0e,UAAUQ,aAAV,CAAwBF,QAAxB,EAAkCC,MAAlC,EAA0Crd,OAAOqD,IAAP,CAAY4Z,YAAY9d,MAAZ,EAAZ,CAA1C,CAAP;AACH;AACD,mBAAOke,MAAP;AACH,SAND;AAOA;;;;;AAKAP,kBAAUS,gBAAV,GAA6B,UAAUC,KAAV,EAAiBzY,IAAjB,EAAuB0Y,MAAvB,EAA+B;AACxD;AACA1Y,iBAAK3F,MAAL,CAAY,UAAUiV,IAAV,EAAgB;AAAE,uBAAO7Q,QAAQia,MAAR,EAAgBpJ,KAAKlW,KAArB,CAAP;AAAqC,aAAnE,EAAqEiE,OAArE,CAA6E,UAAUiS,IAAV,EAAgB;AACzF,oBAAIqJ,YAAYxe,OAAOmV,KAAKlW,KAAL,CAAWke,KAAX,IAAoB,EAA3B,CAAhB;AACA,oBAAIsB,UAAUb,UAAUa,OAAV,CAAkB5Y,IAAlB,EAAwB,UAAUC,CAAV,EAAa;AAAE,2BAAOA,MAAMqP,IAAb;AAAoB,iBAA3D,CAAd;AACA,oBAAIuJ,cAAcF,UAAU/hB,GAAV,CAAc,UAAUkiB,IAAV,EAAgB;AAAE,2BAAOL,MAAMM,gBAAN,CAAuBH,OAAvB,EAAgCE,IAAhC,CAAP;AAA+C,iBAA/E,CAAlB;AACAxJ,qBAAKgI,KAAL,GAAauB,YAAYzhB,MAAZ,CAAmB4J,OAAnB,EAA4B,EAA5B,CAAb;AACH,aALD;AAMH,SARD;AASA;;;;;;;;;;;AAWA+W,kBAAUQ,aAAV,GAA0B,UAAUF,QAAV,EAAoBC,MAApB,EAA4BU,MAA5B,EAAoC;AAC1D,gBAAIA,WAAW,KAAK,CAApB,EAAuB;AAAEA,yBAAS,EAAT;AAAc;AACvC,qBAASC,aAAT,CAAuBjZ,IAAvB,EAA6B5G,KAA7B,EAAoC;AAChC,oBAAIkW,OAAO3U,KAAKqF,IAAL,EAAWxJ,OAAO,OAAP,EAAgB4C,KAAhB,CAAX,CAAX;AACA,uBAAOmE,OAAO,EAAP,EAAW+R,QAAQA,KAAKuH,WAAxB,CAAP;AACH;AACD,gBAAIqC,YAAYb,SAASzhB,GAAT,CAAa,UAAU0Y,IAAV,EAAgB;AAAE,uBAAOA,KAAK8H,WAAZ;AAA0B,aAAzD,EACXhgB,MADW,CACJ4J,OADI,EACK,EADL,EAEX3G,MAFW,CAEJ,UAAUC,KAAV,EAAiB;AAAE,uBAAO,CAACA,MAAMjB,OAAd;AAAwB,aAFvC,EAGXzC,GAHW,CAGPP,KAAK,IAAL,CAHO,CAAhB;AAIA;;;;AAIA,qBAAS8iB,uBAAT,CAAiCC,MAAjC,EAAyC;AACrC;AACA,oBAAIC,cAAc9b,OAAO,EAAP,EAAW6b,UAAUA,OAAOvC,WAA5B,CAAlB;AACA;AACA,oBAAIyC,oBAAoB7Z,KAAK4Z,WAAL,EAAkBL,MAAlB,CAAxB;AACAK,8BAAchZ,KAAKgZ,WAAL,EAAkBL,MAAlB,CAAd;AACA,oBAAIO,gBAAgBlZ,KAAK4Y,cAAcZ,QAAd,EAAwBe,OAAOhgB,KAA/B,KAAyC,EAA9C,EAAkD8f,SAAlD,CAApB;AACA;AACA,oBAAIM,eAAejc,OAAO8b,WAAP,EAAoBE,aAApB,EAAmCD,iBAAnC,CAAnB;AACA,uBAAO,IAAIpC,QAAJ,CAAakC,OAAOhgB,KAApB,EAA2Bqe,cAA3B,CAA0C+B,YAA1C,CAAP;AACH;AACD;AACA,mBAAOlB,OAAO1hB,GAAP,CAAWuiB,uBAAX,CAAP;AACH,SA3BD;AA4BA;;;AAGApB,kBAAUpI,WAAV,GAAwB,UAAU0I,QAAV,EAAoBC,MAApB,EAA4BmB,WAA5B,EAAyC;AAC7D,gBAAIC,OAAO,CAAX;AAAA,gBAAcC,MAAM3X,KAAKD,GAAL,CAASsW,SAAS7iB,MAAlB,EAA0B8iB,OAAO9iB,MAAjC,CAApB;AACA,gBAAIokB,aAAa,SAAbA,UAAa,CAAUC,KAAV,EAAiBC,KAAjB,EAAwB;AACrC,uBAAOD,MAAMnc,MAAN,CAAaoc,KAAb,EAAoB/B,UAAUgC,gBAA9B,CAAP;AACH,aAFD;AAGA,mBAAOL,OAAOC,GAAP,IAActB,SAASqB,IAAT,EAAetgB,KAAf,KAAyBqgB,WAAvC,IAAsDG,WAAWvB,SAASqB,IAAT,CAAX,EAA2BpB,OAAOoB,IAAP,CAA3B,CAA7D,EAAuG;AACnGA;AACH;AACD;AACA,qBAASM,aAAT,CAAuBC,YAAvB,EAAqClb,GAArC,EAA0C;AACtC,oBAAImb,SAAShD,SAASM,KAAT,CAAeyC,YAAf,CAAb;AACAC,uBAAOrD,WAAP,GAAqByB,OAAOvZ,GAAP,EAAY8X,WAAjC;AACA,uBAAOqD,MAAP;AACH;AACD,gBAAIzE,IAAJ,EAAU0E,QAAV,EAAoBC,OAApB,EAA6BC,QAA7B,EAAuC3E,EAAvC;AACAD,mBAAO4C,QAAP;AACA8B,uBAAW1E,KAAKrgB,KAAL,CAAW,CAAX,EAAcskB,IAAd,CAAX;AACAU,sBAAU3E,KAAKrgB,KAAL,CAAWskB,IAAX,CAAV;AACA;AACA,gBAAIY,uBAAuBH,SAASvjB,GAAT,CAAaojB,aAAb,CAA3B;AACAK,uBAAW/B,OAAOljB,KAAP,CAAaskB,IAAb,CAAX;AACAhE,iBAAM4E,oBAAD,CAAuB3kB,MAAvB,CAA8B0kB,QAA9B,CAAL;AACA,mBAAO,EAAE5E,MAAMA,IAAR,EAAcC,IAAIA,EAAlB,EAAsByE,UAAUA,QAAhC,EAA0CC,SAASA,OAAnD,EAA4DC,UAAUA,QAAtE,EAAP;AACH,SAvBD;AAwBA;;;;;;;;;;;;;;;AAeAtC,kBAAU1I,QAAV,GAAqB,UAAUkL,KAAV,EAAiBC,KAAjB,EAAwB3C,QAAxB,EAAkC;AACnD,gBAAI4C,OAAO,KAAX;AACA,gBAAIC,SAAS7Y,YAAY0Y,KAAZ,EAAmBC,KAAnB,CAAb;AACA,mBAAOE,OAAOtjB,MAAP,CAAc,UAAUiY,QAAV,EAAoB7J,EAApB,EAAwB;AACzC,oBAAImV,QAAQnV,GAAG,CAAH,CAAZ;AAAA,oBAAmBoV,QAAQpV,GAAG,CAAH,CAA3B;AACAiV,uBAAOA,QAAQ,CAACE,MAAMjd,MAAN,CAAakd,KAAb,EAAoB/C,QAApB,CAAhB;AACA,uBAAO4C,OAAOpL,QAAP,GAAkBA,SAAS1Z,MAAT,CAAgBglB,KAAhB,CAAzB;AACH,aAJM,EAIJ,EAJI,CAAP;AAKH,SARD;AASA;;;;;;;;AAQA5C,kBAAUra,MAAV,GAAmB,UAAU6c,KAAV,EAAiBC,KAAjB,EAAwB3C,QAAxB,EAAkC;AACjD,mBAAO0C,MAAM/kB,MAAN,KAAiBglB,MAAMhlB,MAAvB,IACHuiB,UAAU1I,QAAV,CAAmBkL,KAAnB,EAA0BC,KAA1B,EAAiC3C,QAAjC,EAA2CriB,MAA3C,KAAsD+kB,MAAM/kB,MADhE;AAEH,SAHD;AAIA;;;;;;;;;;AAUAuiB,kBAAUa,OAAV,GAAoB,UAAU5Y,IAAV,EAAgB6a,SAAhB,EAA2B;AAC3C,gBAAIvL,OAAO3U,KAAKqF,IAAL,EAAW6a,SAAX,CAAX;AACA,gBAAIC,aAAa9a,KAAKpB,OAAL,CAAa0Q,IAAb,CAAjB;AACA,mBAAOwL,eAAe,CAAC,CAAhB,GAAoBre,SAApB,GAAgCuD,KAAK5K,KAAL,CAAW,CAAX,EAAc0lB,aAAa,CAA3B,CAAvC;AACH,SAJD;AAKA,eAAO/C,SAAP;AACH,KAxJgB,EAAjB;AAyJAA,cAAUgC,gBAAV,GAA6B,UAAUzK,IAAV,EAAgB;AACzC,eAAOA,KAAKlW,KAAL,CAAWU,UAAX,CAAsB,EAAET,SAAS,KAAX,EAAtB,EACFgB,MADE,CACK,UAAUC,KAAV,EAAiB;AAAE,mBAAO,CAACA,MAAM2Z,OAAd;AAAwB,SADhD,CAAP;AAEH,KAHD;AAIA;AACA8D,cAAUlB,WAAV,GAAwB,UAAU7W,IAAV,EAAgB;AACpC,eAAOA,KAAK5I,MAAL,CAAY,UAAUmH,GAAV,EAAe+Q,IAAf,EAAqB;AAAE,mBAAO/R,OAAOgB,GAAP,EAAY+Q,KAAKuH,WAAjB,CAAP;AAAuC,SAA1E,EAA4E,EAA5E,CAAP;AACH,KAFD;;AAIA;;;OAzhF2C,CA4hFvC;AACJ;AACA,QAAIkE,uBAAuB;AACvBvR,cAAM,MADiB;AAEvBwR,eAAO;AAFgB,KAA3B;AAIA;;;;;;;;;;;;AAYA,QAAIC,aAAc,YAAY;AAC1B,iBAASA,UAAT,CAAoBC,IAApB,EAA0BC,SAA1B,EAAqCC,IAArC,EAA2CC,MAA3C,EAAmDzR,IAAnD,EAAyD;AACrD,iBAAK0R,QAAL,GAAgB,KAAhB;AACA,iBAAKzX,OAAL,GAAepH,SAAf;AACA,gBAAIye,gBAAgBD,UAApB,EAAgC;AAC5B1d,uBAAO,IAAP,EAAa2d,IAAb;AACH,aAFD,MAGK,IAAIrgB,WAAWsgB,SAAX,CAAJ,EAA2B;AAC5B,oBAAID,QAAQ,IAAR,IAAgBA,QAAQze,SAA5B,EACI,MAAM,IAAIH,KAAJ,CAAU,8CAAV,CAAN;AACJ,oBAAI,CAACzB,WAAWsgB,SAAX,CAAL,EACI,MAAM,IAAI7e,KAAJ,CAAU,yDAAV,CAAN;AACJ,qBAAK8E,KAAL,GAAa8Z,IAAb;AACA,qBAAKG,MAAL,GAAcA,MAAd;AACA,qBAAKF,SAAL,GAAiBA,SAAjB;AACA,qBAAKC,IAAL,GAAYA,QAAQ,EAApB;AACA,qBAAKxR,IAAL,GAAYA,IAAZ;AACA,qBAAK0R,QAAL,GAAgB1R,SAASnN,SAAzB;AACA,qBAAKoH,OAAL,GAAe,KAAKyX,QAAL,GAAgB/e,SAASC,EAAT,CAAYgN,IAAZ,CAAiB,KAAKI,IAAtB,CAAhB,GAA8CnN,SAA7D;AACH,aAZI,MAaA,IAAI1B,SAASmgB,IAAT,KAAkBA,KAAK9Z,KAAvB,IAAgCvG,WAAWqgB,KAAKC,SAAhB,CAApC,EAAgE;AACjE,oBAAII,UAAUL,IAAd;AACA,uBAAO,IAAID,UAAJ,CAAeM,QAAQna,KAAvB,EAA8Bma,QAAQJ,SAAtC,EAAiDI,QAAQH,IAAzD,EAA+DG,QAAQF,MAAvE,EAA+EE,QAAQ3R,IAAvF,CAAP;AACH;AACJ;AACDqR,mBAAWviB,SAAX,CAAqB8iB,SAArB,GAAiC,UAAUpiB,KAAV,EAAiB;AAC9C,gBAAIqiB,aAAa,KAAKJ,MAAL,IAAe,EAAhC;AACA,gBAAIK,cAActiB,SAASA,MAAMuiB,aAAf,IAAgC,EAAlD;AACA,mBAAO;AACHnS,sBAAMiS,WAAWjS,IAAX,IAAmBkS,YAAYlS,IAA/B,IAAuCuR,qBAAqBvR,IAD/D;AAEHwR,uBAAOS,WAAWT,KAAX,IAAoBU,YAAYV,KAAhC,IAAyCD,qBAAqBC;AAFlE,aAAP;AAIH,SAPD;AAQA;;;;;;;AAOAC,mBAAWviB,SAAX,CAAqBkjB,OAArB,GAA+B,UAAUC,cAAV,EAA0BnU,KAA1B,EAAiC;AAC5D,gBAAInF,QAAQ,IAAZ;AACA,gBAAI/F,KAAKD,SAASC,EAAlB;AACA;AACA,gBAAIsf,4BAA4B,SAA5BA,yBAA4B,GAAY;AACxC,uBAAOtf,GAAGtF,GAAH,CAAO2kB,eAAeE,eAAf,CAA+BxZ,KAA/B,EAAsC3L,GAAtC,CAA0C,UAAU+S,UAAV,EAAsB;AAC1E,2BAAOA,WAAWqS,GAAX,CAAeH,cAAf,EAA+BnU,KAA/B,CAAP;AACH,iBAFa,CAAP,CAAP;AAGH,aAJD;AAKA;AACA,gBAAIuU,kBAAkB,SAAlBA,eAAkB,CAAUC,YAAV,EAAwB;AAC1C,uBAAO3Z,MAAM4Y,SAAN,CAAgB9lB,KAAhB,CAAsB,IAAtB,EAA4B6mB,YAA5B,CAAP;AACH,aAFD;AAGA;;;;;;;;AAQA,gBAAIC,YAAY,SAAZA,SAAY,CAAUC,WAAV,EAAuB;AACnC,oBAAIC,SAASD,YAAYE,KAAZ,CAAkB,CAAlB,CAAb;AACA,uBAAOD,OAAOE,IAAP,CAAY,CAAZ,EAAe9W,SAAf,GAA2BG,IAA3B,CAAgC,YAAY;AAAE,2BAAOyW,MAAP;AAAgB,iBAA9D,CAAP;AACH,aAHD;AAIA;AACA,gBAAI/M,OAAOuM,eAAeW,QAAf,CAAwB,IAAxB,CAAX;AACA,gBAAIpjB,QAAQkW,QAAQA,KAAKlW,KAAzB;AACA,gBAAIqjB,iBAAiB,KAAKjB,SAAL,CAAepiB,KAAf,EAAsB4hB,KAAtB,KAAgC,QAAhC,GAA2CmB,SAA3C,GAAuDve,QAA5E;AACA;AACA,gBAAI8e,qBAAqB,SAArBA,kBAAqB,CAAUC,aAAV,EAAyB;AAC9Cpa,sBAAMqH,IAAN,GAAa+S,aAAb;AACApa,sBAAM+Y,QAAN,GAAiB,IAAjB;AACA5Q,sBAAMhB,uBAAN,CAA8BnH,KAA9B,EAAqCmF,KAArC;AACA,uBAAOnF,MAAMqH,IAAb;AACH,aALD;AAMA;AACA,mBAAO,KAAK/F,OAAL,GAAerH,GAAGgN,IAAH,GACjB5D,IADiB,CACZkW,yBADY,EAEjBlW,IAFiB,CAEZqW,eAFY,EAGjBrW,IAHiB,CAGZ6W,cAHY,EAIjB7W,IAJiB,CAIZ8W,kBAJY,CAAtB;AAKH,SA1CD;AA2CA;;;;;;AAMAzB,mBAAWviB,SAAX,CAAqBsjB,GAArB,GAA2B,UAAUH,cAAV,EAA0BnU,KAA1B,EAAiC;AACxD,mBAAO,KAAK7D,OAAL,IAAgB,KAAK+X,OAAL,CAAaC,cAAb,EAA6BnU,KAA7B,CAAvB;AACH,SAFD;AAGAuT,mBAAWviB,SAAX,CAAqBkC,QAArB,GAAgC,YAAY;AACxC,mBAAO,uBAAuBsC,UAAU,KAAKkE,KAAf,CAAvB,GAA+C,eAA/C,GAAiE,KAAKga,IAAL,CAAUxkB,GAAV,CAAcsG,SAAd,CAAjE,GAA4F,IAAnG;AACH,SAFD;AAGA+d,mBAAWviB,SAAX,CAAqB8e,KAArB,GAA6B,YAAY;AACrC,mBAAO,IAAIyD,UAAJ,CAAe,IAAf,CAAP;AACH,SAFD;AAGA,eAAOA,UAAP;AACH,KAnGiB,EAAlB;AAoGAA,eAAW2B,QAAX,GAAsB,UAAUxb,KAAV,EAAiBwI,IAAjB,EAAuB;AACzC,eAAO,IAAIqR,UAAJ,CAAe7Z,KAAf,EAAsB,YAAY;AAAE,mBAAOwI,IAAP;AAAc,SAAlD,EAAoD,IAApD,EAA0D,IAA1D,EAAgEA,IAAhE,CAAP;AACH,KAFD;;AAIA;AACA,QAAIiT,kBAAkB;AAClBrT,cAAM;AACFsT,kBAAM,MADJ;AAEFC,mBAAO;AAFL,SADY;AAKlB/B,eAAO;AACHgC,kBAAM,MADH;AAEHC,oBAAQ,QAFL;AAGHC,oBAAQ;AAHL;AALW,KAAtB;;AAYA;AACA;AACA,QAAI1T,OAAOqT,gBAAgBrT,IAA3B;AACA,QAAI2T,YAAY,CAAC3T,KAAKuT,KAAN,EAAavT,KAAKsT,IAAlB,CAAhB;AACA,QAAIM,cAAc,CAAC5T,KAAKuT,KAAN,CAAlB;AACA,QAAIM,wBAAwB,iBAA5B;AACA;;;;;;;;;;AAUA,QAAIC,iBAAkB,YAAY;AAC9B,iBAASA,cAAT,CAAwBC,KAAxB,EAA+B;AAC3B,iBAAKA,KAAL,GAAaA,KAAb;AACH;AACD;AACAD,uBAAe5kB,SAAf,CAAyB8kB,SAAzB,GAAqC,YAAY;AAC7C,mBAAO,KAAKD,KAAL,CAAWnmB,MAAX,CAAkB,UAAUmH,GAAV,EAAe+Q,IAAf,EAAqB;AAAE,uBAAO/Q,IAAI5I,MAAJ,CAAW2Z,KAAK+H,WAAL,CAAiBzgB,GAAjB,CAAqB,UAAU0b,CAAV,EAAa;AAAE,2BAAOA,EAAElR,KAAT;AAAiB,iBAArD,CAAX,CAAP;AAA4E,aAArH,EAAuH,EAAvH,EAA2HhK,MAA3H,CAAkI+J,KAAlI,EAAyI,EAAzI,CAAP;AACH,SAFD;AAGA;;;;;;AAMAmc,uBAAe5kB,SAAf,CAAyB+kB,aAAzB,GAAyC,UAAUrc,KAAV,EAAiB;AACtD,gBAAIiO,WAAW,KAAKkO,KAAL,CAAW3mB,GAAX,CAAe,UAAU0Y,IAAV,EAAgB;AAAE,uBAAOA,KAAK+H,WAAZ;AAA0B,aAA3D,EACVjgB,MADU,CACH4J,OADG,EACM,EADN,EAEV3G,MAFU,CAEH,UAAUiY,CAAV,EAAa;AAAE,uBAAOA,EAAElR,KAAF,KAAYA,KAAnB;AAA2B,aAFvC,CAAf;AAGA,mBAAOlF,KAAKmT,QAAL,CAAP;AACH,SALD;AAMA;AACAiO,uBAAe5kB,SAAf,CAAyB8iB,SAAzB,GAAqC,UAAU7R,UAAV,EAAsB;AACvD,gBAAI2F,OAAO,KAAKkN,QAAL,CAAc7S,UAAd,CAAX;AACA,mBAAOA,WAAW6R,SAAX,CAAqBlM,KAAKlW,KAA1B,CAAP;AACH,SAHD;AAIA;;;;;;;;;;;;;;;;;;;;;;;AAuBAkkB,uBAAe5kB,SAAf,CAAyBglB,UAAzB,GAAsC,UAAUtkB,KAAV,EAAiB;AACnD,mBAAO,IAAIkkB,cAAJ,CAAmBvF,UAAUa,OAAV,CAAkB,KAAK2E,KAAvB,EAA8B,UAAUjO,IAAV,EAAgB;AAAE,uBAAOA,KAAKlW,KAAL,KAAeA,KAAtB;AAA8B,aAA9E,CAAnB,CAAP;AACH,SAFD;AAGA;;;;;;;;;;;;;;;AAeAkkB,uBAAe5kB,SAAf,CAAyBilB,cAAzB,GAA0C,UAAUC,cAAV,EAA0BxkB,KAA1B,EAAiC;AACvE,gBAAIkW,OAAO3U,KAAK,KAAK4iB,KAAV,EAAiB/mB,OAAO,OAAP,EAAgB4C,KAAhB,CAAjB,CAAX;AACA,gBAAIkF,OAAOsf,eAAehnB,GAAf,CAAmB,UAAU0b,CAAV,EAAa;AAAE,uBAAOA,EAAElR,KAAT;AAAiB,aAAnD,CAAX;AACAkO,iBAAK+H,WAAL,GAAmB/H,KAAK+H,WAAL,CAAiBhd,MAAjB,CAAwB,UAAUiY,CAAV,EAAa;AAAE,uBAAOhU,KAAKM,OAAL,CAAa0T,EAAElR,KAAf,MAA0B,CAAC,CAAlC;AAAsC,aAA7E,EAA+EzL,MAA/E,CAAsFioB,cAAtF,CAAnB;AACH,SAJD;AAKA;;;;;;;AAOAN,uBAAe5kB,SAAf,CAAyBmlB,WAAzB,GAAuC,UAAUrU,IAAV,EAAgB9B,KAAhB,EAAuB;AAC1D,gBAAInF,QAAQ,IAAZ;AACA,gBAAIiH,SAAS,KAAK,CAAlB,EAAqB;AAAEA,uBAAO,MAAP;AAAgB;AACvC;AACA,gBAAIsU,aAAarf,QAAQ0e,SAAR,EAAmB3T,IAAnB,IAA2BA,IAA3B,GAAkC,MAAnD;AACA;AACA;AACA,gBAAIuU,eAAeD,eAAejB,gBAAgBrT,IAAhB,CAAqBuT,KAApC,GAA4CK,WAA5C,GAA0DD,SAA7E;AACA;AACAzS,kBAAMnB,gBAAN,CAAuB,KAAKgU,KAA5B,EAAmC/T,IAAnC,EAAyC9B,KAAzC;AACA,gBAAIsW,gBAAgB,SAAhBA,aAAgB,CAAUC,YAAV,EAAwBC,WAAxB,EAAqC;AACrD,uBAAO,UAAUvU,UAAV,EAAsB;AACzB,2BAAOlL,QAAQwf,YAAR,EAAsB1b,MAAMiZ,SAAN,CAAgB7R,UAAhB,EAA4BuU,WAA5B,CAAtB,CAAP;AACH,iBAFD;AAGH,aAJD;AAKA;AACA;AACA,gBAAIC,WAAW,KAAKZ,KAAL,CAAWnmB,MAAX,CAAkB,UAAUmH,GAAV,EAAe+Q,IAAf,EAAqB;AAClD,oBAAI8O,kBAAkB9O,KAAK+H,WAAL,CAAiBhd,MAAjB,CAAwB2jB,cAAcD,YAAd,EAA4B,MAA5B,CAAxB,CAAtB;AACA,oBAAIM,SAASD,gBAAgB/jB,MAAhB,CAAuB2jB,cAAc,CAAC,QAAD,CAAd,EAA0B,OAA1B,CAAvB,CAAb;AACA,oBAAIM,OAAOF,gBAAgB/jB,MAAhB,CAAuBxD,IAAImnB,cAAc,CAAC,QAAD,CAAd,EAA0B,OAA1B,CAAJ,CAAvB,CAAX;AACA;AACA,oBAAIN,aAAanb,MAAMmb,UAAN,CAAiBpO,KAAKlW,KAAtB,CAAjB;AACA,oBAAImlB,YAAY,SAAZA,SAAY,CAAUjM,CAAV,EAAa;AAAE,2BAAOA,EAAE0J,GAAF,CAAM0B,UAAN,EAAkBhW,KAAlB,EACjC9B,IADiC,CAC5B,UAAUzD,KAAV,EAAiB;AAAE,+BAAQ,EAAEf,OAAOkR,EAAElR,KAAX,EAAkBe,OAAOA,KAAzB,EAAR;AAA4C,qBADnC,CAAP;AAC8C,iBAD7E;AAEAkc,uBAAOhhB,OAAP,CAAekhB,SAAf;AACA,uBAAOhgB,IAAI5I,MAAJ,CAAW2oB,KAAK1nB,GAAL,CAAS2nB,SAAT,CAAX,CAAP;AACH,aAVc,EAUZ,EAVY,CAAf;AAWA;AACA,mBAAOhiB,SAASC,EAAT,CAAYtF,GAAZ,CAAgBinB,QAAhB,CAAP;AACH,SA9BD;AA+BAb,uBAAe5kB,SAAf,CAAyB8lB,QAAzB,GAAoC,YAAY;AAC5C,mBAAO,KAAKC,SAAL,KAAmB,KAAKA,SAAL,GAAiB,IAAIC,cAAJ,CAAmB,IAAnB,CAApC,CAAP;AACH,SAFD;AAGApB,uBAAe5kB,SAAf,CAAyB8jB,QAAzB,GAAoC,UAAU7S,UAAV,EAAsB;AACtD,mBAAOhP,KAAK,KAAK4iB,KAAV,EAAiB,UAAUjO,IAAV,EAAgB;AAAE,uBAAO7Q,QAAQ6Q,KAAK+H,WAAb,EAA0B1N,UAA1B,CAAP;AAA+C,aAAlF,CAAP;AACH,SAFD;AAGA;;;;;AAKA2T,uBAAe5kB,SAAf,CAAyBqjB,eAAzB,GAA2C,UAAUpS,UAAV,EAAsB;AAC7D,gBAAIpH,QAAQ,IAAZ;AACA,gBAAI+M,OAAO,KAAKkN,QAAL,CAAc7S,UAAd,CAAX;AACA;AACA;AACA,gBAAIiP,UAAUb,UAAUa,OAAV,CAAkB,KAAK2E,KAAvB,EAA8B,UAAUjmB,CAAV,EAAa;AAAE,uBAAOA,MAAMgY,IAAb;AAAoB,aAAjE,KAAsE,KAAKiO,KAAzF;AACA,gBAAIoB,uBAAuB/F,QACtBxhB,MADsB,CACf,UAAUmH,GAAV,EAAe+Q,IAAf,EAAqB;AAAE,uBAAO/Q,IAAI5I,MAAJ,CAAW2Z,KAAK+H,WAAhB,CAAP;AAAsC,aAD9C,EACgD,EADhD,EACoD;AADpD,aAEtBhd,MAFsB,CAEf,UAAUkd,GAAV,EAAe;AAAE,uBAAOA,QAAQ5N,UAAf;AAA4B,aAF9B,CAA3B,CAN6D,CAQD;AAC5D,gBAAIiV,gBAAgB,SAAhBA,aAAgB,CAAUxd,KAAV,EAAiB;AACjC,oBAAIiO,WAAWsP,qBAAqBtkB,MAArB,CAA4B,UAAUiY,CAAV,EAAa;AAAE,2BAAOA,EAAElR,KAAF,KAAYA,KAAnB;AAA2B,iBAAtE,CAAf;AACA,oBAAIiO,SAAS7Z,MAAb,EACI,OAAO0G,KAAKmT,QAAL,CAAP;AACJ,oBAAIwP,eAAetc,MAAMic,QAAN,GAAiBM,SAAjB,CAA2B1d,KAA3B,CAAnB;AACA,oBAAI,CAACyd,YAAL,EAAmB;AACf,0BAAM,IAAIviB,KAAJ,CAAU,gDAAgDY,UAAUkE,KAAV,CAA1D,CAAN;AACH;AACD,uBAAO,IAAI6Z,UAAJ,CAAe7Z,KAAf,EAAsB,YAAY;AAAE,2BAAOyd,YAAP;AAAsB,iBAA1D,EAA4D,EAA5D,EAAgEA,YAAhE,CAAP;AACH,aATD;AAUA,mBAAOlV,WAAWyR,IAAX,CAAgBxkB,GAAhB,CAAoBgoB,aAApB,CAAP;AACH,SApBD;AAqBA,eAAOtB,cAAP;AACH,KA9IqB,EAAtB;AA+IA,QAAIoB,iBAAkB,YAAY;AAC9B,iBAASA,cAAT,CAAwB1V,OAAxB,EAAiC;AAC7B,iBAAKA,OAAL,GAAeA,OAAf;AACA,iBAAK+V,MAAL,GAAc,KAAK/C,GAAL,CAASqB,qBAAT,KAAmC9gB,SAASG,SAA1D;AACH;AACDgiB,uBAAehmB,SAAf,CAAyBsjB,GAAzB,GAA+B,UAAU5a,KAAV,EAAiB;AAC5C,gBAAIuI,aAAa,KAAKX,OAAL,CAAayU,aAAb,CAA2Brc,KAA3B,CAAjB;AACA,gBAAIuI,UAAJ,EAAgB;AACZ,oBAAI,KAAKX,OAAL,CAAawS,SAAb,CAAuB7R,UAAvB,EAAmCqR,KAAnC,KAA6C,QAAjD,EAA2D;AACvD,2BAAOrR,WAAWqS,GAAX,CAAe,KAAKhT,OAApB,CAAP;AACH;AACD,oBAAI,CAACW,WAAW2R,QAAhB,EAA0B;AACtB,0BAAM,IAAIhf,KAAJ,CAAU,0CAA0CY,UAAUyM,WAAWvI,KAArB,CAApD,CAAN;AACH;AACD,uBAAOuI,WAAWC,IAAlB;AACH;AACD,mBAAO,KAAKmV,MAAL,IAAe,KAAKA,MAAL,CAAY/C,GAAZ,CAAgB5a,KAAhB,CAAtB;AACH,SAZD;AAaAsd,uBAAehmB,SAAf,CAAyBsmB,QAAzB,GAAoC,UAAU5d,KAAV,EAAiB;AACjD,gBAAIuI,aAAa,KAAKX,OAAL,CAAayU,aAAb,CAA2Brc,KAA3B,CAAjB;AACA,gBAAIuI,UAAJ,EACI,OAAOA,WAAWqS,GAAX,CAAe,KAAKhT,OAApB,CAAP;AACJ,mBAAOzM,SAASC,EAAT,CAAYgN,IAAZ,CAAiB,KAAKuV,MAAL,CAAY/C,GAAZ,CAAgB5a,KAAhB,CAAjB,CAAP;AACH,SALD;AAMAsd,uBAAehmB,SAAf,CAAyBomB,SAAzB,GAAqC,UAAU1d,KAAV,EAAiB;AAClD,mBAAO,KAAK2d,MAAL,IAAe,KAAKA,MAAL,CAAY/C,GAAZ,CAAgB5a,KAAhB,CAAtB;AACH,SAFD;AAGA,eAAOsd,cAAP;AACH,KA5BqB,EAAtB;;AA8BA;;;;AAIA;AACA;AACA,QAAIO,YAAY5oB,KAAK,MAAL,CAAhB;AACA;;;;;;;;AAQA,QAAI6oB,aAAc,YAAY;AAC1B;;;;;;;;;;;;AAYA,iBAASA,UAAT,CAAoB7G,QAApB,EAA8BH,WAA9B,EAA2C5L,MAA3C,EAAmD;AAC/C,gBAAI/J,QAAQ,IAAZ;AACA;AACA,iBAAK4c,SAAL,GAAiB5iB,SAASC,EAAT,CAAY4iB,KAAZ,EAAjB;AACA;;;;;;AAMA,iBAAKvb,OAAL,GAAe,KAAKsb,SAAL,CAAetb,OAA9B;AACA;AACA,iBAAK2M,gBAAL,GAAwB,EAAxB;AACA;AACA,iBAAK6O,YAAL,GAAoB,IAAIzO,WAAJ,CAAgB,IAAhB,CAApB;AACA;AACA,iBAAK1E,QAAL,GAAgB,YAAY;AACxB,uBAAO3J,MAAM+J,MAAN,CAAagT,OAAb,CAAqB3T,UAArB,KAAoCpJ,KAA3C;AACH,aAFD;AAGA,iBAAK+J,MAAL,GAAcA,MAAd;AACA,iBAAKiT,YAAL,GAAoBrH,WAApB;AACA,gBAAI,CAACA,YAAY7M,KAAZ,EAAL,EAA0B;AACtB,sBAAM,IAAI/O,KAAJ,CAAU4b,YAAYjU,KAAZ,EAAV,CAAN;AACH;AACD;AACA,iBAAKgH,QAAL,GAAgB1N,OAAO,EAAEqH,SAASnO,IAAI,IAAJ,CAAX,EAAP,EAA+ByhB,YAAYpS,OAAZ,EAA/B,CAAhB;AACA,iBAAKT,GAAL,GAAWiH,OAAOiE,iBAAP,CAAyBiP,gBAAzB,EAAX;AACA,gBAAIlH,SAASP,UAAUK,WAAV,CAAsBC,QAAtB,EAAgCH,WAAhC,CAAb;AACA,iBAAKuH,YAAL,GAAoB1H,UAAUpI,WAAV,CAAsB0I,QAAtB,EAAgCC,MAAhC,EAAwC,KAAKrN,QAAL,CAAcwO,WAAtD,CAApB;AACA,iBAAKiG,0BAAL;AACA,gBAAIC,gBAAgB,KAAKN,YAAL,CAAkBxO,kBAAlB,CAAqCnc,QAAQiW,mBAAR,CAA4BoH,MAAjE,CAApB;AACAlG,2BAAekC,WAAf,CAA2B4R,aAA3B,EAA0C,YAAY;AAAE,uBAAO,IAAP;AAAc,aAAtE;AACA,iBAAKnH,gBAAL,CAAsBlM,MAAtB;AACH;AACD;AACA4S,mBAAWxmB,SAAX,CAAqBknB,QAArB,GAAgC,UAAUhQ,QAAV,EAAoBlP,QAApB,EAA8BoF,OAA9B,EAAuC;AAAE;AAAS,SAAlF;AACA;AACAoZ,mBAAWxmB,SAAX,CAAqBmnB,OAArB,GAA+B,UAAUjQ,QAAV,EAAoBlP,QAApB,EAA8BoF,OAA9B,EAAuC;AAAE;AAAS,SAAjF;AACA;AACAoZ,mBAAWxmB,SAAX,CAAqBonB,MAArB,GAA8B,UAAUlQ,QAAV,EAAoBlP,QAApB,EAA8BoF,OAA9B,EAAuC;AAAE;AAAS,SAAhF;AACA;AACAoZ,mBAAWxmB,SAAX,CAAqBqnB,QAArB,GAAgC,UAAUnQ,QAAV,EAAoBlP,QAApB,EAA8BoF,OAA9B,EAAuC;AAAE;AAAS,SAAlF;AACA;AACAoZ,mBAAWxmB,SAAX,CAAqBsnB,OAArB,GAA+B,UAAUpQ,QAAV,EAAoBlP,QAApB,EAA8BoF,OAA9B,EAAuC;AAAE;AAAS,SAAjF;AACA;AACAoZ,mBAAWxmB,SAAX,CAAqBunB,QAArB,GAAgC,UAAUrQ,QAAV,EAAoBlP,QAApB,EAA8BoF,OAA9B,EAAuC;AAAE;AAAS,SAAlF;AACA;AACAoZ,mBAAWxmB,SAAX,CAAqBwnB,SAArB,GAAiC,UAAUtQ,QAAV,EAAoBlP,QAApB,EAA8BoF,OAA9B,EAAuC;AAAE;AAAS,SAAnF;AACA;AACAoZ,mBAAWxmB,SAAX,CAAqBynB,OAArB,GAA+B,UAAUvQ,QAAV,EAAoBlP,QAApB,EAA8BoF,OAA9B,EAAuC;AAAE;AAAS,SAAjF;AACA;;;;AAIAoZ,mBAAWxmB,SAAX,CAAqBgnB,0BAArB,GAAkD,YAAY;AAC1D,gBAAInd,QAAQ,IAAZ;AACA,iBAAK+J,MAAL,CAAYiE,iBAAZ,CAA8Bf,UAA9B,CAAyCwB,UAAzC,GACK3W,MADL,CACY,UAAU6K,IAAV,EAAgB;AAAE,uBAAOA,KAAK8G,SAAL,KAAmBtX,QAAQiW,mBAAR,CAA4BoH,MAAtD;AAA+D,aAD7F,EAEK1U,OAFL,CAEa,UAAU6H,IAAV,EAAgB;AAAE,uBAAOmL,UAAU9N,KAAV,EAAiBA,MAAM+J,MAAN,CAAaiE,iBAA9B,EAAiDrL,IAAjD,CAAP;AAAgE,aAF/F;AAGH,SALD;AAMA;AACAga,mBAAWxmB,SAAX,CAAqBwZ,QAArB,GAAgC,UAAUkO,QAAV,EAAoB;AAChD,mBAAO,KAAK5P,gBAAL,CAAsB4P,QAAtB,CAAP;AACH,SAFD;AAGAlB,mBAAWxmB,SAAX,CAAqB8f,gBAArB,GAAwC,UAAUlM,MAAV,EAAkB;AACtD,gBAAI+T,iBAAiB,KAAKZ,YAAL,CAAkBpF,QAAlB,CAA2BzjB,GAA3B,CAA+B,UAAU0Y,IAAV,EAAgB;AAAE,uBAAOA,KAAKlW,KAAZ;AAAoB,aAArE,CAArB;AACA2e,sBAAUS,gBAAV,CAA2BlM,OAAOiE,iBAAP,CAAyBkI,KAApD,EAA2D,KAAKgH,YAAL,CAAkB/J,EAA7E,EAAiF2K,cAAjF;AACH,SAHD;AAIA;;;;;AAKAnB,mBAAWxmB,SAAX,CAAqB4nB,KAArB,GAA6B,YAAY;AACrC,mBAAOpkB,KAAK,KAAKujB,YAAL,CAAkBhK,IAAvB,EAA6Brc,KAApC;AACH,SAFD;AAGA;;;;;AAKA8lB,mBAAWxmB,SAAX,CAAqB6nB,GAArB,GAA2B,YAAY;AACnC,mBAAOrkB,KAAK,KAAKujB,YAAL,CAAkB/J,EAAvB,EAA2Btc,KAAlC;AACH,SAFD;AAGA;;;;;;;AAOA8lB,mBAAWxmB,SAAX,CAAqB+c,IAArB,GAA4B,YAAY;AACpC,mBAAO,KAAK6K,KAAL,GAAa/mB,IAApB;AACH,SAFD;AAGA;;;;;;;AAOA2lB,mBAAWxmB,SAAX,CAAqBgd,EAArB,GAA0B,YAAY;AAClC,mBAAO,KAAK6K,GAAL,GAAWhnB,IAAlB;AACH,SAFD;AAGA;;;;;;;AAOA2lB,mBAAWxmB,SAAX,CAAqBwf,WAArB,GAAmC,YAAY;AAC3C,mBAAO,KAAKqH,YAAZ;AACH,SAFD;AAGA;;;;AAIAL,mBAAWxmB,SAAX,CAAqBlB,EAArB,GAA0B,UAAUgpB,OAAV,EAAmB;AACzC,gBAAIA,mBAAmBtB,UAAvB,EAAmC;AAC/B;AACA,uBAAO,KAAK1nB,EAAL,CAAQ,EAAEke,IAAI8K,QAAQD,GAAR,GAAcjqB,IAApB,EAA0Bmf,MAAM+K,QAAQF,KAAR,GAAgBhqB,IAAhD,EAAR,CAAP;AACH;AACD,mBAAO,EAAGkqB,QAAQ9K,EAAR,IAAc,CAAClH,WAAW,KAAK+R,GAAL,EAAX,EAAuBC,QAAQ9K,EAA/B,CAAhB,IACJ8K,QAAQ/K,IAAR,IAAgB,CAACjH,WAAW,KAAK8R,KAAL,EAAX,EAAyBE,QAAQ/K,IAAjC,CADf,CAAP;AAEH,SAPD;AAQAyJ,mBAAWxmB,SAAX,CAAqB0B,MAArB,GAA8B,UAAUqmB,QAAV,EAAoB;AAC9C,gBAAIA,aAAa,KAAK,CAAtB,EAAyB;AAAEA,2BAAW,IAAX;AAAkB;AAC7C,mBAAOxlB,OAAOylB,MAAP,CAAc,KAAKjB,YAAL,CAAkBgB,QAAlB,EAA4B7pB,GAA5B,CAAgCP,KAAK,aAAL,CAAhC,EAAqDe,MAArD,CAA4DsI,MAA5D,EAAoE,EAApE,CAAd,CAAP;AACH,SAHD;AAIA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAuDAwf,mBAAWxmB,SAAX,CAAqB8lB,QAArB,GAAgC,UAAUplB,KAAV,EAAiBunB,QAAjB,EAA2B;AACvD,gBAAIA,aAAa,KAAK,CAAtB,EAAyB;AAAEA,2BAAW,IAAX;AAAkB;AAC7C,gBAAI3gB,OAAO,KAAKyf,YAAL,CAAkBkB,QAAlB,CAAX;AACA,gBAAIvnB,KAAJ,EACI4G,OAAO+X,UAAUa,OAAV,CAAkB5Y,IAAlB,EAAwB,UAAUsP,IAAV,EAAgB;AAAE,uBAAOA,KAAKlW,KAAL,KAAeA,KAAf,IAAwBkW,KAAKlW,KAAL,CAAW9C,IAAX,KAAoB8C,KAAnD;AAA2D,aAArG,CAAP;AACJ,mBAAO,IAAIkkB,cAAJ,CAAmBtd,IAAnB,EAAyBwe,QAAzB,EAAP;AACH,SAND;AAOA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgCAU,mBAAWxmB,SAAX,CAAqBkoB,gBAArB,GAAwC,UAAUH,QAAV,EAAoB;AACxD,gBAAIA,aAAa,KAAK,CAAtB,EAAyB;AAAEA,2BAAW,IAAX;AAAkB;AAC7C,mBAAO,IAAInD,cAAJ,CAAmB,KAAKmC,YAAL,CAAkBgB,QAAlB,CAAnB,EAAgDjD,SAAhD,EAAP;AACH,SAHD;AAIA;;;;;;;;;;;;;;;;;AAiBA0B,mBAAWxmB,SAAX,CAAqBmoB,aAArB,GAAqC,UAAUlX,UAAV,EAAsBvQ,KAAtB,EAA6B;AAC9D,gBAAIA,UAAU,KAAK,CAAnB,EAAsB;AAAEA,wBAAQ,EAAR;AAAa;AACrCuQ,yBAAanS,GAAGyjB,UAAH,EAAetR,UAAf,IAA6BA,UAA7B,GAA0C,IAAIsR,UAAJ,CAAetR,UAAf,CAAvD;AACA,gBAAI6B,YAAa,OAAOpS,KAAP,KAAiB,QAAlB,GAA8BA,KAA9B,GAAsCA,MAAM9C,IAA5D;AACA,gBAAIwqB,SAAS,KAAKrB,YAAL,CAAkB/J,EAA/B;AACA,gBAAIqL,aAAapmB,KAAKmmB,MAAL,EAAa,UAAUxR,IAAV,EAAgB;AAAE,uBAAOA,KAAKlW,KAAL,CAAW9C,IAAX,KAAoBkV,SAA3B;AAAuC,aAAtE,CAAjB;AACA,gBAAIqQ,iBAAiB,IAAIyB,cAAJ,CAAmBwD,MAAnB,CAArB;AACAjF,2BAAe8B,cAAf,CAA8B,CAAChU,UAAD,CAA9B,EAA4CoX,WAAW3nB,KAAvD;AACH,SARD;AASA;;;;;;;;;;;;;;;;;AAiBA8lB,mBAAWxmB,SAAX,CAAqBsoB,cAArB,GAAsC,YAAY;AAC9C,mBAAO,KAAK/V,QAAL,CAAc+V,cAAd,IAAgC,IAAvC;AACH,SAFD;AAGA;;;;;;;;;;;;;;;;;;;;;;;;;;AA0BA9B,mBAAWxmB,SAAX,CAAqBuoB,kBAArB,GAA0C,YAAY;AAClD,gBAAIC,KAAK,KAAKF,cAAL,EAAT;AACA,mBAAQE,MAAMA,GAAGD,kBAAH,EAAP,IAAmC,IAA1C;AACH,SAHD;AAIA;;;;;AAKA/B,mBAAWxmB,SAAX,CAAqBoN,OAArB,GAA+B,YAAY;AACvC,mBAAO,KAAKmF,QAAZ;AACH,SAFD;AAGA;;;;;AAKAiU,mBAAWxmB,SAAX,CAAqB2hB,QAArB,GAAgC,YAAY;AACxC,mBAAOzjB,IAAI,KAAK6oB,YAAL,CAAkBpF,QAAtB,EAAgChkB,KAAK,OAAL,CAAhC,EAA+CO,GAA/C,CAAmDqoB,SAAnD,CAAP;AACH,SAFD;AAGA;;;;;AAKAC,mBAAWxmB,SAAX,CAAqB0hB,OAArB,GAA+B,YAAY;AACvC,mBAAOxjB,IAAI,KAAK6oB,YAAL,CAAkBrF,OAAtB,EAA+B/jB,KAAK,OAAL,CAA/B,EAA8CO,GAA9C,CAAkDqoB,SAAlD,EAA6D7oB,OAA7D,EAAP;AACH,SAFD;AAGA;;;;;;AAMA8oB,mBAAWxmB,SAAX,CAAqByhB,QAArB,GAAgC,YAAY;AACxC,mBAAOvjB,IAAI,KAAK6oB,YAAL,CAAkBtF,QAAtB,EAAgC9jB,KAAK,OAAL,CAAhC,EAA+CO,GAA/C,CAAmDqoB,SAAnD,CAAP;AACH,SAFD;AAGA;;;;;;;;;;;;AAYAC,mBAAWxmB,SAAX,CAAqB4e,KAArB,GAA6B,UAAUmJ,QAAV,EAAoBrnB,KAApB,EAA2B;AACpD,gBAAIqnB,aAAa,KAAK,CAAtB,EAAyB;AAAEA,2BAAW,UAAX;AAAwB;AACnD,gBAAIzgB,OAAO,KAAKyf,YAAL,CAAkBgB,QAAlB,CAAX;AACAzgB,mBAAO,CAAC5G,KAAD,GAAS4G,IAAT,GAAgBA,KAAK3F,MAAL,CAAY7D,OAAO,OAAP,EAAgB4C,KAAhB,CAAZ,CAAvB;AACA,mBAAO4G,KAAKpJ,GAAL,CAASP,KAAK,OAAL,CAAT,EAAwBgE,MAAxB,CAA+BuD,QAA/B,EAAyCxG,MAAzC,CAAgD4J,OAAhD,EAAyD,EAAzD,CAAP;AACH,SALD;AAMAke,mBAAWxmB,SAAX,CAAqBiX,WAArB,GAAmC,UAAU8Q,QAAV,EAAoB;AACnD,mBAAOA,WAAW,KAAKhB,YAAL,CAAkBgB,QAAlB,CAAX,GAAyC,KAAKhB,YAArD;AACH,SAFD;AAGA;;;;;;;;;;AAUAP,mBAAWxmB,SAAX,CAAqByoB,QAArB,GAAgC,UAAUjJ,WAAV,EAAuB;AACnD,gBAAIkJ,YAAY,CAAhB;AAAA,gBAAmB1Z,QAAQ,IAA3B;AACA,mBAAO,CAACA,QAAQA,MAAMsZ,cAAN,EAAT,KAAoC,IAA3C,EAAiD;AAC7C,oBAAI,EAAEI,SAAF,GAAc,EAAlB,EACI,MAAM,IAAI9kB,KAAJ,CAAU,iDAAV,CAAN;AACP;AACD,gBAAI+kB,eAAe,EAAEL,gBAAgB,IAAlB,EAAwBjjB,QAAQ,UAAhC,EAAnB;AACA;AACA;AACA;AACA;AACA,gBAAI,KAAK+H,OAAL,GAAe/H,MAAf,KAA0B,KAA1B,IAAmCma,YAAYpS,OAAZ,GAAsB8O,QAAtB,KAAmC,KAA1E,EAAiF;AAC7EyM,6BAAazM,QAAb,GAAwB,SAAxB;AACH;AACD,gBAAI0M,aAAa/jB,OAAO,EAAP,EAAW,KAAKuI,OAAL,EAAX,EAA2BoS,YAAYpS,OAAZ,EAA3B,EAAkDub,YAAlD,CAAjB;AACAnJ,0BAAc,IAAIrN,WAAJ,CAAgBqN,YAAYhN,UAAZ,EAAhB,EAA0CgN,YAAY/M,MAAZ,EAA1C,EAAgE+M,YAAY9d,MAAZ,EAAhE,EAAsFknB,UAAtF,CAAd;AACA,gBAAIC,gBAAgB,KAAKjV,MAAL,CAAYiE,iBAAZ,CAA8BtX,MAA9B,CAAqC,KAAKwmB,YAAL,CAAkBhK,IAAvD,EAA6DyC,WAA7D,CAApB;AACA,gBAAIsJ,wBAAwB,KAAK/B,YAAL,CAAkBpF,QAA9C;AACA,gBAAIoH,wBAAwBF,cAAc9B,YAAd,CAA2BpF,QAAvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAIqH,kBAAkB,SAAlBA,eAAkB,CAAUjI,WAAV,EAAuB;AAAE,uBAAO,UAAUnK,IAAV,EAAgB;AAClE,2BAAOmK,eAAenK,KAAKlW,KAAL,CAAWuoB,QAAX,CAAoBlI,YAAYnjB,IAAhC,CAAtB;AACH,iBAF8C;AAE3C,aAFJ;AAGA;AACA,gBAAIsrB,wBAAwB7J,UAAU1I,QAAV,CAAmBoS,qBAAnB,EAA0CD,qBAA1C,EAAiEzJ,UAAUgC,gBAA3E,EACvB1f,MADuB,CAChBxD,IAAI6qB,gBAAgBxJ,YAAYpS,OAAZ,GAAsB2T,WAAtC,CAAJ,CADgB,CAA5B;AAEA;AACAmI,kCAAsBvkB,OAAtB,CAA8B,UAAUiS,IAAV,EAAgBvQ,GAAhB,EAAqB;AAC/CuQ,qBAAK+H,WAAL,GAAmBmK,sBAAsBziB,GAAtB,EAA2BsY,WAA9C;AACH,aAFD;AAGA,mBAAOkK,aAAP;AACH,SAvCD;AAwCA;AACArC,mBAAWxmB,SAAX,CAAqBmpB,cAArB,GAAsC,YAAY;AAC9C,gBAAIC,KAAK,KAAKrC,YAAd;AACA;AACA;AACA,gBAAI,KAAKxU,QAAL,CAAc8W,MAAlB,EACI,OAAOtlB,SAAP;AACJ;AACA,gBAAIqlB,GAAG1H,OAAH,CAAW5kB,MAAX,IAAqBssB,GAAGzH,QAAH,CAAY7kB,MAArC,EACI,OAAOiH,SAAP;AACJ;AACA,gBAAIqlB,GAAGpM,EAAH,CAAMlgB,MAAN,KAAiBssB,GAAGrM,IAAH,CAAQjgB,MAA7B,EACI,OAAOiH,SAAP;AACJ;AACA,gBAAIulB,cAAcngB,YAAYigB,GAAGpM,EAAf,EAAmBoM,GAAGrM,IAAtB,EACb7e,GADa,CACT,UAAUib,KAAV,EAAiB;AAAE,uBAAOA,MAAM,CAAN,EAASzY,KAAT,KAAmByY,MAAM,CAAN,EAASzY,KAAnC;AAA2C,aADrD,EAEbhC,MAFa,CAEN2J,QAFM,EAEI,KAFJ,CAAlB;AAGA,gBAAIihB,WAAJ,EACI,OAAOvlB,SAAP;AACJ;AACA,gBAAIwlB,cAAcH,GAAGpM,EAAH,CAAM9e,GAAN,CAAU,UAAU0Y,IAAV,EAAgB;AAAE,uBAAOA,KAAK8H,WAAZ;AAA0B,aAAtD,CAAlB;AACA,gBAAI5R,KAAK,CAACsc,GAAGpM,EAAJ,EAAQoM,GAAGrM,IAAX,EAAiB7e,GAAjB,CAAqB,UAAUoJ,IAAV,EAAgB;AAAE,uBAAOA,KAAKpJ,GAAL,CAAS,UAAUU,CAAV,EAAa;AAAE,2BAAOA,EAAEuf,WAAT;AAAuB,iBAA/C,CAAP;AAA0D,aAAjG,CAAT;AAAA,gBAA6GqL,WAAW1c,GAAG,CAAH,CAAxH;AAAA,gBAA+H2c,aAAa3c,GAAG,CAAH,CAA5I;AACA,gBAAIkV,SAAS7Y,YAAYogB,WAAZ,EAAyBC,QAAzB,EAAmCC,UAAnC,CAAb;AACA,mBAAOzH,OAAO9jB,GAAP,CAAW,UAAU4O,EAAV,EAAc;AAC5B,oBAAI4c,SAAS5c,GAAG,CAAH,CAAb;AAAA,oBAAoB6c,SAAS7c,GAAG,CAAH,CAA7B;AAAA,oBAAoC8c,WAAW9c,GAAG,CAAH,CAA/C;AACA,uBAAOmQ,MAAMoB,OAAN,CAAcqL,MAAd,EAAsBC,MAAtB,EAA8BC,QAA9B,CAAP;AACH,aAHM,EAGJlrB,MAHI,CAGG4J,OAHH,EAGY,EAHZ,CAAP;AAIH,SA1BD;AA2BA;;;;;;;AAOAke,mBAAWxmB,SAAX,CAAqBub,OAArB,GAA+B,YAAY;AACvC,gBAAIsO,UAAU,KAAKV,cAAL,EAAd;AACA,mBAAO,CAACU,OAAD,GAAW,KAAX,GAAmBA,QAAQ3rB,GAAR,CAAY,UAAUU,CAAV,EAAa;AAAE,uBAAOA,EAAE2c,OAAT;AAAmB,aAA9C,EAAgD7c,MAAhD,CAAuD2J,QAAvD,EAAiE,KAAjE,CAA1B;AACH,SAHD;AAIA;;;;;;;AAOAme,mBAAWxmB,SAAX,CAAqB0N,OAArB,GAA+B,YAAY;AACvC,mBAAO,CAAC,CAAC,KAAKoc,cAAL,EAAT;AACH,SAFD;AAGA;AACAtD,mBAAWxmB,SAAX,CAAqB8pB,cAArB,GAAsC,YAAY;AAC9C,gBAAIC,UAAU,KAAKnW,MAAL,CAAYgT,OAAZ,CAAoB3T,UAAlC;AACA,gBAAI8N,cAAc,KAAKxO,QAAL,CAAcwO,WAAhC;AACA,gBAAIiJ,OAAO,SAAPA,IAAO,CAAUnI,KAAV,EAAiBC,KAAjB,EAAwB;AAC/B,oBAAID,MAAM/kB,MAAN,KAAiBglB,MAAMhlB,MAA3B,EACI,OAAO,KAAP;AACJ,oBAAI6Z,WAAW0I,UAAU1I,QAAV,CAAmBkL,KAAnB,EAA0BC,KAA1B,CAAf;AACA,uBAAOD,MAAM/kB,MAAN,KAAiB6Z,SAAShV,MAAT,CAAgB,UAAUiV,IAAV,EAAgB;AAAE,2BAAO,CAACmK,WAAD,IAAgB,CAACnK,KAAKlW,KAAL,CAAWuoB,QAAX,CAAoBlI,YAAYnjB,IAAhC,CAAxB;AAAgE,iBAAlG,EAAoGd,MAA5H;AACH,aALD;AAMA,gBAAImtB,QAAQ,KAAKhT,WAAL,EAAZ;AACA,gBAAIiT,SAASH,WAAWA,QAAQ9S,WAAR,EAAxB;AACA,gBAAIiT,UAAUF,KAAKE,OAAOlN,EAAZ,EAAgBiN,MAAMjN,EAAtB,CAAV,IAAuCgN,KAAKE,OAAOxI,OAAZ,EAAqBuI,MAAMvI,OAA3B,CAA3C,EACI,OAAO,eAAP;AACJ,gBAAIuI,MAAMvI,OAAN,CAAc5kB,MAAd,KAAyB,CAAzB,IAA8BmtB,MAAMtI,QAAN,CAAe7kB,MAAf,KAA0B,CAAxD,IAA6DktB,KAAKC,MAAMlN,IAAX,EAAiBkN,MAAMjN,EAAvB,CAAjE,EACI,OAAO,eAAP;AACP,SAfD;AAgBA;;;;;;;;;AASAwJ,mBAAWxmB,SAAX,CAAqBmqB,GAArB,GAA2B,YAAY;AACnC,gBAAItgB,QAAQ,IAAZ;AACA,gBAAI2L,cAAcrC,eAAeqC,WAAjC;AACA;AACA,gBAAI4U,cAAc,SAAdA,WAAc,CAAUhS,KAAV,EAAiB;AAC/B,uBAAOvO,MAAM8c,YAAN,CAAmBxO,kBAAnB,CAAsCC,KAAtC,CAAP;AACH,aAFD;AAGA;AACA,gBAAIiS,oBAAoB,SAApBA,iBAAoB,GAAY;AAChCrY,sBAAMX,YAAN,CAAmBxH,MAAMge,GAAN,EAAnB,EAAgChe,KAAhC;AACAA,sBAAMygB,OAAN,GAAgB,IAAhB;AACAzgB,sBAAM4c,SAAN,CAAgBvD,OAAhB,CAAwBrZ,MAAMmT,EAAN,EAAxB;AACAxH,4BAAY4U,YAAYpuB,QAAQiW,mBAAR,CAA4BsY,OAAxC,CAAZ;AACH,aALD;AAMA,gBAAIC,kBAAkB,SAAlBA,eAAkB,CAAUpZ,MAAV,EAAkB;AACpCY,sBAAMb,UAAN,CAAiBC,MAAjB,EAAyBvH,KAAzB;AACAA,sBAAMygB,OAAN,GAAgB,KAAhB;AACAzgB,sBAAM4c,SAAN,CAAgBjb,MAAhB,CAAuB4F,MAAvB;AACAvH,sBAAM4gB,MAAN,GAAerZ,MAAf;AACAoE,4BAAY4U,YAAYpuB,QAAQiW,mBAAR,CAA4BlE,KAAxC,CAAZ;AACH,aAND;AAOA,gBAAI2c,gBAAgB,SAAhBA,aAAgB,GAAY;AAC5B;AACA;AACA,oBAAIC,cAAcP,YAAYpuB,QAAQiW,mBAAR,CAA4BsB,GAAxC,CAAlB;AACA,oBAAIwO,OAAO,SAAPA,IAAO,GAAY;AAAE,2BAAOle,SAASC,EAAT,CAAYgN,IAAZ,CAAiB/M,SAAjB,CAAP;AAAqC,iBAA9D;AACA,uBAAOoP,eAAekC,WAAf,CAA2BsV,WAA3B,EAAwC5I,IAAxC,CAAP;AACH,aAND;AAOA,gBAAI6I,kBAAkB,SAAlBA,eAAkB,GAAY;AAC9B,oBAAIhE,UAAU/c,MAAM+J,MAAN,CAAagT,OAA3B;AACAA,wBAAQiE,uBAAR,GAAkChhB,MAAM8C,GAAxC;AACAia,wBAAQ3T,UAAR,GAAqBpJ,KAArB;AACA+c,wBAAQkE,iBAAR,CAA0Blf,OAA1B,CAAkC/B,KAAlC;AACAmI,sBAAMnC,oBAAN,CAA2BhG,KAA3B;AACA,uBAAOhG,SAASC,EAAT,CAAYgN,IAAZ,CAAiB/M,SAAjB,CAAP;AACH,aAPD;AAQA,gBAAIgnB,iBAAiBX,YAAYpuB,QAAQiW,mBAAR,CAA4B+Y,MAAxC,CAArB;AACA7X,2BAAekC,WAAf,CAA2B0V,cAA3B,EAA2CH,eAA3C,EACK1d,IADL,CACUwd,aADV,EAEKxd,IAFL,CAEUmd,iBAFV,EAE6BG,eAF7B;AAGA,mBAAO,KAAKrf,OAAZ;AACH,SAzCD;AA0CA;;;;;AAKAqb,mBAAWxmB,SAAX,CAAqB2S,KAArB,GAA6B,YAAY;AACrC,mBAAO,CAAC,KAAKpH,KAAL,EAAD,IAAiB,KAAK+e,OAAL,KAAiBvmB,SAAzC;AACH,SAFD;AAGA;;;;;;AAMAyiB,mBAAWxmB,SAAX,CAAqBirB,KAArB,GAA6B,YAAY;AACrC;AACA,gBAAIvoB,YAAY,KAAK4nB,OAAjB,CAAJ,EAA+B;AAC3B,qBAAKxV,QAAL,GAAgB,IAAhB;AACH;AACJ,SALD;AAMA;;;;;;;;AAQA0R,mBAAWxmB,SAAX,CAAqBuL,KAArB,GAA6B,YAAY;AACrC,gBAAI7K,QAAQ,KAAKmnB,GAAL,EAAZ;AACA,gBAAInnB,MAAMG,IAAN,CAAWqqB,QAAf,EACI,OAAO,0CAA0CxqB,MAAM9C,IAAhD,GAAuD,GAA9D;AACJ,gBAAI,CAACqf,MAAMc,SAAN,CAAgBrd,MAAMU,UAAN,EAAhB,EAAoC,KAAKM,MAAL,EAApC,CAAL,EACI,OAAO,uCAAuChB,MAAM9C,IAA7C,GAAoD,GAA3D;AACJ,gBAAI,KAAK0sB,OAAL,KAAiB,KAArB,EACI,OAAO,KAAKG,MAAZ;AACP,SARD;AASA;;;;;AAKAjE,mBAAWxmB,SAAX,CAAqBkC,QAArB,GAAgC,YAAY;AACxC,gBAAIipB,kBAAkB,KAAKpO,IAAL,EAAtB;AACA,gBAAIqO,gBAAgB,KAAKpO,EAAL,EAApB;AACA,gBAAIqO,iBAAiB,SAAjBA,cAAiB,CAAU3pB,MAAV,EAAkB;AACnC,uBAAQA,OAAO,GAAP,MAAgB,IAAhB,IAAwBA,OAAO,GAAP,MAAgBqC,SAAzC,GAAsDrC,MAAtD,GAA+DiG,KAAKjG,MAAL,EAAa,CAAC,GAAD,CAAb,CAAtE;AACH,aAFD;AAGA;AACA,gBAAII,KAAK,KAAK6K,GAAd;AAAA,gBAAmBoQ,OAAO1a,SAAS8oB,eAAT,IAA4BA,gBAAgBvtB,IAA5C,GAAmDutB,eAA7E;AAAA,gBAA8FG,aAAa/mB,OAAO8mB,eAAe,KAAKtE,YAAL,CAAkBhK,IAAlB,CAAuB7e,GAAvB,CAA2BP,KAAK,aAAL,CAA3B,EAAgDe,MAAhD,CAAuDsI,MAAvD,EAA+D,EAA/D,CAAf,CAAP,CAA3G;AAAA,gBAAuMukB,UAAU,KAAK5Y,KAAL,KAAe,EAAf,GAAoB,MAArO;AAAA,gBAA6OqK,KAAK3a,SAAS+oB,aAAT,IAA0BA,cAAcxtB,IAAxC,GAA+CwtB,aAAjS;AAAA,gBAAgT3L,WAAWlb,OAAO8mB,eAAe,KAAK3pB,MAAL,EAAf,CAAP,CAA3T;AACA,mBAAO,gBAAgBI,EAAhB,GAAqB,KAArB,GAA6Bib,IAA7B,GAAoC,GAApC,GAA0CuO,UAA1C,GAAuD,MAAvD,GAAgEC,OAAhE,GAA0E,GAA1E,GAAgFvO,EAAhF,GAAqF,GAArF,GAA2FyC,QAA3F,GAAsG,IAA7G;AACH,SATD;AAUA,eAAO+G,UAAP;AACH,KA/kBiB,EAAlB;AAglBA;AACAA,eAAWgF,OAAX,GAAqBhF,UAArB;;AAEA;;;;;;OAl8G2C,CAw8GvC;AACJ;;;;;;;;;AASA,aAAS/V,SAAT,CAAmBwQ,GAAnB,EAAwBwK,GAAxB,EAA6B;AACzB,YAAIA,IAAI3uB,MAAJ,IAAcmkB,GAAlB,EACI,OAAOwK,GAAP;AACJ,eAAOA,IAAIpR,MAAJ,CAAW,CAAX,EAAc4G,MAAM,CAApB,IAAyB,KAAhC;AACH;AACD;;;;;;;;;AASA,aAASxP,SAAT,CAAmB3U,MAAnB,EAA2B2uB,GAA3B,EAAgC;AAC5B,eAAOA,IAAI3uB,MAAJ,GAAaA,MAApB;AACI2uB,mBAAO,GAAP;AADJ,SAEA,OAAOA,GAAP;AACH;AACD,aAASC,WAAT,CAAqBC,SAArB,EAAgC;AAC5B,eAAOA,UACF9O,OADE,CACM,UADN,EACkB,UAAU+O,EAAV,EAAc;AAAE,mBAAOA,GAAGC,WAAH,EAAP;AAA0B,SAD5D,EAC8D;AAD9D,SAEFhP,OAFE,CAEM,UAFN,EAEkB,UAAU+O,EAAV,EAAc;AAAE,mBAAO,MAAMA,GAAGC,WAAH,EAAb;AAAgC,SAFlE,CAAP,CAD4B,CAGgD;AAC/E;AACD,aAAStb,gBAAT,CAA0B/T,EAA1B,EAA8B;AAC1B,YAAIsvB,QAAQ/W,WAAWvY,EAAX,CAAZ;AACA,YAAIuvB,qBAAqBD,MAAMrO,KAAN,CAAY,4BAAZ,CAAzB;AACA,YAAInb,QAAQypB,qBAAqBA,mBAAmB,CAAnB,CAArB,GAA6CD,KAAzD;AACA,YAAIzsB,SAAS7C,GAAG,MAAH,KAAc,EAA3B;AACA,YAAI6C,UAAUiD,MAAMmb,KAAN,CAAY,aAAZ,CAAd,EAA0C;AACtC,mBAAO,cAAcpe,MAAd,GAAuBiD,MAAM+X,MAAN,CAAa,CAAb,CAA9B;AACH;AACD,eAAO/X,KAAP;AACH;AACD,aAASyS,UAAT,CAAoBvY,EAApB,EAAwB;AACpB,YAAIwvB,MAAM/oB,QAAQzG,EAAR,IAAcA,GAAGE,KAAH,CAAS,CAAC,CAAV,EAAa,CAAb,CAAd,GAAgCF,EAA1C;AACA,eAAOwvB,OAAOA,IAAI9pB,QAAJ,EAAP,IAAyB,WAAhC;AACH;AACD,QAAI+pB,qBAAqB,IAAzB;AACA,QAAIC,mBAAmB,SAAnBA,gBAAmB,CAAUziB,KAAV,EAAiB;AACpC,YAAI0iB,cAAc5f,UAAUU,kBAA5B;AACAgf,6BAAqBA,sBAAsB3sB,QAAQ,CAC/C,CAACnB,IAAIwE,SAAJ,CAAD,EAAiB5E,IAAI,WAAJ,CAAjB,CAD+C,EAE/C,CAAC6E,MAAD,EAAS7E,IAAI,MAAJ,CAAT,CAF+C,EAG/C,CAAC0F,SAAD,EAAY1F,IAAI,WAAJ,CAAZ,CAH+C,EAI/C,CAACouB,WAAD,EAAc,UAAUvtB,CAAV,EAAa;AAAE,mBAAOA,EAAEoO,oBAAF,CAAuB9K,QAAvB,EAAP;AAA2C,SAAxE,CAJ+C,EAK/C,CAACpD,GAAGyN,SAAH,CAAD,EAAgBnN,OAAO,UAAP,CAAhB,CAL+C,EAM/C,CAACN,GAAG0nB,UAAH,CAAD,EAAiBpnB,OAAO,UAAP,CAAjB,CAN+C,EAO/C,CAACN,GAAGyjB,UAAH,CAAD,EAAiBnjB,OAAO,UAAP,CAAjB,CAP+C,EAQ/C,CAACiE,YAAD,EAAekN,gBAAf,CAR+C,EAS/C,CAACxS,IAAI,IAAJ,CAAD,EAAYmH,QAAZ,CAT+C,CAAR,CAA3C;AAWA,eAAO+mB,mBAAmBxiB,KAAnB,CAAP;AACH,KAdD;AAeA,aAASjF,SAAT,CAAmB3B,CAAnB,EAAsB;AAClB,YAAIupB,OAAO,EAAX;AACA,iBAASC,MAAT,CAAgB/oB,MAAhB,EAAwB;AACpB,gBAAIjB,SAASiB,MAAT,CAAJ,EAAsB;AAClB,oBAAI8oB,KAAKlmB,OAAL,CAAa5C,MAAb,MAAyB,CAAC,CAA9B,EACI,OAAO,gBAAP;AACJ8oB,qBAAK3lB,IAAL,CAAUnD,MAAV;AACH;AACD,mBAAO4oB,iBAAiB5oB,MAAjB,CAAP;AACH;AACD,eAAOe,KAAKG,SAAL,CAAe3B,CAAf,EAAkB,UAAU+E,GAAV,EAAetE,MAAf,EAAuB;AAAE,mBAAO+oB,OAAO/oB,MAAP,CAAP;AAAwB,SAAnE,EAAqEuZ,OAArE,CAA6E,MAA7E,EAAqF,GAArF,CAAP;AACH;AACD;AACA,QAAIyP,oBAAoB,SAApBA,iBAAoB,CAAUC,IAAV,EAAgB;AAAE,eAAO,UAAUd,GAAV,EAAe;AAC5D,gBAAI,CAACA,GAAL,EACI,OAAO,CAAC,EAAD,EAAK,EAAL,CAAP;AACJ,gBAAIplB,MAAMolB,IAAIvlB,OAAJ,CAAYqmB,IAAZ,CAAV;AACA,gBAAIlmB,QAAQ,CAAC,CAAb,EACI,OAAO,CAAColB,GAAD,EAAM,EAAN,CAAP;AACJ,mBAAO,CAACA,IAAIpR,MAAJ,CAAW,CAAX,EAAchU,GAAd,CAAD,EAAqBolB,IAAIpR,MAAJ,CAAWhU,MAAM,CAAjB,CAArB,CAAP;AACH,SAPyC;AAOtC,KAPJ;AAQA;;;;;;;;;;AAUA,aAASmmB,YAAT,CAAsBC,KAAtB,EAA6B;AACzB,YAAIC,KAAK,IAAI3sB,MAAJ,CAAW,MAAM0sB,KAAN,GAAc,GAAzB,EAA8B,GAA9B,CAAT;AACA,eAAO,UAAUhB,GAAV,EAAe;AAClB,mBAAOA,IAAIxtB,KAAJ,CAAUyuB,EAAV,EAAc/qB,MAAd,CAAqBuD,QAArB,CAAP;AACH,SAFD;AAGH;;AAED;;;;;;;;;;;;AAYA,aAASynB,cAAT,CAAwB9mB,GAAxB,EAA6BjH,CAA7B,EAAgC;AAC5B,YAAIoE,SAASQ,KAAKqC,GAAL,CAAT,KAAuB7C,SAASpE,CAAT,CAA3B,EACI,OAAOiH,IAAInJ,KAAJ,CAAU,CAAV,EAAa,CAAC,CAAd,EAAiBO,MAAjB,CAAwBuG,KAAKqC,GAAL,IAAYjH,CAApC,CAAP;AACJ,eAAO4J,MAAM3C,GAAN,EAAWjH,CAAX,CAAP;AACH;;AAED,yBAhkH2C,CAgkHrB;;AAEtB;;;;AAIA;AACA;;;;;;;;;;;;;;;;;AAiBA,QAAIguB,aAAc,YAAY;AAC1B;AACA,iBAASA,UAAT,GAAsB;AAClB;AACA,iBAAKhhB,OAAL,GAAe,IAAf;AACA;AACA,iBAAKihB,SAAL,GAAiB,EAAjB;AACA;AACA,iBAAKC,YAAL,GAAoB/lB,KAAK6lB,WAAW5sB,SAAhB,EAA2B,CAAC,MAAD,EAAS,QAAT,EAAmB,OAAnB,EAA4B,MAA5B,EAAoC,KAApC,EAA2C,MAA3C,EAAmD,MAAnD,EAA2D,MAA3D,EAAmE,KAAnE,CAA3B,CAApB;AACA;AACA,gBAAI+sB,WAAW,SAAXA,QAAW,CAAUC,UAAV,EAAsBpvB,IAAtB,EAA4B;AACvC,uBAAO,IAAImc,SAAJ,CAAclV,OAAO,EAAEjH,MAAMA,IAAR,EAAP,EAAuBovB,UAAvB,CAAd,CAAP;AACH,aAFD;AAGA,iBAAKC,KAAL,GAAatsB,QAAQzC,IAAI,KAAK4uB,YAAT,EAAuBC,QAAvB,CAAR,EAA0C,EAA1C,CAAb;AACH;AACD;AACAH,mBAAW5sB,SAAX,CAAqBktB,OAArB,GAA+B,YAAY;AACvC,iBAAKD,KAAL,GAAa,EAAb;AACH,SAFD;AAGA;;;;;AAKAL,mBAAW5sB,SAAX,CAAqBwM,IAArB,GAA4B,UAAU5O,IAAV,EAAgBovB,UAAhB,EAA4BG,YAA5B,EAA0C;AAClE,gBAAI,CAACxqB,UAAUqqB,UAAV,CAAL,EACI,OAAO,KAAKC,KAAL,CAAWrvB,IAAX,CAAP;AACJ,gBAAI,KAAKqvB,KAAL,CAAWprB,cAAX,CAA0BjE,IAA1B,CAAJ,EACI,MAAM,IAAIgG,KAAJ,CAAU,mBAAmBhG,IAAnB,GAA0B,6BAApC,CAAN;AACJ,iBAAKqvB,KAAL,CAAWrvB,IAAX,IAAmB,IAAImc,SAAJ,CAAclV,OAAO,EAAEjH,MAAMA,IAAR,EAAP,EAAuBovB,UAAvB,CAAd,CAAnB;AACA,gBAAIG,YAAJ,EAAkB;AACd,qBAAKN,SAAL,CAAepmB,IAAf,CAAoB,EAAE7I,MAAMA,IAAR,EAAcoc,KAAKmT,YAAnB,EAApB;AACA,oBAAI,CAAC,KAAKvhB,OAAV,EACI,KAAKwhB,eAAL;AACP;AACD,mBAAO,IAAP;AACH,SAZD;AAaA;AACAR,mBAAW5sB,SAAX,CAAqBotB,eAArB,GAAuC,YAAY;AAC/C,mBAAO,KAAKP,SAAL,CAAe/vB,MAAtB,EAA8B;AAC1B,oBAAI0P,OAAO,KAAKqgB,SAAL,CAAe/gB,KAAf,EAAX;AACA,oBAAIU,KAAKlN,OAAT,EACI,MAAM,IAAIsE,KAAJ,CAAU,mDAAV,CAAN;AACJiB,uBAAO,KAAKooB,KAAL,CAAWzgB,KAAK5O,IAAhB,CAAP,EAA8BiG,SAASG,SAAT,CAAmB5E,MAAnB,CAA0BoN,KAAKwN,GAA/B,CAA9B;AACH;AACJ,SAPD;AAQA,eAAO4S,UAAP;AACH,KA/CiB,EAAlB;AAgDA;AACA,aAASS,gBAAT,GAA4B;AACxB,YAAIC,kBAAkB,SAAlBA,eAAkB,CAAUtT,GAAV,EAAe;AACjC,gBAAIuT,cAAc,SAAdA,WAAc,CAAUjqB,MAAV,EAAkB;AAChC,uBAAOA,UAAU,IAAV,GAAiBA,OAAOpB,QAAP,EAAjB,GAAqCoB,MAA5C;AACH,aAFD;AAGA,gBAAIkqB,kBAAkB;AAClBvT,wBAAQsT,WADU;AAElBrT,wBAAQqT,WAFU;AAGlBzuB,oBAAIA,GAAG2uB,MAAH,CAHc;AAIlBnuB,yBAAS,IAJS;AAKlB0F,wBAAQ,gBAAU6F,CAAV,EAAalM,CAAb,EAAgB;AAAE,2BAAOkM,KAAKlM,CAAZ;AAAgB;AALxB,aAAtB;AAOA,mBAAOkG,OAAO,EAAP,EAAW2oB,eAAX,EAA4BxT,GAA5B,CAAP;AACH,SAZD;AAaA;AACAnV,eAAO+nB,WAAW5sB,SAAlB,EAA6B;AACzB0tB,oBAAQJ,gBAAgB,EAAhB,CADiB;AAEzBhmB,kBAAMgmB,gBAAgB;AAClBhuB,yBAAS;AADS,aAAhB,CAFmB;AAKzBquB,mBAAOL,gBAAgB,EAAhB,CALkB;AAMzBM,kBAAMN,gBAAgB;AAClB3sB,yBAAS;AADS,aAAhB,CANmB;AASzBktB,iBAAKP,gBAAgB;AACjBpT,wBAAQ,gBAAU5W,MAAV,EAAkB;AAAE,2BAAOkM,SAASlM,MAAT,EAAiB,EAAjB,CAAP;AAA8B,iBADzC;AAEjBxE,oBAAI,YAAUwE,MAAV,EAAkB;AAClB,2BAAO,CAACR,kBAAkBQ,MAAlB,CAAD,IAA8B,KAAK4W,MAAL,CAAY5W,OAAOpB,QAAP,EAAZ,MAAmCoB,MAAxE;AACH,iBAJgB;AAKjBhE,yBAAS;AALQ,aAAhB,CAToB;AAgBzBwuB,kBAAMR,gBAAgB;AAClBrT,wBAAQ,gBAAU3W,MAAV,EAAkB;AAAE,2BAAOA,UAAU,CAAV,IAAe,CAAtB;AAA0B,iBADpC;AAElB4W,wBAAQ,gBAAU5W,MAAV,EAAkB;AAAE,2BAAOkM,SAASlM,MAAT,EAAiB,EAAjB,MAAyB,CAAhC;AAAoC,iBAF9C;AAGlBxE,oBAAIA,GAAGivB,OAAH,CAHc;AAIlBzuB,yBAAS;AAJS,aAAhB,CAhBmB;AAsBzB0uB,kBAAMV,gBAAgB;AAClBrT,wBAAQ,gBAAU3W,MAAV,EAAkB;AACtB,2BAAO,CAAC,KAAKxE,EAAL,CAAQwE,MAAR,CAAD,GAAmBS,SAAnB,GAA+B,CAClCT,OAAO2qB,WAAP,EADkC,EAElC,CAAC,OAAO3qB,OAAO4qB,QAAP,KAAoB,CAA3B,CAAD,EAAgCxxB,KAAhC,CAAsC,CAAC,CAAvC,CAFkC,EAGlC,CAAC,MAAM4G,OAAO6qB,OAAP,EAAP,EAAyBzxB,KAAzB,CAA+B,CAAC,CAAhC,CAHkC,EAIpCmD,IAJoC,CAI/B,GAJ+B,CAAtC;AAKH,iBAPiB;AAQlBqa,wBAAQ,gBAAU5W,MAAV,EAAkB;AACtB,wBAAI,KAAKxE,EAAL,CAAQwE,MAAR,CAAJ,EACI,OAAOA,MAAP;AACJ,wBAAIma,QAAQ,KAAK2Q,OAAL,CAAajuB,IAAb,CAAkBmD,MAAlB,CAAZ;AACA,2BAAOma,QAAQ,IAAI4Q,IAAJ,CAAS5Q,MAAM,CAAN,CAAT,EAAmBA,MAAM,CAAN,IAAW,CAA9B,EAAiCA,MAAM,CAAN,CAAjC,CAAR,GAAqD1Z,SAA5D;AACH,iBAbiB;AAclBjF,oBAAI,YAAUwE,MAAV,EAAkB;AAAE,2BAAOA,kBAAkB+qB,IAAlB,IAA0B,CAAC5e,MAAMnM,OAAOgrB,OAAP,EAAN,CAAlC;AAA4D,iBAdlE;AAelBtpB,wBAAQ,gBAAU2U,CAAV,EAAaC,CAAb,EAAgB;AACpB,2BAAO,CAAC,aAAD,EAAgB,UAAhB,EAA4B,SAA5B,EACFlb,MADE,CACK,UAAUmH,GAAV,EAAerJ,EAAf,EAAmB;AAAE,+BAAOqJ,OAAO8T,EAAEnd,EAAF,QAAYod,EAAEpd,EAAF,GAA1B;AAAoC,qBAD9D,EACgE,IADhE,CAAP;AAEH,iBAlBiB;AAmBlB8C,yBAAS,yDAnBS;AAoBlB8uB,yBAAS;AApBS,aAAhB,CAtBmB;AA4CzBG,kBAAMjB,gBAAgB;AAClBrT,wBAAQ1V,MADU;AAElB2V,wBAAQ9V,QAFU;AAGlBtF,oBAAIA,GAAGyD,MAAH,CAHc;AAIlByC,wBAAQA,MAJU;AAKlB1F,yBAAS;AALS,aAAhB,CA5CmB;AAmDzB;AACAT,iBAAKyuB,gBAAgB;AACjBrT,wBAAQ/U,QADS;AAEjBgV,wBAAQhV,QAFS;AAGjBpG,oBAAI,cAAY;AAAE,2BAAO,IAAP;AAAc,iBAHf;AAIjBkG,wBAAQA;AAJS,aAAhB;AApDoB,SAA7B;AA2DH;AACDqoB;;AAEA;;;;AAIA;AACA;AACA,QAAImB,cAAe,YAAY;AAC3B,iBAASA,WAAT,CAAqB9sB,MAArB,EAA6B;AACzB,gBAAIA,WAAW,KAAK,CAApB,EAAuB;AAAEA,yBAAS,EAAT;AAAc;AACvCmD,mBAAO,IAAP,EAAanD,MAAb;AACH;AACD;;;;;;;;AAQA8sB,oBAAYxuB,SAAZ,CAAsByuB,QAAtB,GAAiC,UAAUC,SAAV,EAAqBC,QAArB,EAA+B9G,GAA/B,EAAoC;AACjE,gBAAI+G,UAAUznB,UAAUwnB,QAAV,EAAoB9G,GAApB,CAAd;AAAA,gBAAwCgH,YAAxC;AAAA,gBAAsDrtB,YAAY,EAAlE;AAAA,gBAAsEstB,cAAc,EAApF;AACA,iBAAK,IAAI1xB,CAAT,IAAcwxB,OAAd,EAAuB;AACnB,oBAAI,CAACA,QAAQxxB,CAAR,CAAD,IAAe,CAACwxB,QAAQxxB,CAAR,EAAWsE,MAA/B,EACI;AACJmtB,+BAAetsB,OAAOqD,IAAP,CAAYgpB,QAAQxxB,CAAR,EAAWsE,MAAvB,CAAf;AACA,oBAAI,CAACmtB,aAAa/xB,MAAlB,EACI;AACJ,qBAAK,IAAIiN,CAAT,IAAc8kB,YAAd,EAA4B;AACxB,wBAAIC,YAAY5oB,OAAZ,CAAoB2oB,aAAa9kB,CAAb,CAApB,KAAwC,CAA5C,EACI;AACJ+kB,gCAAYroB,IAAZ,CAAiBooB,aAAa9kB,CAAb,CAAjB;AACAvI,8BAAUqtB,aAAa9kB,CAAb,CAAV,IAA6B,KAAK8kB,aAAa9kB,CAAb,CAAL,CAA7B;AACH;AACJ;AACD,mBAAOlF,OAAO,EAAP,EAAWrD,SAAX,EAAsBktB,SAAtB,CAAP;AACH,SAhBD;;AAkBA,eAAOF,WAAP;AACH,KAhCkB,EAAnB;;AAkCA,uBA9vH2C,CA8vHvB;;AAEpB,0BAhwH2C,CAgwHpB;;AAEvB,wBAlwH2C,CAkwHtB;AACrB,QAAIO,WAAW,SAAXA,QAAW,CAAU/sB,GAAV,EAAe;AAC1B,YAAI,CAACgB,SAAShB,GAAT,CAAL,EACI,OAAO,KAAP;AACJ,YAAIb,OAAOa,IAAIgtB,MAAJ,CAAW,CAAX,MAAkB,GAA7B;AACA,eAAO,EAAEjxB,KAAKoD,OAAOa,IAAIitB,SAAJ,CAAc,CAAd,CAAP,GAA0BjtB,GAAjC,EAAsCb,MAAMA,IAA5C,EAAP;AACH,KALD;AAMA,aAAS+tB,WAAT,CAAqBxuB,KAArB,EAA4B;AACxB,eAAOA,MAAM9C,IAAb;AACH;AACD,aAASuxB,WAAT,CAAqBzuB,KAArB,EAA4B;AACxBA,cAAMG,IAAN,CAAWD,OAAX,GAAqB,YAAY;AAAE,mBAAOF,KAAP;AAAe,SAAlD;AACA,eAAOA,MAAMG,IAAb;AACH;AACD,aAASuuB,WAAT,CAAqB1uB,KAArB,EAA4B;AACxB,YAAIA,MAAMQ,MAAN,IAAgBR,MAAMQ,MAAN,CAAagQ,IAAjC,EAAuC;AACnCxQ,kBAAMwQ,IAAN,GAAaxQ,MAAMG,IAAN,CAAWqQ,IAAX,GAAkBvQ,QAAQD,MAAMQ,MAAN,CAAagQ,IAArB,EAA2BxQ,MAAMwQ,IAAjC,CAA/B;AACH;AACD,eAAOxQ,MAAMwQ,IAAb;AACH;AACD,QAAIme,gBAAgB,SAAhBA,aAAgB,CAAUC,0BAAV,EAAsCnuB,IAAtC,EAA4C;AAC5D,eAAO,SAASouB,UAAT,CAAoB7uB,KAApB,EAA2B;AAC9B,gBAAI8uB,WAAW9uB,KAAf;AACA;AACA;AACA,gBAAI8uB,YAAYA,SAASxtB,GAArB,IAA4BwtB,SAAS5xB,IAArC,IAA6C4xB,SAAS5xB,IAAT,CAAc6f,KAAd,CAAoB,SAApB,CAAjD,EAAiF;AAC7E+R,yBAASxtB,GAAT,IAAgB,iBAAhB,CAD6E,CAC1C;AACtC;AACD,gBAAIytB,SAASV,SAASS,SAASxtB,GAAlB,CAAb;AAAA,gBAAqCd,SAASR,MAAMQ,MAApD;AACA,gBAAIc,MAAM,CAACytB,MAAD,GAAUD,SAASxtB,GAAnB,GAAyBstB,2BAA2BI,OAA3B,CAAmCD,OAAO1xB,GAA1C,EAA+C;AAC9E2D,wBAAQhB,MAAMgB,MAAN,IAAgB,EADsD;AAE9EiuB,0BAAU,kBAAUC,WAAV,EAAuBnV,QAAvB,EAAiC;AACvC,wBAAI+U,SAASK,cAAT,KAA4B,KAA5B,IAAqCpV,QAAzC,EACImV,cAAc/qB,OAAO+qB,eAAe,EAAtB,EAA0B,EAAErU,SAAS,IAAX,EAA1B,CAAd;AACJ,2BAAOqU,WAAP;AACH;AAN6E,aAA/C,CAAnC;AAQA,gBAAI,CAAC5tB,GAAL,EACI,OAAO,IAAP;AACJ,gBAAI,CAACstB,2BAA2BQ,SAA3B,CAAqC9tB,GAArC,CAAL,EACI,MAAM,IAAI4B,KAAJ,CAAU,kBAAkB5B,GAAlB,GAAwB,cAAxB,GAAyCtB,KAAzC,GAAiD,GAA3D,CAAN;AACJ,mBAAQ+uB,UAAUA,OAAOtuB,IAAlB,GAA0Ba,GAA1B,GAAgC,CAAEd,UAAUA,OAAO6uB,SAAlB,IAAgC5uB,MAAjC,EAAyCa,GAAzC,CAA6CguB,MAA7C,CAAoDhuB,GAApD,CAAvC;AACH,SArBD;AAsBH,KAvBD;AAwBA,QAAIiuB,sBAAsB,SAAtBA,mBAAsB,CAAUC,MAAV,EAAkB;AACxC,eAAO,SAASC,gBAAT,CAA0BzvB,KAA1B,EAAiC;AACpC,mBAAO,CAACwvB,OAAOxvB,KAAP,CAAD,IAAkBA,MAAMsB,GAAxB,GAA8BtB,KAA9B,GAAuCA,MAAMQ,MAAN,GAAeR,MAAMQ,MAAN,CAAa6uB,SAA5B,GAAwC,IAAtF;AACH,SAFD;AAGH,KAJD;AAKA,QAAIK,mBAAmB,SAAnBA,gBAAmB,CAAUC,YAAV,EAAwB;AAC3C,eAAO,SAASC,aAAT,CAAuB5vB,KAAvB,EAA8B;AACjC,gBAAI6vB,kBAAkB,SAAlBA,eAAkB,CAAUjwB,MAAV,EAAkBwB,EAAlB,EAAsB;AAAE,uBAAOuuB,aAAaG,UAAb,CAAwB1uB,EAAxB,EAA4B,IAA5B,EAAkCxB,MAAlC,CAAP;AAAmD,aAAjG;AACA,gBAAImwB,YAAa/vB,MAAMsB,GAAN,IAAatB,MAAMsB,GAAN,CAAUZ,UAAV,CAAqB,EAAET,SAAS,KAAX,EAArB,CAAd,IAA2D,EAA3E;AACA,gBAAI+vB,eAAejvB,OAAOyG,OAAOP,KAAKjH,MAAMgB,MAAN,IAAgB,EAArB,EAAyB+uB,UAAUvyB,GAAV,CAAcP,KAAK,IAAL,CAAd,CAAzB,CAAP,EAA4D4yB,eAA5D,CAAP,CAAnB;AACA,mBAAOE,UAAUxzB,MAAV,CAAiByzB,YAAjB,EAA+BxyB,GAA/B,CAAmC,UAAUyyB,CAAV,EAAa;AAAE,uBAAO,CAACA,EAAE7uB,EAAH,EAAO6uB,CAAP,CAAP;AAAmB,aAArE,EAAuEjyB,MAAvE,CAA8E6K,UAA9E,EAA0F,EAA1F,CAAP;AACH,SALD;AAMH,KAPD;AAQA,aAASqnB,WAAT,CAAqBlwB,KAArB,EAA4B;AACxB,eAAOA,MAAMQ,MAAN,GAAeR,MAAMQ,MAAN,CAAaoG,IAAb,CAAkBrK,MAAlB,CAAyByD,KAAzB,CAAf,GAAiD,CAACA,KAAD,CAAxD;AACH;AACD,aAASmwB,eAAT,CAAyBnwB,KAAzB,EAAgC;AAC5B,YAAIuoB,WAAWvoB,MAAMQ,MAAN,GAAe2D,OAAO,EAAP,EAAWnE,MAAMQ,MAAN,CAAa+nB,QAAxB,CAAf,GAAmD,EAAlE;AACAA,iBAASvoB,MAAM9C,IAAf,IAAuB,IAAvB;AACA,eAAOqrB,QAAP;AACH;AACD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyCA,aAAS6H,kBAAT,CAA4BpwB,KAA5B,EAAmC;AAC/B;AACA,YAAIqwB,iBAAiB,SAAjBA,cAAiB,CAAUC,UAAV,EAAsB7M,eAAtB,EAAuC;AACxD,mBAAO5hB,OAAOqD,IAAP,CAAYorB,cAAc,EAA1B,EAA8B9yB,GAA9B,CAAkC,UAAUwK,KAAV,EAAiB;AAAE,uBAAQ,EAAEA,OAAOA,KAAT,EAAgB3K,KAAKizB,WAAWtoB,KAAX,CAArB,EAAwCga,MAAM3e,SAA9C,EAAyD4e,QAAQwB,gBAAgBzb,KAAhB,CAAjE,EAAR;AAAqG,aAA1J,CAAP;AACH,SAFD;AAGA;AACA,YAAIuoB,WAAW,SAAXA,QAAW,CAAUz0B,EAAV,EAAc;AACzB,gBAAIwH,YAAYH,SAASG,SAAzB;AACA;AACA;AACA;AACA,mBAAOxH,GAAG,SAAH,KAAkBwH,aAAaA,UAAUitB,QAAV,CAAmBz0B,EAAnB,EAAuBwH,UAAUktB,QAAjC,CAA/B,IAA8E,UAArF;AACH,SAND;AAOA;AACA,YAAIC,mBAAmB,SAAnBA,gBAAmB,CAAUtzB,GAAV,EAAe;AAAE,mBAAO,CAAC,EAAEA,IAAI6K,KAAJ,IAAa7K,IAAI4kB,SAAnB,CAAR;AAAwC,SAAhF;AACA;AACA,YAAI2O,oBAAoB,SAApBA,iBAAoB,CAAUvzB,GAAV,EAAe;AAAE,mBAAO,CAAC,EAAE,CAACA,IAAIwzB,OAAJ,IAAexzB,IAAI6K,KAApB,MAA+B7K,IAAIyzB,QAAJ,IAAgBzzB,IAAI0zB,UAApB,IAAkC1zB,IAAI2zB,WAAtC,IAAqD3zB,IAAI4zB,QAAxF,CAAF,CAAR;AAA+G,SAAxJ;AACA;AACA,YAAIC,iBAAiB,SAAjBA,cAAiB,CAAU7zB,GAAV,EAAe;AAAE,mBAAO,CAAC,EAAEA,OAAOA,IAAIE,GAAX,KAAmBiF,SAASnF,IAAIE,GAAb,KAAqBkF,QAAQpF,IAAIE,GAAZ,CAArB,IAAyCoE,WAAWtE,IAAIE,GAAf,CAA5D,CAAF,CAAR;AAA8F,SAApI;AACA;AACA,YAAI2K,QAAQ,SAARA,KAAQ,CAAUioB,CAAV,EAAa;AAAE,mBAAOA,EAAEU,OAAF,IAAaV,EAAEjoB,KAAtB;AAA8B,SAAzD;AACA;AACA,YAAIipB,qBAAqBryB,QAAQ,CAC7B,CAAC3B,KAAK,WAAL,CAAD,EAAoB,UAAUgzB,CAAV,EAAa;AAAE,mBAAO,IAAIpO,UAAJ,CAAe7Z,MAAMioB,CAAN,CAAf,EAAyBA,EAAElO,SAA3B,EAAsCkO,EAAEjO,IAAxC,EAA8CiO,EAAEhO,MAAhD,CAAP;AAAiE,SAApG,CAD6B,EAE7B,CAAChlB,KAAK,YAAL,CAAD,EAAqB,UAAUgzB,CAAV,EAAa;AAAE,mBAAO,IAAIpO,UAAJ,CAAe7Z,MAAMioB,CAAN,CAAf,EAAyBA,EAAEY,UAA3B,EAAwCZ,EAAEjO,IAAF,IAAUiO,EAAEiB,YAApD,EAAmEjB,EAAEhO,MAArE,CAAP;AAAsF,SAA1H,CAF6B,EAG7B,CAAChlB,KAAK,UAAL,CAAD,EAAmB,UAAUgzB,CAAV,EAAa;AAAE,mBAAO,IAAIpO,UAAJ,CAAe7Z,MAAMioB,CAAN,CAAf,EAAyB,YAAY;AAAE,uBAAO,IAAIA,EAAEc,QAAN,EAAP;AAA0B,aAAjE,EAAmE,EAAnE,EAAuEd,EAAEhO,MAAzE,CAAP;AAA0F,SAA5H,CAH6B,EAI7B,CAAChlB,KAAK,UAAL,CAAD,EAAmB,UAAUgzB,CAAV,EAAa;AAAE,mBAAO,IAAIpO,UAAJ,CAAe7Z,MAAMioB,CAAN,CAAf,EAAyB,YAAY;AAAE,uBAAOA,EAAEW,QAAT;AAAoB,aAA3D,EAA6D,EAA7D,EAAiEX,EAAEhO,MAAnE,EAA2EgO,EAAEW,QAA7E,CAAP;AAAgG,SAAlI,CAJ6B,EAK7B,CAAC3zB,KAAK,aAAL,CAAD,EAAsB,UAAUgzB,CAAV,EAAa;AAAE,mBAAO,IAAIpO,UAAJ,CAAe7Z,MAAMioB,CAAN,CAAf,EAAyBzrB,QAAzB,EAAmC,CAACyrB,EAAEa,WAAH,CAAnC,EAAoDb,EAAEhO,MAAtD,CAAP;AAAuE,SAA5G,CAL6B,CAAR,CAAzB;AAOA,YAAIkP,mBAAmBvyB,QAAQ,CAC3B,CAAC/B,KAAKI,KAAK,KAAL,CAAL,EAAkBqF,QAAlB,CAAD,EAA8B,UAAUmW,KAAV,EAAiB;AAAE,mBAAO,IAAIoJ,UAAJ,CAAepJ,MAAMzQ,KAArB,EAA4BxD,QAA5B,EAAsC,CAACiU,MAAMpb,GAAP,CAAtC,EAAmDob,MAAMwJ,MAAzD,CAAP;AAA0E,SAA3H,CAD2B,EAE3B,CAACplB,KAAKI,KAAK,KAAL,CAAL,EAAkBsF,OAAlB,CAAD,EAA6B,UAAUkW,KAAV,EAAiB;AAAE,mBAAO,IAAIoJ,UAAJ,CAAepJ,MAAMzQ,KAArB,EAA4BlF,KAAK2V,MAAMpb,GAAX,CAA5B,EAA6Cob,MAAMpb,GAAN,CAAUrB,KAAV,CAAgB,CAAhB,EAAmB,CAAC,CAApB,CAA7C,EAAqEyc,MAAMwJ,MAA3E,CAAP;AAA4F,SAA5I,CAF2B,EAG3B,CAACplB,KAAKI,KAAK,KAAL,CAAL,EAAkBwE,UAAlB,CAAD,EAAgC,UAAUgX,KAAV,EAAiB;AAAE,mBAAO,IAAIoJ,UAAJ,CAAepJ,MAAMzQ,KAArB,EAA4ByQ,MAAMpb,GAAlC,EAAuCkzB,SAAS9X,MAAMpb,GAAf,CAAvC,EAA4Dob,MAAMwJ,MAAlE,CAAP;AAAmF,SAAtI,CAH2B,CAAR,CAAvB;AAKA,YAAImP,kBAAkBxyB,QAAQ,CAC1B,CAACR,GAAGyjB,UAAH,CAAD,EAAiB,UAAU3I,CAAV,EAAa;AAAE,mBAAOA,CAAP;AAAW,SAA3C,CAD0B,EAE1B,CAACuX,gBAAD,EAAmBQ,kBAAnB,CAF0B,EAG1B,CAACP,iBAAD,EAAoBO,kBAApB,CAH0B,EAI1B,CAACD,cAAD,EAAiBG,gBAAjB,CAJ0B,EAK1B,CAAC9zB,IAAI,IAAJ,CAAD,EAAY,UAAUF,GAAV,EAAe;AAAE,kBAAM,IAAI+F,KAAJ,CAAU,4BAA4BY,UAAU3G,GAAV,CAAtC,CAAN;AAA8D,SAA3F,CAL0B,CAAR,CAAtB;AAOA;AACA;AACA,YAAIk0B,OAAOrxB,MAAMwiB,OAAjB;AACA,YAAIrX,QAAQ5I,QAAQ8uB,IAAR,IAAgBA,IAAhB,GAAuBhB,eAAegB,IAAf,EAAqBrxB,MAAMuiB,aAAN,IAAuB,EAA5C,CAAnC;AACA,eAAOpX,MAAM3N,GAAN,CAAU4zB,eAAV,CAAP;AACH;AACD;;;;;;;;;;;;AAYA,QAAIE,eAAgB,YAAY;AAC5B,iBAASA,YAAT,CAAsBC,OAAtB,EAA+B/U,iBAA/B,EAAkD;AAC9C,iBAAK+U,OAAL,GAAeA,OAAf;AACA,gBAAIpxB,OAAO,IAAX;AACA,gBAAIM,OAAO,SAAPA,IAAO,GAAY;AAAE,uBAAO8wB,QAAQhwB,IAAR,CAAa,EAAb,CAAP;AAA0B,aAAnD;AACA,gBAAIiuB,SAAS,SAATA,MAAS,CAAUxvB,KAAV,EAAiB;AAAE,uBAAOA,MAAM9C,IAAN,KAAe,EAAtB;AAA2B,aAA3D;AACA,qBAASs0B,aAAT,CAAuBxxB,KAAvB,EAA8B;AAC1B,oBAAIwvB,OAAOxvB,KAAP,CAAJ,EACI,OAAO,IAAP;AACJ,uBAAOuxB,QAAQhwB,IAAR,CAAapB,KAAKsxB,UAAL,CAAgBzxB,KAAhB,CAAb,KAAwCS,MAA/C;AACH;AACD,iBAAKixB,QAAL,GAAgB;AACZx0B,sBAAM,CAACsxB,WAAD,CADM;AAEZruB,sBAAM,CAACsuB,WAAD,CAFM;AAGZjuB,wBAAQ,CAACgxB,aAAD,CAHI;AAIZhhB,sBAAM,CAACke,WAAD,CAJM;AAKZ;AACAptB,qBAAK,CAACqtB,cAAcnS,iBAAd,EAAiC/b,IAAjC,CAAD,CANO;AAOZ;AACA4uB,2BAAW,CAACE,oBAAoBC,MAApB,CAAD,CARC;AASZxuB,wBAAQ,CAAC0uB,iBAAiBlT,kBAAkBmT,YAAnC,CAAD,CATI;AAUZ;AACA;AACAzR,uBAAO,EAZK;AAaZ;AACAtX,sBAAM,CAACspB,WAAD,CAdM;AAeZ;AACA3H,0BAAU,CAAC4H,eAAD,CAhBE;AAiBZlS,6BAAa,CAACmS,kBAAD;AAjBD,aAAhB;AAmBH;AACD;;;;;;;;;;AAUAkB,qBAAahyB,SAAb,CAAuBqyB,OAAvB,GAAiC,UAAUz0B,IAAV,EAAgBpB,EAAhB,EAAoB;AACjD,gBAAI41B,WAAW,KAAKA,QAApB;AACA,gBAAInsB,QAAQmsB,SAASx0B,IAAT,KAAkB,EAA9B;AACA;AACA,gBAAIoF,SAASpF,IAAT,KAAkB,CAAC+E,UAAUnG,EAAV,CAAvB,EACI,OAAOyJ,MAAMnJ,MAAN,GAAe,CAAf,GAAmBmJ,KAAnB,GAA2BA,MAAM,CAAN,CAAlC;AACJ,gBAAI,CAACjD,SAASpF,IAAT,CAAD,IAAmB,CAACuE,WAAW3F,EAAX,CAAxB,EACI;AACJ41B,qBAASx0B,IAAT,IAAiBqI,KAAjB;AACAmsB,qBAASx0B,IAAT,EAAe6I,IAAf,CAAoBjK,EAApB;AACA,mBAAO,YAAY;AAAE,uBAAO41B,SAASx0B,IAAT,EAAe0I,MAAf,CAAsB8rB,SAASx0B,IAAT,EAAesI,OAAf,CAAuB1J,EAAvB,EAA2B,CAA3B,CAAtB,KAAwD,IAA/D;AAAsE,aAA3F;AACH,SAXD;AAYA;;;;;;;AAOAw1B,qBAAahyB,SAAb,CAAuBsyB,KAAvB,GAA+B,UAAU5xB,KAAV,EAAiB;AAC5C,gBAAIoM,KAAK,IAAT;AAAA,gBAAemlB,UAAUnlB,GAAGmlB,OAA5B;AAAA,gBAAqCG,WAAWtlB,GAAGslB,QAAnD;AACA,gBAAIlxB,SAAS,KAAKixB,UAAL,CAAgBzxB,KAAhB,CAAb;AACA,gBAAIQ,UAAU,CAAC+wB,QAAQhwB,IAAR,CAAaf,MAAb,EAAqB6C,SAArB,EAAgC,KAAhC,CAAf,EAAuD;AACnD,uBAAO,IAAP;AACH;AACD,iBAAK,IAAI6D,GAAT,IAAgBwqB,QAAhB,EAA0B;AACtB,oBAAI,CAACA,SAASvwB,cAAT,CAAwB+F,GAAxB,CAAL,EACI;AACJ,oBAAIoN,QAAQod,SAASxqB,GAAT,EAAclJ,MAAd,CAAqB,UAAU6zB,QAAV,EAAoBpiB,IAApB,EAA0B;AAAE,2BAAO,UAAU+F,MAAV,EAAkB;AAAE,+BAAO/F,KAAK+F,MAAL,EAAaqc,QAAb,CAAP;AAAgC,qBAA3D;AAA8D,iBAA/G,EAAiHptB,MAAjH,CAAZ;AACAzE,sBAAMkH,GAAN,IAAaoN,MAAMtU,KAAN,CAAb;AACH;AACD,mBAAOA,KAAP;AACH,SAbD;AAcAsxB,qBAAahyB,SAAb,CAAuBmyB,UAAvB,GAAoC,UAAUzxB,KAAV,EAAiB;AACjD,gBAAI9C,OAAO8C,MAAM9C,IAAN,IAAc,EAAzB;AACA,gBAAI40B,WAAW50B,KAAKK,KAAL,CAAW,GAAX,CAAf;AACA,gBAAIu0B,SAAS11B,MAAT,GAAkB,CAAtB,EAAyB;AACrB,oBAAI4D,MAAMQ,MAAV,EAAkB;AACd,0BAAM,IAAI0C,KAAJ,CAAU,qFAAqFhG,IAArF,GAA4F,GAAtG,CAAN;AACH;AACD,oBAAI60B,cAAcD,SAASE,GAAT,EAAlB;AACA,oBAAID,gBAAgB,IAApB,EACID,SAASE,GAAT;AACJ,uBAAOF,SAAS3yB,IAAT,CAAc,GAAd,CAAP;AACH;AACD,gBAAI,CAACa,MAAMQ,MAAX,EACI,OAAO,EAAP;AACJ,mBAAO8B,SAAStC,MAAMQ,MAAf,IAAyBR,MAAMQ,MAA/B,GAAwCR,MAAMQ,MAAN,CAAatD,IAA5D;AACH,SAfD;AAgBAo0B,qBAAahyB,SAAb,CAAuBpC,IAAvB,GAA8B,UAAU8C,KAAV,EAAiB;AAC3C,gBAAI9C,OAAO8C,MAAM9C,IAAjB;AACA,gBAAIA,KAAKsI,OAAL,CAAa,GAAb,MAAsB,CAAC,CAAvB,IAA4B,CAACxF,MAAMQ,MAAvC,EACI,OAAOtD,IAAP;AACJ,gBAAIu0B,aAAanvB,SAAStC,MAAMQ,MAAf,IAAyBR,MAAMQ,MAA/B,GAAwCR,MAAMQ,MAAN,CAAatD,IAAtE;AACA,mBAAOu0B,aAAaA,aAAa,GAAb,GAAmBv0B,IAAhC,GAAuCA,IAA9C;AACH,SAND;AAOA,eAAOo0B,YAAP;AACH,KAlGmB,EAApB;;AAoGA,wBA3gI2C,CA2gItB;AACrB,QAAIW,eAAgB,YAAY;AAC5B,iBAASA,YAAT,CAAsBC,OAAtB,EAA+B;AAC3B,iBAAKA,OAAL,GAAeA,OAAf;AACH;AACDD,qBAAa3yB,SAAb,CAAuB6yB,UAAvB,GAAoC,UAAU/f,SAAV,EAAqB;AACrDA,wBAAYA,aAAa,EAAzB;AACA,mBAAOA,UAAU5M,OAAV,CAAkB,GAAlB,MAA2B,CAA3B,IAAgC4M,UAAU5M,OAAV,CAAkB,GAAlB,MAA2B,CAAlE;AACH,SAHD;AAIAysB,qBAAa3yB,SAAb,CAAuBiC,IAAvB,GAA8B,UAAU6wB,WAAV,EAAuBlgB,IAAvB,EAA6BmgB,SAA7B,EAAwC;AAClE,gBAAIA,cAAc,KAAK,CAAvB,EAA0B;AAAEA,4BAAY,IAAZ;AAAmB;AAC/C,gBAAI,CAACD,WAAD,IAAgBA,gBAAgB,EAApC,EACI,OAAO/uB,SAAP;AACJ,gBAAIivB,QAAQhwB,SAAS8vB,WAAT,CAAZ;AACA,gBAAIl1B,OAAOo1B,QAAQF,WAAR,GAAsBA,YAAYl1B,IAA7C;AACA,gBAAI,KAAKi1B,UAAL,CAAgBj1B,IAAhB,CAAJ,EACIA,OAAO,KAAKunB,WAAL,CAAiBvnB,IAAjB,EAAuBgV,IAAvB,CAAP;AACJ,gBAAIlS,QAAQ,KAAKkyB,OAAL,CAAah1B,IAAb,CAAZ;AACA,gBAAI8C,UAAUsyB,SAAU,CAACA,KAAD,KAAWtyB,UAAUoyB,WAAV,IAAyBpyB,MAAMG,IAAN,KAAeiyB,WAAnD,CAApB,CAAJ,EAA2F;AACvF,uBAAOpyB,KAAP;AACH,aAFD,MAGK,IAAIsyB,SAASD,SAAb,EAAwB;AACzB,oBAAIH,UAAUnxB,OAAO,KAAKmxB,OAAZ,CAAd;AACA,oBAAI3yB,UAAU2yB,QAAQjxB,MAAR,CAAe,UAAUjB,KAAV,EAAiB;AAC1C,2BAAOA,MAAMI,kBAAN,CAAyBC,QAAzB,IACHL,MAAMI,kBAAN,CAAyBC,QAAzB,CAAkCd,OAAlC,CAA0CrC,IAA1C,CADJ;AAEH,iBAHa,CAAd;AAIA,oBAAIqC,QAAQnD,MAAR,GAAiB,CAArB,EAAwB;AACpBiT,4BAAQC,GAAR,CAAY,mDAAmDpS,IAAnD,GAA0D,eAAtE,EAAuFqC,QAAQ/B,GAAR,CAAY,UAAUuf,KAAV,EAAiB;AAAE,+BAAOA,MAAM7f,IAAb;AAAoB,qBAAnD,CAAvF;AACH;AACD,uBAAOqC,QAAQ,CAAR,CAAP;AACH;AACD,mBAAO8D,SAAP;AACH,SAxBD;AAyBA4uB,qBAAa3yB,SAAb,CAAuBmlB,WAAvB,GAAqC,UAAUvnB,IAAV,EAAgBgV,IAAhB,EAAsB;AACvD,gBAAI,CAACA,IAAL,EACI,MAAM,IAAIhP,KAAJ,CAAU,wCAAwChG,IAAxC,GAA+C,GAAzD,CAAN;AACJ,gBAAIq1B,YAAY,KAAKhxB,IAAL,CAAU2Q,IAAV,CAAhB;AACA,gBAAIsgB,YAAYt1B,KAAKK,KAAL,CAAW,GAAX,CAAhB;AAAA,gBAAiCb,IAAI,CAArC;AAAA,gBAAwC+1B,aAAaD,UAAUp2B,MAA/D;AAAA,gBAAuEoP,UAAU+mB,SAAjF;AACA,mBAAO71B,IAAI+1B,UAAX,EAAuB/1B,GAAvB,EAA4B;AACxB,oBAAI81B,UAAU91B,CAAV,MAAiB,EAAjB,IAAuBA,MAAM,CAAjC,EAAoC;AAChC8O,8BAAU+mB,SAAV;AACA;AACH;AACD,oBAAIC,UAAU91B,CAAV,MAAiB,GAArB,EAA0B;AACtB,wBAAI,CAAC8O,QAAQhL,MAAb,EACI,MAAM,IAAI0C,KAAJ,CAAU,WAAWhG,IAAX,GAAkB,yBAAlB,GAA8Cq1B,UAAUr1B,IAAxD,GAA+D,GAAzE,CAAN;AACJsO,8BAAUA,QAAQhL,MAAlB;AACA;AACH;AACD;AACH;AACD,gBAAIkyB,UAAUF,UAAUx2B,KAAV,CAAgBU,CAAhB,EAAmByC,IAAnB,CAAwB,GAAxB,CAAd;AACA,mBAAOqM,QAAQtO,IAAR,IAAgBsO,QAAQtO,IAAR,IAAgBw1B,OAAhB,GAA0B,GAA1B,GAAgC,EAAhD,IAAsDA,OAA7D;AACH,SApBD;AAqBA,eAAOT,YAAP;AACH,KAvDmB,EAApB;;AAyDA,wBArkI2C,CAqkItB;AACrB;AACA,QAAIU,oBAAqB,YAAY;AACjC,iBAASA,iBAAT,CAA2BC,SAA3B,EAAsCC,UAAtC,EAAkDvT,MAAlD,EAA0DqS,OAA1D,EAAmEmB,SAAnE,EAA8E;AAC1E,iBAAKF,SAAL,GAAiBA,SAAjB;AACA,iBAAKC,UAAL,GAAkBA,UAAlB;AACA,iBAAKvT,MAAL,GAAcA,MAAd;AACA,iBAAKqS,OAAL,GAAeA,OAAf;AACA,iBAAKmB,SAAL,GAAiBA,SAAjB;AACA,iBAAKC,KAAL,GAAa,EAAb;AACA,iBAAKxB,OAAL,GAAeqB,UAAUrB,OAAzB;AACH;AACD;AACAoB,0BAAkBrzB,SAAlB,CAA4BktB,OAA5B,GAAsC,YAAY;AAC9C,iBAAKuG,KAAL,GAAa,EAAb;AACH,SAFD;AAGAJ,0BAAkBrzB,SAAlB,CAA4B0zB,QAA5B,GAAuC,UAAUlzB,SAAV,EAAqB;AACxD,gBAAIizB,QAAQ,KAAKA,KAAjB;AACA,gBAAI/yB,QAAQL,YAAYE,MAAZ,CAAmBC,SAAnB,CAAZ;AACA,gBAAI5C,OAAO8C,MAAM9C,IAAjB;AACA,gBAAI,CAACoF,SAASpF,IAAT,CAAL,EACI,MAAM,IAAIgG,KAAJ,CAAU,8BAAV,CAAN;AACJ,gBAAI,KAAKoc,MAAL,CAAYne,cAAZ,CAA2BjE,IAA3B,KAAoCmI,QAAQ0tB,MAAMv1B,GAAN,CAAUP,KAAK,MAAL,CAAV,CAAR,EAAiCC,IAAjC,CAAxC,EACI,MAAM,IAAIgG,KAAJ,CAAU,YAAYhG,IAAZ,GAAmB,sBAA7B,CAAN;AACJ61B,kBAAMhtB,IAAN,CAAW/F,KAAX;AACA,iBAAKizB,KAAL;AACA,mBAAOjzB,KAAP;AACH,SAXD;AAYA2yB,0BAAkBrzB,SAAlB,CAA4B2zB,KAA5B,GAAoC,YAAY;AAC5C,gBAAI9pB,QAAQ,IAAZ;AACA,gBAAIiD,KAAK,IAAT;AAAA,gBAAe2mB,QAAQ3mB,GAAG2mB,KAA1B;AAAA,gBAAiCzT,SAASlT,GAAGkT,MAA7C;AAAA,gBAAqDqS,UAAUvlB,GAAGulB,OAAlE;AACA,gBAAIuB,aAAa,EAAjB;AAAA,gBAAqB;AACrBC,sBAAU,EADV;AAAA,gBACc;AACdC,kCAAsB,EAFtB,CAH4C,CAKlB;AAC1B,gBAAIC,WAAW,SAAXA,QAAW,CAAUn2B,IAAV,EAAgB;AAC3B,uBAAOiM,MAAMmW,MAAN,CAAane,cAAb,CAA4BjE,IAA5B,KAAqCiM,MAAMmW,MAAN,CAAapiB,IAAb,CAA5C;AACH,aAFD;AAGA,mBAAO61B,MAAM32B,MAAN,GAAe,CAAtB,EAAyB;AACrB,oBAAI4D,QAAQ+yB,MAAM3nB,KAAN,EAAZ;AACA,oBAAIkoB,SAAStzB,MAAM9C,IAAnB;AACA,oBAAIP,SAASg1B,QAAQC,KAAR,CAAc5xB,KAAd,CAAb;AACA,oBAAIuzB,YAAYJ,QAAQ3tB,OAAR,CAAgBxF,KAAhB,CAAhB;AACA,oBAAIrD,MAAJ,EAAY;AACR,wBAAI62B,gBAAgBH,SAASC,MAAT,CAApB;AACA,wBAAIE,iBAAiBA,cAAct2B,IAAd,KAAuBo2B,MAA5C,EAAoD;AAChD,8BAAM,IAAIpwB,KAAJ,CAAU,YAAYowB,MAAZ,GAAqB,sBAA/B,CAAN;AACH;AACD,wBAAIG,sBAAsBJ,SAASC,SAAS,KAAlB,CAA1B;AACA,wBAAIG,mBAAJ,EAAyB;AACrB;AACA,6BAAKb,SAAL,CAAec,UAAf,CAA0BD,mBAA1B;AACH;AACDnU,2BAAOgU,MAAP,IAAiBtzB,KAAjB;AACA,yBAAK2zB,WAAL,CAAiB3zB,KAAjB;AACA,wBAAIuzB,aAAa,CAAjB,EACIJ,QAAQvtB,MAAR,CAAe2tB,SAAf,EAA0B,CAA1B;AACJL,+BAAWntB,IAAX,CAAgB/F,KAAhB;AACA;AACH;AACD,oBAAIuK,OAAO6oB,oBAAoBE,MAApB,CAAX;AACAF,oCAAoBE,MAApB,IAA8BP,MAAM32B,MAApC;AACA,oBAAIm3B,aAAa,CAAb,IAAkBhpB,SAASwoB,MAAM32B,MAArC,EAA6C;AACzC;AACA;AACA22B,0BAAMhtB,IAAN,CAAW/F,KAAX;AACA,2BAAOsf,MAAP;AACH,iBALD,MAMK,IAAIiU,YAAY,CAAhB,EAAmB;AACpBJ,4BAAQptB,IAAR,CAAa/F,KAAb;AACH;AACD+yB,sBAAMhtB,IAAN,CAAW/F,KAAX;AACH;AACD,gBAAIkzB,WAAW92B,MAAf,EAAuB;AACnB,qBAAK02B,SAAL,CAAe7uB,OAAf,CAAuB,UAAU2vB,QAAV,EAAoB;AAAE,2BAAOA,SAAS,YAAT,EAAuBV,WAAW11B,GAAX,CAAe,UAAUq2B,CAAV,EAAa;AAAE,+BAAOA,EAAE1zB,IAAT;AAAgB,qBAA9C,CAAvB,CAAP;AAAiF,iBAA9H;AACH;AACD,mBAAOmf,MAAP;AACH,SAhDD;AAiDAqT,0BAAkBrzB,SAAlB,CAA4Bq0B,WAA5B,GAA0C,UAAU3zB,KAAV,EAAiB;AACvD,gBAAIA,MAAMwqB,QAAN,IAAkB,CAACxqB,MAAMsB,GAA7B,EACI;AACJ,iBAAKuxB,UAAL,CAAgBiB,IAAhB,CAAqB,KAAKjB,UAAL,CAAgBkB,cAAhB,CAA+Bl0B,MAA/B,CAAsCG,KAAtC,CAArB;AACH,SAJD;AAKA,eAAO2yB,iBAAP;AACH,KAjFwB,EAAzB;;AAmFA;;;OA1pI2C,CA6pIvC;AACJ,QAAIqB,gBAAiB,YAAY;AAC7B;AACA,iBAASA,aAAT,CAAuBC,OAAvB,EAAgC;AAC5B,iBAAKA,OAAL,GAAeA,OAAf;AACA,iBAAK3U,MAAL,GAAc,EAAd;AACA,iBAAKwT,SAAL,GAAiB,EAAjB;AACA,iBAAKvB,OAAL,GAAe,IAAIU,YAAJ,CAAiB,KAAK3S,MAAtB,CAAf;AACA,iBAAKqS,OAAL,GAAe,IAAIL,YAAJ,CAAiB,KAAKC,OAAtB,EAA+B0C,QAAQzX,iBAAvC,CAAf;AACA,iBAAK0X,UAAL,GAAkB,IAAIvB,iBAAJ,CAAsB,IAAtB,EAA4BsB,QAAQE,SAApC,EAA+C,KAAK7U,MAApD,EAA4D,KAAKqS,OAAjE,EAA0E,KAAKmB,SAA/E,CAAlB;AACA,iBAAKsB,aAAL;AACH;AACD;AACAJ,sBAAc10B,SAAd,CAAwB80B,aAAxB,GAAwC,YAAY;AAChD,gBAAIC,eAAe;AACfn3B,sBAAM,EADS;AAEfoE,qBAAK,GAFU;AAGf4c,uBAAO,IAHQ;AAIfld,wBAAQ;AACJ,yBAAK,EAAE+H,OAAO,IAAT,EAAe+C,MAAM,MAArB,EAA6B+O,SAAS,IAAtC;AADD,iBAJO;AAOf2P,0BAAU;AAPK,aAAnB;AASA,gBAAI8J,QAAQ,KAAKA,KAAL,GAAa,KAAKJ,UAAL,CAAgBlB,QAAhB,CAAyBqB,YAAzB,CAAzB;AACAC,kBAAMjF,SAAN,GAAkB,IAAlB;AACH,SAZD;AAaA;AACA2E,sBAAc10B,SAAd,CAAwBktB,OAAxB,GAAkC,YAAY;AAC1C,gBAAIrjB,QAAQ,IAAZ;AACA,iBAAK+qB,UAAL,CAAgB1H,OAAhB;AACA,iBAAKsG,SAAL,GAAiB,EAAjB;AACA,iBAAKlQ,GAAL,GAAW3e,OAAX,CAAmB,UAAUjE,KAAV,EAAiB;AAAE,uBAAOmJ,MAAMyZ,GAAN,CAAU5iB,KAAV,KAAoBmJ,MAAMuqB,UAAN,CAAiB1zB,KAAjB,CAA3B;AAAqD,aAA3F;AACH,SALD;AAMA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8BAg0B,sBAAc10B,SAAd,CAAwBi1B,eAAxB,GAA0C,UAAUX,QAAV,EAAoB;AAC1D,iBAAKd,SAAL,CAAe/sB,IAAf,CAAoB6tB,QAApB;AACA,mBAAO,SAASY,kBAAT,GAA8B;AACjC/uB,2BAAW,KAAKqtB,SAAhB,EAA2Bc,QAA3B;AACH,aAFM,CAELhwB,IAFK,CAEA,IAFA,CAAP;AAGH,SALD;AAMA;;;;;;;;;AASAowB,sBAAc10B,SAAd,CAAwBmB,IAAxB,GAA+B,YAAY;AACvC,mBAAO,KAAK6zB,KAAZ;AACH,SAFD;AAGA;;;;;;;;;;;;AAYAN,sBAAc10B,SAAd,CAAwB0zB,QAAxB,GAAmC,UAAUyB,eAAV,EAA2B;AAC1D,mBAAO,KAAKP,UAAL,CAAgBlB,QAAhB,CAAyByB,eAAzB,CAAP;AACH,SAFD;AAGA;AACAT,sBAAc10B,SAAd,CAAwBo1B,eAAxB,GAA0C,UAAU10B,KAAV,EAAiB;AACvD,gBAAImJ,QAAQ,IAAZ;AACA,gBAAIwrB,SAAS,KAAK/R,GAAL,GAAWplB,GAAX,CAAe,UAAUq2B,CAAV,EAAa;AAAE,uBAAOA,EAAE3zB,OAAF,EAAP;AAAqB,aAAnD,CAAb;AACA,gBAAI00B,cAAc,SAAdA,WAAc,CAAUtV,MAAV,EAAkB;AAChC,oBAAIuV,WAAWF,OAAO1zB,MAAP,CAAc,UAAU4yB,CAAV,EAAa;AAAE,2BAAOvU,OAAO9Z,OAAP,CAAequB,EAAErzB,MAAjB,MAA6B,CAAC,CAArC;AAAyC,iBAAtE,CAAf;AACA,uBAAOq0B,SAASz4B,MAAT,KAAoB,CAApB,GAAwBy4B,QAAxB,GAAmCA,SAASt4B,MAAT,CAAgBq4B,YAAYC,QAAZ,CAAhB,CAA1C;AACH,aAHD;AAIA,gBAAIA,WAAWD,YAAY,CAAC50B,KAAD,CAAZ,CAAf;AACA,gBAAI80B,eAAe,CAAC90B,KAAD,EAAQzD,MAAR,CAAes4B,QAAf,EAAyB73B,OAAzB,EAAnB;AACA83B,yBAAa7wB,OAAb,CAAqB,UAAUjE,KAAV,EAAiB;AAClC,oBAAI+0B,MAAM5rB,MAAM8qB,OAAN,CAAcE,SAAxB;AACA;AACAY,oBAAIC,KAAJ,GAAY/zB,MAAZ,CAAmB7D,OAAO,OAAP,EAAgB4C,KAAhB,CAAnB,EAA2CiE,OAA3C,CAAmD8wB,IAAIE,UAAJ,CAAerxB,IAAf,CAAoBmxB,GAApB,CAAnD;AACA;AACA,uBAAO5rB,MAAMmW,MAAN,CAAatf,MAAM9C,IAAnB,CAAP;AACH,aAND;AAOA,mBAAO43B,YAAP;AACH,SAjBD;AAkBA;;;;;;;;;AASAd,sBAAc10B,SAAd,CAAwBo0B,UAAxB,GAAqC,UAAUtB,WAAV,EAAuB;AACxD,gBAAI5c,SAAS,KAAKoN,GAAL,CAASwP,WAAT,CAAb;AACA,gBAAI,CAAC5c,MAAL,EACI,MAAM,IAAItS,KAAJ,CAAU,wCAAwCkvB,WAAlD,CAAN;AACJ,gBAAI8C,qBAAqB,KAAKR,eAAL,CAAqBlf,OAAOtV,OAAP,EAArB,CAAzB;AACA,iBAAK4yB,SAAL,CAAe7uB,OAAf,CAAuB,UAAU2vB,QAAV,EAAoB;AAAE,uBAAOA,SAAS,cAAT,EAAyBsB,mBAAmB13B,GAAnB,CAAuB,UAAUq2B,CAAV,EAAa;AAAE,2BAAOA,EAAE1zB,IAAT;AAAgB,iBAAtD,CAAzB,CAAP;AAA2F,aAAxI;AACA,mBAAO+0B,kBAAP;AACH,SAPD;AAQAlB,sBAAc10B,SAAd,CAAwBsjB,GAAxB,GAA8B,UAAUwP,WAAV,EAAuBlgB,IAAvB,EAA6B;AACvD,gBAAI/I,QAAQ,IAAZ;AACA,gBAAIjN,UAAUE,MAAV,KAAqB,CAAzB,EACI,OAAOyF,OAAOqD,IAAP,CAAY,KAAKoa,MAAjB,EAAyB9hB,GAAzB,CAA6B,UAAUN,IAAV,EAAgB;AAAE,uBAAOiM,MAAMmW,MAAN,CAAapiB,IAAb,EAAmBiD,IAA1B;AAAiC,aAAhF,CAAP;AACJ,gBAAIg1B,QAAQ,KAAK5D,OAAL,CAAahwB,IAAb,CAAkB6wB,WAAlB,EAA+BlgB,IAA/B,CAAZ;AACA,mBAAOijB,SAASA,MAAMh1B,IAAf,IAAuB,IAA9B;AACH,SAND;AAOA6zB,sBAAc10B,SAAd,CAAwB81B,SAAxB,GAAoC,UAAUl4B,IAAV,EAAgBm4B,IAAhB,EAAsB;AACtD,mBAAO,KAAK1D,OAAL,CAAaA,OAAb,CAAqBz0B,IAArB,EAA2Bm4B,IAA3B,CAAP;AACH,SAFD;AAGA,eAAOrB,aAAP;AACH,KA9IoB,EAArB;;AAgJA;;;;AAIA;AACA;AACA,aAASsB,WAAT,CAAqBtI,MAArB,EAA6B9rB,KAA7B,EAAoC;AAChC,YAAIq0B,kBAAkB,CAAC,EAAD,EAAK,EAAL,CAAtB;AAAA,YAAgC54B,SAASqwB,OAAO7Q,OAAP,CAAe,uBAAf,EAAwC,MAAxC,CAAzC;AACA,YAAI,CAACjb,KAAL,EACI,OAAOvE,MAAP;AACJ,gBAAQuE,MAAM8a,MAAd;AACI,iBAAK,KAAL;AACIuZ,kCAAkB,CAAC,GAAD,EAAM,OAAOr0B,MAAM4a,UAAN,GAAmB,GAAnB,GAAyB,EAAhC,CAAN,CAAlB;AACA;AACJ,iBAAK,IAAL;AACInf,yBAASA,OAAOwf,OAAP,CAAe,KAAf,EAAsB,EAAtB,CAAT;AACAoZ,kCAAkB,CAAC,QAAD,EAAW,QAAX,CAAlB;AACA;AACJ;AACIA,kCAAkB,CAAC,MAAMr0B,MAAM8a,MAAZ,GAAqB,GAAtB,EAA2B,IAA3B,CAAlB;AACA;AAVR;AAYA,eAAOrf,SAAS44B,gBAAgB,CAAhB,CAAT,GAA8Br0B,MAAM4K,IAAN,CAAWlN,OAAX,CAAmB+F,MAAjD,GAA0D4wB,gBAAgB,CAAhB,CAAjE;AACH;AACD;AACA,QAAIC,YAAY,SAAZA,SAAY,CAAUr4B,GAAV,EAAes4B,OAAf,EAAwB35B,EAAxB,EAA4B;AACxC,eAAOqB,IAAIs4B,OAAJ,IAAet4B,IAAIs4B,OAAJ,KAAgB35B,IAAtC;AACH,KAFD;AAGA;AACA,QAAI45B,eAAe5J,aAAa,GAAb,CAAnB;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmDA,QAAI6J,aAAc,YAAY;AAC1B;;;;;;;AAOA,iBAASA,UAAT,CAAoBC,UAApB,EAAgCna,UAAhC,EAA4CkU,YAA5C,EAA0D/vB,MAA1D,EAAkE;AAC9D,gBAAIuJ,QAAQ,IAAZ;AACA,iBAAKvJ,MAAL,GAAcA,MAAd;AACA;AACA,iBAAKi2B,MAAL,GAAc,EAAEjvB,MAAM,CAAC,IAAD,CAAR,EAAd;AACA;AACA,iBAAKkvB,SAAL,GAAiB,EAAjB;AACA;AACA,iBAAKlkB,OAAL,GAAe,EAAf;AACA;AACA,iBAAKmkB,SAAL,GAAiB,EAAjB;AACA;AACA,iBAAKC,SAAL,GAAiB,EAAjB;AACA,iBAAKp3B,OAAL,GAAeg3B,UAAf;AACA,iBAAKh2B,MAAL,GAAcgB,SAAS,KAAKhB,MAAd,EAAsB;AAChCoB,wBAAQ,EADwB;AAEhCi1B,wBAAQ,IAFwB;AAGhCC,iCAAiB,KAHe;AAIhCjH,0BAAUzqB;AAJsB,aAAtB,CAAd;AAMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAI2xB,cAAc,uFAAlB;AAAA,gBAA2GC,oBAAoB,2FAA/H;AAAA,gBAA4NC,OAAO,CAAnO;AAAA,gBAAsOC,CAAtO;AAAA,gBAAyOC,WAAW,EAApP;AACA,gBAAIC,mBAAmB,SAAnBA,gBAAmB,CAAUp1B,EAAV,EAAc;AACjC,oBAAI,CAACu0B,WAAWc,aAAX,CAAyBj3B,IAAzB,CAA8B4B,EAA9B,CAAL,EACI,MAAM,IAAI8B,KAAJ,CAAU,6BAA6B9B,EAA7B,GAAkC,gBAAlC,GAAqDw0B,UAArD,GAAkE,GAA5E,CAAN;AACJ,oBAAIr0B,KAAK4H,MAAMyI,OAAX,EAAoBxU,OAAO,IAAP,EAAagE,EAAb,CAApB,CAAJ,EACI,MAAM,IAAI8B,KAAJ,CAAU,+BAA+B9B,EAA/B,GAAoC,gBAApC,GAAuDw0B,UAAvD,GAAoE,GAA9E,CAAN;AACP,aALD;AAMA;AACA;AACA,gBAAIc,eAAe,SAAfA,YAAe,CAAUJ,CAAV,EAAavc,QAAb,EAAuB;AACtC;AACA,oBAAI3Y,KAAKk1B,EAAE,CAAF,KAAQA,EAAE,CAAF,CAAjB;AACA,oBAAIl3B,SAAS2a,WAAWuc,EAAE,CAAF,CAAX,GAAkBA,EAAE,CAAF,MAASA,EAAE,CAAF,MAAS,GAAT,GAAe,IAAf,GAAsB,IAA/B,CAA/B;AACA,oBAAIK,iBAAiB,SAAjBA,cAAiB,CAAUv3B,MAAV,EAAkB;AAAE,2BAAOa,QAAQwb,WAAW3P,IAAX,CAAgBiO,WAAW,OAAX,GAAqB,MAArC,CAAR,EAAsD;AAClGnb,iCAAS,IAAIS,MAAJ,CAAWD,MAAX,EAAmB+J,MAAMvJ,MAAN,CAAas2B,eAAb,GAA+B,GAA/B,GAAqC7yB,SAAxD;AADyF,qBAAtD,CAAP;AAEpC,iBAFL;AAGA,uBAAO;AACHjC,wBAAIA,EADD;AAEHhC,4BAAQA,MAFL;AAGH6b,yBAAK9R,MAAMvJ,MAAN,CAAaoB,MAAb,CAAoBI,EAApB,CAHF;AAIHw1B,6BAAShB,WAAWrH,SAAX,CAAqB8H,IAArB,EAA2BC,EAAEO,KAA7B,CAJN;AAKH/qB,0BAAM,CAAC1M,MAAD,GAAU,IAAV,GAAiBqc,WAAW3P,IAAX,CAAgB1M,MAAhB,KAA2Bu3B,eAAev3B,MAAf;AAL/C,iBAAP;AAOH,aAdD;AAeA,gBAAI6wB,CAAJ,EAAO2G,OAAP;AACA,mBAAQN,IAAIH,YAAY12B,IAAZ,CAAiBm2B,UAAjB,CAAZ,EAA2C;AACvC3F,oBAAIyG,aAAaJ,CAAb,EAAgB,KAAhB,CAAJ;AACA,oBAAIrG,EAAE2G,OAAF,CAAUpxB,OAAV,CAAkB,GAAlB,KAA0B,CAA9B,EACI,MAHmC,CAG5B;AACXgxB,iCAAiBvG,EAAE7uB,EAAnB;AACA,qBAAKwQ,OAAL,CAAa7L,IAAb,CAAkB4pB,aAAa1Q,QAAb,CAAsBgR,EAAE7uB,EAAxB,EAA4B6uB,EAAEnkB,IAA9B,EAAoC,KAAKlM,MAAL,CAAYqvB,QAAZ,CAAqBgB,EAAEhV,GAAvB,EAA4B,KAA5B,CAApC,CAAlB;AACA,qBAAK8a,SAAL,CAAehwB,IAAf,CAAoBkqB,EAAE2G,OAAtB;AACAL,yBAASxwB,IAAT,CAAc,CAACkqB,EAAE2G,OAAH,EAAY9zB,KAAK,KAAK8O,OAAV,CAAZ,CAAd;AACAykB,uBAAOF,YAAYW,SAAnB;AACH;AACDF,sBAAUhB,WAAWrH,SAAX,CAAqB8H,IAArB,CAAV;AACA;AACA,gBAAI35B,IAAIk6B,QAAQpxB,OAAR,CAAgB,GAAhB,CAAR;AACA,gBAAI9I,KAAK,CAAT,EAAY;AACR,oBAAIq6B,SAASH,QAAQrI,SAAR,CAAkB7xB,CAAlB,CAAb;AACAk6B,0BAAUA,QAAQrI,SAAR,CAAkB,CAAlB,EAAqB7xB,CAArB,CAAV;AACA,oBAAIq6B,OAAO36B,MAAP,GAAgB,CAApB,EAAuB;AACnBi6B,2BAAO,CAAP;AACA,2BAAQC,IAAIF,kBAAkB32B,IAAlB,CAAuBs3B,MAAvB,CAAZ,EAA6C;AACzC9G,4BAAIyG,aAAaJ,CAAb,EAAgB,IAAhB,CAAJ;AACAE,yCAAiBvG,EAAE7uB,EAAnB;AACA,6BAAKwQ,OAAL,CAAa7L,IAAb,CAAkB4pB,aAAaqH,UAAb,CAAwB/G,EAAE7uB,EAA1B,EAA8B6uB,EAAEnkB,IAAhC,EAAsC,KAAKlM,MAAL,CAAYqvB,QAAZ,CAAqBgB,EAAEhV,GAAvB,EAA4B,IAA5B,CAAtC,CAAlB;AACAob,+BAAOF,YAAYW,SAAnB;AACA;AACH;AACJ;AACJ;AACD,iBAAKf,SAAL,CAAehwB,IAAf,CAAoB6wB,OAApB;AACA,iBAAKZ,SAAL,GAAiBO,SAAS/4B,GAAT,CAAa,UAAUo4B,UAAV,EAAsB;AAAE,uBAAON,YAAYr5B,KAAZ,CAAkB,IAAlB,EAAwB25B,UAAxB,CAAP;AAA6C,aAAlF,EAAoFr5B,MAApF,CAA2F+4B,YAAYsB,OAAZ,CAA3F,CAAjB;AACH;AACD;;;;;;;AAOAjB,mBAAWr2B,SAAX,CAAqBgwB,MAArB,GAA8B,UAAUhuB,GAAV,EAAe;AACzC,iBAAKw0B,SAAL,CAAe/vB,IAAf,CAAoBzE,GAApB;AACAA,gBAAIu0B,MAAJ,GAAa;AACTjvB,sBAAM,KAAKivB,MAAL,CAAYjvB,IAAZ,CAAiBrK,MAAjB,CAAwB+E,GAAxB,CADG;AAETd,wBAAQ,IAFC;AAGT5B,yBAAS;AAHA,aAAb;AAKA,mBAAO0C,GAAP;AACH,SARD;AASA;AACAq0B,mBAAWr2B,SAAX,CAAqBkwB,MAArB,GAA8B,YAAY;AACtC,mBAAO,KAAKqG,MAAL,CAAYjvB,IAAZ,CAAiB,CAAjB,MAAwB,IAA/B;AACH,SAFD;AAGA;AACA+uB,mBAAWr2B,SAAX,CAAqBkC,QAArB,GAAgC,YAAY;AACxC,mBAAO,KAAK5C,OAAZ;AACH,SAFD;AAGA;;;;;;;;;;;;;;;;;;;;;;;;;;AA0BA+2B,mBAAWr2B,SAAX,CAAqBG,IAArB,GAA4B,UAAUmH,IAAV,EAAgBmwB,MAAhB,EAAwB7J,IAAxB,EAA8BxgB,OAA9B,EAAuC;AAC/D,gBAAIvD,QAAQ,IAAZ;AACA,gBAAI4tB,WAAW,KAAK,CAApB,EAAuB;AAAEA,yBAAS,EAAT;AAAc;AACvC,gBAAIrqB,YAAY,KAAK,CAArB,EAAwB;AAAEA,0BAAU,EAAV;AAAe;AACzC,gBAAIqQ,QAAQyY,UAAU,KAAKK,MAAf,EAAuB,SAAvB,EAAkC,YAAY;AACtD,uBAAO,IAAIx2B,MAAJ,CAAW,CACd,GADc,EAEd4I,OAAOkB,MAAM0sB,MAAN,CAAajvB,IAAb,CAAkBpJ,GAAlB,CAAsBP,KAAK,WAAL,CAAtB,CAAP,EAAiDkC,IAAjD,CAAsD,EAAtD,CAFc,EAGdgK,MAAMvJ,MAAN,CAAaq2B,MAAb,KAAwB,KAAxB,GAAgC,KAAhC,GAAwC,EAH1B,EAId,GAJc,EAKhB92B,IALgB,CAKX,EALW,CAAX,EAKKgK,MAAMvJ,MAAN,CAAas2B,eAAb,GAA+B,GAA/B,GAAqC7yB,SAL1C,CAAP;AAMH,aAPW,EAOT5D,IAPS,CAOJmH,IAPI,CAAZ;AAQA,gBAAI,CAACmW,KAAL,EACI,OAAO,IAAP;AACJ;AACA,gBAAIka,YAAY,KAAKv2B,UAAL,EAAhB;AAAA,gBAAmCw2B,aAAaD,UAAUh2B,MAAV,CAAiB,UAAUC,KAAV,EAAiB;AAAE,uBAAO,CAACA,MAAM6Y,QAAN,EAAR;AAA2B,aAA/D,CAAhD;AAAA,gBAAkHod,eAAeF,UAAUh2B,MAAV,CAAiB,UAAUC,KAAV,EAAiB;AAAE,uBAAOA,MAAM6Y,QAAN,EAAP;AAA0B,aAA9D,CAAjI;AAAA,gBAAkMqd,gBAAgB,KAAKvB,MAAL,CAAYjvB,IAAZ,CAAiBpJ,GAAjB,CAAqB,UAAU65B,IAAV,EAAgB;AAAE,uBAAOA,KAAKtB,SAAL,CAAe35B,MAAf,GAAwB,CAA/B;AAAmC,aAA1E,EAA4E4B,MAA5E,CAAmF,UAAUmM,CAAV,EAAajM,CAAb,EAAgB;AAAE,uBAAOiM,IAAIjM,CAAX;AAAe,aAApH,CAAlN;AAAA,gBAAyUsf,YAAY,EAArV;AACA,gBAAI4Z,kBAAkBra,MAAM3gB,MAAN,GAAe,CAArC,EACI,MAAM,IAAI8G,KAAJ,CAAU,wCAAwC,KAAKtE,OAA7C,GAAuD,GAAjE,CAAN;AACJ,qBAAS04B,eAAT,CAAyBtK,MAAzB,EAAiC;AAC7B,oBAAIuK,gBAAgB,SAAhBA,aAAgB,CAAUxM,GAAV,EAAe;AAAE,2BAAOA,IAAIxtB,KAAJ,CAAU,EAAV,EAAcP,OAAd,GAAwBmC,IAAxB,CAA6B,EAA7B,CAAP;AAA0C,iBAA/E;AACA,oBAAIq4B,gBAAgB,SAAhBA,aAAgB,CAAUzM,GAAV,EAAe;AAAE,2BAAOA,IAAI5O,OAAJ,CAAY,MAAZ,EAAoB,GAApB,CAAP;AAAkC,iBAAvE;AACA,oBAAI5e,QAAQg6B,cAAcvK,MAAd,EAAsBzvB,KAAtB,CAA4B,SAA5B,CAAZ;AACA,oBAAIk6B,cAAcj6B,IAAID,KAAJ,EAAWg6B,aAAX,CAAlB;AACA,uBAAO/5B,IAAIi6B,WAAJ,EAAiBD,aAAjB,EAAgCx6B,OAAhC,EAAP;AACH;AACD,iBAAK,IAAIN,IAAI,CAAb,EAAgBA,IAAI06B,aAApB,EAAmC16B,GAAnC,EAAwC;AACpC,oBAAIwE,QAAQg2B,WAAWx6B,CAAX,CAAZ;AACA,oBAAIqM,QAAQgU,MAAMrgB,IAAI,CAAV,CAAZ;AACA;AACA,qBAAK,IAAI2M,IAAI,CAAb,EAAgBA,IAAInI,MAAMib,OAAN,CAAc/f,MAAlC,EAA0CiN,GAA1C,EAA+C;AAC3C,wBAAInI,MAAMib,OAAN,CAAc9S,CAAd,EAAiBgT,IAAjB,KAA0BtT,KAA9B,EACIA,QAAQ7H,MAAMib,OAAN,CAAc9S,CAAd,EAAiBiT,EAAzB;AACP;AACD,oBAAIvT,SAAS7H,MAAMqE,KAAN,KAAgB,IAA7B,EACIwD,QAAQuuB,gBAAgBvuB,KAAhB,CAAR;AACJ,oBAAI9G,UAAU8G,KAAV,CAAJ,EACIA,QAAQ7H,MAAM4K,IAAN,CAAW0N,MAAX,CAAkBzQ,KAAlB,CAAR;AACJyU,0BAAUtc,MAAME,EAAhB,IAAsBF,MAAM6H,KAAN,CAAYA,KAAZ,CAAtB;AACH;AACDouB,yBAAalzB,OAAb,CAAqB,UAAU/C,KAAV,EAAiB;AAClC,oBAAI6H,QAAQguB,OAAO71B,MAAME,EAAb,CAAZ;AACA,qBAAK,IAAIiI,IAAI,CAAb,EAAgBA,IAAInI,MAAMib,OAAN,CAAc/f,MAAlC,EAA0CiN,GAA1C,EAA+C;AAC3C,wBAAInI,MAAMib,OAAN,CAAc9S,CAAd,EAAiBgT,IAAjB,KAA0BtT,KAA9B,EACIA,QAAQ7H,MAAMib,OAAN,CAAc9S,CAAd,EAAiBiT,EAAzB;AACP;AACD,oBAAIra,UAAU8G,KAAV,CAAJ,EACIA,QAAQ7H,MAAM4K,IAAN,CAAW0N,MAAX,CAAkBzQ,KAAlB,CAAR;AACJyU,0BAAUtc,MAAME,EAAhB,IAAsBF,MAAM6H,KAAN,CAAYA,KAAZ,CAAtB;AACH,aATD;AAUA,gBAAImkB,IAAJ,EACI1P,UAAU,GAAV,IAAiB0P,IAAjB;AACJ,mBAAO1P,SAAP;AACH,SApDD;AAqDA;;;;;;;AAOAmY,mBAAWr2B,SAAX,CAAqBoB,UAArB,GAAkC,UAAUC,IAAV,EAAgB;AAC9C,gBAAIA,SAAS,KAAK,CAAlB,EAAqB;AAAEA,uBAAO,EAAP;AAAY;AACnC,gBAAIA,KAAKV,OAAL,KAAiB,KAArB,EACI,OAAO,KAAK2R,OAAZ;AACJ,mBAAO3J,OAAO,KAAK4tB,MAAL,CAAYjvB,IAAZ,CAAiBpJ,GAAjB,CAAqB,UAAU+zB,OAAV,EAAmB;AAAE,uBAAOA,QAAQ3f,OAAf;AAAyB,aAAnE,CAAP,CAAP;AACH,SALD;AAMA;;;;;;;;AAQA+jB,mBAAWr2B,SAAX,CAAqB+B,SAArB,GAAiC,UAAUD,EAAV,EAAcT,IAAd,EAAoB;AACjD,gBAAIwI,QAAQ,IAAZ;AACA,gBAAIxI,SAAS,KAAK,CAAlB,EAAqB;AAAEA,uBAAO,EAAP;AAAY;AACnC,gBAAI+2B,YAAY,SAAZA,SAAY,GAAY;AACxB,qBAAK,IAAI36B,KAAK,CAAT,EAAYqP,KAAKjD,MAAMyI,OAA5B,EAAqC7U,KAAKqP,GAAGhQ,MAA7C,EAAqDW,IAArD,EAA2D;AACvD,wBAAImE,QAAQkL,GAAGrP,EAAH,CAAZ;AACA,wBAAImE,MAAME,EAAN,KAAaA,EAAjB,EACI,OAAOF,KAAP;AACP;AACJ,aAND;AAOA,gBAAIV,SAAS,KAAKq1B,MAAL,CAAYr1B,MAAzB;AACA,mBAAOk3B,eAAgB/2B,KAAKV,OAAL,KAAiB,KAAjB,IAA0BO,MAA1B,IAAoCA,OAAOa,SAAP,CAAiBD,EAAjB,EAAqBT,IAArB,CAApD,IAAmF,IAA1F;AACH,SAZD;AAaA;;;;;;;;;AASAg1B,mBAAWr2B,SAAX,CAAqB+d,SAArB,GAAiC,UAAUrc,MAAV,EAAkB;AAC/C,gBAAI22B,gBAAgB,SAAhBA,aAAgB,CAAUz2B,KAAV,EAAiB0B,MAAjB,EAAyB;AACzC,uBAAO,CAAC1B,KAAD,IAAUA,MAAMmc,SAAN,CAAgBza,MAAhB,CAAjB;AACH,aAFD;AAGA5B,qBAASA,UAAU,EAAnB;AACA;AACA,gBAAIgd,cAAc,KAAKtd,UAAL,GAAkBO,MAAlB,CAAyB,UAAUsd,QAAV,EAAoB;AAAE,uBAAOvd,OAAOG,cAAP,CAAsBod,SAASnd,EAA/B,CAAP;AAA4C,aAA3F,CAAlB;AACA,mBAAO4c,YAAYxgB,GAAZ,CAAgB,UAAU+gB,QAAV,EAAoB;AAAE,uBAAOoZ,cAAcpZ,QAAd,EAAwBvd,OAAOud,SAASnd,EAAhB,CAAxB,CAAP;AAAsD,aAA5F,EAA8FpD,MAA9F,CAAqGyJ,QAArG,EAA+G,IAA/G,CAAP;AACH,SARD;AASA;;;;;;;;;;;;;;;AAeAkuB,mBAAWr2B,SAAX,CAAqBqsB,MAArB,GAA8B,UAAUnO,SAAV,EAAqB;AAC/C,gBAAIA,cAAc,KAAK,CAAvB,EAA0B;AAAEA,4BAAY,EAAZ;AAAiB;AAC7C;AACA,gBAAIoa,cAAc,KAAK/B,MAAL,CAAYjvB,IAA9B;AACA;AACA;AACA,gBAAIixB,wBAAwBD,YAAYp6B,GAAZ,CAAgBm4B,WAAWkC,qBAA3B,EACvB75B,MADuB,CAChB4J,OADgB,EACP,EADO,EAEvBpK,GAFuB,CAEnB,UAAUU,CAAV,EAAa;AAAE,uBAAOoE,SAASpE,CAAT,IAAcA,CAAd,GAAkB45B,WAAW55B,CAAX,CAAzB;AAAyC,aAFrC,CAA5B;AAGA;AACA,gBAAI65B,cAAcH,YAAYp6B,GAAZ,CAAgBm4B,WAAWoC,WAA3B,EACb/5B,MADa,CACN4J,OADM,EACG,EADH,EAEbpK,GAFa,CAETs6B,UAFS,CAAlB;AAGA,gBAAIE,YAAY,SAAZA,SAAY,CAAU92B,KAAV,EAAiB;AAAE,uBAAOA,MAAM+2B,OAAN,KAAkB,KAAzB;AAAiC,aAApE;AACA,gBAAIJ,sBAAsBt7B,MAAtB,CAA6Bw7B,WAA7B,EAA0C92B,MAA1C,CAAiD+2B,SAAjD,EAA4D57B,MAAhE,EAAwE;AACpE,uBAAO,IAAP;AACH;AACD;;;AAGA,qBAAS07B,UAAT,CAAoB52B,KAApB,EAA2B;AACvB;AACA,oBAAI6H,QAAQ7H,MAAM6H,KAAN,CAAYyU,UAAUtc,MAAME,EAAhB,CAAZ,CAAZ;AACA,oBAAI62B,UAAU/2B,MAAMmc,SAAN,CAAgBtU,KAAhB,CAAd;AACA,oBAAIiU,iBAAiB9b,MAAM8b,cAAN,CAAqBjU,KAArB,CAArB;AACA;AACA,oBAAIiT,SAASgB,iBAAiB9b,MAAM8a,MAAvB,GAAgC,KAA7C;AACA;AACA,oBAAIuB,UAAUrc,MAAM4K,IAAN,CAAWyN,MAAX,CAAkBxQ,KAAlB,CAAd;AACA,uBAAO,EAAE7H,OAAOA,KAAT,EAAgB6H,OAAOA,KAAvB,EAA8BkvB,SAASA,OAAvC,EAAgDjb,gBAAgBA,cAAhE,EAAgFhB,QAAQA,MAAxF,EAAgGuB,SAASA,OAAzG,EAAP;AACH;AACD;AACA,gBAAI2a,aAAaL,sBAAsB75B,MAAtB,CAA6B,UAAUmH,GAAV,EAAejH,CAAf,EAAkB;AAC5D;AACA,oBAAIoE,SAASpE,CAAT,CAAJ,EACI,OAAOiH,MAAMjH,CAAb;AACJ;AACA,oBAAI8d,SAAS9d,EAAE8d,MAAf;AAAA,oBAAuBuB,UAAUrf,EAAEqf,OAAnC;AAAA,oBAA4Crc,QAAQhD,EAAEgD,KAAtD;AACA;AACA,oBAAI8a,WAAW,IAAf,EACI,OAAQ7W,IAAI4X,KAAJ,CAAU,KAAV,CAAD,GAAqB5X,IAAInJ,KAAJ,CAAU,CAAV,EAAa,CAAC,CAAd,CAArB,GAAwCmJ,GAA/C;AACJ;AACA,oBAAI7C,SAAS0Z,MAAT,CAAJ,EACI,OAAO7W,MAAM6W,MAAb;AACJ,oBAAIA,WAAW,KAAf,EACI,OAAO7W,GAAP,CAbwD,CAa5C;AAChB,oBAAIoY,WAAW,IAAf,EACI,OAAOpY,GAAP;AACJ;AACA,oBAAI5C,QAAQgb,OAAR,CAAJ,EACI,OAAOpY,MAAM3H,IAAI+f,OAAJ,EAAaoY,WAAWwC,YAAxB,EAAsCh5B,IAAtC,CAA2C,GAA3C,CAAb;AACJ;AACA,oBAAI+B,MAAMwb,GAAV,EACI,OAAOvX,MAAMoY,OAAb;AACJ;AACA,uBAAOpY,MAAMizB,mBAAmB7a,OAAnB,CAAb;AACH,aAxBgB,EAwBd,EAxBc,CAAjB;AAyBA;AACA;AACA,gBAAI8a,cAAcN,YAAYv6B,GAAZ,CAAgB,UAAU86B,YAAV,EAAwB;AACtD,oBAAIp3B,QAAQo3B,aAAap3B,KAAzB;AAAA,oBAAgC8a,SAASsc,aAAatc,MAAtD;AAAA,oBAA8DuB,UAAU+a,aAAa/a,OAArF;AAAA,oBAA8FP,iBAAiBsb,aAAatb,cAA5H;AACA,oBAAIO,WAAW,IAAX,IAAoBP,kBAAkBhB,WAAW,KAArD,EACI;AACJ,oBAAI,CAACzZ,QAAQgb,OAAR,CAAL,EACIA,UAAU,CAACA,OAAD,CAAV;AACJ,oBAAIA,QAAQnhB,MAAR,KAAmB,CAAvB,EACI;AACJ,oBAAI,CAAC8E,MAAMwb,GAAX,EACIa,UAAU/f,IAAI+f,OAAJ,EAAa6a,kBAAb,CAAV;AACJ,uBAAO7a,QAAQ/f,GAAR,CAAY,UAAUoF,MAAV,EAAkB;AAAE,2BAAO1B,MAAME,EAAN,GAAW,GAAX,GAAiBwB,MAAxB;AAAiC,iBAAjE,CAAP;AACH,aAXiB,EAWf3B,MAXe,CAWRuD,QAXQ,EAWExG,MAXF,CAWS4J,OAXT,EAWkB,EAXlB,EAWsBzI,IAXtB,CAW2B,GAX3B,CAAlB;AAYA;AACA,mBAAO+4B,cAAcG,cAAc,MAAMA,WAApB,GAAkC,EAAhD,KAAuD7a,UAAU,GAAV,IAAiB,MAAMA,UAAU,GAAV,CAAvB,GAAwC,EAA/F,CAAP;AACH,SAzED;AA0EA;AACAmY,mBAAWwC,YAAX,GAA0B,UAAUpN,GAAV,EAAe;AACrC,mBAAOqN,mBAAmBrN,GAAnB,EAAwB5O,OAAxB,CAAgC,IAAhC,EAAsC,UAAUoc,CAAV,EAAa;AAAE,uBAAO,SAASA,EAAEC,UAAF,CAAa,CAAb,EAAgBh3B,QAAhB,CAAyB,EAAzB,EAA6Bi3B,WAA7B,EAAhB;AAA6D,aAAlH,CAAP;AACH,SAFD;AAGA;AACA9C,mBAAWkC,qBAAX,GAAmC,UAAUtG,OAAV,EAAmB;AAClD,gBAAImH,iBAAiBnH,QAAQwE,SAA7B;AACA,gBAAImB,aAAa3F,QAAQ3f,OAAR,CAAgB3Q,MAAhB,CAAuB,UAAUgvB,CAAV,EAAa;AAAE,uBAAOA,EAAEzU,QAAF,KAAelgB,QAAQ4f,OAAR,CAAgBS,IAAtC;AAA6C,aAAnF,CAAjB;AACA,mBAAOlT,YAAYiwB,cAAZ,EAA4BxB,WAAW36B,MAAX,CAAkB8G,SAAlB,CAA5B,EACFrF,MADE,CACK4J,OADL,EACc,EADd,EAEF3G,MAFE,CAEK,UAAU/C,CAAV,EAAa;AAAE,uBAAOA,MAAM,EAAN,IAAY+D,UAAU/D,CAAV,CAAnB;AAAkC,aAFtD,CAAP;AAGH,SAND;AAOA;AACAy3B,mBAAWoC,WAAX,GAAyB,UAAUxG,OAAV,EAAmB;AACxC,mBAAOA,QAAQ3f,OAAR,CAAgB3Q,MAAhB,CAAuB,UAAUgvB,CAAV,EAAa;AAAE,uBAAOA,EAAEzU,QAAF,KAAelgB,QAAQ4f,OAAR,CAAgBU,MAAtC;AAA+C,aAArF,CAAP;AACH,SAFD;AAGA;;;;;;;;;AASA+Z,mBAAWvO,OAAX,GAAqB,UAAUjd,CAAV,EAAalM,CAAb,EAAgB;AACjC;;;;;;;;;;AAUA,gBAAI6zB,WAAW,SAAXA,QAAW,CAAUP,OAAV,EAAmB;AAC9B,uBAAOA,QAAQsE,MAAR,CAAe/D,QAAf,GAA0BP,QAAQsE,MAAR,CAAe/D,QAAf,IAC7BP,QAAQsE,MAAR,CAAejvB,IAAf,CAAoBpJ,GAApB,CAAwBm4B,WAAWkC,qBAAnC,EACK75B,MADL,CACY4J,OADZ,EACqB,EADrB,EAEK5J,MAFL,CAEYiuB,cAFZ,EAE4B,EAF5B,EAGKzuB,GAHL,CAGS,UAAUU,CAAV,EAAa;AAAE,2BAAOoE,SAASpE,CAAT,IAAcw3B,aAAax3B,CAAb,CAAd,GAAgCA,CAAvC;AAA2C,iBAHnE,EAIKF,MAJL,CAIY4J,OAJZ,EAIqB,EAJrB,CADJ;AAMH,aAPD;AAQA;;;;;AAKA,gBAAI+wB,UAAU,SAAVA,OAAU,CAAUpH,OAAV,EAAmB;AAC7B,uBAAOA,QAAQsE,MAAR,CAAe8C,OAAf,GAAyBpH,QAAQsE,MAAR,CAAe8C,OAAf,IAC5B7G,SAASP,OAAT,EAAkB/zB,GAAlB,CAAsB,UAAUo5B,OAAV,EAAmB;AACrC;AACA,wBAAIA,YAAY,GAAhB,EACI,OAAO,CAAP;AACJ,wBAAIt0B,SAASs0B,OAAT,CAAJ,EACI,OAAO,CAAP;AACJ,wBAAIA,mBAAmBra,KAAvB,EACI,OAAO,CAAP;AACP,iBARD,CADJ;AAUH,aAXD;AAYA,gBAAIqc,GAAJ;AAAA,gBAASl8B,CAAT;AAAA,gBAAYm8B,WAAWpwB,YAAYkwB,QAAQxuB,CAAR,CAAZ,EAAwBwuB,QAAQ16B,CAAR,CAAxB,CAAvB;AACA,iBAAKvB,IAAI,CAAT,EAAYA,IAAIm8B,SAASz8B,MAAzB,EAAiCM,GAAjC,EAAsC;AAClCk8B,sBAAMC,SAASn8B,CAAT,EAAY,CAAZ,IAAiBm8B,SAASn8B,CAAT,EAAY,CAAZ,CAAvB;AACA,oBAAIk8B,QAAQ,CAAZ,EACI,OAAOA,GAAP;AACP;AACD,mBAAO,CAAP;AACH,SA3CD;AA4CA,eAAOjD,UAAP;AACH,KA1ZiB,EAAlB;AA2ZA;AACAA,eAAWc,aAAX,GAA2B,2BAA3B;;AAEA;;;OA7xJ2C,CAgyJvC;AACJ;;;;;;AAMA,QAAIqC,oBAAqB,YAAY;AACjC,iBAASA,iBAAT,GAA6B;AACzB,gBAAI3vB,QAAQ,IAAZ;AACA,0BAAe,KAAKsS,UAAL,GAAkB,IAAIyQ,UAAJ,EAAlB;AACf,0BAAe,KAAK6M,kBAAL,GAA0B,KAA1B;AACf,0BAAe,KAAKC,aAAL,GAAqB,IAArB;AACf,0BAAe,KAAKC,oBAAL,GAA4B,KAA5B;AACf;AACA,iBAAKC,UAAL,GAAkB,UAAUt5B,MAAV,EAAkB;AAChC,uBAAOuE,OAAO,EAAE8xB,QAAQ9sB,MAAM6vB,aAAhB,EAA+B9C,iBAAiB/sB,MAAM4vB,kBAAtD,EAAP,EAAmFn5B,MAAnF,CAAP;AACH,aAFD;AAGA;AACA,iBAAK+vB,YAAL,GAAoB;AAChB;AACAG,4BAAY,oBAAU1uB,EAAV,EAAc0K,IAAd,EAAoBlM,MAApB,EAA4B;AACpC,2BAAO,IAAI2c,KAAJ,CAAUnb,EAAV,EAAc0K,IAAd,EAAoBlM,MAApB,EAA4BtE,QAAQ4f,OAAR,CAAgBQ,MAA5C,EAAoDvS,KAApD,CAAP;AACH,iBAJe;AAKhB;AACA8V,0BAAU,kBAAU7d,EAAV,EAAc0K,IAAd,EAAoBlM,MAApB,EAA4B;AAClC,2BAAO,IAAI2c,KAAJ,CAAUnb,EAAV,EAAc0K,IAAd,EAAoBlM,MAApB,EAA4BtE,QAAQ4f,OAAR,CAAgBS,IAA5C,EAAkDxS,KAAlD,CAAP;AACH,iBARe;AAShB;AACA6tB,4BAAY,oBAAU51B,EAAV,EAAc0K,IAAd,EAAoBlM,MAApB,EAA4B;AACpC,2BAAO,IAAI2c,KAAJ,CAAUnb,EAAV,EAAc0K,IAAd,EAAoBlM,MAApB,EAA4BtE,QAAQ4f,OAAR,CAAgBU,MAA5C,EAAoDzS,KAApD,CAAP;AACH;AAZe,aAApB;AAcAhF,mBAAO,IAAP,EAAa,EAAEwxB,YAAYA,UAAd,EAA0BpZ,OAAOA,KAAjC,EAAb;AACH;AACD;AACAuc,0BAAkBx5B,SAAlB,CAA4B42B,eAA5B,GAA8C,UAAUntB,KAAV,EAAiB;AAC3D,mBAAO,KAAKgwB,kBAAL,GAA0B92B,UAAU8G,KAAV,IAAmBA,KAAnB,GAA2B,KAAKgwB,kBAAjE;AACH,SAFD;AAGA;AACAD,0BAAkBx5B,SAAlB,CAA4B65B,UAA5B,GAAyC,UAAUpwB,KAAV,EAAiB;AACtD,mBAAO,KAAKiwB,aAAL,GAAqB/2B,UAAU8G,KAAV,IAAmBA,KAAnB,GAA2B,KAAKiwB,aAA5D;AACH,SAFD;AAGA;AACAF,0BAAkBx5B,SAAlB,CAA4Bqd,mBAA5B,GAAkD,UAAU5T,KAAV,EAAiB;AAC/D,gBAAI9G,UAAU8G,KAAV,KAAoBA,UAAU,IAA9B,IAAsCA,UAAU,KAAhD,IAAyD,CAACzG,SAASyG,KAAT,CAA9D,EACI,MAAM,IAAI7F,KAAJ,CAAU,4BAA4B6F,KAA5B,GAAoC,iDAA9C,CAAN;AACJ,mBAAO,KAAKkwB,oBAAL,GAA4Bh3B,UAAU8G,KAAV,IAAmBA,KAAnB,GAA2B,KAAKkwB,oBAAnE;AACH,SAJD;AAKA;;;;;;;AAOAH,0BAAkBx5B,SAAlB,CAA4B0vB,OAA5B,GAAsC,UAAUpwB,OAAV,EAAmBgB,MAAnB,EAA2B;AAC7D,mBAAO,IAAI+1B,UAAJ,CAAe/2B,OAAf,EAAwB,KAAK6c,UAA7B,EAAyC,KAAKkU,YAA9C,EAA4D,KAAKuJ,UAAL,CAAgBt5B,MAAhB,CAA5D,CAAP;AACH,SAFD;AAGA;;;;;;;AAOAk5B,0BAAkBx5B,SAAlB,CAA4B8vB,SAA5B,GAAwC,UAAUgK,MAAV,EAAkB;AACtD;AACA,gBAAI,CAACz3B,SAASy3B,MAAT,CAAL,EACI,OAAO,KAAP;AACJ,gBAAIz8B,SAAS,IAAb;AACAsH,oBAAQ0xB,WAAWr2B,SAAnB,EAA8B,UAAUjC,GAAV,EAAeH,IAAf,EAAqB;AAC/C,oBAAIuE,WAAWpE,GAAX,CAAJ,EACIV,SAASA,UAAWsF,UAAUm3B,OAAOl8B,IAAP,CAAV,KAA2BuE,WAAW23B,OAAOl8B,IAAP,CAAX,CAA/C;AACP,aAHD;AAIA,mBAAOP,MAAP;AACH,SAVD;;AAYA;;;;;;;;;;;;;;;;;;;AAmBAm8B,0BAAkBx5B,SAAlB,CAA4BwM,IAA5B,GAAmC,UAAU5O,IAAV,EAAgBovB,UAAhB,EAA4BG,YAA5B,EAA0C;AACzE,gBAAI3gB,OAAO,KAAK2P,UAAL,CAAgB3P,IAAhB,CAAqB5O,IAArB,EAA2BovB,UAA3B,EAAuCG,YAAvC,CAAX;AACA,mBAAO,CAACxqB,UAAUqqB,UAAV,CAAD,GAAyBxgB,IAAzB,GAAgC,IAAvC;AACH,SAHD;;AAKA;AACAgtB,0BAAkBx5B,SAAlB,CAA4B+5B,IAA5B,GAAmC,YAAY;AAC3C,iBAAK5d,UAAL,CAAgBvQ,OAAhB,GAA0B,KAA1B;AACA,iBAAKuQ,UAAL,CAAgBiR,eAAhB;AACA,mBAAO,IAAP;AACH,SAJD;;AAMA;AACAoM,0BAAkBx5B,SAAlB,CAA4BktB,OAA5B,GAAsC,YAAY;AAC9C,iBAAK/Q,UAAL,CAAgB+Q,OAAhB;AACH,SAFD;AAGA,eAAOsM,iBAAP;AACH,KA3GwB,EAAzB;;AA6GA;;;OAp5J2C,CAu5JvC;AACJ;;;;;;;;;;;AAWA,QAAIQ,iBAAkB,YAAY;AAC9B,iBAASA,cAAT,CAAwBpmB,MAAxB,EAAgC;AAC5B,iBAAKA,MAAL,GAAcA,MAAd;AACH;AACDomB,uBAAeh6B,SAAf,CAAyB0vB,OAAzB,GAAmC,UAAUjE,GAAV,EAAe;AAC9C,mBAAO,KAAK7X,MAAL,CAAYsJ,iBAAZ,CAA8BwS,OAA9B,CAAsCjE,GAAtC,CAAP;AACH,SAFD;AAGAuO,uBAAeh6B,SAAf,CAAyBO,MAAzB,GAAkC,UAAU05B,IAAV,EAAgBC,OAAhB,EAAyB;AACvD,gBAAIrwB,QAAQ,IAAZ;AACA,gBAAIswB,WAAW76B,QAAQ,CACnB,CAAC0D,QAAD,EAAW,UAAUo3B,KAAV,EAAiB;AAAE,uBAAOD,SAAStwB,MAAM6lB,OAAN,CAAc0K,KAAd,CAAT,CAAP;AAAwC,aAAtE,CADmB,EAEnB,CAACt7B,GAAGu3B,UAAH,CAAD,EAAiB,UAAU+D,KAAV,EAAiB;AAAE,uBAAOvwB,MAAMwwB,cAAN,CAAqBD,KAArB,EAA4BF,OAA5B,CAAP;AAA8C,aAAlF,CAFmB,EAGnB,CAAC93B,OAAD,EAAU,UAAUg4B,KAAV,EAAiB;AAAE,uBAAOvwB,MAAMywB,SAAN,CAAgBF,KAAhB,EAAuBvwB,MAAM+J,MAA7B,CAAP;AAA8C,aAA3E,CAHmB,EAInB,CAAC9U,GAAGiB,MAAH,CAAD,EAAa,UAAUq6B,KAAV,EAAiB;AAAE,uBAAOvwB,MAAM0wB,UAAN,CAAiBH,KAAjB,EAAwBF,OAAxB,CAAP;AAA0C,aAA1E,CAJmB,EAKnB,CAAC/3B,UAAD,EAAa,UAAUi4B,KAAV,EAAiB;AAAE,uBAAO,IAAII,WAAJ,CAAgBJ,KAAhB,EAAuBF,OAAvB,CAAP;AAAyC,aAAzE,CALmB,CAAR,CAAf;AAOA,gBAAI1F,OAAO2F,SAASF,IAAT,CAAX;AACA,gBAAI,CAACzF,IAAL,EACI,MAAM,IAAI5wB,KAAJ,CAAU,0BAAV,CAAN;AACJ,mBAAO4wB,IAAP;AACH,SAbD;AAcA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoCAwF,uBAAeh6B,SAAf,CAAyBq6B,cAAzB,GAA0C,UAAUI,UAAV,EAAsBP,OAAtB,EAA+B;AACrE,gBAAIQ,WAAWR,OAAf;AACA,gBAAIl3B,SAASk3B,OAAT,CAAJ,EACIA,UAAU,KAAKtmB,MAAL,CAAYsJ,iBAAZ,CAA8BwS,OAA9B,CAAsCwK,OAAtC,CAAV;AACJ,gBAAIp7B,GAAGu3B,UAAH,EAAe6D,OAAf,CAAJ,EACIQ,WAAW,kBAAUjd,KAAV,EAAiB;AAAE,uBAAOyc,QAAQ7N,MAAR,CAAe5O,KAAf,CAAP;AAA+B,aAA7D;AACJ,qBAASA,KAAT,CAAezb,GAAf,EAAoB;AAChB,oBAAIyb,QAAQgd,WAAWt6B,IAAX,CAAgB6B,IAAIsF,IAApB,EAA0BtF,IAAIy1B,MAA9B,EAAsCz1B,IAAI4rB,IAA1C,CAAZ;AACA,uBAAO6M,WAAW1c,SAAX,CAAqBN,KAArB,KAA+BA,KAAtC;AACH;AACD;AACA;AACA;AACA;AACA;AACA,qBAASkd,aAAT,CAAuBj5B,MAAvB,EAA+B;AAC3B,oBAAIk5B,WAAWH,WAAWr5B,UAAX,GAAwBO,MAAxB,CAA+B,UAAUC,KAAV,EAAiB;AAAE,2BAAOA,MAAM4a,UAAb;AAA0B,iBAA5E,CAAf;AACA,oBAAI,CAACoe,SAAS99B,MAAd,EACI,OAAO,QAAP;AACJ,oBAAI+9B,UAAUD,SAASj5B,MAAT,CAAgB,UAAUC,KAAV,EAAiB;AAAE,2BAAOF,OAAOE,MAAME,EAAb,CAAP;AAA0B,iBAA7D,CAAd;AACA,uBAAO+4B,QAAQ/9B,MAAR,GAAiB89B,SAAS99B,MAAjC;AACH;AACD,gBAAIg+B,UAAU,EAAEL,YAAYA,UAAd,EAA0BE,eAAeA,aAAzC,EAAwDnuB,MAAM,YAA9D,EAAd;AACA,mBAAO3H,OAAO,IAAI21B,WAAJ,CAAgB/c,KAAhB,EAAuBid,QAAvB,CAAP,EAAyCI,OAAzC,CAAP;AACH,SAxBD;AAyBA;;;;;;;;;;;AAWAd,uBAAeh6B,SAAf,CAAyBs6B,SAAzB,GAAqC,UAAU55B,KAAV,EAAiBkT,MAAjB,EAAyB;AAC1D;;;;;;;AAOA,gBAAIsmB,UAAU,SAAVA,OAAU,CAAUzc,KAAV,EAAiB;AAC3B,oBAAIhL,SAASmB,OAAOC,YAApB;AACA,oBAAI+S,UAAUhT,OAAOgT,OAArB;AACA,oBAAInU,OAAOsoB,IAAP,CAAYr6B,KAAZ,EAAmB+c,KAAnB,MAA8BhL,OAAOsoB,IAAP,CAAYnU,QAAQ1a,OAApB,EAA6B0a,QAAQllB,MAArC,CAAlC,EAAgF;AAC5E+Q,2BAAOuoB,YAAP,CAAoBt6B,KAApB,EAA2B+c,KAA3B,EAAkC,EAAE9c,SAAS,IAAX,EAAiB0E,QAAQ,KAAzB,EAAlC;AACH;AACJ,aAND;AAOA,gBAAIy1B,UAAU,EAAEp6B,OAAOA,KAAT,EAAgB8L,MAAM,OAAtB,EAAd;AACA,mBAAO3H,OAAO,KAAKw1B,cAAL,CAAoB35B,MAAMsB,GAA1B,EAA+Bk4B,OAA/B,CAAP,EAAgDY,OAAhD,CAAP;AACH,SAjBD;AAkBA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgCAd,uBAAeh6B,SAAf,CAAyBu6B,UAAzB,GAAsC,UAAUz6B,MAAV,EAAkBo6B,OAAlB,EAA2B;AAC7D,gBAAIp6B,OAAOhE,MAAP,IAAiBgE,OAAOm7B,MAA5B,EACI,MAAM,IAAIr3B,KAAJ,CAAU,0CAAV,CAAN;AACJ;;;;;AAKA,gBAAIs3B,gBAAgB,SAAhBA,aAAgB,CAAUzd,KAAV,EAAiB;AACjC;AACA,uBAAOyc,QAAQrd,OAAR,CAAgB,gBAAhB,EAAkC,UAAUma,CAAV,EAAaiD,IAAb,EAAmB;AACxD,2BAAOxc,MAAMwc,SAAS,GAAT,GAAe,CAAf,GAAmBkB,OAAOlB,IAAP,CAAzB,CAAP;AACH,iBAFM,CAAP;AAGH,aALD;AAMA,gBAAIS,WAAW13B,SAASk3B,OAAT,IAAoBgB,aAApB,GAAoChB,OAAnD;AACA,gBAAIzc,QAAQ,SAARA,KAAQ,CAAUzb,GAAV,EAAe;AACvB,uBAAOlC,OAAOK,IAAP,CAAY6B,IAAIsF,IAAhB,CAAP;AACH,aAFD;AAGA,gBAAIwzB,UAAU,EAAEh7B,QAAQA,MAAV,EAAkB0M,MAAM,QAAxB,EAAd;AACA,mBAAO3H,OAAO,IAAI21B,WAAJ,CAAgB/c,KAAhB,EAAuBid,QAAvB,CAAP,EAAyCI,OAAzC,CAAP;AACH,SApBD;AAqBA,eAAOd,cAAP;AACH,KArKqB,EAAtB;AAsKAA,mBAAeoB,SAAf,GAA2B,UAAUv9B,GAAV,EAAe;AACtC,eAAOA,OAAO,CAAC,MAAD,EAAS,OAAT,EAAkB,SAAlB,EAA6B6Z,KAA7B,CAAmC,UAAU9P,GAAV,EAAe;AAAE,mBAAOjF,UAAU9E,IAAI+J,GAAJ,CAAV,CAAP;AAA6B,SAAjF,CAAd;AACH,KAFD;AAGA;;;;;;AAMA,QAAI4yB,cAAe,YAAY;AAC3B,iBAASA,WAAT,CAAqB/c,KAArB,EAA4Byc,OAA5B,EAAqC;AACjC,gBAAIrwB,QAAQ,IAAZ;AACA,iBAAK4T,KAAL,GAAaA,KAAb;AACA,iBAAKjR,IAAL,GAAY,KAAZ;AACA,iBAAKmuB,aAAL,GAAqB,UAAUld,KAAV,EAAiB;AAAE,uBAAO,IAAI5T,MAAM8C,GAAjB;AAAuB,aAA/D;AACA,iBAAKutB,OAAL,GAAeA,WAAWh1B,QAA1B;AACH;AACD,eAAOs1B,WAAP;AACH,KATkB,EAAnB;;AAWA;;;;AAIA;AACA;AACA,aAASa,cAAT,CAAwBr5B,GAAxB,EAA6Bs5B,OAA7B,EAAsCC,QAAtC,EAAgDC,QAAhD,EAA0D;AACtD,YAAIA,aAAa,GAAjB,EACI,OAAOx5B,GAAP;AACJ,YAAIs5B,OAAJ,EACI,OAAOE,SAAS9+B,KAAT,CAAe,CAAf,EAAkB,CAAC,CAAnB,IAAwBsF,GAA/B;AACJ,YAAIu5B,QAAJ,EACI,OAAOC,SAAS9+B,KAAT,CAAe,CAAf,IAAoBsF,GAA3B;AACJ,eAAOA,GAAP;AACH;AACD;AACA,QAAIy5B,aAAa99B,KAAK,YAAL,CAAjB;AACA;;;;;;;;;;;;AAYA,QAAI+9B,iBAAJ;AACAA,wBAAoB5wB,YAAYJ,OAAOnN,KAAKI,KAAK,UAAL,CAAL,EAAuB,UAAUiB,CAAV,EAAa;AAAE,eAAO,CAACA,CAAR;AAAY,KAAlD,CAAP,CAAZ,EAAyE8L,OAAOnN,KAAKI,KAAK,MAAL,CAAL,EAAmB,UAAU6O,IAAV,EAAgB;AAAE,eAAQ,EAAE,SAAS,CAAX,EAAc,cAAc,CAA5B,EAA+B,UAAU,CAAzC,EAA4C,OAAO,CAAnD,EAAsD,SAAS,CAA/D,EAAD,CAAqEA,IAArE,CAAP;AAAoF,KAAzH,CAAP,CAAzE,EAA6M,UAAU3B,CAAV,EAAalM,CAAb,EAAgB;AAAE,eAAQ88B,WAAW5wB,CAAX,KAAiB4wB,WAAW98B,CAAX,CAAlB,GAAmC03B,WAAWvO,OAAX,CAAmB2T,WAAW5wB,CAAX,CAAnB,EAAkC4wB,WAAW98B,CAAX,CAAlC,CAAnC,GAAsF,CAA7F;AAAiG,KAAhU,EAAkU+L,OAAO/M,KAAK,KAAL,CAAP,EAAoBoI,QAAQ,CAAC,QAAD,EAAW,KAAX,EAAkB,OAAlB,CAAR,CAApB,CAAlU,CAApB;AACA;;;;;;;;;;;AAWA,QAAI41B,YAAa,YAAY;AACzB;AACA,iBAASA,SAAT,CAAmB/nB,MAAnB,EAA2B;AACvB,0BAAe,KAAKgoB,OAAL,GAAeF,iBAAf;AACf,0BAAe,KAAKG,MAAL,GAAc,EAAd;AACf,0BAAe,KAAKC,iBAAL,GAAyB,KAAzB;AACf,0BAAe,KAAKC,GAAL,GAAW,CAAX;AACf,0BAAe,KAAKC,OAAL,GAAe,KAAf;AACf,iBAAKrH,OAAL,GAAe/gB,MAAf;AACA,iBAAK6gB,cAAL,GAAsB,IAAIuF,cAAJ,CAAmBpmB,MAAnB,CAAtB;AACAxO,iCAAqBrH,IAAI49B,UAAU37B,SAAd,CAArB,EAA+C,IAA/C,EAAqDjC,IAAI,IAAJ,CAArD;AACH;AACD;AACA49B,kBAAU37B,SAAV,CAAoBktB,OAApB,GAA8B,YAAY;AACtC,iBAAK+O,MAAL,CAAY,KAAZ;AACA,iBAAKJ,MAAL,GAAc,EAAd;AACA,mBAAO,KAAKK,YAAZ;AACH,SAJD;AAKA;AACAP,kBAAU37B,SAAV,CAAoBgZ,IAApB,GAA2B,UAAUmjB,SAAV,EAAqB;AAC5C,iBAAKN,MAAL,CAAY7iB,IAAZ,CAAiB,KAAK4iB,OAAL,GAAeO,aAAa,KAAKP,OAAlD;AACA,iBAAKI,OAAL,GAAe,IAAf;AACH,SAHD;AAIAL,kBAAU37B,SAAV,CAAoBo8B,YAApB,GAAmC,YAAY;AAC3C,iBAAKJ,OAAL,IAAgB,KAAKhjB,IAAL,EAAhB;AACH,SAFD;AAGA;;;;;AAKA2iB,kBAAU37B,SAAV,CAAoByd,KAApB,GAA4B,UAAUzb,GAAV,EAAe;AACvC,gBAAI6H,QAAQ,IAAZ;AACA,iBAAKuyB,YAAL;AACAp6B,kBAAM6C,OAAO,EAAEyC,MAAM,EAAR,EAAYmwB,QAAQ,EAApB,EAAwB7J,MAAM,EAA9B,EAAP,EAA2C5rB,GAA3C,CAAN;AACA,gBAAI0zB,QAAQ,KAAKA,KAAL,EAAZ;AACA,gBAAI,KAAKwG,YAAT,EACIxG,MAAMjvB,IAAN,CAAW,KAAKy1B,YAAhB;AACJ;AACA,gBAAIG,YAAY,SAAZA,SAAY,CAAU7H,IAAV,EAAgB;AAC5B,oBAAI/W,QAAQ+W,KAAK/W,KAAL,CAAWzb,GAAX,EAAgB6H,MAAM8qB,OAAtB,CAAZ;AACA,uBAAOlX,SAAS,EAAEA,OAAOA,KAAT,EAAgB+W,MAAMA,IAAtB,EAA4B8H,QAAQ9H,KAAKmG,aAAL,CAAmBld,KAAnB,CAApC,EAAhB;AACH,aAHD;AAIA;AACA;AACA;AACA;AACA,gBAAI8e,IAAJ;AACA,iBAAK,IAAIn/B,IAAI,CAAb,EAAgBA,IAAIs4B,MAAM54B,MAA1B,EAAkCM,GAAlC,EAAuC;AACnC;AACA,oBAAIm/B,QAAQ,KAAKX,OAAL,CAAalG,MAAMt4B,CAAN,CAAb,EAAuBm/B,KAAK/H,IAA5B,MAAsC,CAAlD,EACI;AACJ,oBAAItoB,UAAUmwB,UAAU3G,MAAMt4B,CAAN,CAAV,CAAd;AACA;AACAm/B,uBAAQ,CAACA,IAAD,IAASrwB,WAAWA,QAAQowB,MAAR,GAAiBC,KAAKD,MAA3C,GAAqDpwB,OAArD,GAA+DqwB,IAAtE;AACH;AACD,mBAAOA,IAAP;AACH,SA1BD;AA2BA;AACAZ,kBAAU37B,SAAV,CAAoBw8B,IAApB,GAA2B,UAAUC,GAAV,EAAe;AACtC,gBAAIA,OAAOA,IAAIC,gBAAf,EACI;AACJ,gBAAI9oB,SAAS,KAAK+gB,OAAlB;AAAA,gBAA2BgI,OAAO/oB,OAAOgpB,UAAzC;AAAA,gBAAqDnqB,SAASmB,OAAOC,YAArE;AACA,gBAAI7R,MAAM;AACNsF,sBAAMq1B,KAAKr1B,IAAL,EADA,EACamwB,QAAQkF,KAAKlF,MAAL,EADrB,EACoC7J,MAAM+O,KAAK/O,IAAL;AAD1C,aAAV;AAGA,gBAAI2O,OAAO,KAAK9e,KAAL,CAAWzb,GAAX,CAAX;AACA,gBAAI66B,cAAcv9B,QAAQ,CACtB,CAAC0D,QAAD,EAAW,UAAU85B,MAAV,EAAkB;AAAE,uBAAOH,KAAK36B,GAAL,CAAS86B,MAAT,EAAiB,IAAjB,CAAP;AAAgC,aAA/D,CADsB,EAEtB,CAAC3qB,YAAYY,KAAb,EAAoB,UAAUiH,GAAV,EAAe;AAAE,uBAAOvH,OAAOsqB,EAAP,CAAU/iB,IAAItZ,KAAd,EAAqBsZ,IAAItY,MAAzB,EAAiCsY,IAAI5M,OAArC,CAAP;AAAuD,aAA5F,CAFsB,EAGtB,CAACtO,GAAGqT,WAAH,CAAD,EAAkB,UAAU7M,MAAV,EAAkB;AAAE,uBAAOmN,OAAOsqB,EAAP,CAAUz3B,OAAO5E,KAAP,EAAV,EAA0B4E,OAAO5D,MAAP,EAA1B,EAA2C4D,OAAO8H,OAAP,EAA3C,CAAP;AAAsE,aAA5G,CAHsB,CAAR,CAAlB;AAKAyvB,wBAAYN,QAAQA,KAAK/H,IAAL,CAAU0F,OAAV,CAAkBqC,KAAK9e,KAAvB,EAA8Bzb,GAA9B,EAAmC4R,MAAnC,CAApB;AACH,SAdD;AAeA;AACA+nB,kBAAU37B,SAAV,CAAoBi8B,MAApB,GAA6B,UAAU5sB,OAAV,EAAmB;AAC5C,gBAAIxF,QAAQ,IAAZ;AACA,gBAAIwF,YAAY,KAAhB,EAAuB;AACnB,qBAAK2tB,OAAL,IAAgB,KAAKA,OAAL,EAAhB;AACA,uBAAO,KAAKA,OAAZ;AACH,aAHD,MAIK;AACD,uBAAO,KAAKA,OAAL,GAAe,KAAKA,OAAL,IAAgB,KAAKrI,OAAL,CAAaiI,UAAb,CAAwBK,QAAxB,CAAiC,UAAUR,GAAV,EAAe;AAAE,2BAAO5yB,MAAM2yB,IAAN,CAAWC,GAAX,CAAP;AAAyB,iBAA3E,CAAtC;AACH;AACJ,SATD;AAUA;;;;AAIAd,kBAAU37B,SAAV,CAAoBk9B,MAApB,GAA6B,UAAUC,IAAV,EAAgB;AACzC,gBAAIR,OAAO,KAAKhI,OAAL,CAAayI,eAAxB;AACA,gBAAID,IAAJ,EAAU;AACN,qBAAKjhB,QAAL,GAAgBygB,KAAKr1B,IAAL,EAAhB;AACA;AACH;AACD,gBAAIq1B,KAAKr1B,IAAL,OAAgB,KAAK4U,QAAzB,EACI;AACJygB,iBAAK36B,GAAL,CAAS,KAAKka,QAAd,EAAwB,IAAxB;AACH,SATD;AAUA;;;;;;;;;;AAUAyf,kBAAU37B,SAAV,CAAoByG,IAApB,GAA2B,UAAUg0B,UAAV,EAAsB/4B,MAAtB,EAA8B0L,OAA9B,EAAuC;AAC9D,gBAAIyP,UAAUzP,WAAW,CAAC,CAACA,QAAQyP,OAAnC;AACA,iBAAK8X,OAAL,CAAaiI,UAAb,CAAwB56B,GAAxB,CAA4By4B,WAAWpO,MAAX,CAAkB3qB,UAAU,EAA5B,CAA5B,EAA6Dmb,OAA7D;AACH,SAHD;AAIA;;;;;;;;;;;;;;;;;;;AAmBA8e,kBAAU37B,SAAV,CAAoB+6B,IAApB,GAA2B,UAAUN,UAAV,EAAsB/4B,MAAtB,EAA8B0L,OAA9B,EAAuC;AAC9D,gBAAIpL,MAAMy4B,WAAWpO,MAAX,CAAkB3qB,MAAlB,CAAV;AACA,gBAAIM,OAAO,IAAX,EACI,OAAO,IAAP;AACJoL,sBAAUA,WAAW,EAAEmuB,UAAU,KAAZ,EAArB;AACA,gBAAI5f,MAAM,KAAKgZ,OAAL,CAAaiI,UAAb,CAAwBt8B,MAAlC;AACA,gBAAIg7B,UAAU3f,IAAI0hB,SAAJ,EAAd;AACA,gBAAI,CAAC/B,OAAD,IAAYt5B,QAAQ,IAAxB,EAA8B;AAC1BA,sBAAM,MAAM2Z,IAAI2hB,UAAJ,EAAN,GAAyBt7B,GAA/B;AACH;AACDA,kBAAMq5B,eAAer5B,GAAf,EAAoBs5B,OAApB,EAA6BluB,QAAQmuB,QAArC,EAA+C5f,IAAI6f,QAAJ,EAA/C,CAAN;AACA,gBAAI,CAACpuB,QAAQmuB,QAAT,IAAqB,CAACv5B,GAA1B,EAA+B;AAC3B,uBAAOA,GAAP;AACH;AACD,gBAAIu7B,QAAS,CAACjC,OAAD,IAAYt5B,GAAZ,GAAkB,GAAlB,GAAwB,EAArC;AAAA,gBAA0Cw7B,OAAO7hB,IAAI6hB,IAAJ,EAAjD;AACAA,mBAAQA,SAAS,EAAT,IAAeA,SAAS,GAAxB,GAA8B,EAA9B,GAAmC,MAAMA,IAAjD;AACA,mBAAO,CAAC7hB,IAAI8hB,QAAJ,EAAD,EAAiB,KAAjB,EAAwB9hB,IAAI+hB,IAAJ,EAAxB,EAAoCF,IAApC,EAA0CD,KAA1C,EAAiDv7B,GAAjD,EAAsDnC,IAAtD,CAA2D,EAA3D,CAAP;AACH,SAjBD;AAkBA;;;;;;;;;;;;AAYA87B,kBAAU37B,SAAV,CAAoBw0B,IAApB,GAA2B,UAAUA,IAAV,EAAgB;AACvC,gBAAI3qB,QAAQ,IAAZ;AACA,gBAAI,CAACmwB,eAAeoB,SAAf,CAAyB5G,IAAzB,CAAL,EACI,MAAM,IAAI5wB,KAAJ,CAAU,cAAV,CAAN;AACJ4wB,iBAAK7nB,GAAL,GAAW,KAAKovB,GAAL,EAAX;AACAvH,iBAAKhe,QAAL,GAAgBge,KAAKhe,QAAL,IAAiB,CAAjC;AACA,iBAAKqlB,MAAL,CAAYp1B,IAAZ,CAAiB+tB,IAAjB;AACA,iBAAKwH,OAAL,GAAe,KAAf;AACA,mBAAO,YAAY;AAAE,uBAAOnyB,MAAM8rB,UAAN,CAAiBnB,IAAjB,CAAP;AAAgC,aAArD;AACH,SATD;AAUA;AACAmH,kBAAU37B,SAAV,CAAoB21B,UAApB,GAAiC,UAAUnB,IAAV,EAAgB;AAC7CruB,uBAAW,KAAK01B,MAAhB,EAAwBrH,IAAxB;AACH,SAFD;AAGA;AACAmH,kBAAU37B,SAAV,CAAoB01B,KAApB,GAA4B,YAAY;AACpC,iBAAK0G,YAAL;AACA,mBAAO,KAAKP,MAAL,CAAYn/B,KAAZ,EAAP;AACH,SAHD;AAIA;AACAi/B,kBAAU37B,SAAV,CAAoB29B,SAApB,GAAgC,UAAUzD,OAAV,EAAmB;AAC/C,gBAAI0D,YAAYC,aAAa3D,OAAb,CAAhB;AACA,iBAAKgC,YAAL,GAAoB,KAAKzH,cAAL,CAAoBl0B,MAApB,CAA2BxC,IAAI,IAAJ,CAA3B,EAAsC6/B,SAAtC,CAApB;AACA,iBAAK5B,OAAL,GAAe,KAAf;AACH,SAJD;;AAMA;AACAL,kBAAU37B,SAAV,CAAoB89B,OAApB,GAA8B,UAAU5D,OAAV,EAAmB;AAC7C,gBAAI0D,YAAYC,aAAa3D,OAAb,CAAhB;AACA,gBAAI9jB,UAAU,SAAVA,OAAU,CAAU2nB,QAAV,EAAoBnqB,MAApB,EAA4B;AACtC,uBAAOA,OAAOgT,OAAP,CAAekE,iBAAf,CAAiC9e,IAAjC,OAA4C,CAA5C,IAAiD,CAAC,CAAC,QAAQ7L,IAAR,CAAa49B,SAASz2B,IAAtB,CAA1D;AACH,aAFD;AAGA,iBAAKktB,IAAL,CAAU,KAAKC,cAAL,CAAoBl0B,MAApB,CAA2B6V,OAA3B,EAAoCwnB,SAApC,CAAV;AACH,SAND;;AAQA;AACAjC,kBAAU37B,SAAV,CAAoB8Q,IAApB,GAA2B,UAAUmhB,OAAV,EAAmBiI,OAAnB,EAA4B9sB,OAA5B,EAAqC;AAC5D,gBAAIonB,OAAO,KAAKC,cAAL,CAAoBl0B,MAApB,CAA2B0xB,OAA3B,EAAoCiI,OAApC,CAAX;AACA,gBAAIv3B,UAAUyK,WAAWA,QAAQoJ,QAA7B,CAAJ,EACIge,KAAKhe,QAAL,GAAgBpJ,QAAQoJ,QAAxB;AACJ,iBAAKge,IAAL,CAAUA,IAAV;AACA,mBAAOA,IAAP;AACH,SAND;;AAQA;AACAmH,kBAAU37B,SAAV,CAAoBg+B,cAApB,GAAqC,UAAUtX,KAAV,EAAiB;AAClD,gBAAIA,UAAU3iB,SAAd,EACI2iB,QAAQ,IAAR;AACJ,iBAAKoV,iBAAL,GAAyBpV,KAAzB;AACH,SAJD;;AAMA,eAAOiV,SAAP;AACH,KAtNgB,EAAjB;AAuNA,aAASkC,YAAT,CAAsB3D,OAAtB,EAA+B;AAC3B,YAAI,CAAC/3B,WAAW+3B,OAAX,CAAD,IAAwB,CAACl3B,SAASk3B,OAAT,CAAzB,IAA8C,CAACp7B,GAAGqT,WAAH,EAAgB+nB,OAAhB,CAA/C,IAA2E,CAAC/nB,YAAYY,KAAZ,CAAkBmnB,OAAlB,CAAhF,EAA4G;AACxG,kBAAM,IAAIt2B,KAAJ,CAAU,0FAAV,CAAN;AACH;AACD,eAAOzB,WAAW+3B,OAAX,IAAsBA,OAAtB,GAAgCn8B,IAAIm8B,OAAJ,CAAvC;AACH;;AAED;;;OAr2K2C,CAw2KvC;AACJ;;;;;;;;;;;;;;;;AAgBA,QAAI+D,cAAe,YAAY;AAC3B,iBAASA,WAAT,GAAuB;AACnB,gBAAIp0B,QAAQ,IAAZ;AACA,iBAAKq0B,QAAL,GAAgB,EAAhB;AACA,iBAAKC,YAAL,GAAoB,EAApB;AACA,iBAAKC,oBAAL,GAA4B,EAA5B;AACA,iBAAKtnB,UAAL,GAAkB;AACdunB,kCAAkB,KAAKA,gBAAL,CAAsB/5B,IAAtB,CAA2B,IAA3B,CADJ;AAEdg6B,oCAAoB,KAAKA,kBAAL,CAAwBh6B,IAAxB,CAA6B,IAA7B,CAFN;AAGdi6B,oCAAoB,8BAAY;AAAE,2BAAO10B,MAAMq0B,QAAb;AAAwB,iBAH5C;AAIdM,oCAAoB,8BAAY;AAAE,2BAAO30B,MAAMs0B,YAAb;AAA4B;AAJhD,aAAlB;AAMH;AACDF,oBAAYj+B,SAAZ,CAAsBq+B,gBAAtB,GAAyC,UAAU/tB,OAAV,EAAmB;AACxD,mBAAO,KAAKmuB,YAAL,GAAoBnuB,WAAW,KAAKmuB,YAA3C;AACH,SAFD;;AAIAR,oBAAYj+B,SAAZ,CAAsBs+B,kBAAtB,GAA2C,UAAUI,QAAV,EAAoB3iC,OAApB,EAA6B;AACpE,iBAAKqiC,oBAAL,CAA0BM,QAA1B,IAAsC3iC,OAAtC;AACH,SAFD;AAGAkiC,oBAAYj+B,SAAZ,CAAsBqgB,gBAAtB,GAAyC,UAAU/Y,IAAV,EAAgByqB,IAAhB,EAAsB;AAC3D,gBAAI4M,aAAa,KAAKP,oBAAL,CAA0BrM,KAAK6M,KAA/B,CAAjB;AACA,gBAAI,CAACD,UAAL,EACI,MAAM,IAAI/6B,KAAJ,CAAU,6DAA6DmuB,KAAK6M,KAA5E,CAAN;AACJ,gBAAIC,OAAOF,WAAWr3B,IAAX,EAAiByqB,IAAjB,CAAX;AACA,mBAAO9uB,QAAQ47B,IAAR,IAAgBA,IAAhB,GAAuB,CAACA,IAAD,CAA9B;AACH,SAND;AAOA;;;;;;;;AAQAZ,oBAAYj+B,SAAZ,CAAsB8+B,oBAAtB,GAA6C,UAAUzwB,UAAV,EAAsB;AAC/D2D,kBAAMH,qBAAN,CAA4B,aAA5B,EAA2CxD,UAA3C;AACAlI,uBAAW,KAAKg4B,YAAhB,EAA8B9vB,UAA9B;AACH,SAHD;AAIA4vB,oBAAYj+B,SAAZ,CAAsB++B,kBAAtB,GAA2C,UAAU1wB,UAAV,EAAsB;AAC7D2D,kBAAMH,qBAAN,CAA4B,gBAA5B,EAA8CxD,UAA9C;AACA,iBAAK8vB,YAAL,CAAkB13B,IAAlB,CAAuB4H,UAAvB;AACH,SAHD;AAIA4vB,oBAAYj+B,SAAZ,CAAsBw8B,IAAtB,GAA6B,YAAY;AACrC,gBAAI3yB,QAAQ,IAAZ;AACA,gBAAIm1B,eAAe,KAAKd,QAAL,CAAchgC,GAAd,CAAkB,UAAU+gC,GAAV,EAAe;AAAE,uBAAO,CAACA,IAAIh+B,GAAL,EAAUg+B,GAAV,CAAP;AAAwB,aAA3D,EAA6DvgC,MAA7D,CAAoE6K,UAApE,EAAgF,EAAhF,CAAnB;AACA;AACA;AACA;AACA,qBAAS21B,WAAT,CAAqBC,MAArB,EAA6B;AACzB,oBAAIC,aAAa,SAAbA,UAAa,CAAU9uB,OAAV,EAAmB;AAChC,2BAAOA,WAAWA,QAAQpP,MAAnB,GAA4Bk+B,WAAW9uB,QAAQpP,MAAnB,IAA6B,CAAzD,GAA6D,CAApE;AACH,iBAFD;AAGA,uBAAQi+B,OAAOl+B,GAAP,CAAWhD,KAAX,CAAiB,GAAjB,EAAsBnB,MAAtB,GAA+B,KAAhC,GAAyCsiC,WAAWD,OAAOhxB,eAAlB,CAAhD;AACH;AACD;AACA,qBAASkxB,eAAT,CAAyB/+B,MAAzB,EAAiC;AAC7B,oBAAIgQ,UAAUhQ,OAAOgO,QAAP,CAAgBC,QAA9B;AAAA,oBAAwC+wB,QAAQ,CAAhD;AACA,uBAAO,EAAEA,KAAF,IAAWhvB,QAAQpP,MAA1B;AACIoP,8BAAUA,QAAQpP,MAAlB;AADJ,iBAEA,OAAOo+B,KAAP;AACH;AACD;AACA,gBAAIC,eAAehjC,MAAM,UAAUijC,OAAV,EAAmBC,MAAnB,EAA2BtkB,IAA3B,EAAiCC,KAAjC,EAAwC;AAAE,uBAAOqkB,UAAUD,QAAQrkB,IAAR,IAAgBqkB,QAAQpkB,KAAR,CAA1B,CAAP;AAAmD,aAAnG,CAAnB;AACA,gBAAIskB,qBAAqB,SAArBA,kBAAqB,CAAUP,MAAV,EAAkB;AACvC,oBAAIQ,kBAAkB91B,MAAMs0B,YAAN,CAAmBx8B,MAAnB,CAA0Bs8B,YAAYh+B,OAAZ,CAAoB++B,YAApB,EAAkCG,MAAlC,CAA1B,CAAtB;AACA,oBAAIQ,gBAAgB7iC,MAAhB,GAAyB,CAA7B,EAAgC;AAC5B;AACA;AACA;AACA6iC,oCAAgB3mB,IAAhB,CAAqBumB,aAAaF,eAAb,EAA8B,CAAC,CAA/B,CAArB,EAJ4B,CAI6B;AAC5D;AACD,uBAAO,CAACF,MAAD,EAASQ,gBAAgB,CAAhB,CAAT,CAAP;AACH,aATD;AAUA,gBAAIC,kBAAkB,SAAlBA,eAAkB,CAAU9yB,EAAV,EAAc;AAChC,oBAAIqyB,SAASryB,GAAG,CAAH,CAAb;AAAA,oBAAoBuB,aAAavB,GAAG,CAAH,CAAjC;AACA;AACA;AACA,oBAAIjD,MAAMq0B,QAAN,CAAeh4B,OAAf,CAAuBi5B,MAAvB,MAAmC,CAAC,CAAxC,EACIA,OAAOU,aAAP,CAAqBxxB,UAArB;AACP,aAND;AAOA;AACA,iBAAK6vB,QAAL,CAAcllB,IAAd,CAAmBumB,aAAaL,WAAb,EAA0B,CAA1B,CAAnB,EAAiDhhC,GAAjD,CAAqDwhC,kBAArD,EAAyE/6B,OAAzE,CAAiFi7B,eAAjF;AACH,SAxCD;;AA0CA;;;;;;;;;;;;;;;AAeA3B,oBAAYj+B,SAAZ,CAAsB8/B,cAAtB,GAAuC,UAAUX,MAAV,EAAkB;AACrDntB,kBAAMD,2BAAN,CAAkC,gBAAlC,EAAoDotB,MAApD;AACA,gBAAIY,UAAU,KAAK7B,QAAnB;AACA,gBAAI8B,aAAa,SAAbA,UAAa,CAAUf,GAAV,EAAe;AAAE,uBAAOA,IAAIh+B,GAAJ,KAAYk+B,OAAOl+B,GAA1B;AAAgC,aAAlE;AACA,gBAAI8+B,QAAQp+B,MAAR,CAAeq+B,UAAf,EAA2BljC,MAA/B,EACIkV,MAAMD,2BAAN,CAAkC,8BAAlC,EAAkEotB,MAAlE;AACJY,oBAAQt5B,IAAR,CAAa04B,MAAb;AACA,iBAAK3C,IAAL;AACA,mBAAO,YAAY;AACf,oBAAIn2B,MAAM05B,QAAQ75B,OAAR,CAAgBi5B,MAAhB,CAAV;AACA,oBAAI94B,QAAQ,CAAC,CAAb,EAAgB;AACZ2L,0BAAMD,2BAAN,CAAkC,sCAAlC,EAA0EotB,MAA1E;AACA;AACH;AACDntB,sBAAMD,2BAAN,CAAkC,kBAAlC,EAAsDotB,MAAtD;AACAh5B,2BAAW45B,OAAX,EAAoBZ,MAApB;AACH,aARD;AASH,SAjBD;;AAmBA;;;;;AAKAlB,oBAAYj+B,SAAZ,CAAsBigC,SAAtB,GAAkC,YAAY;AAC1C,mBAAO,KAAK/B,QAAL,CAAchgC,GAAd,CAAkBP,KAAK,KAAL,CAAlB,CAAP;AACH,SAFD;AAGA;;;;;AAKAsgC,oBAAYj+B,SAAZ,CAAsBkgC,MAAtB,GAA+B,YAAY;AACvC,mBAAO,KAAKhC,QAAL,CAAcv8B,MAAd,CAAqBhE,KAAK,SAAL,CAArB,EAAsCO,GAAtC,CAA0CP,KAAK,MAAL,CAA1C,CAAP;AACH,SAFD;AAGA;;;;;;;;;;;AAWAsgC,oBAAYkC,qBAAZ,GAAoC,UAAU7vB,OAAV,EAAmB8vB,WAAnB,EAAgC;AAChE,gBAAIA,gBAAgB,KAAK,CAAzB,EAA4B;AAAEA,8BAAc,EAAd;AAAmB;AACjD;AACA;AACA;AACA,gBAAIC,gBAAgBD,YAAYniC,KAAZ,CAAkB,GAAlB,CAApB;AACA,gBAAIqiC,aAAaD,cAAc,CAAd,KAAoB,UAArC,CANgE,CAMf;AACjD,gBAAIE,sBAAsBv9B,SAASq9B,cAAc,CAAd,CAAT,IAA6BA,cAAc,CAAd,CAA7B,GAAgD,GAA1E,CAPgE,CAOe;AAC/E;AACA;AACA,gBAAIG,wBAAwB,wBAAwBrgC,IAAxB,CAA6BmgC,UAA7B,CAA5B;AACA,gBAAIE,qBAAJ,EAA2B;AACvB;AACAD,sCAAsBC,sBAAsB,CAAtB,CAAtB,CAFuB,CAEyB;AAChDF,6BAAaE,sBAAsB,CAAtB,CAAb,CAHuB,CAGgB;AAC1C;AACD,gBAAIF,WAAWtR,MAAX,CAAkB,CAAlB,MAAyB,GAA7B,EAAkC;AAC9BsR,6BAAaA,WAAWjmB,MAAX,CAAkB,CAAlB,CAAb;AACAkmB,sCAAsB,EAAtB,CAF8B,CAEJ;AAC7B;AACD;AACA,gBAAIE,gBAAgB,iBAApB;AACA,gBAAIA,cAActgC,IAAd,CAAmBogC,mBAAnB,CAAJ,EAA6C;AACzC,oBAAIG,SAASH,oBAAoBtiC,KAApB,CAA0B,GAA1B,EAA+BS,MAA/B,CAAuC,UAAUgiC,MAAV,EAAkB9hC,CAAlB,EAAqB;AAAE,2BAAO8hC,OAAOx/B,MAAd;AAAuB,iBAArF,EAAwFoP,OAAxF,CAAb;AACAiwB,sCAAsBG,OAAO9iC,IAA7B;AACH,aAHD,MAIK,IAAI2iC,wBAAwB,GAA5B,EAAiC;AAClCA,sCAAsBjwB,QAAQ1S,IAA9B;AACH;AACD,mBAAO,EAAE0iC,YAAYA,UAAd,EAA0BC,qBAAqBA,mBAA/C,EAAP;AACH,SA9BD;AA+BA,eAAOtC,WAAP;AACH,KAlLkB,EAAnB;AAmLA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyDAA,gBAAYh+B,OAAZ,GAAsB,UAAU++B,YAAV,EAAwBG,MAAxB,EAAgC;AAAE,eAAO,UAAU9wB,UAAV,EAAsB;AACjF;AACA,gBAAI8wB,OAAOP,KAAP,KAAiBvwB,WAAWC,QAAX,CAAoBswB,KAAzC,EACI,OAAO,KAAP;AACJ;AACA,gBAAI+B,KAAKtyB,WAAWC,QAApB;AACA,gBAAIsyB,aAAaD,GAAGnyB,WAAH,CAAevQ,KAAf,CAAqB,GAArB,CAAjB;AACA,gBAAI4iC,cAAc1B,OAAOl+B,GAAP,CAAWhD,KAAX,CAAiB,GAAjB,CAAlB;AACA;AACA;AACA,gBAAI,CAAC+G,OAAO47B,UAAP,EAAmBC,YAAYnkC,KAAZ,CAAkB,IAAIkkC,WAAW9jC,MAAjC,CAAnB,CAAL,EACI,OAAO,KAAP;AACJ;AACA;AACA,gBAAIgkC,YAAa,IAAIF,WAAW9jC,MAAhB,IAA2BiH,SAA3C;AACA,gBAAIg9B,oBAAoBF,YAAYnkC,KAAZ,CAAkB,CAAlB,EAAqBokC,SAArB,EAAgCjhC,IAAhC,CAAqC,GAArC,CAAxB;AACA,gBAAImhC,gBAAgBhC,aAAa+B,iBAAb,EAAgC5yB,eAApD;AACA,mBAAOwyB,GAAGlyB,oBAAH,MAA6BuyB,iBAAiBA,cAAcpjC,IAA5D,CAAP;AACH,SAlBuD;AAkBpD,KAlBJ;;AAoBA;;;OAznL2C,CA4nLvC;AACJ;;;;;;AAMA,QAAIqjC,kBAAmB,YAAY;AAC/B,iBAASA,eAAT,GAA2B;AACvB;;;;;AAKA,iBAAKv/B,MAAL,GAAc,IAAI8sB,WAAJ,EAAd;AACA;AACA,iBAAK3D,uBAAL,GAA+B,CAAC,CAAhC;AACA;AACA,iBAAKC,iBAAL,GAAyB,IAAIrf,KAAJ,CAAU,EAAV,EAAc,CAAd,CAAzB;AACA;AACA,iBAAKy1B,qBAAL,GAA6B,IAAIz1B,KAAJ,CAAU,EAAV,EAAc,CAAd,CAA7B;AACH;AACDw1B,wBAAgBjhC,SAAhB,CAA0BktB,OAA1B,GAAoC,YAAY;AAC5C,iBAAKpC,iBAAL,CAAuB7e,KAAvB;AACA,iBAAKi1B,qBAAL,CAA2Bj1B,KAA3B;AACA,iBAAKgH,UAAL,GAAkB,IAAlB;AACH,SAJD;AAKA,eAAOguB,eAAP;AACH,KArBsB,EAAvB;;AAuBA;;;OA1pL2C,CA6pLvC;AACJ;AACA,QAAIE,WAAW,SAAXA,QAAW,CAAUv7B,IAAV,EAAgB;AAC3B,eAAOA,KAAKlH,MAAL,CAAY,UAAUmH,GAAV,EAAe+B,GAAf,EAAoB;AAAE,mBAAQ/B,IAAI+B,GAAJ,IAAWlE,eAAekE,GAAf,CAAX,EAAgC/B,GAAxC;AAA+C,SAAjF,EAAmF,EAAEqnB,SAAS/nB,MAAX,EAAnF,CAAP;AACH,KAFD;AAGA,kBAAe,IAAIi8B,sBAAsB,CAAC,KAAD,EAAQ,MAAR,EAAgB,QAAhB,EAA0B,MAA1B,EAAkC,UAAlC,CAA1B;AACf,kBAAe,IAAIC,oBAAoB,CAAC,MAAD,EAAS,UAAT,EAAqB,MAArB,EAA6B,UAA7B,EAAyC,WAAzC,EAAsD,YAAtD,CAAxB;AACf,kBAAe,IAAIC,SAAS,CAAC,MAAD,EAAS,iBAAT,EAA4B,YAA5B,EAA0C,qBAA1C,CAAb;AACf,kBAAe,IAAIC,WAAW,CAAC,MAAD,EAAS,MAAT,EAAiB,SAAjB,EAA4B,WAA5B,EAAyC,OAAzC,EAAkD,MAAlD,EAA0D,YAA1D,CAAf;AACf,kBAAe,IAAIC,UAAU,CAAC,gBAAD,EAAmB,QAAnB,EAA6B,MAA7B,EAAqC,OAArC,CAAd;AACf;;;AAGA,QAAIC,aAAc,YAAY;AAC1B;AACA,iBAASA,UAAT,CAAoB7tB,MAApB,EAA4B8tB,QAA5B,EAAsC;AAClC,gBAAIA,aAAa,KAAK,CAAtB,EAAyB;AAAEA,2BAAW,IAAX;AAAkB;AAC7C,iBAAK9tB,MAAL,GAAcA,MAAd;AACA,iBAAK8hB,KAAL,GAAa,EAAb;AACA,iBAAKp1B,MAAL,GAAc,EAAd;AACA;AACA,gBAAIqhC,mBAAmB,SAAnBA,gBAAmB,GAAY;AAAE,uBAAO/tB,OAAOwpB,eAAd;AAAgC,aAArE;AACAh4B,iCAAqBu8B,gBAArB,EAAuC,IAAvC,EAA6CA,gBAA7C,EAA+DP,mBAA/D,EAAoFM,QAApF;AACA,gBAAIE,iBAAiB,SAAjBA,cAAiB,GAAY;AAAE,uBAAOhuB,OAAOguB,cAAd;AAA+B,aAAlE;AACAx8B,iCAAqBw8B,cAArB,EAAqC,KAAKthC,MAA1C,EAAkDshC,cAAlD,EAAkEP,iBAAlE,EAAqFK,QAArF;AACA,gBAAIG,MAAM,SAANA,GAAM,GAAY;AAAE,uBAAOjuB,OAAOsJ,iBAAd;AAAkC,aAA1D;AACA9X,iCAAqBy8B,GAArB,EAA0B,KAAKvhC,MAA/B,EAAuCuhC,GAAvC,EAA4CP,MAA5C;AACA,gBAAIzM,YAAY,SAAZA,SAAY,GAAY;AAAE,uBAAOjhB,OAAOihB,SAAd;AAA0B,aAAxD;AACAzvB,iCAAqByvB,SAArB,EAAgC,KAAKa,KAArC,EAA4Cb,SAA5C,EAAuD0M,QAAvD;AACAn8B,iCAAqByvB,SAArB,EAAgC,IAAhC,EAAsCA,SAAtC,EAAiD2M,OAAjD;AACH;AACDC,mBAAWzhC,SAAX,CAAqBgC,GAArB,GAA2B,UAAU86B,MAAV,EAAkBjgB,OAAlB,EAA2Bnc,KAA3B,EAAkC;AAAE;AAAS,SAAxE;;AAEA;AACA+gC,mBAAWzhC,SAAX,CAAqBsH,IAArB,GAA4B,YAAY;AAAE;AAAS,SAAnD;;AAEA;AACAm6B,mBAAWzhC,SAAX,CAAqBy3B,MAArB,GAA8B,YAAY;AAAE;AAAS,SAArD;;AAEA;AACAgK,mBAAWzhC,SAAX,CAAqB4tB,IAArB,GAA4B,YAAY;AAAE;AAAS,SAAnD;;AAEA;AACA6T,mBAAWzhC,SAAX,CAAqBi9B,QAArB,GAAgC,UAAUj1B,QAAV,EAAoB;AAAE;AAAS,SAA/D;;AAEA;;;;;;;AAOAy5B,mBAAWzhC,SAAX,CAAqB8hC,KAArB,GAA6B,YAAY;AACrC,mBAAO,EAAEx6B,MAAM,KAAKA,IAAL,EAAR,EAAqBmwB,QAAQ,KAAKA,MAAL,EAA7B,EAA4C7J,MAAM,KAAKA,IAAL,EAAlD,EAAP;AACH,SAFD;AAGA6T,mBAAWzhC,SAAX,CAAqBktB,OAArB,GAA+B,YAAY,CAAG,CAA9C;AACA;AACAuU,mBAAWzhC,SAAX,CAAqBw8B,IAArB,GAA4B,UAAUC,GAAV,EAAe;AAAE;AAAS,SAAtD;AACA;AACAgF,mBAAWzhC,SAAX,CAAqBi8B,MAArB,GAA8B,UAAU5sB,OAAV,EAAmB;AAAE;AAAS,SAA5D;;AAEA;AACAoyB,mBAAWzhC,SAAX,CAAqBg+B,cAArB,GAAsC,UAAUtX,KAAV,EAAiB;AAAE;AAAS,SAAlE;AACA;AACA+a,mBAAWzhC,SAAX,CAAqByd,KAArB,GAA6B,UAAUsgB,QAAV,EAAoB;AAAE;AAAS,SAA5D;AACA,eAAO0D,UAAP;AACH,KArDiB,EAAlB;AAsDA;AACAA,eAAWM,mBAAX,GAAiCZ,SAASC,mBAAT,CAAjC;AACA;AACAK,eAAWO,kBAAX,GAAgCb,SAASE,iBAAT,CAAhC;;AAEA;;;OAruL2C,CAwuLvC;AACJ;AACA,QAAIY,kBAAkB,CAAtB;AACA;;;;;;;;;;;;;;;AAeA,QAAIC,WAAY,YAAY;AACxB;;;;;;;AAOA,iBAASA,QAAT,CAAkB9E,eAAlB,EAAmCwE,cAAnC,EAAmD;AAC/C,gBAAIxE,oBAAoB,KAAK,CAA7B,EAAgC;AAAEA,kCAAkBqE,WAAWM,mBAA7B;AAAmD;AACrF,gBAAIH,mBAAmB,KAAK,CAA5B,EAA+B;AAAEA,iCAAiBH,WAAWO,kBAA5B;AAAiD;AAClF,iBAAK5E,eAAL,GAAuBA,eAAvB;AACA,iBAAKwE,cAAL,GAAsBA,cAAtB;AACA,0BAAe,KAAKj1B,GAAL,GAAWs1B,iBAAX;AACf,0BAAe,KAAKptB,SAAL,GAAiB,KAAjB;AACf,0BAAe,KAAKstB,YAAL,GAAoB,EAApB;AACf;AACA,iBAAKnwB,KAAL,GAAaA,KAAb;AACA;AACA,iBAAKowB,WAAL,GAAmB,IAAInE,WAAJ,EAAnB;AACA;AACA,iBAAKpmB,iBAAL,GAAyB,IAAIwqB,iBAAJ,CAAsB,IAAtB,CAAzB;AACA;AACA,iBAAKzb,OAAL,GAAe,IAAIqa,eAAJ,EAAf;AACA;;;;AAIA,iBAAK/jB,iBAAL,GAAyB,IAAIsc,iBAAJ,EAAzB;AACA;;;;AAIA,iBAAK3E,SAAL,GAAiB,IAAI8G,SAAJ,CAAc,IAAd,CAAjB;AACA;AACA,iBAAK2G,aAAL,GAAqB,IAAI5N,aAAJ,CAAkB,IAAlB,CAArB;AACA;AACA,iBAAK7gB,YAAL,GAAoB,IAAI0uB,YAAJ,CAAiB,IAAjB,CAApB;AACA;AACA,iBAAK3F,UAAL,GAAkB,IAAI6E,UAAJ,CAAe,IAAf,CAAlB;AACA;AACA,iBAAKe,QAAL,GAAgB,EAAhB;AACA,iBAAKJ,WAAL,CAAiBtrB,UAAjB,CAA4BunB,gBAA5B,CAA6C,KAAKiE,aAAL,CAAmBnhC,IAAnB,EAA7C;AACA,iBAAKylB,OAAL,CAAa+H,QAAb,GAAwB,KAAK2T,aAAL,CAAmBnhC,IAAnB,EAAxB;AACA,iBAAKylB,OAAL,CAAa1a,OAAb,GAAuB,KAAK0a,OAAL,CAAa+H,QAAb,CAAsB9tB,IAA7C;AACA,iBAAK4hC,UAAL,CAAgB,KAAK7b,OAArB;AACA,iBAAK6b,UAAL,CAAgB,KAAK5uB,YAArB;AACA,iBAAK4uB,UAAL,CAAgB,KAAKH,aAArB;AACA,iBAAKG,UAAL,CAAgB,KAAK5qB,iBAArB;AACA,iBAAK4qB,UAAL,CAAgB,KAAK5N,SAArB;AACA,iBAAK4N,UAAL,CAAgBrF,eAAhB;AACA,iBAAKqF,UAAL,CAAgBb,cAAhB;AACH;AACD;AACAM,iBAASliC,SAAT,CAAmByiC,UAAnB,GAAgC,UAAUA,UAAV,EAAsB;AAClD,iBAAKN,YAAL,CAAkB17B,IAAlB,CAAuBg8B,UAAvB;AACH,SAFD;AAGA;;;;;;;;;;AAUAP,iBAASliC,SAAT,CAAmBktB,OAAnB,GAA6B,UAAUuV,UAAV,EAAsB;AAC/C,gBAAI54B,QAAQ,IAAZ;AACA,gBAAI44B,cAActgC,WAAWsgC,WAAWvV,OAAtB,CAAlB,EAAkD;AAC9CuV,2BAAWvV,OAAX,CAAmB,IAAnB;AACA,uBAAOnpB,SAAP;AACH;AACD,iBAAK8Q,SAAL,GAAiB,IAAjB;AACA,iBAAKstB,YAAL,CAAkBzlC,KAAlB,GAA0BiI,OAA1B,CAAkC,UAAUkI,CAAV,EAAa;AAC3C,oBAAI;AACA,2BAAOA,EAAEqgB,OAAT,KAAqB,UAArB,IAAmCrgB,EAAEqgB,OAAF,CAAUrjB,KAAV,CAAnC;AACA1D,+BAAW0D,MAAMs4B,YAAjB,EAA+Bt1B,CAA/B;AACH,iBAHD,CAIA,OAAOa,OAAP,EAAgB,CAAG;AACtB,aAND;AAOH,SAdD;AAeA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqDAw0B,iBAASliC,SAAT,CAAmB0iC,MAAnB,GAA4B,UAAUA,MAAV,EAAkBt1B,OAAlB,EAA2B;AACnD,gBAAIA,YAAY,KAAK,CAArB,EAAwB;AAAEA,0BAAU,EAAV;AAAe;AACzC,gBAAIu1B,iBAAiB,IAAID,MAAJ,CAAW,IAAX,EAAiBt1B,OAAjB,CAArB;AACA,gBAAI,CAACu1B,eAAe/kC,IAApB,EACI,MAAM,IAAIgG,KAAJ,CAAU,iDAAiD++B,cAA3D,CAAN;AACJ,iBAAKR,YAAL,CAAkB17B,IAAlB,CAAuBk8B,cAAvB;AACA,mBAAO,KAAKH,QAAL,CAAcG,eAAe/kC,IAA7B,IAAqC+kC,cAA5C;AACH,SAPD;AAQAT,iBAASliC,SAAT,CAAmB4iC,SAAnB,GAA+B,UAAUC,UAAV,EAAsB;AACjD,mBAAOA,aAAa,KAAKL,QAAL,CAAcK,UAAd,CAAb,GAAyCphC,OAAO,KAAK+gC,QAAZ,CAAhD;AACH,SAFD;AAGA,eAAON,QAAP;AACH,KAnJe,EAAhB;;AAqJA,wBA/4L2C,CA+4LtB;AACrB,aAASY,kBAAT,CAA4B9zB,KAA5B,EAAmC;AAC/BA,cAAMmZ,aAAN,CAAoB,EAAEzf,OAAOw5B,QAAT,EAAmBxf,MAAM,EAAzB,EAA6BD,WAAW,qBAAY;AAAE,uBAAOzT,MAAM4E,MAAb;AAAsB,aAA5E,EAA8E1C,MAAMlC,MAAM4E,MAA1F,EAApB,EAAwH,EAAxH;AACA5E,cAAMmZ,aAAN,CAAoB,EAAEzf,OAAO8d,UAAT,EAAqB9D,MAAM,EAA3B,EAA+BD,WAAW,qBAAY;AAAE,uBAAOzT,KAAP;AAAe,aAAvE,EAAyEkC,MAAMlC,KAA/E,EAApB,EAA4G,EAA5G;AACAA,cAAMmZ,aAAN,CAAoB,EAAEzf,OAAO,cAAT,EAAyBga,MAAM,EAA/B,EAAmCD,WAAW,qBAAY;AAAE,uBAAOzT,KAAP;AAAe,aAA3E,EAA6EkC,MAAMlC,KAAnF,EAApB,EAAgH,EAAhH;AACAA,cAAMmZ,aAAN,CAAoB,EAAEzf,OAAO,cAAT,EAAyBga,MAAM,EAA/B,EAAmCD,WAAW,qBAAY;AAAE,uBAAOzT,MAAMtN,MAAN,EAAP;AAAwB,aAApF,EAAsFwP,MAAMlC,MAAMtN,MAAN,EAA5F,EAApB,EAAkI,EAAlI;AACAsN,cAAM2S,QAAN,GAAiBhd,OAAjB,CAAyB,UAAUjE,KAAV,EAAiB;AACtCsO,kBAAMmZ,aAAN,CAAoB,EAAEzf,OAAO,SAAT,EAAoBga,MAAM,EAA1B,EAA8BD,WAAW,qBAAY;AAAE,2BAAO/hB,KAAP;AAAe,iBAAtE,EAAwEwQ,MAAMxQ,KAA9E,EAApB,EAA2GA,KAA3G;AACH,SAFD;AAGH;AACD,QAAIqiC,6BAA6B,SAA7BA,0BAA6B,CAAUlrB,iBAAV,EAA6B;AAC1D,eAAOA,kBAAkBmrB,QAAlB,CAA2B,EAA3B,EAA+BF,kBAA/B,CAAP;AACH,KAFD;;AAIA,wBA75L2C,CA65LtB;AACrB;;;;;;;AAOA,QAAIG,iBAAiB,SAAjBA,cAAiB,CAAUj0B,KAAV,EAAiB;AAClC,YAAIyZ,WAAWzZ,MAAMgO,EAAN,GAAWkmB,UAA1B;AACA,YAAI,CAACza,QAAL,EACI;AACJ,YAAIhW,SAASzD,MAAM4E,MAAN,CAAaC,YAA1B;AACA,iBAASW,YAAT,CAAsBnX,MAAtB,EAA8B;AAC1B,gBAAI,CAACA,MAAL,EACI;AACJ,gBAAIA,kBAAkB8U,WAAtB,EACI,OAAO9U,MAAP;AACJ,gBAAI2F,SAAS3F,MAAT,CAAJ,EACI,OAAOoV,OAAOnN,MAAP,CAAcjI,MAAd,EAAsB2R,MAAMtN,MAAN,EAAtB,EAAsCsN,MAAM5B,OAAN,EAAtC,CAAP;AACJ,gBAAI/P,OAAO,OAAP,KAAmBA,OAAO,QAAP,CAAvB,EACI,OAAOoV,OAAOnN,MAAP,CAAcjI,OAAO,OAAP,KAAmB2R,MAAMgO,EAAN,EAAjC,EAA6C3f,OAAO,QAAP,KAAoB2R,MAAMtN,MAAN,EAAjE,EAAiFsN,MAAM5B,OAAN,EAAjF,CAAP;AACP;AACD,YAAIjL,WAAWsmB,QAAX,CAAJ,EAA0B;AACtB,mBAAO5kB,SAASC,EAAT,CAAYgN,IAAZ,CAAiB2X,SAASzZ,KAAT,CAAjB,EAAkC9B,IAAlC,CAAuCsH,YAAvC,CAAP;AACH;AACD,eAAOA,aAAaiU,QAAb,CAAP;AACH,KAnBD;AAoBA,QAAI0a,yBAAyB,SAAzBA,sBAAyB,CAAUtrB,iBAAV,EAA6B;AACtD,eAAOA,kBAAkBsP,OAAlB,CAA0B,EAAEnK,IAAI,YAAUtc,KAAV,EAAiB;AAAE,uBAAO,CAAC,CAACA,MAAMwiC,UAAf;AAA4B,aAArD,EAA1B,EAAmFD,cAAnF,CAAP;AACH,KAFD;;AAIA;;;;;;;;AAQA,aAASG,uBAAT,CAAiC1b,QAAjC,EAA2C;AACvC,eAAO,UAAUzU,UAAV,EAAsBvS,KAAtB,EAA6B;AAChC,gBAAIwV,SAASxV,MAAME,OAAN,EAAb;AACA,gBAAIyiC,SAASntB,OAAOwR,QAAP,CAAb;AACA,mBAAO2b,OAAOpwB,UAAP,EAAmBvS,KAAnB,CAAP;AACH,SAJD;AAKH;AACD;;;;;;;;;AASA,QAAI4iC,aAAaF,wBAAwB,QAAxB,CAAjB;AACA,QAAIG,qBAAqB,SAArBA,kBAAqB,CAAU1rB,iBAAV,EAA6B;AAClD,eAAOA,kBAAkBuP,MAAlB,CAAyB,EAAE1F,SAAS,iBAAUhhB,KAAV,EAAiB;AAAE,uBAAO,CAAC,CAACA,MAAM0mB,MAAf;AAAwB,aAAtD,EAAzB,EAAmFkc,UAAnF,CAAP;AACH,KAFD;AAGA;;;;;;;;;AASA,QAAIE,eAAeJ,wBAAwB,UAAxB,CAAnB;AACA,QAAIK,uBAAuB,SAAvBA,oBAAuB,CAAU5rB,iBAAV,EAA6B;AACpD,eAAOA,kBAAkBwP,QAAlB,CAA2B,EAAE5F,UAAU,kBAAU/gB,KAAV,EAAiB;AAAE,uBAAO,CAAC,CAACA,MAAM2mB,QAAf;AAA0B,aAAzD,EAA3B,EAAwFmc,YAAxF,CAAP;AACH,KAFD;AAGA;;;;;;;;;AASA,QAAIE,cAAcN,wBAAwB,SAAxB,CAAlB;AACA,QAAIO,sBAAsB,SAAtBA,mBAAsB,CAAU9rB,iBAAV,EAA6B;AACnD,eAAOA,kBAAkByP,OAAlB,CAA0B,EAAE3F,UAAU,kBAAUjhB,KAAV,EAAiB;AAAE,uBAAO,CAAC,CAACA,MAAM4mB,OAAf;AAAyB,aAAxD,EAA1B,EAAsFoc,WAAtF,CAAP;AACH,KAFD;;AAIA;AACA;AACA;;;;;;;;;AASA,QAAIE,mBAAmB,SAAnBA,gBAAmB,CAAU50B,KAAV,EAAiB;AACpC,eAAO,IAAI4V,cAAJ,CAAmB5V,MAAMiI,WAAN,GAAoB+F,EAAvC,EACFmI,WADE,CACU,OADV,EACmBnW,KADnB,EAEF9B,IAFE,CAEG/H,MAFH,CAAP;AAGH,KAJD;AAKA,QAAI0+B,2BAA2B,SAA3BA,wBAA2B,CAAUhsB,iBAAV,EAA6B;AACxD,eAAOA,kBAAkBsP,OAAlB,CAA0B,EAA1B,EAA8Byc,gBAA9B,EAAgD,EAAEptB,UAAU,IAAZ,EAAhD,CAAP;AACH,KAFD;AAGA;;;;;;;;;AASA,QAAIstB,mBAAmB,SAAnBA,gBAAmB,CAAU90B,KAAV,EAAiBtO,KAAjB,EAAwB;AAC3C,eAAO,IAAIkkB,cAAJ,CAAmB5V,MAAMiI,WAAN,GAAoB+F,EAAvC,EACFgI,UADE,CACStkB,MAAME,OAAN,EADT,EAEFukB,WAFE,CAEU,MAFV,EAEkBnW,KAFlB,EAGF9B,IAHE,CAGG/H,MAHH,CAAP;AAIH,KALD;AAMA,QAAI4+B,2BAA2B,SAA3BA,wBAA2B,CAAUlsB,iBAAV,EAA6B;AACxD,eAAOA,kBAAkByP,OAAlB,CAA0B,EAAE3F,UAAU5jB,IAAI,IAAJ,CAAZ,EAA1B,EAAmD+lC,gBAAnD,EAAqE,EAAEttB,UAAU,IAAZ,EAArE,CAAP;AACH,KAFD;;AAIA,wBA1hM2C,CA0hMtB;AACrB;;;;;;;;AAQA,QAAIwtB,oBAAoB,SAApBA,iBAAoB,CAAU/wB,UAAV,EAAsB;AAC1C,YAAInP,KAAKD,SAASC,EAAlB;AACA,YAAImgC,gBAAgBhxB,WAAW2L,KAAX,CAAiB,UAAjB,CAApB;AACA,YAAI,CAACqlB,cAAcnnC,MAAnB,EACI;AACJ,eAAOgH,GAAGtF,GAAH,CAAOylC,cAAc/lC,GAAd,CAAkB,UAAUkiB,IAAV,EAAgB;AAAE,mBAAOtc,GAAGgN,IAAH,CAAQsP,KAAK8jB,IAAL,EAAR,CAAP;AAA8B,SAAlE,CAAP,EAA4Eh3B,IAA5E,CAAiF/H,MAAjF,CAAP;AACH,KAND;AAOA,QAAIg/B,4BAA4B,SAA5BA,yBAA4B,CAAUtsB,iBAAV,EAA6B;AACzD,eAAOA,kBAAkB0P,QAAlB,CAA2B,EAA3B,EAA+Byc,iBAA/B,CAAP;AACH,KAFD;AAGA;;;;;;;;;;AAUA,QAAII,gBAAgB,SAAhBA,aAAgB,CAAUnxB,UAAV,EAAsB;AACtC,YAAIgxB,gBAAgBhxB,WAAW2L,KAAX,CAAiB,UAAjB,CAApB;AACA,YAAIylB,eAAepxB,WAAW2L,KAAX,CAAiB,SAAjB,CAAnB;AACA,YAAI,CAACqlB,cAAcnnC,MAAf,IAAyB,CAACunC,aAAavnC,MAA3C,EACI;AACJ,YAAIijB,QAAQ9M,WAAWW,MAAX,CAAkBwuB,WAA9B;AACAiC,qBAAa1/B,OAAb,CAAqB,UAAUg8B,EAAV,EAAc;AAAE,mBAAO5gB,MAAM+e,oBAAN,CAA2B6B,EAA3B,CAAP;AAAwC,SAA7E;AACAsD,sBAAct/B,OAAd,CAAsB,UAAUg8B,EAAV,EAAc;AAAE,mBAAO5gB,MAAMgf,kBAAN,CAAyB4B,EAAzB,CAAP;AAAsC,SAA5E;AACA5gB,cAAMyc,IAAN;AACH,KATD;AAUA,QAAI8H,wBAAwB,SAAxBA,qBAAwB,CAAUzsB,iBAAV,EAA6B;AACrD,eAAOA,kBAAkB2P,SAAlB,CAA4B,EAA5B,EAAgC4c,aAAhC,CAAP;AACH,KAFD;;AAIA;;;;;;;;;;;;AAYA,QAAIG,oBAAoB,SAApBA,iBAAoB,CAAUv1B,KAAV,EAAiB;AACrC,YAAI4X,UAAU5X,MAAM4E,MAAN,CAAagT,OAA3B;AACA,YAAI4d,uBAAuB,SAAvBA,oBAAuB,GAAY;AACnC5d,oBAAQsa,qBAAR,CAA8Bt1B,OAA9B,CAAsCoD,KAAtC;AACA4X,oBAAQ+H,QAAR,GAAmB3f,MAAM6Y,GAAN,EAAnB;AACAjB,oBAAQ1a,OAAR,GAAkB0a,QAAQ+H,QAAR,CAAiB9tB,IAAnC;AACA4D,iBAAKuK,MAAMtN,MAAN,EAAL,EAAqBklB,QAAQllB,MAA7B;AACH,SALD;AAMA,YAAI+iC,yBAAyB,SAAzBA,sBAAyB,GAAY;AACrC;AACA,gBAAI7d,QAAQ3T,UAAR,KAAuBjE,KAA3B,EACI4X,QAAQ3T,UAAR,GAAqB,IAArB;AACP,SAJD;AAKAjE,cAAMwY,SAAN,CAAgB,EAAhB,EAAoBgd,oBAApB,EAA0C,EAAEhuB,UAAU,KAAZ,EAA1C;AACAxH,cAAM7D,OAAN,CAAc+B,IAAd,CAAmBu3B,sBAAnB,EAA2CA,sBAA3C;AACH,KAfD;AAgBA,QAAIC,4BAA4B,SAA5BA,yBAA4B,CAAU7sB,iBAAV,EAA6B;AACzD,eAAOA,kBAAkBmrB,QAAlB,CAA2B,EAA3B,EAA+BuB,iBAA/B,CAAP;AACH,KAFD;;AAIA;;;;;AAKA,QAAII,YAAY,SAAZA,SAAY,CAAU1xB,UAAV,EAAsB;AAClC,YAAI7F,UAAU6F,WAAW7F,OAAX,EAAd;AACA,YAAIqF,SAASQ,WAAWW,MAAX,CAAkBC,YAA/B;AACA,YAAI0f,aAAatgB,WAAWW,MAAX,CAAkBihB,SAAnC;AACA;AACA;AACA;AACA;AACA,YAAIznB,QAAQ/H,MAAR,KAAmB,KAAnB,IAA4B+H,QAAQ8O,QAApC,IAAgDzJ,OAAOkc,QAAP,CAAgBoB,SAApE,EAA+E;AAC3E,gBAAI6U,aAAa,EAAE/nB,SAASzP,QAAQ8O,QAAR,KAAqB,SAAhC,EAAjB;AACAqX,uBAAW9sB,IAAX,CAAgBgM,OAAOkc,QAAP,CAAgBoB,SAAhB,CAA0B/tB,GAA1C,EAA+CyQ,OAAO/Q,MAAtD,EAA8DkjC,UAA9D;AACH;AACDrR,mBAAW2J,MAAX,CAAkB,IAAlB;AACH,KAbD;AAcA,QAAI2H,oBAAoB,SAApBA,iBAAoB,CAAUhtB,iBAAV,EAA6B;AACjD,eAAOA,kBAAkB2P,SAAlB,CAA4B,EAA5B,EAAgCmd,SAAhC,EAA2C,EAAEnuB,UAAU,IAAZ,EAA3C,CAAP;AACH,KAFD;;AAIA;;;;;;;;;;;;;;;;;;;;;;;;AAwBA,QAAIsuB,eAAe,SAAfA,YAAe,CAAU7xB,UAAV,EAAsB;AACrC,YAAIW,SAASX,WAAWW,MAAxB;AACA,iBAASmxB,eAAT,GAA2B;AACvB,gBAAI9xB,WAAWsV,kBAAX,GAAgCnb,OAAhC,GAA0C/H,MAA1C,KAAqD,KAAzD,EAAgE;AAC5D;AACA;AACA,oBAAI2/B,OAAO/xB,WAAWuM,WAAX,EAAX;AACA,uBAAO5L,OAAOC,YAAP,CAAoBvO,MAApB,CAA2B0/B,KAAKxyB,UAAL,EAA3B,EAA8CwyB,KAAKtjC,MAAL,EAA9C,EAA6DsjC,KAAK53B,OAAL,EAA7D,CAAP;AACH;AACD;AACA;AACA,gBAAIuvB,OAAO/oB,OAAOgpB,UAAlB;AACA,gBAAIv/B,SAASs/B,KAAKlf,KAAL,CAAWkf,KAAKmF,KAAL,EAAX,CAAb;AACA,gBAAItN,OAAOn3B,UAAUA,OAAOm3B,IAA5B;AACA;AACA;AACA,gBAAIA,QAAQA,KAAKhoB,IAAL,KAAc,OAA1B,EAAmC;AAC/B,oBAAI9L,QAAQ8zB,KAAK9zB,KAAjB;AACA,oBAAIgB,SAASrE,OAAOogB,KAApB;AACA,uBAAO7J,OAAOC,YAAP,CAAoBvO,MAApB,CAA2B5E,KAA3B,EAAkCgB,MAAlC,EAA0CuR,WAAW7F,OAAX,EAA1C,CAAP;AACH;AACD;AACAwG,mBAAOgpB,UAAP,CAAkBJ,IAAlB;AACH;AACD,YAAI/W,WAAWxS,WAAW0O,QAAX,GACVhgB,MADU,CACH,UAAUjB,KAAV,EAAiB;AAAE,mBAAO,CAAC,CAACA,MAAME,OAAN,GAAgBqkC,QAAzB;AAAoC,SADpD,EAEV/mC,GAFU,CAEN,UAAUwC,KAAV,EAAiB;AAAE,mBAAOwkC,cAAcjyB,UAAd,EAA0BvS,KAA1B,CAAP;AAA0C,SAFvD,CAAf;AAGA,eAAOmD,SAASC,EAAT,CAAYtF,GAAZ,CAAgBinB,QAAhB,EAA0BvY,IAA1B,CAA+B63B,eAA/B,CAAP;AACH,KA5BD;AA6BA,QAAII,uBAAuB,SAAvBA,oBAAuB,CAAUttB,iBAAV,EAA6B;AACpD,eAAOA,kBAAkBqP,QAAlB,CAA2B,EAAEvF,UAAU,kBAAUjhB,KAAV,EAAiB;AAAE,uBAAO,CAAC,CAACA,MAAMukC,QAAf;AAA0B,aAAzD,EAA3B,EAAwFH,YAAxF,CAAP;AACH,KAFD;AAGA;;;;;;;AAOA,aAASI,aAAT,CAAuBjyB,UAAvB,EAAmCvS,KAAnC,EAA0C;AACtC,YAAI0kC,aAAa1kC,MAAME,OAAN,GAAgBqkC,QAAjC;AACA;AACA,YAAI95B,UAAUi6B,WAAW,UAAX,CAAd;AACA,YAAI,CAACj6B,OAAL,EAAc;AACV,gBAAImf,UAAU,SAAVA,OAAU,CAAUjtB,MAAV,EAAkB;AAC5B,uBAAOqD,MAAMukC,QAAb;AACA,uBAAOvkC,MAAME,OAAN,GAAgBqkC,QAAvB;AACA,uBAAOG,WAAW,UAAX,CAAP;AACA,uBAAO/nC,MAAP;AACH,aALD;AAMA,gBAAIkO,QAAQ,SAARA,KAAQ,CAAUoI,GAAV,EAAe;AACvB,uBAAOyxB,WAAW,UAAX,CAAP;AACA,uBAAOvhC,SAASC,EAAT,CAAY0H,MAAZ,CAAmBmI,GAAnB,CAAP;AACH,aAHD;AAIAxI,sBAAUi6B,WAAW,UAAX,IACNvhC,SAASC,EAAT,CAAYgN,IAAZ,CAAiBs0B,WAAWnyB,UAAX,EAAuBvS,KAAvB,CAAjB,EACKwM,IADL,CACUm4B,mBADV,EAEKn4B,IAFL,CAEUod,OAFV,EAEmB/e,KAFnB,CADJ;AAIH;AACD;AACA,iBAAS85B,mBAAT,CAA6BhoC,MAA7B,EAAqC;AACjC,gBAAIA,UAAU6F,MAAMD,OAAN,CAAc5F,OAAO2iB,MAArB,CAAd,EAA4C;AACxC3iB,uBAAO2iB,MAAP,CAAcrb,OAAd,CAAsB,UAAUjE,KAAV,EAAiB;AAAE,2BAAOuS,WAAWW,MAAX,CAAkB0uB,aAAlB,CAAgC5O,QAAhC,CAAyChzB,KAAzC,CAAP;AAAyD,iBAAlG;AACH;AACD,mBAAOrD,MAAP;AACH;AACD,eAAO8N,OAAP;AACH;;AAED;;;;;;AAMA,QAAIm6B,sBAAuB,YAAY;AACnC,iBAASA,mBAAT,CAA6B1nC,IAA7B,EAAmC0V,SAAnC,EAA8CiyB,SAA9C,EAAyDzsB,iBAAzD,EAA4EI,WAA5E,EAAyFzE,gBAAzF,EAA2GF,eAA3G,EAA4HG,WAA5H,EAAyI;AACrI,gBAAIwE,gBAAgB,KAAK,CAAzB,EAA4B;AAAEA,8BAAc,KAAd;AAAsB;AACpD,gBAAIzE,qBAAqB,KAAK,CAA9B,EAAiC;AAAEA,mCAAmBtB,eAAesC,aAAlC;AAAkD;AACrF,gBAAIlB,oBAAoB,KAAK,CAA7B,EAAgC;AAAEA,kCAAkBpB,eAAeyC,YAAjC;AAAgD;AAClF,gBAAIlB,gBAAgB,KAAK,CAAzB,EAA4B;AAAEA,8BAAc,KAAd;AAAsB;AACpD,iBAAK9W,IAAL,GAAYA,IAAZ;AACA,iBAAK0V,SAAL,GAAiBA,SAAjB;AACA,iBAAKiyB,SAAL,GAAiBA,SAAjB;AACA,iBAAKzsB,iBAAL,GAAyBA,iBAAzB;AACA,iBAAKI,WAAL,GAAmBA,WAAnB;AACA,iBAAKzE,gBAAL,GAAwBA,gBAAxB;AACA,iBAAKF,eAAL,GAAuBA,eAAvB;AACA,iBAAKG,WAAL,GAAmBA,WAAnB;AACH;AACD,eAAO4wB,mBAAP;AACH,KAhB0B,EAA3B;;AAkBA,wBAjvM2C,CAivMtB;AACrB;;;;;;;;AAQA,aAASE,WAAT,CAAqBx2B,KAArB,EAA4B;AACxB,YAAIy2B,gBAAgBz2B,MAAM8a,cAAN,EAApB;AACA,YAAI,CAAC2b,aAAL,EACI;AACJzzB,cAAM/B,sBAAN,CAA6BjB,KAA7B;AACA,YAAI+a,UAAU/a,MAAM4E,MAAN,CAAagT,OAAb,CAAqB3T,UAAnC;AACA;AACA;AACA;AACA,YAAIwyB,kBAAkB,eAAlB,IAAqC1b,OAAzC,EAAkD;AAC9CA,oBAAQkB,KAAR;AACH;AACD,eAAO1e,UAAUmB,OAAV,GAAoBX,SAApB,EAAP;AACH;AACD,QAAI24B,gCAAgC,SAAhCA,6BAAgC,CAAU7tB,iBAAV,EAA6B;AAC7D,eAAOA,kBAAkBqP,QAAlB,CAA2B,EAA3B,EAA+Bse,WAA/B,EAA4C,EAAEhvB,UAAU,CAAC,IAAb,EAA5C,CAAP;AACH,KAFD;;AAIA,wBA5wM2C,CA4wMtB;AACrB;;;;;;;AAOA,aAASmvB,qBAAT,CAA+B32B,KAA/B,EAAsC;AAClC,YAAI,CAACA,MAAM2D,KAAN,EAAL,EAAoB;AAChB,kBAAM,IAAI/O,KAAJ,CAAUoL,MAAMzD,KAAN,EAAV,CAAN;AACH;AACJ;AACD,QAAIq6B,gCAAgC,SAAhCA,6BAAgC,CAAU/tB,iBAAV,EAA6B;AAC7D,eAAOA,kBAAkBqP,QAAlB,CAA2B,EAA3B,EAA+Bye,qBAA/B,EAAsD,EAAEnvB,UAAU,CAAC,KAAb,EAAtD,CAAP;AACH,KAFD;;AAIA;;;;AAIA;AACA;;;;;;;AAOA,QAAIqvB,mBAAmB;AACnB3pB,kBAAU,IADS;AAEnBrJ,kBAAU,IAFS;AAGnBlS,iBAAS,KAHU;AAInBmlC,gBAAQ,IAJW;AAKnBzc,gBAAQ,KALW;AAMnB0c,gBAAQ,EANW;AAOnB75B,iBAAS,mBAAY;AAAE,mBAAO,IAAP;AAAc,SAPlB;AAQnB7G,gBAAQ;AARW,KAAvB;AAUA;;;;;;;;;AASA,QAAIg9B,oBAAqB,YAAY;AACjC;AACA,iBAASA,iBAAT,CAA2B1N,OAA3B,EAAoC;AAChC;AACA,iBAAK7N,gBAAL,GAAwB,CAAxB;AACA;AACA,iBAAKkf,WAAL,GAAmB,EAAnB;AACA;AACA,iBAAKluB,gBAAL,GAAwB,EAAxB;AACA;AACA,iBAAKmuB,cAAL,GAAsB,EAAtB;AACA,iBAAKtR,OAAL,GAAeA,OAAf;AACA,iBAAK5U,KAAL,GAAa4U,QAAQyN,WAArB;AACA,iBAAK8D,kBAAL,GAA0B,EAA1B;AACA,iBAAKpvB,UAAL,GAAkB1R,qBAAqBrH,IAAI,IAAJ,CAArB,EAAgC,EAAhC,EAAoCA,IAAI,IAAJ,CAApC,EAA+C,CAC7D,iBAD6D,EAE7D,cAF6D,EAG7D,eAH6D,EAI7D,YAJ6D,EAK7D,UAL6D,CAA/C,CAAlB;AAOA,iBAAKooC,gBAAL;AACA,iBAAKC,iBAAL;AACA,iBAAKC,4BAAL;AACH;AACD;;;;;;;;;;;;;;;;;;;;;;;AAuBAhE,0BAAkBriC,SAAlB,CAA4BgjC,QAA5B,GAAuC,UAAU9rB,QAAV,EAAoBlP,QAApB,EAA8BoF,OAA9B,EAAuC;AAAE;AAAS,SAAzF;AACA;AACAi1B,0BAAkBriC,SAAlB,CAA4BknB,QAA5B,GAAuC,UAAUhQ,QAAV,EAAoBlP,QAApB,EAA8BoF,OAA9B,EAAuC;AAAE;AAAS,SAAzF;AACA;AACAi1B,0BAAkBriC,SAAlB,CAA4BmnB,OAA5B,GAAsC,UAAUjQ,QAAV,EAAoBlP,QAApB,EAA8BoF,OAA9B,EAAuC;AAAE;AAAS,SAAxF;AACA;AACAi1B,0BAAkBriC,SAAlB,CAA4BonB,MAA5B,GAAqC,UAAUlQ,QAAV,EAAoBlP,QAApB,EAA8BoF,OAA9B,EAAuC;AAAE;AAAS,SAAvF;AACA;AACAi1B,0BAAkBriC,SAAlB,CAA4BqnB,QAA5B,GAAuC,UAAUnQ,QAAV,EAAoBlP,QAApB,EAA8BoF,OAA9B,EAAuC;AAAE;AAAS,SAAzF;AACA;AACAi1B,0BAAkBriC,SAAlB,CAA4BsnB,OAA5B,GAAsC,UAAUpQ,QAAV,EAAoBlP,QAApB,EAA8BoF,OAA9B,EAAuC;AAAE;AAAS,SAAxF;AACA;AACAi1B,0BAAkBriC,SAAlB,CAA4BunB,QAA5B,GAAuC,UAAUrQ,QAAV,EAAoBlP,QAApB,EAA8BoF,OAA9B,EAAuC;AAAE;AAAS,SAAzF;AACA;AACAi1B,0BAAkBriC,SAAlB,CAA4BwnB,SAA5B,GAAwC,UAAUtQ,QAAV,EAAoBlP,QAApB,EAA8BoF,OAA9B,EAAuC;AAAE;AAAS,SAA1F;AACA;AACAi1B,0BAAkBriC,SAAlB,CAA4BynB,OAA5B,GAAsC,UAAUvQ,QAAV,EAAoBlP,QAApB,EAA8BoF,OAA9B,EAAuC;AAAE;AAAS,SAAxF;AACA;;;;AAIAi1B,0BAAkBriC,SAAlB,CAA4BktB,OAA5B,GAAsC,UAAUtZ,MAAV,EAAkB;AACpDnS,mBAAO,KAAKqW,gBAAZ,EAA8BnT,OAA9B,CAAsC,UAAU2hC,UAAV,EAAsB;AAAE,uBAAOA,WAAW3hC,OAAX,CAAmB,UAAUqP,IAAV,EAAgB;AACpGA,yBAAKC,aAAL,GAAqB,IAArB;AACA9N,+BAAWmgC,UAAX,EAAuBtyB,IAAvB;AACH,iBAHoE,CAAP;AAGzD,aAHL;AAIH,SALD;AAMA;;;;;;;;;;AAUAquB,0BAAkBriC,SAAlB,CAA4BO,MAA5B,GAAqC,UAAUof,QAAV,EAAoBH,WAApB,EAAiC;AAClE,mBAAO,IAAIgH,UAAJ,CAAe7G,QAAf,EAAyBH,WAAzB,EAAsC,KAAKmV,OAA3C,CAAP;AACH,SAFD;AAGA;AACA0N,0BAAkBriC,SAAlB,CAA4BomC,iBAA5B,GAAgD,YAAY;AACxD,gBAAIG,QAAQvqC,QAAQiW,mBAApB;AACA,gBAAIu0B,KAAKrzB,cAAT;AACA,gBAAIgE,QAAQ,KAAK8uB,cAAjB;AACA,gBAAIQ,cAAc,KAAlB;AAAA,gBAAyBC,eAAe,IAAxC;AACA,gBAAIC,eAAe,KAAnB;AAAA,gBAA0BC,cAAc,IAAxC;AACA,iBAAKC,YAAL,CAAkB,UAAlB,EAA8BN,MAAMltB,MAApC,EAA4C,CAA5C,EAA+ClC,MAAM6F,EAArD,EAAyDypB,WAAzD,EAAsED,GAAG9wB,mBAAzE,EAA8F8wB,GAAG3wB,WAAjG,EAA8G+wB,WAA9G;AACA,iBAAKC,YAAL,CAAkB,UAAlB,EAA8BN,MAAMvb,MAApC,EAA4C,CAA5C,EAA+C7T,MAAM6F,EAArD;AACA,iBAAK6pB,YAAL,CAAkB,SAAlB,EAA6BN,MAAMhzB,GAAnC,EAAwC,CAAxC,EAA2C4D,MAAM6F,EAAjD;AACA,iBAAK6pB,YAAL,CAAkB,QAAlB,EAA4BN,MAAMhzB,GAAlC,EAAuC,GAAvC,EAA4C4D,MAAMuK,OAAlD,EAA2DglB,YAA3D;AACA,iBAAKG,YAAL,CAAkB,UAAlB,EAA8BN,MAAMhzB,GAApC,EAAyC,GAAzC,EAA8C4D,MAAMsK,QAApD;AACA,iBAAKolB,YAAL,CAAkB,SAAlB,EAA6BN,MAAMhzB,GAAnC,EAAwC,GAAxC,EAA6C4D,MAAMwK,QAAnD;AACA,iBAAKklB,YAAL,CAAkB,UAAlB,EAA8BN,MAAMhzB,GAApC,EAAyC,GAAzC,EAA8C4D,MAAM6F,EAApD;AACA,iBAAK6pB,YAAL,CAAkB,WAAlB,EAA+BN,MAAMhc,OAArC,EAA8C,CAA9C,EAAiDpT,MAAM6F,EAAvD,EAA2DypB,WAA3D,EAAwED,GAAG9wB,mBAA3E,EAAgG8wB,GAAG7wB,SAAnG,EAA8GixB,WAA9G;AACA,iBAAKC,YAAL,CAAkB,SAAlB,EAA6BN,MAAMx4B,KAAnC,EAA0C,CAA1C,EAA6CoJ,MAAM6F,EAAnD,EAAuDypB,WAAvD,EAAoED,GAAG9wB,mBAAvE,EAA4F8wB,GAAG7wB,SAA/F,EAA0GixB,WAA1G;AACH,SAfD;AAgBA;AACAvE,0BAAkBriC,SAAlB,CAA4BmmC,gBAA5B,GAA+C,YAAY;AACvD,gBAAI3uB,QAAQxb,QAAQkW,mBAAR,CAA4BsF,KAAxC;AAAA,gBAA+C1H,aAAa9T,QAAQkW,mBAAR,CAA4BpC,UAAxF;AACA,iBAAKg3B,eAAL,CAAqB,IAArB,EAA2Bh3B,UAA3B;AACA,iBAAKg3B,eAAL,CAAqB,MAArB,EAA6Bh3B,UAA7B;AACA,iBAAKg3B,eAAL,CAAqB,SAArB,EAAgCtvB,KAAhC;AACA,iBAAKsvB,eAAL,CAAqB,UAArB,EAAiCtvB,KAAjC;AACA,iBAAKsvB,eAAL,CAAqB,UAArB,EAAiCtvB,KAAjC;AACH,SAPD;AAQA;AACA6qB,0BAAkBriC,SAAlB,CAA4B6mC,YAA5B,GAA2C,UAAUjpC,IAAV,EAAgB0V,SAAhB,EAA2BiyB,SAA3B,EAAsCzsB,iBAAtC,EAAyDI,WAAzD,EAAsEzE,gBAAtE,EAAwFF,eAAxF,EAAyGG,WAAzG,EAAsH;AAC7J,gBAAIwE,gBAAgB,KAAK,CAAzB,EAA4B;AAAEA,8BAAc,KAAd;AAAsB;AACpD,gBAAIzE,qBAAqB,KAAK,CAA9B,EAAiC;AAAEA,mCAAmBtB,eAAesC,aAAlC;AAAkD;AACrF,gBAAIlB,oBAAoB,KAAK,CAA7B,EAAgC;AAAEA,kCAAkBpB,eAAeyC,YAAjC;AAAgD;AAClF,gBAAIlB,gBAAgB,KAAK,CAAzB,EAA4B;AAAEA,8BAAc,KAAd;AAAsB;AACpD,gBAAIjB,YAAY,IAAI6xB,mBAAJ,CAAwB1nC,IAAxB,EAA8B0V,SAA9B,EAAyCiyB,SAAzC,EAAoDzsB,iBAApD,EAAuEI,WAAvE,EAAoFzE,gBAApF,EAAsGF,eAAtG,EAAuHG,WAAvH,CAAhB;AACA,iBAAKsxB,WAAL,CAAiBv/B,IAAjB,CAAsBgN,SAAtB;AACAkE,sBAAU,IAAV,EAAgB,IAAhB,EAAsBlE,SAAtB;AACH,SARD;;AAUA;AACA4uB,0BAAkBriC,SAAlB,CAA4BsY,UAA5B,GAAyC,UAAUF,KAAV,EAAiB;AACtD,gBAAI2uB,sBAAsBpkC,UAAUyV,KAAV,IACtB,KAAK4tB,WAAL,CAAiBrkC,MAAjB,CAAwB,UAAU6K,IAAV,EAAgB;AAAE,uBAAOA,KAAK8G,SAAL,KAAmB8E,KAA1B;AAAkC,aAA5E,CADsB,GAEtB,KAAK4tB,WAAL,CAAiBtpC,KAAjB,EAFJ;AAGA,mBAAOqqC,oBAAoB/tB,IAApB,CAAyB,UAAUW,CAAV,EAAaC,CAAb,EAAgB;AAC5C,oBAAIotB,aAAartB,EAAErG,SAAF,GAAcsG,EAAEtG,SAAjC;AACA,uBAAO0zB,eAAe,CAAf,GAAmBrtB,EAAE4rB,SAAF,GAAc3rB,EAAE2rB,SAAnC,GAA+CyB,UAAtD;AACH,aAHM,CAAP;AAIH,SARD;AASA;;;;;;;;;;;;;AAaA3E,0BAAkBriC,SAAlB,CAA4B8mC,eAA5B,GAA8C,UAAUlpC,IAAV,EAAgBqpC,SAAhB,EAA2B;AACrE,iBAAKhB,cAAL,CAAoBroC,IAApB,IAA4B,EAAEA,MAAMA,IAAR,EAAc2Z,OAAO0vB,SAArB,EAA5B;AACH,SAFD;AAGA;AACA5E,0BAAkBriC,SAAlB,CAA4B+W,aAA5B,GAA4C,YAAY;AACpD,mBAAO,KAAKkvB,cAAZ;AACH,SAFD;AAGA;AACA5D,0BAAkBriC,SAAlB,CAA4BwZ,QAA5B,GAAuC,UAAUkO,QAAV,EAAoB;AACvD,mBAAO,KAAK5P,gBAAL,CAAsB4P,QAAtB,CAAP;AACH,SAFD;AAGA;AACA2a,0BAAkBriC,SAAlB,CAA4BqmC,4BAA5B,GAA2D,YAAY;AACnE,gBAAIa,MAAM,KAAKhB,kBAAf;AACAgB,gBAAIC,eAAJ,GAAsBpE,2BAA2B,IAA3B,CAAtB;AACAmE,gBAAIx5B,OAAJ,GAAcg4B,8BAA8B,IAA9B,CAAd;AACAwB,gBAAI15B,OAAJ,GAAco4B,8BAA8B,IAA9B,CAAd;AACA;AACAsB,gBAAIhE,UAAJ,GAAiBC,uBAAuB,IAAvB,CAAjB;AACA;AACA+D,gBAAI9f,MAAJ,GAAamc,mBAAmB,IAAnB,CAAb;AACA2D,gBAAI7f,QAAJ,GAAeoc,qBAAqB,IAArB,CAAf;AACAyD,gBAAI5f,OAAJ,GAAcqc,oBAAoB,IAApB,CAAd;AACA;AACAuD,gBAAIE,YAAJ,GAAmBvD,yBAAyB,IAAzB,CAAnB;AACAqD,gBAAIG,WAAJ,GAAkBtD,yBAAyB,IAAzB,CAAlB;AACA;AACAmD,gBAAII,SAAJ,GAAgBnD,0BAA0B,IAA1B,CAAhB;AACA+C,gBAAI9C,aAAJ,GAAoBE,sBAAsB,IAAtB,CAApB;AACA;AACA4C,gBAAIK,aAAJ,GAAoB7C,0BAA0B,IAA1B,CAApB;AACA;AACAwC,gBAAIvC,SAAJ,GAAgBE,kBAAkB,IAAlB,CAAhB;AACA;AACAqC,gBAAIjC,QAAJ,GAAeE,qBAAqB,IAArB,CAAf;AACH,SAvBD;AAwBA,eAAO9C,iBAAP;AACH,KAzLwB,EAAzB;;AA2LA;;;;AAIA;AACA;;;;;;AAMA,QAAIE,eAAgB,YAAY;AAC5B;AACA,iBAASA,YAAT,CAAsB3uB,MAAtB,EAA8B;AAC1B,iBAAKA,MAAL,GAAcA,MAAd;AACA;AACA,iBAAK4zB,gBAAL,GAAwB,EAAxB;AACA;AACA,iBAAKC,oBAAL,GAA4B,SAASC,oBAAT,CAA8BC,OAA9B,EAAuC;AAC/D,oBAAIA,mBAAmB/jC,KAAnB,IAA4B+jC,QAAQC,KAAxC,EAA+C;AAC3C73B,4BAAQxE,KAAR,CAAco8B,OAAd;AACA53B,4BAAQxE,KAAR,CAAco8B,QAAQC,KAAtB;AACH,iBAHD,MAIK,IAAID,mBAAmBp7B,SAAvB,EAAkC;AACnCwD,4BAAQxE,KAAR,CAAco8B,QAAQzlC,QAAR,EAAd;AACA,wBAAIylC,QAAQj7B,MAAR,IAAkBi7B,QAAQj7B,MAAR,CAAek7B,KAArC,EACI73B,QAAQxE,KAAR,CAAco8B,QAAQj7B,MAAR,CAAek7B,KAA7B;AACP,iBAJI,MAKA;AACD73B,4BAAQxE,KAAR,CAAco8B,OAAd;AACH;AACJ,aAbD;AAcA,gBAAIE,UAAU,CAAC,SAAD,EAAY,UAAZ,EAAwB,QAAxB,EAAkC,YAAlC,CAAd;AACA,gBAAIC,WAAWvlC,OAAOqD,IAAP,CAAY28B,aAAaviC,SAAzB,EAAoC2B,MAApC,CAA2CxD,IAAI4H,QAAQ8hC,OAAR,CAAJ,CAA3C,CAAf;AACAziC,iCAAqBrH,IAAIwkC,aAAaviC,SAAjB,CAArB,EAAkD,IAAlD,EAAwDjC,IAAI,IAAJ,CAAxD,EAAmE+pC,QAAnE;AACH;AACDvlC,eAAOwlC,cAAP,CAAsBxF,aAAaviC,SAAnC,EAA8C,YAA9C,EAA4D;AACxD;;;;;AAKAsjB,iBAAK,eAAY;AAAE,uBAAO,KAAK1P,MAAL,CAAYgT,OAAZ,CAAoB3T,UAA3B;AAAwC,aANH;AAOxD+0B,wBAAY,IAP4C;AAQxDC,0BAAc;AAR0C,SAA5D;AAUA1lC,eAAOwlC,cAAP,CAAsBxF,aAAaviC,SAAnC,EAA8C,QAA9C,EAAwD;AACpD;;;;;AAKAsjB,iBAAK,eAAY;AAAE,uBAAO,KAAK1P,MAAL,CAAYgT,OAAZ,CAAoBllB,MAA3B;AAAoC,aANH;AAOpDsmC,wBAAY,IAPwC;AAQpDC,0BAAc;AARsC,SAAxD;AAUA1lC,eAAOwlC,cAAP,CAAsBxF,aAAaviC,SAAnC,EAA8C,SAA9C,EAAyD;AACrD;;;;;AAKAsjB,iBAAK,eAAY;AAAE,uBAAO,KAAK1P,MAAL,CAAYgT,OAAZ,CAAoB1a,OAA3B;AAAqC,aANH;AAOrD87B,wBAAY,IAPyC;AAQrDC,0BAAc;AARuC,SAAzD;AAUA1lC,eAAOwlC,cAAP,CAAsBxF,aAAaviC,SAAnC,EAA8C,UAA9C,EAA0D;AACtD;;;;;AAKAsjB,iBAAK,eAAY;AAAE,uBAAO,KAAK1P,MAAL,CAAYgT,OAAZ,CAAoB+H,QAA3B;AAAsC,aANH;AAOtDqZ,wBAAY,IAP0C;AAQtDC,0BAAc;AARwC,SAA1D;AAUA;AACA1F,qBAAaviC,SAAb,CAAuBktB,OAAvB,GAAiC,YAAY;AACzC,iBAAKpZ,mBAAL,CAAyB3O,MAAzB;AACA,iBAAKqiC,gBAAL,GAAwB,EAAxB;AACH,SAHD;AAIA;;;;;;;;;;;AAWAjF,qBAAaviC,SAAb,CAAuBkoC,yBAAvB,GAAmD,UAAUvoB,QAAV,EAAoBwoB,OAApB,EAA6B;AAC5E,gBAAIt+B,QAAQ,IAAZ;AACA,gBAAIywB,YAAYjb,UAAUC,eAAV,CAA0BK,QAA1B,CAAhB;AACA,gBAAIiH,UAAU,KAAKhT,MAAL,CAAYgT,OAA1B;AACA,gBAAIwhB,cAAc,SAAdA,WAAc,GAAY;AAAE,uBAAOxhB,QAAQkE,iBAAR,CAA0B1e,QAA1B,EAAP;AAA8C,aAA9E;AACA,gBAAIi8B,SAASD,aAAb;AACA,gBAAIE,gBAAgB,IAAI78B,KAAJ,CAAU,KAAK+7B,gBAAL,CAAsB9qC,KAAtB,EAAV,CAApB;AACA,gBAAIopB,WAAW,IAAIlB,cAAJ,CAAmBjF,QAAnB,EAA6BmG,QAA7B,EAAf;AACA,gBAAIyiB,mBAAmB,SAAnBA,gBAAmB,CAAUlrC,MAAV,EAAkB;AACrC,oBAAI,EAAEA,kBAAkB8U,WAApB,CAAJ,EAAsC;AAClC;AACH;AACD,oBAAI7M,SAASjI,MAAb;AACA;AACAiI,yBAASuE,MAAMvE,MAAN,CAAaA,OAAOkN,UAAP,EAAb,EAAkClN,OAAO5D,MAAP,EAAlC,EAAmD4D,OAAO8H,OAAP,EAAnD,CAAT;AACA,oBAAI,CAAC9H,OAAOqN,KAAP,EAAL,EAAqB;AACjB,2BAAOpG,UAAUiB,OAAV,CAAkBlI,OAAOiG,KAAP,EAAlB,EAAkCwB,SAAlC,EAAP;AACH;AACD,oBAAIq7B,kBAAkBC,MAAtB,EAA8B;AAC1B,2BAAO97B,UAAUY,UAAV,GAAuBJ,SAAvB,EAAP;AACH;AACD,uBAAOlD,MAAMmxB,YAAN,CAAmB11B,OAAOkN,UAAP,EAAnB,EAAwClN,OAAO5D,MAAP,EAAxC,EAAyD4D,OAAO8H,OAAP,EAAzD,CAAP;AACH,aAdD;AAeA,qBAASo7B,kBAAT,GAA8B;AAC1B,oBAAIC,eAAeH,cAAcv8B,OAAd,EAAnB;AACA,oBAAI08B,iBAAiB1kC,SAArB,EACI,OAAOwI,UAAUiB,OAAV,CAAkB26B,QAAQ58B,KAAR,EAAlB,EAAmCwB,SAAnC,EAAP;AACJ,oBAAI27B,iBAAiB7kC,SAASC,EAAT,CAAYgN,IAAZ,CAAiB23B,aAAaN,OAAb,EAAsB7N,SAAtB,EAAiCxU,QAAjC,CAAjB,CAArB;AACA,uBAAO4iB,eAAex7B,IAAf,CAAoBq7B,gBAApB,EAAsCr7B,IAAtC,CAA2C,UAAU7P,MAAV,EAAkB;AAAE,2BAAOA,UAAUmrC,oBAAjB;AAAwC,iBAAvG,CAAP;AACH;AACD,mBAAOA,oBAAP;AACH,SA/BD;AAgCA;;;;;;;;;;;;;;;;;;;;;;;;AAwBAjG,qBAAaviC,SAAb,CAAuB2oC,SAAvB,GAAmC,UAAU3gC,QAAV,EAAoB;AACnD,iBAAKw/B,gBAAL,CAAsB/gC,IAAtB,CAA2BuB,QAA3B;AACA,mBAAO,SAASktB,kBAAT,GAA8B;AACjC/uB,2BAAW,KAAKqhC,gBAAhB,EAAkCx/B,QAAlC;AACH,aAFM,CAEL1D,IAFK,CAEA,IAFA,CAAP;AAGH,SALD;AAMA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4CAi+B,qBAAaviC,SAAb,CAAuBqpB,MAAvB,GAAgC,UAAUtI,WAAV,EAAuB;AACnD,mBAAO,KAAKia,YAAL,CAAkB,KAAK9uB,OAAvB,EAAgC,KAAKxK,MAArC,EAA6C;AAChD2nB,wBAAQ1mB,UAAUoe,WAAV,IAAyBA,WAAzB,GAAuC,IADC;AAEhDpgB,yBAAS,KAFuC;AAGhDmlC,wBAAQ;AAHwC,aAA7C,CAAP;AAKH,SAND;;AAQA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwCAvD,qBAAaviC,SAAb,CAAuB+8B,EAAvB,GAA4B,UAAU/f,EAAV,EAActb,MAAd,EAAsB0L,OAAtB,EAA+B;AACvD,gBAAIw7B,eAAe,EAAE/1B,UAAU,KAAK8b,QAAjB,EAA2BhuB,SAAS,IAApC,EAAnB;AACA,gBAAIkoC,YAAYvnC,SAAS8L,OAAT,EAAkBw7B,YAAlB,EAAgC/C,gBAAhC,CAAhB;AACA,mBAAO,KAAK7K,YAAL,CAAkBhe,EAAlB,EAAsBtb,MAAtB,EAA8BmnC,SAA9B,CAAP;AACH,SAJD;;AAMA;;;;;;;AAOAtG,qBAAaviC,SAAb,CAAuBsF,MAAvB,GAAgC,UAAUkN,UAAV,EAAsB9Q,MAAtB,EAA8B0L,OAA9B,EAAuC;AACnE,gBAAIA,YAAY,KAAK,CAArB,EAAwB;AAAEA,0BAAU,EAAV;AAAe;AACzC;AACA,gBAAI/K,SAAS+K,QAAQic,MAAjB,KAA4B,CAACjc,QAAQic,MAAR,CAAezrB,IAAhD,EACI,MAAM,IAAIgG,KAAJ,CAAU,6BAAV,CAAN;AACJ,gBAAI2V,MAAM,KAAK3F,MAAL,CAAY0uB,aAAtB;AACAl1B,oBAAQ2T,WAAR,GAAsB3T,QAAQic,MAAR,KAAmB,IAAnB,GAA0B9P,IAAIpY,IAAJ,EAA1B,GAAuCoY,IAAI0Y,OAAJ,CAAYhwB,IAAZ,CAAiBmL,QAAQic,MAAzB,EAAiCjc,QAAQyF,QAAzC,CAA7D;AACA,gBAAIzF,QAAQic,MAAR,IAAkB,CAACjc,QAAQ2T,WAA/B,EACI,MAAM,IAAInd,KAAJ,CAAU,4BAA4BZ,SAASoK,QAAQic,MAAjB,IAA2Bjc,QAAQic,MAAnC,GAA4Cjc,QAAQic,MAAR,CAAezrB,IAAvF,IAA+F,GAAzG,CAAN;AACJ,gBAAIu3B,kBAAkB5b,IAAI0Y,OAAJ,CAAYhwB,IAAZ,CAAiBuQ,UAAjB,EAA6BpF,QAAQyF,QAArC,CAAtB;AACA,mBAAO,IAAIV,WAAJ,CAAgBK,UAAhB,EAA4B2iB,eAA5B,EAA6CzzB,MAA7C,EAAqD0L,OAArD,CAAP;AACH,SAXD;;AAaAm1B,qBAAaviC,SAAb,CAAuB8oC,cAAvB,GAAwC,YAAY;AAChD,gBAAIj/B,QAAQ,IAAZ;AACA,gBAAI+c,UAAU,KAAKhT,MAAL,CAAYgT,OAA1B;AACA,gBAAImiB,gBAAgBniB,QAAQsa,qBAAR,CAA8B90B,QAA9B,EAApB;AACA,gBAAI48B,WAAW,SAAXA,QAAW,GAAY;AAAE,uBAAO,CAAC,IAAIxqB,QAAJ,CAAa3U,MAAM+J,MAAN,CAAa0uB,aAAb,CAA2BnhC,IAA3B,EAAb,CAAD,CAAP;AAA2D,aAAxF;AACA,mBAAO4nC,gBAAgBA,cAAc9xB,WAAd,GAA4B+F,EAA5C,GAAiDgsB,UAAxD;AACH,SAND;AAOA;;;;;;;;;;;;;;;;;;;;;;;AAuBAzG,qBAAaviC,SAAb,CAAuBg7B,YAAvB,GAAsC,UAAUhe,EAAV,EAAcyC,QAAd,EAAwBrS,OAAxB,EAAiC;AACnE,gBAAIvD,QAAQ,IAAZ;AACA,gBAAI4V,aAAa,KAAK,CAAtB,EAAyB;AAAEA,2BAAW,EAAX;AAAgB;AAC3C,gBAAIrS,YAAY,KAAK,CAArB,EAAwB;AAAEA,0BAAU,EAAV;AAAe;AACzC,gBAAIwG,SAAS,KAAKA,MAAlB;AACA,gBAAIgT,UAAUhT,OAAOgT,OAArB;AACAxZ,sBAAU9L,SAAS8L,OAAT,EAAkBy4B,gBAAlB,CAAV;AACA,gBAAIoD,aAAa,SAAbA,UAAa,GAAY;AACzB,uBAAOriB,QAAQ3T,UAAf;AACH,aAFD;AAGA7F,sBAAUvI,OAAOuI,OAAP,EAAgB,EAAElB,SAAS+8B,UAAX,EAAhB,CAAV;AACA,gBAAIjoC,MAAM,KAAKsE,MAAL,CAAY0X,EAAZ,EAAgByC,QAAhB,EAA0BrS,OAA1B,CAAV;AACA,gBAAI87B,cAAc,KAAKJ,cAAL,EAAlB;AACA,gBAAI,CAAC9nC,IAAI0R,MAAJ,EAAL,EACI,OAAO,KAAKw1B,yBAAL,CAA+BgB,WAA/B,EAA4CloC,GAA5C,CAAP;AACJ,gBAAI,CAACA,IAAI2R,KAAJ,EAAL,EACI,OAAOrH,gBAAgBtK,IAAIuK,KAAJ,EAAhB,CAAP;AACJ;;;;;;;;;AASA,gBAAI49B,4BAA4B,SAA5BA,yBAA4B,CAAUl2B,UAAV,EAAsB;AAAE,uBAAO,UAAU1H,KAAV,EAAiB;AAC5E,wBAAIA,iBAAiBgB,SAArB,EAAgC;AAC5B,4BAAI68B,WAAWx1B,OAAOgT,OAAP,CAAeiE,uBAAf,KAA2C5X,WAAWtG,GAArE;AACA,4BAAIpB,MAAMiB,IAAN,KAAexQ,QAAQsQ,UAAR,CAAmBqB,OAAtC,EAA+C;AAC3Cy7B,wCAAYx1B,OAAOihB,SAAP,CAAiBqI,MAAjB,EAAZ;AACA;AACA,mCAAOr5B,SAASC,EAAT,CAAYgN,IAAZ,CAAiB8V,QAAQ1a,OAAzB,CAAP;AACH;AACD,4BAAIQ,SAASnB,MAAMmB,MAAnB;AACA,4BAAInB,MAAMiB,IAAN,KAAexQ,QAAQsQ,UAAR,CAAmBgB,UAAlC,IAAgD/B,MAAMgC,UAAtD,IAAoEb,kBAAkByF,WAA1F,EAAuG;AACnG;AACA;AACA,gCAAIsW,WAAWxV,WAAWwV,QAAX,CAAoB/b,MAApB,CAAf;AACA,mCAAO+b,SAAS0B,GAAT,GAAe/e,KAAf,CAAqB+9B,0BAA0B1gB,QAA1B,CAArB,CAAP;AACH;AACD,4BAAIld,MAAMiB,IAAN,KAAexQ,QAAQsQ,UAAR,CAAmBuB,OAAtC,EAA+C;AAC3Cu7B,wCAAYx1B,OAAOihB,SAAP,CAAiBqI,MAAjB,EAAZ;AACA,mCAAOr5B,SAASC,EAAT,CAAY0H,MAAZ,CAAmBD,KAAnB,CAAP;AACH;AACJ;AACD,wBAAI89B,eAAex/B,MAAMiK,mBAAN,EAAnB;AACAu1B,iCAAa99B,KAAb;AACA,2BAAO1H,SAASC,EAAT,CAAY0H,MAAZ,CAAmBD,KAAnB,CAAP;AACH,iBAvBuD;AAuBpD,aAvBJ;AAwBA,gBAAI0H,aAAa,KAAKW,MAAL,CAAYiE,iBAAZ,CAA8BtX,MAA9B,CAAqC2oC,WAArC,EAAkDloC,GAAlD,CAAjB;AACA,gBAAIsoC,sBAAsBr2B,WAAWkX,GAAX,GAAiB/e,KAAjB,CAAuB+9B,0BAA0Bl2B,UAA1B,CAAvB,CAA1B;AACA/H,qCAAyBo+B,mBAAzB,EApDmE,CAoDpB;AAC/C;AACA,mBAAOzkC,OAAOykC,mBAAP,EAA4B,EAAEr2B,YAAYA,UAAd,EAA5B,CAAP;AACH,SAvDD;;AAyDA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+BAsvB,qBAAaviC,SAAb,CAAuBlB,EAAvB,GAA4B,UAAUg0B,WAAV,EAAuBpxB,MAAvB,EAA+B0L,OAA/B,EAAwC;AAChEA,sBAAU9L,SAAS8L,OAAT,EAAkB,EAAEyF,UAAU,KAAK8b,QAAjB,EAAlB,CAAV;AACA,gBAAIjuB,QAAQ,KAAKkT,MAAL,CAAY0uB,aAAZ,CAA0BrQ,OAA1B,CAAkChwB,IAAlC,CAAuC6wB,WAAvC,EAAoD1lB,QAAQyF,QAA5D,CAAZ;AACA,gBAAI,CAAClQ,UAAUjC,KAAV,CAAL,EACI,OAAOqD,SAAP;AACJ,gBAAI,KAAK4qB,QAAL,KAAkBjuB,KAAtB,EACI,OAAO,KAAP;AACJ,gBAAI,CAACgB,MAAL,EACI,OAAO,IAAP;AACJ,gBAAIgoB,SAAShpB,MAAMU,UAAN,CAAiB,EAAET,SAAS,IAAX,EAAiBY,cAAcG,MAA/B,EAAjB,CAAb;AACA,mBAAOub,MAAMjY,MAAN,CAAa0kB,MAAb,EAAqBzM,MAAMxb,MAAN,CAAaioB,MAAb,EAAqBhoB,MAArB,CAArB,EAAmD,KAAKA,MAAxD,CAAP;AACH,SAXD;;AAaA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsCA6gC,qBAAaviC,SAAb,CAAuBipB,QAAvB,GAAkC,UAAU6J,WAAV,EAAuBpxB,MAAvB,EAA+B0L,OAA/B,EAAwC;AACtEA,sBAAU9L,SAAS8L,OAAT,EAAkB,EAAEyF,UAAU,KAAK8b,QAAjB,EAAlB,CAAV;AACA,gBAAIjvB,OAAOsD,SAAS8vB,WAAT,KAAyBtzB,KAAKY,UAAL,CAAgB0yB,WAAhB,CAApC;AACA,gBAAIpzB,IAAJ,EAAU;AACN,oBAAI,CAACA,KAAKO,OAAL,CAAa,KAAK0uB,QAAL,CAAc/wB,IAA3B,CAAL,EACI,OAAO,KAAP;AACJk1B,8BAAc,KAAKnE,QAAL,CAAc/wB,IAA5B;AACH;AACD,gBAAI8C,QAAQ,KAAKkT,MAAL,CAAY0uB,aAAZ,CAA0BrQ,OAA1B,CAAkChwB,IAAlC,CAAuC6wB,WAAvC,EAAoD1lB,QAAQyF,QAA5D,CAAZ;AAAA,gBAAmF02B,UAAU,KAAK5a,QAAL,CAAc1F,QAA3G;AACA,gBAAI,CAACtmB,UAAUjC,KAAV,CAAL,EACI,OAAOqD,SAAP;AACJ,gBAAI,CAACpB,UAAU4mC,QAAQ7oC,MAAM9C,IAAd,CAAV,CAAL,EACI,OAAO,KAAP;AACJ,gBAAI,CAAC8D,MAAL,EACI,OAAO,IAAP;AACJ,gBAAIgoB,SAAShpB,MAAMU,UAAN,CAAiB,EAAET,SAAS,IAAX,EAAiBY,cAAcG,MAA/B,EAAjB,CAAb;AACA,mBAAOub,MAAMjY,MAAN,CAAa0kB,MAAb,EAAqBzM,MAAMxb,MAAN,CAAaioB,MAAb,EAAqBhoB,MAArB,CAArB,EAAmD,KAAKA,MAAxD,CAAP;AACH,SAjBD;;AAmBA;;;;;;;;;;;;;;;;AAgBA6gC,qBAAaviC,SAAb,CAAuB+6B,IAAvB,GAA8B,UAAUjI,WAAV,EAAuBpxB,MAAvB,EAA+B0L,OAA/B,EAAwC;AAClE,gBAAIo8B,kBAAkB;AAClBC,uBAAO,IADW;AAElB9oC,yBAAS,IAFS;AAGlB46B,0BAAU,KAHQ;AAIlB1oB,0BAAU,KAAK8b;AAJG,aAAtB;AAMAvhB,sBAAU9L,SAAS8L,OAAT,EAAkBo8B,eAAlB,CAAV;AACA9nC,qBAASA,UAAU,EAAnB;AACA,gBAAIhB,QAAQ,KAAKkT,MAAL,CAAY0uB,aAAZ,CAA0BrQ,OAA1B,CAAkChwB,IAAlC,CAAuC6wB,WAAvC,EAAoD1lB,QAAQyF,QAA5D,CAAZ;AACA,gBAAI,CAAClQ,UAAUjC,KAAV,CAAL,EACI,OAAO,IAAP;AACJ,gBAAI0M,QAAQzM,OAAZ,EACIe,SAAS,KAAKA,MAAL,CAAY+sB,QAAZ,CAAqB/sB,MAArB,EAA6B,KAAKitB,QAAlC,EAA4CjuB,KAA5C,CAAT;AACJ,gBAAIgpC,MAAOhpC,SAAS0M,QAAQq8B,KAAlB,GAA2B/oC,MAAMqvB,SAAjC,GAA6CrvB,KAAvD;AACA,gBAAI,CAACgpC,GAAD,IAAQA,IAAI1nC,GAAJ,KAAY+B,SAApB,IAAiC2lC,IAAI1nC,GAAJ,KAAY,IAAjD,EAAuD;AACnD,uBAAO,IAAP;AACH;AACD,mBAAO,KAAK4R,MAAL,CAAYihB,SAAZ,CAAsBkG,IAAtB,CAA2B2O,IAAI1nC,GAA/B,EAAoCN,MAApC,EAA4C;AAC/C65B,0BAAUnuB,QAAQmuB;AAD6B,aAA5C,CAAP;AAGH,SArBD;;AAuBA;;;;;;;;;;;;;;;;;;;;;;;;AAwBAgH,qBAAaviC,SAAb,CAAuB8T,mBAAvB,GAA6C,UAAUomB,OAAV,EAAmB;AAC5D,mBAAO,KAAKuN,oBAAL,GAA4BvN,WAAW,KAAKuN,oBAAnD;AACH,SAFD;AAGAlF,qBAAaviC,SAAb,CAAuBsjB,GAAvB,GAA6B,UAAUwP,WAAV,EAAuBlgB,IAAvB,EAA6B;AACtD,gBAAI2G,MAAM,KAAK3F,MAAL,CAAY0uB,aAAtB;AACA,gBAAI1lC,UAAUE,MAAV,KAAqB,CAAzB,EACI,OAAOyc,IAAI+J,GAAJ,EAAP;AACJ,mBAAO/J,IAAI+J,GAAJ,CAAQwP,WAAR,EAAqBlgB,QAAQ,KAAK+b,QAAlC,CAAP;AACH,SALD;AAMA;;;;;;;;;;;;AAYA4T,qBAAaviC,SAAb,CAAuBilC,QAAvB,GAAkC,UAAUnS,WAAV,EAAuB7f,UAAvB,EAAmC;AACjE,gBAAIvS,QAAQ,KAAK4iB,GAAL,CAASwP,WAAT,CAAZ;AACA,gBAAI,CAACpyB,KAAD,IAAU,CAACA,MAAMukC,QAArB,EACI,MAAM,IAAIrhC,KAAJ,CAAU,uBAAuBkvB,WAAjC,CAAN;AACJ,gBAAIoW,cAAc,KAAKJ,cAAL,EAAlB;AACA,gBAAIxjC,SAAS+Z,UAAUC,eAAV,CAA0B4pB,WAA1B,CAAb;AACAj2B,yBAAaA,cAAc,KAAKW,MAAL,CAAYiE,iBAAZ,CAA8BtX,MAA9B,CAAqC2oC,WAArC,EAAkD5jC,MAAlD,CAA3B;AACA,mBAAO4/B,cAAcjyB,UAAd,EAA0BvS,KAA1B,CAAP;AACH,SARD;AASA,eAAO6hC,YAAP;AACH,KA/hBmB,EAApB;;AAiiBA;;;;;;;;;;;;;OAniO2C,CAgjOvC;;AAEJ;;;;AAIA;AACA;;;;;;;;;;;;;;;AAeA,QAAIz+B,KAAK;AACL;AACAgN,cAAM,cAAUxN,MAAV,EAAkB;AAAE,mBAAO,IAAIqmC,OAAJ,CAAY,UAAUzmB,OAAV,EAAmB1X,MAAnB,EAA2B;AAAE,uBAAO0X,QAAQ5f,MAAR,CAAP;AAAyB,aAAlE,CAAP;AAA6E,SAFlG;AAGL;AACAkI,gBAAQ,gBAAUlI,MAAV,EAAkB;AAAE,mBAAO,IAAIqmC,OAAJ,CAAY,UAAUzmB,OAAV,EAAmB1X,MAAnB,EAA2B;AAAEA,uBAAOlI,MAAP;AAAiB,aAA1D,CAAP;AAAqE,SAJ5F;AAKL;AACAojB,eAAO,iBAAY;AACf,gBAAIkjB,WAAW,EAAf;AACAA,qBAASz+B,OAAT,GAAmB,IAAIw+B,OAAJ,CAAY,UAAUzmB,OAAV,EAAmB1X,MAAnB,EAA2B;AACtDo+B,yBAAS1mB,OAAT,GAAmBA,OAAnB;AACA0mB,yBAASp+B,MAAT,GAAkBA,MAAlB;AACH,aAHkB,CAAnB;AAIA,mBAAOo+B,QAAP;AACH,SAbI;AAcL;AACAprC,aAAK,aAAUinB,QAAV,EAAoB;AACrB,gBAAIxiB,QAAQwiB,QAAR,CAAJ,EAAuB;AACnB,uBAAOkkB,QAAQnrC,GAAR,CAAYinB,QAAZ,CAAP;AACH;AACD,gBAAIpjB,SAASojB,QAAT,CAAJ,EAAwB;AACpB;AACA;AACA,oBAAIzQ,QAAQzS,OAAOqD,IAAP,CAAY6f,QAAZ,EACPvnB,GADO,CACH,UAAU0J,GAAV,EAAe;AAAE,2BAAO6d,SAAS7d,GAAT,EAAcsF,IAAd,CAAmB,UAAU5J,MAAV,EAAkB;AAAE,+BAAQ,EAAEsE,KAAKA,GAAP,EAAY7J,KAAKuF,MAAjB,EAAR;AAAqC,qBAA5E,CAAP;AAAuF,iBADrG,CAAZ;AAEA;AACA,uBAAOQ,GAAGtF,GAAH,CAAOwW,KAAP,EAAc9H,IAAd,CAAmB,UAAUgR,SAAV,EAAqB;AAC3C,2BAAOA,UAAUxf,MAAV,CAAiB,UAAUmH,GAAV,EAAesT,KAAf,EAAsB;AAAEtT,4BAAIsT,MAAMvR,GAAV,IAAiBuR,MAAMpb,GAAvB,CAA4B,OAAO8H,GAAP;AAAa,qBAAlF,EAAoF,EAApF,CAAP;AACH,iBAFM,CAAP;AAGH;AACJ;AA7BI,KAAT;;AAgCA;;;;AAIA;AACA;AACA,QAAI+gB,UAAU,EAAd;AACA,QAAIijB,iBAAiB,kCAArB;AACA,QAAIC,iBAAiB,YAArB;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+CA,QAAI9lC,YAAY;AACZ;AACAsf,aAAK,aAAU1lB,IAAV,EAAgB;AAAE,mBAAOgpB,QAAQhpB,IAAR,CAAP;AAAuB,SAFlC;AAGZ;AACAmsC,aAAK,aAAUnsC,IAAV,EAAgB;AAAE,mBAAOoG,UAAUsf,GAAV,CAAc1lB,IAAd,KAAuB,IAA9B;AAAqC,SAJhD;AAKZ;;;;;;;AAOAwB,gBAAQ,gBAAU5C,EAAV,EAAc8T,OAAd,EAAuB05B,MAAvB,EAA+B;AACnC,gBAAI3U,SAASxwB,OAAO,EAAP,EAAW+hB,OAAX,EAAoBojB,UAAU,EAA9B,CAAb;AACA,gBAAItoC,SAASsC,UAAUitB,QAAV,CAAmBz0B,EAAnB,CAAb;AACA,gBAAIytC,cAAcphC,gBAAgB,UAAUjB,GAAV,EAAe;AAAE,uBAAOytB,OAAOxzB,cAAP,CAAsB+F,GAAtB,CAAP;AAAoC,aAArE,EAAuE,UAAUA,GAAV,EAAe;AAAE,uBAAO,gCAAgCA,GAAhC,GAAsC,GAA7C;AAAmD,aAA3I,CAAlB;AACA,gBAAI5K,OAAO0E,OAAOC,MAAP,CAAcsoC,WAAd,EAA2B/rC,GAA3B,CAA+B,UAAUU,CAAV,EAAa;AAAE,uBAAOy2B,OAAOz2B,CAAP,CAAP;AAAmB,aAAjE,CAAX;AACA,gBAAIuD,WAAW3F,EAAX,CAAJ,EACI,OAAOA,GAAGG,KAAH,CAAS2T,OAAT,EAAkBtT,IAAlB,CAAP,CADJ,KAGI,OAAOR,GAAGE,KAAH,CAAS,CAAC,CAAV,EAAa,CAAb,EAAgBC,KAAhB,CAAsB2T,OAAtB,EAA+BtT,IAA/B,CAAP;AACP,SArBW;AAsBZ;;;;;;AAMAi0B,kBAAU,kBAAUz0B,EAAV,EAAc;AACpB,gBAAI,CAAC6G,aAAa7G,EAAb,CAAL,EACI,MAAM,IAAIoH,KAAJ,CAAU,iCAAiCpH,EAA3C,CAAN;AACJ,gBAAIA,MAAMA,GAAG0tC,OAAb,EACI,OAAO1tC,GAAG0tC,OAAV;AACJ,gBAAIjnC,QAAQzG,EAAR,CAAJ,EACI,OAAOA,GAAGE,KAAH,CAAS,CAAT,EAAY,CAAC,CAAb,CAAP;AACJ,gBAAIovB,QAAQtvB,GAAG0F,QAAH,GAAc2a,OAAd,CAAsBgtB,cAAtB,EAAsC,EAAtC,CAAZ;AACA,gBAAIxsC,SAASyuB,MAAMpvB,KAAN,CAAYovB,MAAM5lB,OAAN,CAAc,GAAd,IAAqB,CAAjC,EAAoC4lB,MAAM5lB,OAAN,CAAc,GAAd,CAApC,EAAwDuX,KAAxD,CAA8DqsB,cAA9D,CAAb;AACA,mBAAOzsC,UAAU,EAAjB;AACH;AAtCW,KAAhB;;AAyCA;;;;AAIA;AACA,QAAI8sC,sBAAsB,SAAtBA,mBAAsB,CAAU5d,IAAV,EAAgB;AAAE,eAAO,UAAUd,GAAV,EAAe;AAC9D,gBAAI,CAACA,GAAL,EACI,OAAO,CAAC,EAAD,EAAK,EAAL,CAAP;AACJ,gBAAIplB,MAAMolB,IAAIvlB,OAAJ,CAAYqmB,IAAZ,CAAV;AACA,gBAAIlmB,QAAQ,CAAC,CAAb,EACI,OAAO,CAAColB,GAAD,EAAM,EAAN,CAAP;AACJ,mBAAO,CAACA,IAAIpR,MAAJ,CAAW,CAAX,EAAchU,GAAd,CAAD,EAAqBolB,IAAIpR,MAAJ,CAAWhU,MAAM,CAAjB,CAArB,CAAP;AACH,SAP2C;AAOxC,KAPJ;AAQA,QAAI+jC,YAAYD,oBAAoB,GAApB,CAAhB;AACA,QAAIE,aAAaF,oBAAoB,GAApB,CAAjB;AACA,QAAIG,aAAaH,oBAAoB,GAApB,CAAjB;AACA,QAAII,cAAc,SAAdA,WAAc,CAAU9e,GAAV,EAAe;AAAE,eAAOA,MAAMA,IAAI5O,OAAJ,CAAY,IAAZ,EAAkB,EAAlB,CAAN,GAA8B,EAArC;AAA0C,KAA7E;AACA,QAAI2tB,mBAAmB,SAAnBA,gBAAmB,CAAUC,KAAV,EAAiB39B,EAAjB,EAAqB;AACxC,YAAIlF,MAAMkF,GAAG,CAAH,CAAV;AAAA,YAAiBxJ,SAASwJ,GAAG,CAAH,CAA1B;AACA,YAAI,CAAC29B,MAAM5oC,cAAN,CAAqB+F,GAArB,CAAL,EAAgC;AAC5B6iC,kBAAM7iC,GAAN,IAAatE,MAAb;AACH,SAFD,MAGK,IAAIL,QAAQwnC,MAAM7iC,GAAN,CAAR,CAAJ,EAAyB;AAC1B6iC,kBAAM7iC,GAAN,EAAWnB,IAAX,CAAgBnD,MAAhB;AACH,SAFI,MAGA;AACDmnC,kBAAM7iC,GAAN,IAAa,CAAC6iC,MAAM7iC,GAAN,CAAD,EAAatE,MAAb,CAAb;AACH;AACD,eAAOmnC,KAAP;AACH,KAZD;AAaA,QAAIC,YAAY,SAAZA,SAAY,CAAU3R,WAAV,EAAuB;AACnC,eAAOA,YAAY96B,KAAZ,CAAkB,GAAlB,EAAuB0D,MAAvB,CAA8BuD,QAA9B,EAAwChH,GAAxC,CAA4CosC,UAA5C,EAAwD5rC,MAAxD,CAA+D8rC,gBAA/D,EAAiF,EAAjF,CAAP;AACH,KAFD;AAGA,aAASG,UAAT,CAAoB3oC,GAApB,EAAyB;AACrB,YAAI4oC,gBAAgB,SAAhBA,aAAgB,CAAUhsC,CAAV,EAAa;AAAE,mBAAOA,KAAK,EAAZ;AAAiB,SAApD;AACA,YAAIkO,KAAKs9B,UAAUpoC,GAAV,EAAe9D,GAAf,CAAmB0sC,aAAnB,CAAT;AAAA,YAA4CC,aAAa/9B,GAAG,CAAH,CAAzD;AAAA,YAAgE8gB,OAAO9gB,GAAG,CAAH,CAAvE;AACA,YAAIg+B,KAAKT,WAAWQ,UAAX,EAAuB3sC,GAAvB,CAA2B0sC,aAA3B,CAAT;AAAA,YAAoDtjC,OAAOwjC,GAAG,CAAH,CAA3D;AAAA,YAAkErT,SAASqT,GAAG,CAAH,CAA3E;AACA,eAAO,EAAExjC,MAAMA,IAAR,EAAcmwB,QAAQA,MAAtB,EAA8B7J,MAAMA,IAApC,EAA0C5rB,KAAKA,GAA/C,EAAP;AACH;AACD,QAAI+oC,WAAW,SAAXA,QAAW,CAAUC,GAAV,EAAe;AAC1B,YAAI1jC,OAAO0jC,IAAI1jC,IAAJ,EAAX;AACA,YAAI2jC,eAAeD,IAAIvT,MAAJ,EAAnB;AACA,YAAI7J,OAAOod,IAAIpd,IAAJ,EAAX;AACA,YAAI6J,SAASl1B,OAAOqD,IAAP,CAAYqlC,YAAZ,EAA0B/sC,GAA1B,CAA8B,UAAU0J,GAAV,EAAe;AACtD,gBAAIhG,QAAQqpC,aAAarjC,GAAb,CAAZ;AACA,gBAAIsjC,OAAOjoC,QAAQrB,KAAR,IAAiBA,KAAjB,GAAyB,CAACA,KAAD,CAApC;AACA,mBAAOspC,KAAKhtC,GAAL,CAAS,UAAUoF,MAAV,EAAkB;AAAE,uBAAOsE,MAAM,GAAN,GAAYtE,MAAnB;AAA4B,aAAzD,CAAP;AACH,SAJY,EAIV5E,MAJU,CAIH4J,OAJG,EAIM,EAJN,EAIUzI,IAJV,CAIe,GAJf,CAAb;AAKA,eAAOyH,QAAQmwB,SAAS,MAAMA,MAAf,GAAwB,EAAhC,KAAuC7J,OAAO,MAAMA,IAAb,GAAoB,EAA3D,CAAP;AACH,KAVD;AAWA,aAASud,qBAAT,CAA+BvtC,IAA/B,EAAqC09B,OAArC,EAA8C8P,YAA9C,EAA4DC,kBAA5D,EAAgF;AAC5E,eAAO,UAAUz3B,MAAV,EAAkB;AACrB,gBAAI03B,UAAU13B,OAAOwpB,eAAP,GAAyB,IAAIgO,YAAJ,CAAiBx3B,MAAjB,CAAvC;AACA,gBAAI23B,gBAAgB33B,OAAOguB,cAAP,GAAwB,IAAIyJ,kBAAJ,CAAuBz3B,MAAvB,EAA+B0nB,OAA/B,CAA5C;AACA,qBAASpO,OAAT,CAAiBtZ,MAAjB,EAAyB;AACrBA,uBAAOsZ,OAAP,CAAeoe,OAAf;AACA13B,uBAAOsZ,OAAP,CAAeqe,aAAf;AACH;AACD,mBAAO,EAAE3tC,MAAMA,IAAR,EAAc0tC,SAASA,OAAvB,EAAgCC,eAAeA,aAA/C,EAA8Dre,SAASA,OAAvE,EAAP;AACH,SARD;AASH;;AAED;;;OArwO2C,CAwwOvC;AACJ;AACA,QAAIse,uBAAwB,YAAY;AACpC,iBAASA,oBAAT,CAA8B53B,MAA9B,EAAsC63B,eAAtC,EAAuD;AACnD,gBAAI5hC,QAAQ,IAAZ;AACA,iBAAK4hC,eAAL,GAAuBA,eAAvB;AACA,iBAAKC,SAAL,GAAiB,UAAUjP,GAAV,EAAe;AAAE,uBAAO5yB,MAAM8hC,UAAN,CAAiBhnC,OAAjB,CAAyB,UAAUiF,EAAV,EAAc;AAAE,2BAAOA,GAAG6yB,GAAH,CAAP;AAAiB,iBAA1D,CAAP;AAAqE,aAAvG;AACA,iBAAKkP,UAAL,GAAkB,EAAlB;AACA,iBAAK/d,IAAL,GAAY,YAAY;AAAE,uBAAO+c,WAAW9gC,MAAM+hC,IAAN,EAAX,EAAyBhe,IAAhC;AAAuC,aAAjE;AACA,iBAAKtmB,IAAL,GAAY,YAAY;AAAE,uBAAOqjC,WAAW9gC,MAAM+hC,IAAN,EAAX,EAAyBtkC,IAAhC;AAAuC,aAAjE;AACA,iBAAKmwB,MAAL,GAAc,YAAY;AAAE,uBAAOiT,UAAUC,WAAW9gC,MAAM+hC,IAAN,EAAX,EAAyBnU,MAAnC,CAAP;AAAoD,aAAhF;AACA,iBAAKoU,SAAL,GAAiB3nC,UAAUA,OAAOgY,QAAlC;AACA,iBAAK4vB,QAAL,GAAgB5nC,UAAUA,OAAO6nC,OAAjC;AACH;AACDP,6BAAqBxrC,SAArB,CAA+BgC,GAA/B,GAAqC,UAAUA,GAAV,EAAe6a,OAAf,EAAwB;AACzD,gBAAIA,YAAY,KAAK,CAArB,EAAwB;AAAEA,0BAAU,IAAV;AAAiB;AAC3C,gBAAIla,UAAUX,GAAV,KAAkBA,QAAQ,KAAK4pC,IAAL,EAA9B,EAA2C;AACvC,qBAAKx8B,IAAL,CAAU,IAAV,EAAgB,IAAhB,EAAsBpN,GAAtB,EAA2B6a,OAA3B;AACA,oBAAI,KAAK4uB,eAAT,EAA0B;AACtB,wBAAIO,QAAQnnC,OAAO,IAAIonC,KAAJ,CAAU,gBAAV,CAAP,EAAoC,EAAEjqC,KAAKA,GAAP,EAApC,CAAZ;AACA,yBAAK2pC,UAAL,CAAgBhnC,OAAhB,CAAwB,UAAUiF,EAAV,EAAc;AAAE,+BAAOA,GAAGoiC,KAAH,CAAP;AAAmB,qBAA3D;AACH;AACJ;AACD,mBAAOjB,SAAS,IAAT,CAAP;AACH,SAVD;AAWAS,6BAAqBxrC,SAArB,CAA+Bi9B,QAA/B,GAA0C,UAAUrzB,EAAV,EAAc;AACpD,gBAAIC,QAAQ,IAAZ;AACA,iBAAK8hC,UAAL,CAAgBllC,IAAhB,CAAqBmD,EAArB;AACA,mBAAO,YAAY;AAAE,uBAAOzD,WAAW0D,MAAM8hC,UAAjB,EAA6B/hC,EAA7B,CAAP;AAA0C,aAA/D;AACH,SAJD;AAKA4hC,6BAAqBxrC,SAArB,CAA+BktB,OAA/B,GAAyC,UAAUtZ,MAAV,EAAkB;AACvDlN,qBAAS,KAAKilC,UAAd;AACH,SAFD;AAGA,eAAOH,oBAAP;AACH,KAhC2B,EAA5B;;AAkCA,QAAIU,YAAanoC,aAAaA,UAAUmoC,SAAxB,IAAuC,YAAY;AAC/D,YAAIC,gBAAgB5pC,OAAO6pC,cAAP,IACf,EAAEC,WAAW,EAAb,cAA6BnpC,KAA7B,IAAsC,UAAU2J,CAAV,EAAalO,CAAb,EAAgB;AAAEkO,cAAEw/B,SAAF,GAAc1tC,CAAd;AAAkB,SAD3D,IAEhB,UAAUkO,CAAV,EAAalO,CAAb,EAAgB;AAAE,iBAAK,IAAIgyB,CAAT,IAAchyB,CAAd;AAAiB,oBAAIA,EAAEkD,cAAF,CAAiB8uB,CAAjB,CAAJ,EAAyB9jB,EAAE8jB,CAAF,IAAOhyB,EAAEgyB,CAAF,CAAP;AAA1C;AAAwD,SAF9E;AAGA,eAAO,UAAU9jB,CAAV,EAAalO,CAAb,EAAgB;AACnBwtC,0BAAct/B,CAAd,EAAiBlO,CAAjB;AACA,qBAAS2tC,EAAT,GAAc;AAAE,qBAAKttC,WAAL,GAAmB6N,CAAnB;AAAuB;AACvCA,cAAE7M,SAAF,GAAcrB,MAAM,IAAN,GAAa4D,OAAOhC,MAAP,CAAc5B,CAAd,CAAb,IAAiC2tC,GAAGtsC,SAAH,GAAerB,EAAEqB,SAAjB,EAA4B,IAAIssC,EAAJ,EAA7D,CAAd;AACH,SAJD;AAKH,KATqD,EAAtD;AAUA;;;;AAIA;AACA;AACA,QAAIC,sBAAuB,UAAUC,MAAV,EAAkB;AACzCN,kBAAUK,mBAAV,EAA+BC,MAA/B;AACA,iBAASD,mBAAT,CAA6B34B,MAA7B,EAAqC;AACjC,gBAAI/J,QAAQ2iC,OAAOlvC,IAAP,CAAY,IAAZ,EAAkBsW,MAAlB,EAA0B,KAA1B,KAAoC,IAAhD;AACA1P,mBAAOuoC,gBAAP,CAAwB,YAAxB,EAAsC5iC,MAAM6hC,SAA5C,EAAuD,KAAvD;AACA,mBAAO7hC,KAAP;AACH;AACD0iC,4BAAoBvsC,SAApB,CAA8B4rC,IAA9B,GAAqC,YAAY;AAC7C,mBAAOrB,YAAY,KAAKsB,SAAL,CAAeje,IAA3B,CAAP;AACH,SAFD;AAGA2e,4BAAoBvsC,SAApB,CAA8BoP,IAA9B,GAAqC,UAAU1O,KAAV,EAAiBgsC,KAAjB,EAAwB1qC,GAAxB,EAA6B6a,OAA7B,EAAsC;AACvE,iBAAKgvB,SAAL,CAAeje,IAAf,GAAsB5rB,GAAtB;AACH,SAFD;AAGAuqC,4BAAoBvsC,SAApB,CAA8BktB,OAA9B,GAAwC,UAAUtZ,MAAV,EAAkB;AACtD44B,mBAAOxsC,SAAP,CAAiBktB,OAAjB,CAAyB5vB,IAAzB,CAA8B,IAA9B,EAAoCsW,MAApC;AACA1P,mBAAOyoC,mBAAP,CAA2B,YAA3B,EAAyC,KAAKjB,SAA9C;AACH,SAHD;AAIA,eAAOa,mBAAP;AACH,KAlB0B,CAkBzBf,oBAlByB,CAA3B;;AAoBA,QAAIoB,cAAe7oC,aAAaA,UAAUmoC,SAAxB,IAAuC,YAAY;AACjE,YAAIC,gBAAgB5pC,OAAO6pC,cAAP,IACf,EAAEC,WAAW,EAAb,cAA6BnpC,KAA7B,IAAsC,UAAU2J,CAAV,EAAalO,CAAb,EAAgB;AAAEkO,cAAEw/B,SAAF,GAAc1tC,CAAd;AAAkB,SAD3D,IAEhB,UAAUkO,CAAV,EAAalO,CAAb,EAAgB;AAAE,iBAAK,IAAIgyB,CAAT,IAAchyB,CAAd;AAAiB,oBAAIA,EAAEkD,cAAF,CAAiB8uB,CAAjB,CAAJ,EAAyB9jB,EAAE8jB,CAAF,IAAOhyB,EAAEgyB,CAAF,CAAP;AAA1C;AAAwD,SAF9E;AAGA,eAAO,UAAU9jB,CAAV,EAAalO,CAAb,EAAgB;AACnBwtC,0BAAct/B,CAAd,EAAiBlO,CAAjB;AACA,qBAAS2tC,EAAT,GAAc;AAAE,qBAAKttC,WAAL,GAAmB6N,CAAnB;AAAuB;AACvCA,cAAE7M,SAAF,GAAcrB,MAAM,IAAN,GAAa4D,OAAOhC,MAAP,CAAc5B,CAAd,CAAb,IAAiC2tC,GAAGtsC,SAAH,GAAerB,EAAEqB,SAAjB,EAA4B,IAAIssC,EAAJ,EAA7D,CAAd;AACH,SAJD;AAKH,KATuD,EAAxD;AAUA;;;;AAIA;AACA;AACA,QAAIO,wBAAyB,UAAUL,MAAV,EAAkB;AAC3CI,oBAAYC,qBAAZ,EAAmCL,MAAnC;AACA,iBAASK,qBAAT,CAA+Bj5B,MAA/B,EAAuC;AACnC,mBAAO44B,OAAOlvC,IAAP,CAAY,IAAZ,EAAkBsW,MAAlB,EAA0B,IAA1B,KAAmC,IAA1C;AACH;AACDi5B,8BAAsB7sC,SAAtB,CAAgC4rC,IAAhC,GAAuC,YAAY;AAC/C,mBAAO,KAAKkB,IAAZ;AACH,SAFD;AAGAD,8BAAsB7sC,SAAtB,CAAgCoP,IAAhC,GAAuC,UAAU1O,KAAV,EAAiBgsC,KAAjB,EAAwB1qC,GAAxB,EAA6B6a,OAA7B,EAAsC;AACzE,iBAAKiwB,IAAL,GAAY9qC,GAAZ;AACH,SAFD;AAGA,eAAO6qC,qBAAP;AACH,KAZ4B,CAY3BrB,oBAZ2B,CAA7B;;AAcA,QAAIuB,cAAehpC,aAAaA,UAAUmoC,SAAxB,IAAuC,YAAY;AACjE,YAAIC,gBAAgB5pC,OAAO6pC,cAAP,IACf,EAAEC,WAAW,EAAb,cAA6BnpC,KAA7B,IAAsC,UAAU2J,CAAV,EAAalO,CAAb,EAAgB;AAAEkO,cAAEw/B,SAAF,GAAc1tC,CAAd;AAAkB,SAD3D,IAEhB,UAAUkO,CAAV,EAAalO,CAAb,EAAgB;AAAE,iBAAK,IAAIgyB,CAAT,IAAchyB,CAAd;AAAiB,oBAAIA,EAAEkD,cAAF,CAAiB8uB,CAAjB,CAAJ,EAAyB9jB,EAAE8jB,CAAF,IAAOhyB,EAAEgyB,CAAF,CAAP;AAA1C;AAAwD,SAF9E;AAGA,eAAO,UAAU9jB,CAAV,EAAalO,CAAb,EAAgB;AACnBwtC,0BAAct/B,CAAd,EAAiBlO,CAAjB;AACA,qBAAS2tC,EAAT,GAAc;AAAE,qBAAKttC,WAAL,GAAmB6N,CAAnB;AAAuB;AACvCA,cAAE7M,SAAF,GAAcrB,MAAM,IAAN,GAAa4D,OAAOhC,MAAP,CAAc5B,CAAd,CAAb,IAAiC2tC,GAAGtsC,SAAH,GAAerB,EAAEqB,SAAjB,EAA4B,IAAIssC,EAAJ,EAA7D,CAAd;AACH,SAJD;AAKH,KATuD,EAAxD;AAUA;;;;;AAKA,QAAIU,2BAA4B,UAAUR,MAAV,EAAkB;AAC9CO,oBAAYC,wBAAZ,EAAsCR,MAAtC;AACA,iBAASQ,wBAAT,CAAkCp5B,MAAlC,EAA0C;AACtC,gBAAI/J,QAAQ2iC,OAAOlvC,IAAP,CAAY,IAAZ,EAAkBsW,MAAlB,EAA0B,IAA1B,KAAmC,IAA/C;AACA/J,kBAAMojC,OAAN,GAAgBr5B,OAAOgpB,UAAP,CAAkBt8B,MAAlC;AACA4D,mBAAOuoC,gBAAP,CAAwB,UAAxB,EAAoC5iC,MAAM6hC,SAA1C,EAAqD,KAArD;AACA,mBAAO7hC,KAAP;AACH;;AAEDmjC,iCAAyBhtC,SAAzB,CAAmC4rC,IAAnC,GAA0C,YAAY;AAClD,gBAAI9+B,KAAK,KAAK++B,SAAd;AAAA,gBAAyB9jB,WAAWjb,GAAGib,QAAvC;AAAA,gBAAiD6F,OAAO9gB,GAAG8gB,IAA3D;AAAA,gBAAiE6J,SAAS3qB,GAAG2qB,MAA7E;AACAA,qBAAS4S,WAAW5S,MAAX,EAAmB,CAAnB,CAAT,CAFkD,CAElB;AAChC7J,mBAAOwc,UAAUxc,IAAV,EAAgB,CAAhB,CAAP,CAHkD,CAGvB;AAC3B,mBAAO7F,YAAY0P,SAAS,MAAMA,MAAf,GAAwB,EAApC,KAA2C7J,OAAO,MAAM6J,MAAb,GAAsB,EAAjE,CAAP;AACH,SALD;AAMAuV,iCAAyBhtC,SAAzB,CAAmCoP,IAAnC,GAA0C,UAAU1O,KAAV,EAAiBgsC,KAAjB,EAAwB1qC,GAAxB,EAA6B6a,OAA7B,EAAsC;AAC5E,gBAAI/P,KAAK,IAAT;AAAA,gBAAemgC,UAAUngC,GAAGmgC,OAA5B;AAAA,gBAAqCnB,WAAWh/B,GAAGg/B,QAAnD;AACA,gBAAIoB,UAAUD,QAAQzR,QAAR,KAAqBx5B,GAAnC;AACA,gBAAI6a,OAAJ,EAAa;AACTivB,yBAASqB,YAAT,CAAsBzsC,KAAtB,EAA6BgsC,KAA7B,EAAoCQ,OAApC;AACH,aAFD,MAGK;AACDpB,yBAASsB,SAAT,CAAmB1sC,KAAnB,EAA0BgsC,KAA1B,EAAiCQ,OAAjC;AACH;AACJ,SATD;AAUAF,iCAAyBhtC,SAAzB,CAAmCktB,OAAnC,GAA6C,UAAUtZ,MAAV,EAAkB;AAC3D44B,mBAAOxsC,SAAP,CAAiBktB,OAAjB,CAAyB5vB,IAAzB,CAA8B,IAA9B,EAAoCsW,MAApC;AACA1P,mBAAOyoC,mBAAP,CAA2B,UAA3B,EAAuC,KAAKjB,SAA5C;AACH,SAHD;AAIA,eAAOsB,wBAAP;AACH,KA9B+B,CA8B9BxB,oBA9B8B,CAAhC;;AAgCA;AACA,QAAI6B,uBAAwB,YAAY;AACpC,iBAASA,oBAAT,GAAgC;AAC5B,gBAAIxjC,QAAQ,IAAZ;AACA,iBAAKyjC,SAAL,GAAiB,EAAjB;AACA,iBAAKC,KAAL,GAAa,EAAb;AACA,iBAAKC,SAAL,GAAiB,MAAjB;AACA,iBAAKC,KAAL,GAAa,WAAb;AACA,iBAAKC,WAAL,GAAmB,EAAnB;AACA,iBAAKlQ,IAAL,GAAY,YAAY;AAAE,uBAAO3zB,MAAM0jC,KAAb;AAAqB,aAA/C;AACA,iBAAK9P,QAAL,GAAgB,YAAY;AAAE,uBAAO5zB,MAAM2jC,SAAb;AAAyB,aAAvD;AACA,iBAAK9P,IAAL,GAAY,YAAY;AAAE,uBAAO7zB,MAAM4jC,KAAb;AAAqB,aAA/C;AACA,iBAAKjS,QAAL,GAAgB,YAAY;AAAE,uBAAO3xB,MAAMyjC,SAAb;AAAyB,aAAvD;AACA,iBAAKjQ,SAAL,GAAiB,YAAY;AAAE,uBAAO,KAAP;AAAe,aAA9C;AACA,iBAAKC,UAAL,GAAkB,UAAUqQ,MAAV,EAAkB;AAAE,uBAAOhrC,UAAUgrC,MAAV,IAAoB9jC,MAAM6jC,WAAN,GAAoBC,MAAxC,GAAiD9jC,MAAM6jC,WAA9D;AAA4E,aAAlH;AACA,iBAAKxgB,OAAL,GAAe/nB,MAAf;AACH;AACD,eAAOkoC,oBAAP;AACH,KAjB2B,EAA5B;;AAmBA;;;;AAIA;AACA;AACA,QAAIO,wBAAyB,YAAY;AACrC,iBAASA,qBAAT,CAA+Bh6B,MAA/B,EAAuCi6B,QAAvC,EAAiD;AAC7C,gBAAIA,aAAa,KAAK,CAAtB,EAAyB;AAAEA,2BAAW,KAAX;AAAmB;AAC9C,iBAAKA,QAAL,GAAgBA,QAAhB;AACA,iBAAKP,SAAL,GAAiBvpC,SAAjB;AACA,iBAAK2pC,WAAL,GAAmB,EAAnB;AACH;AACDE,8BAAsB5tC,SAAtB,CAAgCw9B,IAAhC,GAAuC,YAAY;AAC/C,gBAAIthB,SAASshB,IAAb,EAAmB;AACf,uBAAOrC,OAAOjf,SAASshB,IAAhB,CAAP;AACH;AACD,mBAAO,KAAKC,QAAL,OAAoB,OAApB,GAA8B,GAA9B,GAAoC,EAA3C;AACH,SALD;AAMAmQ,8BAAsB5tC,SAAtB,CAAgCy9B,QAAhC,GAA2C,YAAY;AACnD,mBAAOvhB,SAASuhB,QAAT,CAAkB5gB,OAAlB,CAA0B,IAA1B,EAAgC,EAAhC,CAAP;AACH,SAFD;AAGA+wB,8BAAsB5tC,SAAtB,CAAgC09B,IAAhC,GAAuC,YAAY;AAC/C,mBAAOxhB,SAASwhB,IAAhB;AACH,SAFD;AAGAkQ,8BAAsB5tC,SAAtB,CAAgCq9B,SAAhC,GAA4C,YAAY;AACpD,mBAAO,KAAKwQ,QAAZ;AACH,SAFD;AAGAD,8BAAsB5tC,SAAtB,CAAgCs9B,UAAhC,GAA6C,UAAUwQ,SAAV,EAAqB;AAC9D,mBAAOnrC,UAAUmrC,SAAV,IAAuB,KAAKJ,WAAL,GAAmBI,SAA1C,GAAsD,KAAKJ,WAAlE;AACH,SAFD;;AAIAE,8BAAsB5tC,SAAtB,CAAgCw7B,QAAhC,GAA2C,UAAUT,IAAV,EAAgB;AACvD,mBAAOp4B,UAAUo4B,IAAV,IAAkB,KAAKuS,SAAL,GAAiBvS,IAAnC,GAA0C,KAAKuS,SAAL,IAAkB,KAAKS,qBAAL,EAAnE;AACH,SAFD;AAGAH,8BAAsB5tC,SAAtB,CAAgC+tC,qBAAhC,GAAwD,YAAY;AAChE,gBAAIC,WAAWC,SAASC,oBAAT,CAA8B,MAA9B,CAAf;AACA,mBAAO,KAAKZ,SAAL,GAAiBU,SAASlxC,MAAT,GAAkBkxC,SAAS,CAAT,EAAYjT,IAAZ,CAAiB1gB,MAAjB,CAAwB6B,SAASiyB,MAAT,CAAgBrxC,MAAxC,CAAlB,GAAoE,EAA5F;AACH,SAHD;AAIA8wC,8BAAsB5tC,SAAtB,CAAgCktB,OAAhC,GAA0C,YAAY,CAAG,CAAzD;AACA,eAAO0gB,qBAAP;AACH,KAnC4B,EAA7B;;AAqCA;;;;AAIA;AACA,aAASQ,cAAT,CAAwBx6B,MAAxB,EAAgC;AAC5B/P,iBAASG,SAAT,GAAqBA,SAArB;AACAH,iBAASC,EAAT,GAAcA,EAAd;AACA,eAAO,EAAElG,MAAM,kBAAR,EAA4BkG,IAAIA,EAAhC,EAAoCE,WAAWA,SAA/C,EAA0DkpB,SAAS,mBAAY;AAAE,uBAAO,IAAP;AAAc,aAA/F,EAAP;AACH;AACD;AACA,QAAImhB,qBAAqBlD,sBAAsB,0BAAtB,EAAkD,KAAlD,EAAyDoB,mBAAzD,EAA8EqB,qBAA9E,CAAzB;AACA;AACA,QAAIU,0BAA0BnD,sBAAsB,2BAAtB,EAAmD,IAAnD,EAAyD6B,wBAAzD,EAAmFY,qBAAnF,CAA9B;AACA;AACA,QAAIW,uBAAuBpD,sBAAsB,wBAAtB,EAAgD,KAAhD,EAAuD0B,qBAAvD,EAA8EQ,oBAA9E,CAA3B;;AAEA;;;;AAIA;;AAEA;;;;;;;;;OAn/O2C,CA4/OvC;AACJ;AACA,QAAImB,qBAAsB,YAAY;AAClC,iBAASA,kBAAT,GAA8B,CAC7B;AACDA,2BAAmBxuC,SAAnB,CAA6BktB,OAA7B,GAAuC,UAAUtZ,MAAV,EAAkB,CAAG,CAA5D;AACA,eAAO46B,kBAAP;AACH,KALyB,EAA1B;;AAOA;;;OArgP2C,CAwgPvC;;AAIJ,QAAIC,UAAUlsC,OAAOylB,MAAP,CAAc;AAC3B5jB,kBAAUA,QADiB;AAE3BG,gBAAQA,MAFmB;AAG3BE,cAAMA,IAHqB;AAI3BE,iBAASA,OAJkB;AAK3BE,gBAAQA,MALmB;AAM3BG,gBAAQA,MANmB;AAO3BE,kBAAUA,QAPiB;AAQ3BwpC,cAAMvpC,MARqB;AAS3BC,8BAAsBA,oBATK;AAU3BzE,iBAASA,OAVkB;AAW3BoF,iBAASA,OAXkB;AAY3BC,kBAAUA,QAZiB;AAa3BG,oBAAYA,UAbe;AAc3BC,qBAAaA,WAdc;AAe3BG,gBAAQA,MAfmB;AAgB3BC,iBAASA,OAhBkB;AAiB3BE,kBAAUA,QAjBiB;AAkB3BpF,kBAAUA,QAlBiB;AAmB3B0F,gBAAQA,MAnBmB;AAoB3BG,mBAAWA,SApBgB;AAqB3BJ,cAAMA,IArBqB;AAsB3BY,cAAMA,IAtBqB;AAuB3BE,eAAOA,KAvBoB;AAwB3BlG,gBAAQA,MAxBmB;AAyB3BM,cAAMA,IAzBqB;AA0B3BiG,gBAAQA,MA1BmB;AA2B3BhK,aAAKA,GA3BsB;AA4B3BuD,gBAAQA,MA5BmB;AA6B3B0G,kBAAUA,QA7BiB;AA8B3BE,kBAAUA,QA9BiB;AA+B3BC,iBAASA,OA/BkB;AAgC3BC,kBAAUA,QAhCiB;AAiC3BC,eAAOA,KAjCoB;AAkC3BC,eAAOA,KAlCoB;AAmC3BE,gBAAQA,MAnCmB;AAoC3BC,iBAASA,OApCkB;AAqC3BC,yBAAiBA,eArCU;AAsC3BE,mBAAWA,SAtCgB;AAuC3BD,kBAAUA,QAvCiB;AAwC3BI,eAAOA,KAxCoB;AAyC3BC,qBAAaA,WAzCc;AA0C3BI,oBAAYA,UA1Ce;AA2C3B/F,cAAMA,IA3CqB;AA4C3BuB,iBAASA,OA5CkB;AA6C3B2F,gBAAQA,MA7CmB;AA8C3BI,qBAAaA,WA9Cc;AA+C3BI,kCAA0BA,wBA/CC;AAgD3BI,yBAAiBA,eAhDU;AAiD3B5H,wBAAgBA,cAjDW;AAkD3BG,kBAAUA,QAlDiB;AAmD3BrE,cAAMA,IAnDqB;AAoD3BjD,eAAOA,KApDoB;AAqD3BW,iBAASA,OArDkB;AAsD3BK,cAAMA,IAtDqB;AAuD3BI,cAAMA,IAvDqB;AAwD3BG,gBAAQA,MAxDmB;AAyD3BE,eAAOA,KAzDoB;AA0D3BG,aAAKA,GA1DsB;AA2D3BC,aAAKA,GA3DsB;AA4D3BG,YAAIA,EA5DuB;AA6D3BC,aAAKA,GA7DsB;AA8D3BK,aAAKA,GA9DsB;AA+D3BC,YAAIA,EA/DuB;AAgE3BG,YAAIA,EAhEuB;AAiE3BlB,aAAKA,GAjEsB;AAkE3BqB,gBAAQA,MAlEmB;AAmE3BE,iBAASA,OAnEkB;AAoE3BoD,qBAAaA,WApEc;AAqE3BC,mBAAWA,SArEgB;AAsE3BC,gBAAQA,MAtEmB;AAuE3BE,2BAAmBA,iBAvEQ;AAwE3BX,oBAAYA,UAxEe;AAyE3BY,kBAAUA,QAzEiB;AA0E3BC,kBAAUA,QA1EiB;AA2E3BX,kBAAUA,QA3EiB;AA4E3BY,iBAASA,OA5EkB;AA6E3BE,gBAAQA,MA7EmB;AA8E3BC,kBAAUA,QA9EiB;AA+E3BhB,iBAASA,OA/EkB;AAgF3BiB,sBAAcA,YAhFa;AAiF3BI,mBAAWA,SAjFgB;AAkF3BgI,eAAOA,KAlFoB;AAmF3BgF,mBAAWA,SAnFgB;AAoF3BgB,mBAAWA,SApFgB;AAqF3Bia,qBAAaA,WArFc;AAsF3Bnb,0BAAkBA,gBAtFS;AAuF3BwE,oBAAYA,UAvFe;AAwF3BvQ,mBAAWA,SAxFgB;AAyF3B8nB,2BAAmBA,iBAzFQ;AA0F3BE,sBAAcA,YA1Fa;AA2F3BG,wBAAgBA,cA3FW;AA4F3B,YAAI/d,QAAJ,GAAgB;AAAE,mBAAO5S,QAAQ4S,QAAf;AAA0B,SA5FjB;AA6F3BK,eAAOA,KA7FoB;AA8F3B+C,eAAOA,KA9FoB;AA+F3B,YAAI4J,OAAJ,GAAe;AAAE,mBAAO5f,QAAQ4f,OAAf;AAAyB,SA/Ff;AAgG3BqB,eAAOA,KAhGoB;AAiG3B2P,oBAAYA,UAjGe;AAkG3B4B,qBAAaA,WAlGc;AAmG3BzU,mBAAWA,SAnGgB;AAoG3ByE,kBAAUA,QApGiB;AAqG3Ba,mBAAWA,SArGgB;AAsG3B8E,yBAAiBA,eAtGU;AAuG3B9B,8BAAsBA,oBAvGK;AAwG3BE,oBAAYA,UAxGe;AAyG3BoC,+BAAuBA,qBAzGI;AA0G3BC,wBAAgBA,cA1GW;AA2G3BkM,4BAAoBA,kBA3GO;AA4G3BkB,sBAAcA,YA5Ga;AA6G3B3xB,qBAAaA,WA7Gc;AA8G3BsyB,sBAAcA,YA9Ga;AA+G3BU,2BAAmBA,iBA/GQ;AAgH3BqB,uBAAeA,aAhHY;AAiH3B6N,sBAAcA,YAjHa;AAkH3BpwB,qBAAaA,WAlHc;AAmH3B,YAAIF,mBAAJ,GAA2B;AAAE,mBAAOjW,QAAQiW,mBAAf;AAAqC,SAnHvC;AAoH3B,YAAIC,mBAAJ,GAA2B;AAAE,mBAAOlW,QAAQkW,mBAAf;AAAqC,SApHvC;AAqH3BgG,qBAAaA,WArHc;AAsH3BpC,oBAAYA,UAtHe;AAuH3BO,wBAAgBA,cAvHW;AAwH3BsB,mBAAWA,SAxHgB;AAyH3B,YAAIrL,UAAJ,GAAkB;AAAE,mBAAOtQ,QAAQsQ,UAAf;AAA4B,SAzHrB;AA0H3BC,mBAAWA,SA1HgB;AA2H3Bia,oBAAYA,UA3He;AA4H3BrT,wBAAgBA,cA5HW;AA6H3BmyB,6BAAqBA,mBA7HM;AA8H3BO,0BAAkBA,gBA9HS;AA+H3BxD,2BAAmBA,iBA/HQ;AAgI3BhM,oBAAYA,UAhIe;AAiI3BmD,2BAAmBA,iBAjIQ;AAkI3BmC,mBAAWA,SAlIgB;AAmI3B3B,wBAAgBA,cAnIW;AAoI3BQ,qBAAaA,WApIc;AAqI3BiH,oBAAYA,UArIe;AAsI3BxD,qBAAaA,WAtIc;AAuI3BgD,yBAAiBA,eAvIU;AAwI3BiB,kBAAUA,QAxIiB;AAyI3Bp+B,YAAIA,EAzIuB;AA0I3BE,mBAAWA,SA1IgB;AA2I3BwnC,8BAAsBA,oBA3IK;AA4I3Be,6BAAqBA,mBA5IM;AA6I3BM,+BAAuBA,qBA7II;AA8I3BG,kCAA0BA,wBA9IC;AA+I3BK,8BAAsBA,oBA/IK;AAgJ3BO,+BAAuBA,qBAhJI;AAiJ3BxD,mBAAWA,SAjJgB;AAkJ3BC,oBAAYA,UAlJe;AAmJ3BC,oBAAYA,UAnJe;AAoJ3BC,qBAAaA,WApJc;AAqJ3BC,0BAAkBA,gBArJS;AAsJ3BE,mBAAWA,SAtJgB;AAuJ3B3b,kBAAU4b,UAvJiB;AAwJ3BI,kBAAUA,QAxJiB;AAyJ3BI,+BAAuBA,qBAzJI;AA0J3BiD,wBAAgBA,cA1JW;AA2J3BC,4BAAoBA,kBA3JO;AA4J3BC,iCAAyBA,uBA5JE;AA6J3BC,8BAAsBA,oBA7JK;AA8J3BC,4BAAoBA;AA9JO,KAAd,CAAd;;AAiKA,QAAIG,iBAAiBtyC,OAArB;AACA,QAAIuyC,KAAMtyC,kBAAkBA,eAAeL,MAAlC,GAA4CK,cAA5C,GAA6DqyC,cAAtE;;AAEA,aAASE,uBAAT,GAAmC;AAC/B,YAAIC,kBAAkB,IAAtB;AACA,eAAO,UAAUxnC,IAAV,EAAgB8Y,IAAhB,EAAsB;AACzB0uB,8BAAkBA,mBAAmBjrC,SAASG,SAAT,CAAmBsf,GAAnB,CAAuB,kBAAvB,CAArC;AACA,mBAAO,CAAC,IAAIyrB,aAAJ,CAAkBznC,IAAlB,EAAwB8Y,IAAxB,EAA8B0uB,eAA9B,CAAD,CAAP;AACH,SAHD;AAIH;AACD,QAAIE,YAAY,SAAZA,SAAY,CAAUppC,IAAV,EAAgB/H,GAAhB,EAAqB;AACjC,eAAO+H,KAAKlH,MAAL,CAAY,UAAUmH,GAAV,EAAe+B,GAAf,EAAoB;AAAE,mBAAO/B,OAAOlD,UAAU9E,IAAI+J,GAAJ,CAAV,CAAd;AAAoC,SAAtE,EAAwE,KAAxE,CAAP;AACH,KAFD;AAGA;;;;;;;;;AASA,aAASqnC,eAAT,CAAyBvuC,KAAzB,EAAgC;AAC5B;AACA,YAAI,CAACA,MAAMQ,MAAX,EACI,OAAO,EAAP;AACJ,YAAIguC,UAAU,CAAC,kBAAD,EAAqB,aAArB,EAAoC,UAApC,EAAgD,QAAhD,EAA0D,OAA1D,CAAd;AAAA,YAAkFC,WAAW,CAAC,YAAD,EAAe,oBAAf,EAAqC,cAArC,EAAqD,WAArD,CAA7F;AAAA,YAAgKC,WAAW,CAAC,WAAD,EAAc,UAAd,EAA0B,mBAA1B,CAA3K;AAAA,YAA2NC,cAAcH,QAAQjyC,MAAR,CAAekyC,QAAf,CAAzO;AAAA,YAAmQG,cAAcF,SAASnyC,MAAT,CAAgBoyC,WAAhB,CAAjR;AACA;AACA;AACA;AACA,YAAI1sC,UAAUjC,MAAMke,KAAhB,KAA0BowB,UAAUM,WAAV,EAAuB5uC,KAAvB,CAA9B,EAA6D;AACzD,kBAAM,IAAIkD,KAAJ,CAAU,YAAYlD,MAAM9C,IAAlB,GAAyB,0BAAzB,GACZ,+DADY,GAEZ,qEAFY,IAGX,MAAM0xC,YAAY3tC,MAAZ,CAAmB,UAAUiG,GAAV,EAAe;AAAE,uBAAOjF,UAAUjC,MAAMkH,GAAN,CAAV,CAAP;AAA+B,aAAnE,EAAqE/H,IAArE,CAA0E,IAA1E,CAHK,CAAV,CAAN;AAIH;AACD,YAAI+e,QAAQ,EAAZ;AAAA,YAAgB2wB,cAAc7uC,MAAMke,KAAN,IAAe,EAAE,YAAY7X,KAAKrG,KAAL,EAAY4uC,WAAZ,CAAd,EAA7C;AACA3qC,gBAAQ4qC,WAAR,EAAqB,UAAUjvC,MAAV,EAAkB1C,IAAlB,EAAwB;AACzC;AACAA,mBAAOA,QAAQ,UAAf;AACA;AACA,gBAAIoF,SAAS1C,MAAT,CAAJ,EACIA,SAAS,EAAEkvC,WAAWlvC,MAAb,EAAT;AACJ;AACAA,qBAASuE,OAAO,EAAP,EAAWvE,MAAX,CAAT;AACA;AACA,gBAAI0uC,UAAUI,QAAV,EAAoB9uC,MAApB,KAA+B0uC,UAAUK,WAAV,EAAuB/uC,MAAvB,CAAnC,EAAmE;AAC/D,sBAAM,IAAIsD,KAAJ,CAAU,qBAAqBwrC,SAASvvC,IAAT,CAAc,GAAd,CAArB,GAA0C,SAA1C,GAAsDwvC,YAAYxvC,IAAZ,CAAiB,GAAjB,CAAtD,GAA8E,kBAA9E,GAAmGjC,IAAnG,GAA0G,GAA1G,GAAgH8C,MAAM9C,IAAtH,GAA6H,GAAvI,CAAN;AACH;AACD0C,mBAAOmvC,SAAP,GAAmBnvC,OAAOmvC,SAAP,IAAoB,UAAvC;AACAnvC,mBAAOs+B,KAAP,GAAe,KAAf;AACAt+B,mBAAOiO,QAAP,GAAkB7N,KAAlB;AACAJ,mBAAOovC,KAAP,GAAe9xC,IAAf;AACA,gBAAIogB,aAAaigB,YAAYkC,qBAAZ,CAAkC7/B,OAAOiO,QAAzC,EAAmDjO,OAAOovC,KAA1D,CAAjB;AACApvC,mBAAOkO,WAAP,GAAqBwP,WAAWsiB,UAAhC;AACAhgC,mBAAOmO,oBAAP,GAA8BuP,WAAWuiB,mBAAzC;AACA3hB,kBAAMhhB,IAAN,IAAc0C,MAAd;AACH,SApBD;AAqBA,eAAOse,KAAP;AACH;AACD,QAAI+wB,OAAO,CAAX;AACA,QAAIZ,gBAAiB,YAAY;AAC7B,iBAASA,aAAT,CAAuBznC,IAAvB,EAA6BgH,QAA7B,EAAuCvS,OAAvC,EAAgD;AAC5C,gBAAI8N,QAAQ,IAAZ;AACA,iBAAKvC,IAAL,GAAYA,IAAZ;AACA,iBAAKgH,QAAL,GAAgBA,QAAhB;AACA,iBAAKvS,OAAL,GAAeA,OAAf;AACA,iBAAK4Q,GAAL,GAAWgjC,MAAX;AACA,iBAAKC,MAAL,GAAc,KAAd;AACA,iBAAKC,WAAL,GAAmB,UAAU1Q,MAAV,EAAkB7uB,OAAlB,EAA2B;AAC1C,uBAAOzG,MAAM2lC,SAAN,GAAkB3lC,MAAM9N,OAAN,CAAc+zC,qBAAd,CAAoC3Q,MAApC,EAA4C7uB,OAA5C,EAAqDzG,MAAM2lC,SAA3D,EAAsE3lC,MAAMyE,QAAN,CAAeyhC,QAArF,CAAlB,GAAmHlmC,MAAMmmC,QAAhI;AACH,aAFD;AAGH;AACDjB,sBAAc/uC,SAAd,CAAwBkkC,IAAxB,GAA+B,YAAY;AACvC,gBAAIr6B,QAAQ,IAAZ;AACA,gBAAIomC,QAAQpsC,SAASC,EAArB;AACA,gBAAIwM,UAAU,IAAIsU,cAAJ,CAAmB,KAAKtd,IAAxB,CAAd;AACA,gBAAI5F,SAAS,KAAK4F,IAAL,CAAU5I,MAAV,CAAiB,UAAUmH,GAAV,EAAe+Q,IAAf,EAAqB;AAAE,uBAAO/R,OAAOgB,GAAP,EAAY+Q,KAAKuH,WAAjB,CAAP;AAAuC,aAA/E,EAAiF,EAAjF,CAAb;AACA,gBAAIsH,WAAW;AACXuqB,0BAAUC,MAAMn/B,IAAN,CAAW,KAAK/U,OAAL,CAAay0B,UAAb,CAAwB,KAAKliB,QAA7B,EAAuC5M,MAAvC,EAA+C4O,OAA/C,CAAX,CADC;AAEX4/B,4BAAYD,MAAMn/B,IAAN,CAAW,KAAKq/B,aAAL,CAAmB7/B,OAAnB,CAAX;AAFD,aAAf;AAIA,mBAAO2/B,MAAMzxC,GAAN,CAAUinB,QAAV,EAAoBvY,IAApB,CAAyB,UAAUkjC,OAAV,EAAmB;AAC/Cp+B,sBAAMH,qBAAN,CAA4B,QAA5B,EAAsChI,KAAtC;AACAA,sBAAMqmC,UAAN,GAAmBE,QAAQF,UAA3B;AACArrC,uBAAOgF,KAAP,EAAcumC,QAAQJ,QAAtB,EAH+C,CAGd;AACjC,uBAAOnmC,KAAP;AACH,aALM,CAAP;AAMH,SAfD;AAgBA;;;;;AAKAklC,sBAAc/uC,SAAd,CAAwBmwC,aAAxB,GAAwC,UAAU7/B,OAAV,EAAmB;AACvD,gBAAI+/B,WAAW,KAAK/hC,QAAL,CAAcgiC,kBAA7B;AACA,gBAAI,CAACjtC,aAAagtC,QAAb,CAAL,EACI,OAAO,KAAK/hC,QAAL,CAAc4hC,UAArB;AACJ,gBAAIxtB,OAAO7e,SAASG,SAAT,CAAmBitB,QAAnB,CAA4Bof,QAA5B,CAAX;AACA,gBAAIE,aAAattC,QAAQotC,QAAR,IAAoB7sC,KAAK6sC,QAAL,CAApB,GAAqCA,QAAtD;AACA,gBAAIp/B,aAAa,IAAIsR,UAAJ,CAAe,EAAf,EAAmBguB,UAAnB,EAA+B7tB,IAA/B,CAAjB;AACA,mBAAOzR,WAAWqS,GAAX,CAAehT,OAAf,CAAP;AACH,SARD;AASA,eAAOy+B,aAAP;AACH,KA3CoB,EAArB;;AA6CA;AACA;AACA;;;AAGA,QAAIyB,kBAAmB,YAAY;AAC/B,iBAASA,eAAT,GAA2B;AACvB,gBAAI3mC,QAAQ,IAAZ;AACA,0BAAe,KAAK4mC,QAAL,GAAgB7B,GAAG8B,OAAH,CAAWC,KAAX,GAAmB,CAAnC;AACf,0BAAe,KAAK5W,IAAL,GAAY,CAAC,OAAD,EAAU,gBAAV,EAA4B,WAA5B,EAAyC,UAAU6W,KAAV,EAAiBC,cAAjB,EAAiCC,YAAjC,EAA+C;AAC3GjnC,sBAAMknC,gBAAN,GAAyBD,aAAa/G,GAAb,IAAoB+G,aAAa/G,GAAb,CAAiB,kBAAjB,CAApB,IAA4D+G,aAAaxtB,GAAb,CAAiB,kBAAjB,CAArF;AACAzZ,sBAAM+mC,KAAN,GAAcA,KAAd;AACA/mC,sBAAMgnC,cAAN,GAAuBA,cAAvB;AACA,uBAAOhnC,KAAP;AACH,aALsB,CAAZ;AAMlB;AACD;AACA2mC,wBAAgBxwC,SAAhB,CAA0BgxC,cAA1B,GAA2C,UAAUvnC,KAAV,EAAiB;AACxD,iBAAKgnC,QAAL,GAAgBhnC,KAAhB;AACH,SAFD;;AAIA;;;;;;;;;;;;;AAaA+mC,wBAAgBxwC,SAAhB,CAA0BwwB,UAA1B,GAAuC,UAAUlwB,MAAV,EAAkBoB,MAAlB,EAA0B4O,OAA1B,EAAmC;AACtE,gBAAI2gC,kBAAkB,qBAAtB;AACA,gBAAIC,aAAa,SAAbA,UAAa,CAAU7zC,MAAV,EAAkB;AAAE,uBAAOwG,SAASC,EAAT,CAAYgN,IAAZ,CAAiBzT,MAAjB,EAAyB6P,IAAzB,CAA8B,UAAUue,GAAV,EAAe;AAAE,2BAAQ,EAAEukB,UAAUvkB,GAAZ,EAAR;AAA6B,iBAA5E,CAAP;AAAuF,aAA5H;AACA,gBAAI0lB,cAAc,SAAdA,WAAc,CAAU9zC,MAAV,EAAkB;AAAE,uBAAOwG,SAASC,EAAT,CAAYgN,IAAZ,CAAiBzT,MAAjB,EAAyB6P,IAAzB,CAA8B,UAAUue,GAAV,EAAe;AAAE,2BAAQ,EAAE+jB,WAAW/jB,GAAb,EAAR;AAA8B,iBAA7E,CAAP;AAAwF,aAA9H;AACA,mBAAQ9oB,UAAUrC,OAAO0vC,QAAjB,IAA6BkB,WAAW,KAAK9wC,UAAL,CAAgBE,OAAO0vC,QAAvB,EAAiCtuC,MAAjC,CAAX,CAA7B,GACJiB,UAAUrC,OAAO8wC,WAAjB,IAAgCF,WAAW,KAAKG,OAAL,CAAa/wC,OAAO8wC,WAApB,EAAiC1vC,MAAjC,CAAX,CAAhC,GACIiB,UAAUrC,OAAOgxC,gBAAjB,IAAqCJ,WAAW,KAAKK,YAAL,CAAkBjxC,OAAOgxC,gBAAzB,EAA2C5vC,MAA3C,EAAmD4O,OAAnD,CAAX,CAArC,GACI3N,UAAUrC,OAAOkvC,SAAjB,IAA8B2B,YAAY7wC,OAAOkvC,SAAnB,CAA9B,GACI7sC,UAAUrC,OAAOkxC,iBAAjB,IAAsCL,YAAY,KAAKM,qBAAL,CAA2BnxC,OAAOkxC,iBAAlC,EAAqD9vC,MAArD,EAA6D4O,OAA7D,CAAZ,CAAtC,GACI4gC,WAAWD,eAAX,CALpB;AAMH,SAVD;;AAYA;;;;;;;;;AASAT,wBAAgBxwC,SAAhB,CAA0BI,UAA1B,GAAuC,UAAU4vC,QAAV,EAAoBtuC,MAApB,EAA4B;AAC/D,mBAAOS,WAAW6tC,QAAX,IAAuBA,SAAStuC,MAAT,CAAvB,GAA0CsuC,QAAjD;AACH,SAFD;;AAIA;;;;;;;;;AASAQ,wBAAgBxwC,SAAhB,CAA0BqxC,OAA1B,GAAoC,UAAUrvC,GAAV,EAAeN,MAAf,EAAuB;AACvD,gBAAIS,WAAWH,GAAX,CAAJ,EACIA,MAAMA,IAAIN,MAAJ,CAAN;AACJ,gBAAIM,OAAO,IAAX,EACI,OAAO,IAAP;AACJ,gBAAI,KAAKyuC,QAAT,EAAmB;AACf,uBAAO,KAAKG,KAAL,CAAWttB,GAAX,CAAethB,GAAf,EAAoB,EAAE4hB,OAAO,KAAKitB,cAAd,EAA8Ba,SAAS,EAAEC,QAAQ,WAAV,EAAvC,EAApB,EACFzkC,IADE,CACG,UAAU0kC,QAAV,EAAoB;AAC1B,2BAAOA,SAAS1gC,IAAhB;AACH,iBAHM,CAAP;AAIH;AACD,mBAAO,KAAK6/B,gBAAL,CAAsB/uC,GAAtB,CAAP;AACH,SAZD;;AAcA;;;;;;;;AAQAwuC,wBAAgBxwC,SAAhB,CAA0BuxC,YAA1B,GAAyC,UAAUlB,QAAV,EAAoB3uC,MAApB,EAA4B4O,OAA5B,EAAqC;AAC1E,gBAAIoS,OAAO7e,SAASG,SAAT,CAAmBitB,QAAnB,CAA4Bof,QAA5B,CAAX;AACA,gBAAIE,aAAattC,QAAQotC,QAAR,IAAoB7sC,KAAK6sC,QAAL,CAApB,GAAqCA,QAAtD;AACA,gBAAIp/B,aAAa,IAAIsR,UAAJ,CAAe,EAAf,EAAmBguB,UAAnB,EAA+B7tB,IAA/B,CAAjB;AACA,mBAAOzR,WAAWqS,GAAX,CAAehT,OAAf,CAAP;AACH,SALD;;AAOA;;;;;;;AAOAkgC,wBAAgBxwC,SAAhB,CAA0ByxC,qBAA1B,GAAkD,UAAUpB,QAAV,EAAoB3uC,MAApB,EAA4B4O,OAA5B,EAAqC;AACnF,gBAAIoS,OAAO7e,SAASG,SAAT,CAAmBitB,QAAnB,CAA4Bof,QAA5B,CAAX;AACA,gBAAIE,aAAattC,QAAQotC,QAAR,IAAoB7sC,KAAK6sC,QAAL,CAApB,GAAqCA,QAAtD;AACA,gBAAIp/B,aAAa,IAAIsR,UAAJ,CAAe,EAAf,EAAmBguB,UAAnB,EAA+B7tB,IAA/B,CAAjB;AACA,mBAAOzR,WAAWqS,GAAX,CAAehT,OAAf,CAAP;AACH,SALD;;AAOA;;;;;;;;;;;;;;AAcAkgC,wBAAgBxwC,SAAhB,CAA0B8vC,qBAA1B,GAAkD,UAAU3Q,MAAV,EAAkB7uB,OAAlB,EAA2Bk/B,SAA3B,EAAsCO,QAAtC,EAAgD;AAC9FA,uBAAWA,YAAY,EAAvB;AACA;AACA,gBAAI8B,SAASjD,GAAG8B,OAAH,CAAWC,KAAX,IAAoB,CAApB,GAAwB,IAAxB,GAA+B,EAA5C;AACA;AACA,gBAAImB,QAAQ,SAARA,KAAQ,CAAUnmB,SAAV,EAAqB;AAC7B,oBAAIomB,UAAUrmB,YAAYC,SAAZ,CAAd;AACA,uBAAO,cAAaxrB,IAAb,CAAkB4xC,OAAlB,IAA6B,OAAOA,OAApC,GAA8CA;AAArD;AACH,aAHD;AAIA,gBAAIC,eAAe,SAAfA,YAAe,CAAUrjC,KAAV,EAAiB;AAChC,oBAAI/Q,OAAO+Q,MAAM/Q,IAAjB;AAAA,oBAAuB4O,OAAOmC,MAAMnC,IAApC;AACA,oBAAIylC,WAAWH,MAAMl0C,IAAN,CAAf;AACA;AACA;AACA;AACA,oBAAIuhC,OAAO+S,IAAP,CAAYD,QAAZ,KAAyB,CAAClC,SAASnyC,IAAT,CAA9B,EACI,OAAOq0C,WAAW,IAAX,GAAkB9S,OAAO+S,IAAP,CAAYD,QAAZ,CAAlB,GAA0C,GAAjD;AACJ,oBAAIE,cAAcpC,SAASnyC,IAAT,KAAkBA,IAApC;AACA;AACA;AACA,oBAAI4O,SAAS,GAAb,EACI,OAAOylC,WAAW,MAAX,GAAoBJ,MAApB,GAA6B,WAA7B,GAA2CM,WAA3C,GAAyD,KAAhE;AACJ;AACA;AACA;AACA,oBAAI3lC,SAAS,GAAb,EAAkB;AACd,wBAAIqS,MAAMvO,QAAQyU,aAAR,CAAsBotB,WAAtB,CAAV;AACA,wBAAI31C,KAAKqiB,OAAOA,IAAI3N,IAApB;AACA,wBAAIlU,OAAOR,MAAMqH,SAASG,SAAT,CAAmBitB,QAAnB,CAA4Bz0B,EAA5B,CAAN,IAAyC,EAApD;AACA;AACA,wBAAI41C,cAAcnvC,QAAQzG,EAAR,IAAc,OAAOA,GAAGM,MAAH,GAAY,CAAnB,IAAwB,GAAtC,GAA4C,EAA9D;AACA,2BAAOm1C,WAAW,aAAX,GAA2BE,WAA3B,GAAyCC,WAAzC,GAAuD,GAAvD,GAA6Dp1C,KAAK6C,IAAL,CAAU,GAAV,CAA7D,GAA8E,IAArF;AACH;AACD;AACA,uBAAOoyC,WAAW,IAAX,GAAkBJ,MAAlB,GAA2B,WAA3B,GAAyCM,WAAzC,GAAuD,GAA9D;AACH,aA1BD;AA2BA,gBAAIE,QAAQC,qBAAqB9C,SAArB,EAAgCtxC,GAAhC,CAAoC8zC,YAApC,EAAkDnyC,IAAlD,CAAuD,GAAvD,CAAZ;AACA,gBAAI0yC,YAAYT,MAAMtC,SAAN,CAAhB;AACA,mBAAO,MAAM+C,SAAN,GAAkB,GAAlB,GAAwBF,KAAxB,GAAgC,KAAhC,GAAwCE,SAAxC,GAAoD,GAA3D;AACH,SAvCD;;AAyCA,eAAO/B,eAAP;AACH,KAlKsB,EAAvB;AAmKA;AACA,aAAS8B,oBAAT,CAA8B10C,IAA9B,EAAoC;AAChC,YAAI40C,UAAU3uC,SAASG,SAAT,CAAmBsf,GAAnB,CAAuB1lB,OAAO,WAA9B,CAAd,CADgC,CAC0B;AAC1D,YAAI,CAAC40C,OAAD,IAAY,CAACA,QAAQ11C,MAAzB,EACI,MAAM,IAAI8G,KAAJ,CAAU,qCAAqChG,IAArC,GAA4C,GAAtD,CAAN;AACJ,eAAO40C,QAAQt0C,GAAR,CAAYu0C,WAAZ,EAAyB/zC,MAAzB,CAAgC4J,OAAhC,EAAyC,EAAzC,CAAP;AACH;AACD;AACA;AACA,QAAImqC,cAAc,SAAdA,WAAc,CAAUz4B,GAAV,EAAe;AAC7B,YAAI3X,SAAS2X,IAAI04B,gBAAb,CAAJ,EACI,OAAOC,cAAc34B,IAAI04B,gBAAlB,CAAP;AACJ,eAAOC,cAAc34B,IAAIzC,KAAlB,CAAP;AACH,KAJD;AAKA;AACA;AACA,QAAIo7B,gBAAgB,SAAhBA,aAAgB,CAAUC,WAAV,EAAuB;AAAE,eAAOrwC,OAAOqD,IAAP,CAAYgtC,eAAe,EAA3B,EAC/C10C,GAD+C,CAC3C,UAAU0J,GAAV,EAAe;AAAE,mBAAO,CAACA,GAAD,EAAM,oBAAoBzH,IAApB,CAAyByyC,YAAYhrC,GAAZ,CAAzB,CAAN,CAAP;AAA2D,SADjC,EAE/CjG,MAF+C,CAExC,UAAUwX,KAAV,EAAiB;AAAE,mBAAOxW,UAAUwW,KAAV,KAAoBlW,QAAQkW,MAAM,CAAN,CAAR,CAA3B;AAA+C,SAF1B,EAG/Cjb,GAH+C,CAG3C,UAAUib,KAAV,EAAiB;AAAE,mBAAQ,EAAEvb,MAAMub,MAAM,CAAN,EAAS,CAAT,KAAeA,MAAM,CAAN,CAAvB,EAAiC3M,MAAM2M,MAAM,CAAN,EAAS,CAAT,CAAvC,EAAR;AAAgE,SAHxC,CAAP;AAGmD,KAHhG;;AAKA,sBAp9P2C,CAo9PxB;AACnB;;;;;;;;;;;;;;;;AAgBA,QAAI05B,gBAAiB,YAAY;AAC7B,iBAASA,aAAT,CAAuBvQ,aAAvB,EAAsCzuB,YAAtC,EAAoD;AAChD,iBAAKyuB,aAAL,GAAqBA,aAArB;AACA,iBAAKzuB,YAAL,GAAoBA,YAApB;AACAzO,iCAAqBrH,IAAI80C,cAAc7yC,SAAlB,CAArB,EAAmD,IAAnD,EAAyDjC,IAAI,IAAJ,CAAzD;AACH;AACD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyFA80C,sBAAc7yC,SAAd,CAAwB81B,SAAxB,GAAoC,UAAUl4B,IAAV,EAAgBm4B,IAAhB,EAAsB;AACtD,mBAAO,KAAKuM,aAAL,CAAmBxM,SAAnB,CAA6Bl4B,IAA7B,EAAmCm4B,IAAnC,KAA4C,IAAnD;AACH,SAFD;AAGA8c,sBAAc7yC,SAAd,CAAwBU,KAAxB,GAAgC,UAAU9C,IAAV,EAAgBovB,UAAhB,EAA4B;AACxD,gBAAI3qB,SAASzE,IAAT,CAAJ,EAAoB;AAChBovB,6BAAapvB,IAAb;AACH,aAFD,MAGK;AACDovB,2BAAWpvB,IAAX,GAAkBA,IAAlB;AACH;AACD,iBAAK0kC,aAAL,CAAmB5O,QAAnB,CAA4B1G,UAA5B;AACA,mBAAO,IAAP;AACH,SATD;AAUA;;;;;AAKA6lB,sBAAc7yC,SAAd,CAAwB2oC,SAAxB,GAAoC,UAAU3gC,QAAV,EAAoB;AACpD,mBAAO,KAAK6L,YAAL,CAAkB80B,SAAlB,CAA4B3gC,QAA5B,CAAP;AACH,SAFD;AAGA,eAAO6qC,aAAP;AACH,KArHoB,EAArB;;AAuHA,sBA5lQ2C,CA4lQxB;AACnB;;;;;;;AAOA,QAAIC,sBAAsB,SAAtBA,mBAAsB,CAAUprB,QAAV,EAAoB;AAC1C,eAAO,SAASqrB,gBAAT,CAA0BryC,KAA1B,EAAiC6xB,QAAjC,EAA2C;AAC9C,gBAAIve,OAAOtT,MAAMgnB,QAAN,CAAX;AACA,gBAAIK,WAAWL,aAAa,QAAb,GAAwB,MAAxB,GAAiC,IAAhD;AACA,qBAASsrB,gBAAT,CAA0BhkC,KAA1B,EAAiCtO,KAAjC,EAAwC;AACpC,oBAAIyiB,iBAAiB,IAAIyB,cAAJ,CAAmB5V,MAAMiI,WAAN,CAAkB8Q,QAAlB,CAAnB,CAArB;AACA,oBAAIiiB,SAASnlC,OAAOouC,UAAU9vB,cAAV,CAAP,EAAkC,EAAE+vB,SAASxyC,KAAX,EAAkByyC,cAAcnkC,KAAhC,EAAlC,CAAb;AACA,uBAAOnL,SAASG,SAAT,CAAmB5E,MAAnB,CAA0B4U,IAA1B,EAAgC,IAAhC,EAAsCg2B,MAAtC,CAAP;AACH;AACD,mBAAOh2B,OAAOg/B,gBAAP,GAA0BjvC,SAAjC;AACH,SATD;AAUH,KAXD;;AAaA;;;AAGA,QAAIqvC,sBAAuB,YAAY;AACnC,iBAASA,mBAAT,CAA6BC,iBAA7B,EAAgD;AAC5C;AACA,iBAAKC,aAAL,GAAqB,EAArB;AACA,iBAAKD,iBAAL,GAAyBA,iBAAzB;AACA,gBAAIE,MAAMx1C,IAAIs1C,iBAAJ,CAAV;AACAjuC,iCAAqBmuC,GAArB,EAA0B,IAA1B,EAAgCA,GAAhC,EAAqC,CAAC,YAAD,CAArC;AACH;AACDH,4BAAoBpzC,SAApB,CAA8BktB,OAA9B,GAAwC,YAAY,CAAG,CAAvD;AACAkmB,4BAAoBpzC,SAApB,CAA8Bi9B,QAA9B,GAAyC,UAAUj1B,QAAV,EAAoB;AACzD,gBAAI6B,QAAQ,IAAZ;AACA,iBAAKypC,aAAL,CAAmB7sC,IAAnB,CAAwBuB,QAAxB;AACA,mBAAO,YAAY;AAAE,uBAAO7B,WAAW0D,MAAMypC,aAAjB,EAAgCtrC,QAAhC,CAAP;AAAmD,aAAxE;AACH,SAJD;AAKAorC,4BAAoBpzC,SAApB,CAA8Bq9B,SAA9B,GAA0C,YAAY;AAClD,gBAAIA,YAAY,KAAKgW,iBAAL,CAAuBhW,SAAvB,EAAhB;AACAA,wBAAYh7B,SAASg7B,SAAT,IAAsBA,UAAUhuB,OAAhC,GAA0CguB,SAAtD;AACA,mBAAOA,aAAa,KAAKmW,QAAL,CAAczH,OAAlC;AACH,SAJD;AAKAqH,4BAAoBpzC,SAApB,CAA8BgC,GAA9B,GAAoC,UAAUyxC,MAAV,EAAkB52B,OAAlB,EAA2Bnc,KAA3B,EAAkC;AAClE,gBAAImc,YAAY,KAAK,CAArB,EAAwB;AAAEA,0BAAU,KAAV;AAAkB;AAC5C,gBAAI42B,MAAJ,EACI,KAAKC,SAAL,CAAe1xC,GAAf,CAAmByxC,MAAnB;AACJ,gBAAI52B,OAAJ,EACI,KAAK62B,SAAL,CAAe72B,OAAf;AACJ,gBAAInc,KAAJ,EACI,KAAKgzC,SAAL,CAAehzC,KAAf,CAAqBA,KAArB;AACJ,mBAAO,KAAKgzC,SAAL,CAAe1xC,GAAf,EAAP;AACH,SATD;AAUAoxC,4BAAoBpzC,SAApB,CAA8B2zC,gBAA9B,GAAiD,UAAUC,UAAV,EAAsBF,SAAtB,EAAiCF,QAAjC,EAA2CK,QAA3C,EAAqD;AAClG,gBAAIhqC,QAAQ,IAAZ;AACA,iBAAK6pC,SAAL,GAAiBA,SAAjB;AACA,iBAAKF,QAAL,GAAgBA,QAAhB;AACA;AACAI,uBAAWE,GAAX,CAAe,wBAAf,EAAyC,UAAUrX,GAAV,EAAe;AAAE,uBAAO5yB,MAAMypC,aAAN,CAAoB3uC,OAApB,CAA4B,UAAUnI,EAAV,EAAc;AAAE,2BAAOA,GAAGigC,GAAH,CAAP;AAAiB,iBAA7D,CAAP;AAAwE,aAAlI;AACA,gBAAIsX,OAAOh2C,IAAI21C,SAAJ,CAAX;AACA,gBAAIM,WAAWj2C,IAAI81C,QAAJ,CAAf;AACA;AACAzuC,iCAAqB2uC,IAArB,EAA2B,IAA3B,EAAiCA,IAAjC,EAAuC,CAAC,SAAD,EAAY,MAAZ,EAAoB,QAApB,EAA8B,MAA9B,CAAvC;AACA;AACA3uC,iCAAqB2uC,IAArB,EAA2B,IAA3B,EAAiCA,IAAjC,EAAuC,CAAC,MAAD,EAAS,UAAT,EAAqB,MAArB,CAAvC;AACA;AACA3uC,iCAAqB4uC,QAArB,EAA+B,IAA/B,EAAqCA,QAArC,EAA+C,CAAC,UAAD,CAA/C;AACH,SAdD;AAeA;;;;;;;;;;;;AAYAZ,4BAAoBa,4BAApB,GAAmD,UAAUrgC,MAAV,EAAkB;AACjE,gBAAIsgC,WAAWtgC,OAAOsJ,iBAAP,CAAyB1Q,IAAzB,CAA8B,MAA9B,CAAf;AACA0nC,qBAASj6B,MAAT,GAAkB,UAAU3W,MAAV,EAAkB;AAChC,uBAAOA,UAAU,IAAV,GAAiBA,OAAOpB,QAAP,GAAkB2a,OAAlB,CAA0B,SAA1B,EAAqC,UAAUma,CAAV,EAAa;AAAE,2BAAQ,EAAE,KAAK,IAAP,EAAa,KAAK,KAAlB,GAA0BA,CAA1B,CAAR;AAAwC,iBAA5F,CAAjB,GAAiH1zB,MAAxH;AACH,aAFD;AAGA4wC,qBAASh6B,MAAT,GAAkB,UAAU5W,MAAV,EAAkB;AAChC,uBAAOA,UAAU,IAAV,GAAiBA,OAAOpB,QAAP,GAAkB2a,OAAlB,CAA0B,WAA1B,EAAuC,UAAUma,CAAV,EAAa;AAAE,2BAAQ,EAAE,MAAM,GAAR,EAAa,OAAO,GAApB,GAA0BA,CAA1B,CAAR;AAAwC,iBAA9F,CAAjB,GAAmH1zB,MAA1H;AACH,aAFD;AAGH,SARD;AASA,eAAO8vC,mBAAP;AACH,KAlE0B,EAA3B;;AAoEA,sBAxrQ2C,CAwrQxB;AACnB;;;;;;;;;;;;;;AAcA,QAAIe,oBAAqB,YAAY;AACjC;AACA,iBAASA,iBAAT,CAA2BvgC,MAA3B,EAAmC;AAC/B,iBAAK+gB,OAAL,GAAe/gB,MAAf;AACA,iBAAKwgC,UAAL,GAAkBxgC,OAAOihB,SAAzB;AACH;AACD;AACAsf,0BAAkBn0C,SAAlB,CAA4B+5B,IAA5B,GAAmC,YAAY;AAC3C,gBAAIlF,YAAY,KAAKuf,UAArB;AACAvf,sBAAUqI,MAAV,CAAiB,IAAjB;AACA,gBAAI,CAACrI,UAAUiH,iBAAf,EACIjH,UAAUoH,MAAV;AACJ,mBAAOpH,SAAP;AACH,SAND;AAOA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+BAsf,0BAAkBn0C,SAAlB,CAA4Bw0B,IAA5B,GAAmC,UAAU6f,MAAV,EAAkB;AACjD,gBAAIxqC,QAAQ,IAAZ;AACA,gBAAI,CAAC1H,WAAWkyC,MAAX,CAAL,EACI,MAAM,IAAIzwC,KAAJ,CAAU,2BAAV,CAAN;AACJ,gBAAI6Z,QAAQ,SAARA,KAAQ,GAAY;AACpB,uBAAO42B,OAAOxwC,SAASG,SAAhB,EAA2B6F,MAAM8qB,OAAN,CAAcyI,eAAzC,CAAP;AACH,aAFD;AAGA,gBAAI5I,OAAO,IAAIgG,WAAJ,CAAgB/c,KAAhB,EAAuBvY,QAAvB,CAAX;AACA,iBAAKkvC,UAAL,CAAgB5f,IAAhB,CAAqBA,IAArB;AACA,mBAAO,IAAP;AACH,SAVD;;AAYA;;;;;;;;;;;;;;;;;;;;;;;;;;AA0BA2f,0BAAkBn0C,SAAlB,CAA4B29B,SAA5B,GAAwC,UAAUnJ,IAAV,EAAgB;AACpD,gBAAI3qB,QAAQ,IAAZ;AACA,gBAAIgrB,YAAY,KAAKuf,UAArB;AACA,gBAAIpxC,SAASwxB,IAAT,CAAJ,EAAoB;AAChBK,0BAAU8I,SAAV,CAAoBnJ,IAApB;AACH,aAFD,MAGK,IAAIryB,WAAWqyB,IAAX,CAAJ,EAAsB;AACvBK,0BAAU8I,SAAV,CAAoB,YAAY;AAAE,2BAAOnJ,KAAK3wB,SAASG,SAAd,EAAyB6F,MAAM8qB,OAAN,CAAcyI,eAAvC,CAAP;AAAiE,iBAAnG;AACH,aAFI,MAGA;AACD,sBAAM,IAAIx5B,KAAJ,CAAU,qCAAV,CAAN;AACH;AACD,mBAAO,IAAP;AACH,SAbD;;AAeA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsCAuwC,0BAAkBn0C,SAAlB,CAA4B8Q,IAA5B,GAAmC,UAAUmpB,IAAV,EAAgBC,OAAhB,EAAyB;AACxD,gBAAIj3B,QAAQi3B,OAAR,KAAoB/3B,WAAW+3B,OAAX,CAAxB,EAA6C;AACzCA,0BAAUia,kBAAkBG,iBAAlB,CAAoC,KAAK3f,OAAzC,EAAkDuF,OAAlD,CAAV;AACH;AACD,iBAAKka,UAAL,CAAgBtjC,IAAhB,CAAqBmpB,IAArB,EAA2BC,OAA3B;AACA,mBAAO,IAAP;AACH,SAND;;AAQAia,0BAAkBG,iBAAlB,GAAsC,UAAU1gC,MAAV,EAAkBsmB,OAAlB,EAA2B;AAC7D,mBAAO,UAAUzc,KAAV,EAAiB;AACpB,uBAAO5Z,SAASG,SAAT,CAAmB5E,MAAnB,CAA0B86B,OAA1B,EAAmC,IAAnC,EAAyC,EAAEqa,QAAQ92B,KAAV,EAAiB+2B,cAAc5gC,OAAOgT,OAAP,CAAellB,MAA9C,EAAzC,CAAP;AACH,aAFD;AAGH,SAJD;AAKA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8BAyyC,0BAAkBn0C,SAAlB,CAA4Bg+B,cAA5B,GAA6C,UAAUtX,KAAV,EAAiB;AAC1D,iBAAK0tB,UAAL,CAAgBpW,cAAhB,CAA+BtX,KAA/B;AACH,SAFD;;AAIA,eAAOytB,iBAAP;AACH,KAxLwB,EAAzB;;AA0LA;;;;;;;;;;;AAWA;AACAvF,OAAG3yC,MAAH,CAAU,oBAAV,EAAgC,EAAhC;AACA,QAAIw4C,WAAW7F,GAAG3yC,MAAH,CAAU,gBAAV,EAA4B,EAA5B,CAAf;AACA,QAAIy4C,WAAW9F,GAAG3yC,MAAH,CAAU,gBAAV,EAA4B,CAAC,IAAD,EAAO,gBAAP,CAA5B,CAAf;AACA,QAAI04C,UAAU/F,GAAG3yC,MAAH,CAAU,kBAAV,EAA8B,CAAC,gBAAD,CAA9B,CAAd;AACA,QAAI24C,YAAYhG,GAAG3yC,MAAH,CAAU,iBAAV,EAA6B,CAAC,kBAAD,EAAqB,gBAArB,EAAuC,oBAAvC,CAA7B,CAAhB;AACA,QAAI44C,WAAWjG,GAAG3yC,MAAH,CAAU,WAAV,EAAuB,CAAC,gBAAD,EAAmB,iBAAnB,EAAsC,oBAAtC,CAAvB,CAAf;AACA,QAAI64C,WAAWlG,GAAG3yC,MAAH,CAAU,kBAAV,EAA8B,CAAC,WAAD,CAA9B,CAAf,CAn5Q2C,CAm5QkB;AAC7D,QAAI2X,SAAS,IAAb;AACAmhC,cAAU7K,OAAV,GAAoB,CAAC,mBAAD,CAApB;AACA;AACA,aAAS6K,SAAT,CAAmB1B,iBAAnB,EAAsC;AAClC;AACAz/B,iBAAS,KAAKA,MAAL,GAAc,IAAIsuB,QAAJ,EAAvB;AACAtuB,eAAOohC,aAAP,GAAuB,IAAInC,aAAJ,CAAkBj/B,OAAO0uB,aAAzB,EAAwC1uB,OAAOC,YAA/C,CAAvB;AACA;AACAD,eAAO0uB,aAAP,CAAqBxM,SAArB,CAA+B,OAA/B,EAAwCmZ,eAAxC;AACAr7B,eAAO0uB,aAAP,CAAqBxM,SAArB,CAA+B,QAA/B,EAAyCgd,oBAAoB,QAApB,CAAzC;AACAl/B,eAAO0uB,aAAP,CAAqBxM,SAArB,CAA+B,UAA/B,EAA2Cgd,oBAAoB,UAApB,CAA3C;AACAl/B,eAAO0uB,aAAP,CAAqBxM,SAArB,CAA+B,SAA/B,EAA0Cgd,oBAAoB,SAApB,CAA1C;AACAl/B,eAAOwuB,WAAP,CAAmBtrB,UAAnB,CAA8BwnB,kBAA9B,CAAiD,KAAjD,EAAwDuQ,yBAAxD;AACA,YAAIoG,qBAAqBrhC,OAAOwpB,eAAP,GAAyBxpB,OAAOguB,cAAP,GAAwB,IAAIwR,mBAAJ,CAAwBC,iBAAxB,CAA1E;AACAD,4BAAoBa,4BAApB,CAAiDrgC,MAAjD;AACA;AACAA,eAAO,QAAP,IAAmBA,MAAnB;AACAA,eAAO,MAAP,IAAiBmmB,IAAjB;AACAA,aAAKmQ,OAAL,GAAe,CAAC,WAAD,EAAc,UAAd,EAA0B,UAA1B,EAAsC,YAAtC,EAAoD,OAApD,EAA6D,gBAA7D,CAAf;AACA,iBAASnQ,IAAT,CAAc2Z,SAAd,EAAyBG,QAAzB,EAAmCL,QAAnC,EAA6CI,UAA7C,EAAyDhD,KAAzD,EAAgEC,cAAhE,EAAgF;AAC5EoE,+BAAmBtB,gBAAnB,CAAoCC,UAApC,EAAgDF,SAAhD,EAA2DF,QAA3D,EAAqEK,QAArE;AACA,mBAAOjgC,OAAO,QAAP,CAAP;AACA,mBAAOA,OAAO,MAAP,CAAP;AACA,mBAAOA,MAAP;AACH;AACD,eAAOA,MAAP;AACH;AACD,QAAIshC,iBAAiB,SAAjBA,cAAiB,CAAUC,WAAV,EAAuB;AAAE,eAAO,CAAC,mBAAD,EAAsB,UAAUC,IAAV,EAAgB;AACnF,gBAAI9J,UAAU8J,KAAKxhC,MAAL,CAAYuhC,WAAZ,CAAd;AACA7J,oBAAQ,MAAR,IAAkB,YAAY;AAAE,uBAAOA,OAAP;AAAiB,aAAjD;AACA,mBAAOA,OAAP;AACH,SAJgD,CAAP;AAIrC,KAJT;AAKA;AACA+J,aAASnL,OAAT,GAAmB,CAAC,WAAD,EAAc,IAAd,EAAoB,WAApB,CAAnB;AACA,aAASmL,QAAT,CAAkBvE,YAAlB,EAAgCb,KAAhC,EAAuC8E,SAAvC,EAAkD;AAC9ClxC,iBAASG,SAAT,GAAqB8sC,YAArB;AACAjtC,iBAASC,EAAT,GAAcmsC,KAAd;AACA;AACA;AACA8E,kBAAUzS,aAAV,CAAwBhf,GAAxB,GACKplB,GADL,CACS,UAAUU,CAAV,EAAa;AAAE,mBAAOA,EAAEgC,OAAF,GAAY+d,WAAnB;AAAiC,SADzD,EAEKjgB,MAFL,CAEY4J,OAFZ,EAEqB,EAFrB,EAGK3G,MAHL,CAGY,UAAU/C,CAAV,EAAa;AAAE,mBAAOA,EAAE8jB,IAAF,KAAW,UAAlB;AAA+B,SAH1D,EAIK/d,OAJL,CAIa,UAAUsM,UAAV,EAAsB;AAAE,mBAAOA,WAAWyR,IAAX,GAAkBouB,aAAa7f,QAAb,CAAsBhgB,WAAWwR,SAAjC,CAAzB;AAAuE,SAJ5G;AAKH;AACD;AACA,QAAI6yB,uBAAuB,SAAvBA,oBAAuB,CAAUC,QAAV,EAAoB;AAC3C,eAAOA,SAASC,iBAAT,GAA6B,IAAIrB,iBAAJ,CAAsBoB,QAAtB,CAApC;AACH,KAFD;AAGA;AACA;AACA,QAAIE,mBAAmB,SAAnBA,gBAAmB,GAAY;AAC/B,eAAO5wC,OAAO+O,OAAOohC,aAAd,EAA6B,EAAEjb,MAAM,gBAAY;AAAE,uBAAOnmB,OAAOC,YAAd;AAA6B,aAAnD,EAA7B,CAAP;AACH,KAFD;AAGA6hC,iBAAaxL,OAAb,GAAuB,CAAC,YAAD,CAAvB;AACA,aAASwL,YAAT,CAAsB9B,UAAtB,EAAkC;AAC9BA,mBAAW+B,MAAX,CAAkB,YAAY;AAAE3jC,kBAAM7C,kBAAN;AAA6B,SAA7D;AACH;AACDslC,aAASpE,QAAT,CAAkB,WAAlB,EAA+B0E,SAA/B;AACAJ,YAAQtE,QAAR,CAAiB,YAAjB,EAA+B,CAAC,mBAAD,EAAsBiF,oBAAtB,CAA/B;AACAZ,aAASrE,QAAT,CAAkB,aAAlB,EAAiC6E,eAAe,YAAf,CAAjC;AACAR,aAASrE,QAAT,CAAkB,oBAAlB,EAAwC,CAAC,mBAAD,EAAsB,YAAY;AAAE,eAAOz8B,OAAOsJ,iBAAd;AAAkC,KAAtE,CAAxC;AACAw3B,aAASrE,QAAT,CAAkB,kBAAlB,EAAsC,YAAY;AAAE,eAAO,IAAIG,eAAJ,EAAP;AAA+B,KAAnF;AACAoE,cAAUvE,QAAV,CAAmB,gBAAnB,EAAqC6E,eAAe,eAAf,CAArC;AACAN,cAAUvE,QAAV,CAAmB,kBAAnB,EAAuC6E,eAAe,SAAf,CAAvC;AACAN,cAAUvE,QAAV,CAAmB,cAAnB,EAAmC6E,eAAe,mBAAf,CAAnC;AACAN,cAAUvE,QAAV,CAAmB,QAAnB,EAA6B,CAAC,mBAAD,EAAsBoF,gBAAtB,CAA7B;AACAb,cAAU74C,OAAV,CAAkB,cAAlB,EAAkC,CAAC,WAAD,EAAc,UAAUg5C,SAAV,EAAqB;AAAE,eAAOA,UAAUnuB,OAAV,CAAkBllB,MAAzB;AAAkC,KAAvE,CAAlC;AACAmzC,aAAS94C,OAAT,CAAiB,OAAjB,EAA0B,YAAY;AAAE,eAAO6X,OAAOwuB,WAAd;AAA4B,KAApE;AACAyS,aAASvJ,OAAT,CAAiB,QAAjB,EAA2B,YAAY;AAAE,eAAOt5B,KAAP;AAAe,KAAxD;AACA6iC,aAAS1qB,GAAT,CAAaurB,YAAb;AACAhB,aAASvqB,GAAT,CAAa,CAAC,oBAAD,EAAuB,UAAUyrB,kBAAV,EAA8B,CAAG,CAAxD,CAAb;AACAhB,cAAUzqB,GAAV,CAAc,CAAC,QAAD,EAAW,UAAU1X,MAAV,EAAkB,CAAG,CAAhC,CAAd;AACAkiC,YAAQxqB,GAAR,CAAY,CAAC,YAAD,EAAe,UAAUoJ,UAAV,EAAsB,CAAG,CAAxC,CAAZ;AACAkhB,aAAStqB,GAAT,CAAakrB,QAAb;AACA;AACA,QAAIpC,YAAY,SAAZA,SAAY,CAAU4C,GAAV,EAAe;AAC3B,YAAIC,SAASD,IAAI/wB,SAAJ,GAAgBnjB,MAAhB,CAAuBqB,QAAvB,CAAb;AACA,YAAIgf,SAAS8zB,OAAO53C,GAAP,CAAW,UAAU0J,GAAV,EAAe;AACnC,gBAAIqJ,aAAa4kC,IAAI9wB,aAAJ,CAAkBnd,GAAlB,CAAjB;AACA,gBAAImuC,aAAaF,IAAI/yB,SAAJ,CAAc7R,UAAd,EAA0BqR,KAA3C;AACA,mBAAO,CAAC1a,GAAD,EAAMmuC,eAAe,QAAf,GAA0B9kC,WAAW9F,OAArC,GAA+C8F,WAAWC,IAAhE,CAAP;AACH,SAJY,CAAb;AAKA,eAAO8Q,OAAOtjB,MAAP,CAAc6K,UAAd,EAA0B,EAA1B,CAAP;AACH,KARD;;AAUA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;OA1+Q2C,CA6hRvC;AACJ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8DA;;;;;;;;;OA5lR2C,CAqmRvC;AACJ;AACA,aAASysC,aAAT,CAAuBh1C,GAAvB,EAA4B;AACxB,YAAIi1C,aAAaj1C,IAAIyc,KAAJ,CAAU,mBAAV,CAAjB;AAAA,YAAiDgS,MAAjD;AACA,YAAIwmB,UAAJ,EACIj1C,MAAM,MAAMi1C,WAAW,CAAX,CAAN,GAAsB,GAA5B;AACJxmB,iBAASzuB,IAAI6b,OAAJ,CAAY,KAAZ,EAAmB,GAAnB,EAAwBY,KAAxB,CAA8B,gCAA9B,CAAT;AACA,YAAI,CAACgS,MAAD,IAAWA,OAAO3yB,MAAP,KAAkB,CAAjC,EACI,MAAM,IAAI8G,KAAJ,CAAU,wBAAwB5C,GAAxB,GAA8B,GAAxC,CAAN;AACJ,eAAO,EAAEN,OAAO+uB,OAAO,CAAP,KAAa,IAAtB,EAA4BymB,WAAWzmB,OAAO,CAAP,KAAa,IAApD,EAAP;AACH;AACD;AACA,aAASrc,YAAT,CAAsB+iC,EAAtB,EAA0B;AACtB,YAAIC,UAAUD,GAAGj1C,MAAH,GAAYm1C,aAAZ,CAA0B,SAA1B,CAAd;AACA,YAAI/uC,OAAOtJ,MAAM,WAAN,EAAmBo4C,OAAnB,CAAX;AACA,eAAO9uC,OAAO9D,KAAK8D,IAAL,EAAW5G,KAAX,CAAiB9C,IAAxB,GAA+BmG,SAAtC;AACH;AACD;AACA,aAASuyC,YAAT,CAAsB7jC,MAAtB,EAA8B8jC,QAA9B,EAAwCv8B,GAAxC,EAA6C;AACzC,YAAIw8B,UAAUx8B,IAAIw8B,OAAJ,IAAe/jC,OAAOvG,OAAP,CAAetO,IAA5C;AACA,YAAI64C,cAAc5xC,OAAO6xC,YAAYH,QAAZ,EAAsB9jC,MAAtB,CAAP,EAAsCuH,IAAIy8B,WAAJ,IAAmB,EAAzD,CAAlB;AACA,YAAI1b,OAAOtoB,OAAOsoB,IAAP,CAAYyb,OAAZ,EAAqBx8B,IAAI28B,aAAzB,EAAwCF,WAAxC,CAAX;AACA,eAAO,EAAED,SAASA,OAAX,EAAoBG,eAAe38B,IAAI28B,aAAvC,EAAsDF,aAAaA,WAAnE,EAAgF1b,MAAMA,IAAtF,EAAP;AACH;AACD;AACA,aAAS6b,WAAT,CAAqBT,EAArB,EAAyB;AACrB;AACA,YAAIU,QAAQt0C,OAAOvC,SAAP,CAAiBkC,QAAjB,CAA0B5E,IAA1B,CAA+B64C,GAAGx4C,IAAH,CAAQ,MAAR,CAA/B,MAAoD,4BAAhE;AACA,YAAIm5C,SAASX,GAAG,CAAH,EAAMY,QAAN,KAAmB,MAAhC;AACA,eAAO;AACH7E,kBAAM4E,SAAS,QAAT,GAAqBD,QAAQ,YAAR,GAAuB,MAD/C;AAEHG,sBAAUb,GAAGx4C,IAAH,CAAQ,SAAR,EAAmBw7B,WAAnB,OAAqC,GAF5C;AAGH8d,uBAAW,CAACH;AAHT,SAAP;AAKH;AACD;AACA,aAASI,SAAT,CAAmBf,EAAnB,EAAuB1jC,MAAvB,EAA+B0kC,QAA/B,EAAyC3qC,IAAzC,EAA+C4qC,MAA/C,EAAuD;AACnD,eAAO,UAAU/rC,CAAV,EAAa;AAChB,gBAAIgsC,SAAShsC,EAAEisC,KAAF,IAAWjsC,EAAEgsC,MAA1B;AAAA,gBAAkC/xC,SAAS8xC,QAA3C;AACA,gBAAI,EAAEC,SAAS,CAAT,IAAchsC,EAAEksC,OAAhB,IAA2BlsC,EAAEmsC,OAA7B,IAAwCnsC,EAAEosC,QAA1C,IAAsDtB,GAAGjE,IAAH,CAAQ,QAAR,CAAxD,CAAJ,EAAgF;AAC5E;AACA,oBAAIj/B,aAAakkC,SAAS,YAAY;AAClC1kC,2BAAOsqB,EAAP,CAAUz3B,OAAOkxC,OAAjB,EAA0BlxC,OAAOqxC,aAAjC,EAAgDrxC,OAAOmxC,WAAvD;AACH,iBAFgB,CAAjB;AAGAprC,kBAAEqsC,cAAF;AACA;AACA,oBAAIC,4BAA4BnrC,KAAKwqC,QAAL,IAAiB,CAAC1xC,OAAOy1B,IAAzB,GAAgC,CAAhC,GAAoC,CAApE;AACA1vB,kBAAEqsC,cAAF,GAAmB,YAAY;AAC3B,wBAAIC,+BAA+B,CAAnC,EACIR,SAASS,MAAT,CAAgB3kC,UAAhB;AACP,iBAHD;AAIH;AACJ,SAfD;AAgBH;AACD;AACA,aAASyjC,WAAT,CAAqBP,EAArB,EAAyB1jC,MAAzB,EAAiC;AAC7B,eAAO;AACHI,sBAAUO,aAAa+iC,EAAb,KAAoB1jC,OAAOkc,QADlC;AAEHhuB,qBAAS,IAFN;AAGH0E,oBAAQ;AAHL,SAAP;AAKH;AACD;AACA,aAASwyC,UAAT,CAAoBC,OAApB,EAA6BvgC,KAA7B,EAAoC8rB,MAApC,EAA4CoT,WAA5C,EAAyD;AACrD,YAAIsB,MAAJ;AACA,YAAItB,WAAJ,EAAiB;AACbsB,qBAAStB,YAAYsB,MAArB;AACH;AACD,YAAI,CAAC90C,QAAQ80C,MAAR,CAAL,EAAsB;AAClBA,qBAAS,CAAC,OAAD,CAAT;AACH;AACD,YAAIC,KAAKF,QAAQE,EAAR,GAAa,IAAb,GAAoB,MAA7B;AACA,aAAK,IAAIv6C,KAAK,CAAT,EAAYw6C,WAAWF,MAA5B,EAAoCt6C,KAAKw6C,SAASn7C,MAAlD,EAA0DW,IAA1D,EAAgE;AAC5D,gBAAIy6C,UAAUD,SAASx6C,EAAT,CAAd;AACAq6C,oBAAQE,EAAR,EAAYE,OAAZ,EAAqB7U,MAArB;AACH;AACD9rB,cAAMu8B,GAAN,CAAU,UAAV,EAAsB,YAAY;AAC9B,gBAAIqE,MAAML,QAAQK,GAAR,GAAc,KAAd,GAAsB,QAAhC;AACA,iBAAK,IAAI16C,KAAK,CAAT,EAAY26C,WAAWL,MAA5B,EAAoCt6C,KAAK26C,SAASt7C,MAAlD,EAA0DW,IAA1D,EAAgE;AAC5D,oBAAI46C,UAAUD,SAAS36C,EAAT,CAAd;AACAq6C,wBAAQK,GAAR,EAAaE,OAAb,EAAsBhV,MAAtB;AACH;AACJ,SAND;AAOH;AACD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqIA,QAAIiV,MAAJ;AACAA,aAAS,CAAC,WAAD,EAAc,UAAd,EACL,SAASC,kBAAT,CAA4BxD,SAA5B,EAAuCoC,QAAvC,EAAiD;AAC7C,YAAI1kC,SAASsiC,UAAUlhC,YAAvB;AACA,eAAO;AACH2kC,sBAAU,GADP;AAEHt8C,qBAAS,CAAC,gBAAD,EAAmB,kBAAnB,CAFN;AAGHu8C,kBAAM,cAAUlhC,KAAV,EAAiBugC,OAAjB,EAA0BzF,KAA1B,EAAiCqG,YAAjC,EAA+C;AACjD,oBAAIlsC,OAAOoqC,YAAYkB,OAAZ,CAAX;AACA,oBAAI5X,SAASwY,aAAa,CAAb,KAAmBA,aAAa,CAAb,CAAhC;AACA,oBAAIC,eAAe,IAAnB;AACA,oBAAItV,MAAJ;AACA,oBAAIuV,SAAS,EAAb;AACA,oBAAIxB,SAAS,SAATA,MAAS,GAAY;AAAE,2BAAOd,aAAa7jC,MAAb,EAAqBqlC,OAArB,EAA8Bc,MAA9B,CAAP;AAA+C,iBAA1E;AACA,oBAAI53C,MAAMg1C,cAAc3D,MAAMiG,MAApB,CAAV;AACAM,uBAAOpC,OAAP,GAAiBx1C,IAAIN,KAArB;AACAk4C,uBAAOnC,WAAP,GAAqBpE,MAAMwG,UAAN,GAAmBthC,MAAMuhC,KAAN,CAAYzG,MAAMwG,UAAlB,CAAnB,GAAmD,EAAxE;AACA,yBAAS3b,MAAT,GAAkB;AACd,wBAAIljB,MAAMo9B,QAAV;AACA,wBAAIuB,YAAJ,EACIA;AACJ,wBAAIzY,MAAJ,EACIyY,eAAezY,OAAO6Y,cAAP,CAAsB/+B,IAAIw8B,OAA1B,EAAmCx8B,IAAI28B,aAAvC,CAAf;AACJ,wBAAI38B,IAAI+gB,IAAJ,IAAY,IAAhB,EACIsX,MAAM2G,IAAN,CAAWxsC,KAAK0lC,IAAhB,EAAsBl4B,IAAI+gB,IAA1B;AACP;AACD,oBAAI/5B,IAAIk1C,SAAR,EAAmB;AACf3+B,0BAAMo+B,MAAN,CAAa30C,IAAIk1C,SAAjB,EAA4B,UAAU5yC,MAAV,EAAkB;AAC1Cs1C,+BAAOjC,aAAP,GAAuB9xC,OAAO,EAAP,EAAWvB,MAAX,CAAvB;AACA45B;AACH,qBAHD,EAGG,IAHH;AAIA0b,2BAAOjC,aAAP,GAAuB9xC,OAAO,EAAP,EAAW0S,MAAMuhC,KAAN,CAAY93C,IAAIk1C,SAAhB,CAAX,CAAvB;AACH;AACDhZ;AACA3lB,sBAAMu8B,GAAN,CAAU,UAAV,EAAsBiB,UAAUzS,aAAV,CAAwBrN,eAAxB,CAAwCiI,MAAxC,CAAtB;AACA3lB,sBAAMu8B,GAAN,CAAU,UAAV,EAAsBiB,UAAUl9B,iBAAV,CAA4B2P,SAA5B,CAAsC,EAAtC,EAA0C0V,MAA1C,CAAtB;AACA,oBAAI,CAAC1wB,KAAKyqC,SAAV,EACI;AACJ5T,yBAAS6T,UAAUY,OAAV,EAAmBrlC,MAAnB,EAA2B0kC,QAA3B,EAAqC3qC,IAArC,EAA2C4qC,MAA3C,CAAT;AACAS,2BAAWC,OAAX,EAAoBvgC,KAApB,EAA2B8rB,MAA3B,EAAmCuV,OAAOnC,WAA1C;AACH;AApCE,SAAP;AAsCH,KAzCI,CAAT;AA0CA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoFA,QAAID,OAAJ;AACAA,cAAU,CAAC,WAAD,EAAc,UAAd,EACN,SAASyC,yBAAT,CAAmClE,SAAnC,EAA8CoC,QAA9C,EAAwD;AACpD,YAAI1kC,SAASsiC,UAAUlhC,YAAvB;AACA,eAAO;AACH2kC,sBAAU,GADP;AAEHt8C,qBAAS,CAAC,gBAAD,EAAmB,kBAAnB,CAFN;AAGHu8C,kBAAM,cAAUlhC,KAAV,EAAiBugC,OAAjB,EAA0BzF,KAA1B,EAAiCqG,YAAjC,EAA+C;AACjD,oBAAIlsC,OAAOoqC,YAAYkB,OAAZ,CAAX;AACA,oBAAI5X,SAASwY,aAAa,CAAb,KAAmBA,aAAa,CAAb,CAAhC;AACA,oBAAIC,eAAe,IAAnB;AACA,oBAAItV,MAAJ;AACA,oBAAIuV,SAAS,EAAb;AACA,oBAAIxB,SAAS,SAATA,MAAS,GAAY;AAAE,2BAAOd,aAAa7jC,MAAb,EAAqBqlC,OAArB,EAA8Bc,MAA9B,CAAP;AAA+C,iBAA1E;AACA,oBAAIM,aAAa,CAAC,SAAD,EAAY,eAAZ,EAA6B,aAA7B,CAAjB;AACA,oBAAIC,gBAAgBD,WAAWx6C,MAAX,CAAkB,UAAUmH,GAAV,EAAeqsC,IAAf,EAAqB;AAAE,2BAAQrsC,IAAIqsC,IAAJ,IAAY/sC,MAAZ,EAAoBU,GAA5B;AAAmC,iBAA5E,EAA8E,EAA9E,CAApB;AACA,yBAASq3B,MAAT,GAAkB;AACd,wBAAIljB,MAAMo9B,QAAV;AACA,wBAAIuB,YAAJ,EACIA;AACJ,wBAAIzY,MAAJ,EACIyY,eAAezY,OAAO6Y,cAAP,CAAsB/+B,IAAIw8B,OAA1B,EAAmCx8B,IAAI28B,aAAvC,CAAf;AACJ,wBAAI38B,IAAI+gB,IAAJ,IAAY,IAAhB,EACIsX,MAAM2G,IAAN,CAAWxsC,KAAK0lC,IAAhB,EAAsBl4B,IAAI+gB,IAA1B;AACP;AACDme,2BAAWv0C,OAAX,CAAmB,UAAUy0C,KAAV,EAAiB;AAChCR,2BAAOQ,KAAP,IAAgB/G,MAAM+G,KAAN,IAAe7hC,MAAMuhC,KAAN,CAAYzG,MAAM+G,KAAN,CAAZ,CAAf,GAA2C,IAA3D;AACA/G,0BAAMgH,QAAN,CAAeD,KAAf,EAAsB,UAAUE,IAAV,EAAgB;AAClCH,sCAAcC,KAAd;AACAD,sCAAcC,KAAd,IAAuB7hC,MAAMo+B,MAAN,CAAa2D,IAAb,EAAmB,UAAU3L,MAAV,EAAkB;AACxDiL,mCAAOQ,KAAP,IAAgBzL,MAAhB;AACAzQ;AACH,yBAHsB,EAGpB,IAHoB,CAAvB;AAIH,qBAND;AAOH,iBATD;AAUAA;AACA3lB,sBAAMu8B,GAAN,CAAU,UAAV,EAAsBiB,UAAUzS,aAAV,CAAwBrN,eAAxB,CAAwCiI,MAAxC,CAAtB;AACA3lB,sBAAMu8B,GAAN,CAAU,UAAV,EAAsBiB,UAAUl9B,iBAAV,CAA4B2P,SAA5B,CAAsC,EAAtC,EAA0C0V,MAA1C,CAAtB;AACA,oBAAI,CAAC1wB,KAAKyqC,SAAV,EACI;AACJ5T,yBAAS6T,UAAUY,OAAV,EAAmBrlC,MAAnB,EAA2B0kC,QAA3B,EAAqC3qC,IAArC,EAA2C4qC,MAA3C,CAAT;AACAS,2BAAWC,OAAX,EAAoBvgC,KAApB,EAA2B8rB,MAA3B,EAAmCuV,OAAOnC,WAA1C;AACH;AAtCE,SAAP;AAwCH,KA3CK,CAAV;AA4CA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiFA,QAAIiC,YAAJ;AACAA,mBAAe,CAAC,QAAD,EAAW,cAAX,EAA2B,cAA3B,EAA2C,WAA3C,EACX,SAASa,wBAAT,CAAkC9mC,MAAlC,EAA0C+hC,YAA1C,EAAwDgF,YAAxD,EAAsEzE,SAAtE,EAAiF;AAC7E,eAAO;AACHyD,sBAAU,GADP;AAEHtI,wBAAY,CAAC,QAAD,EAAW,UAAX,EAAuB,QAAvB,EACR,UAAUuJ,MAAV,EAAkBlD,QAAlB,EAA4BmD,MAA5B,EAAoC;AAChC,oBAAI15B,SAAS,EAAb;AAAA,oBAAiB25B,aAAjB;AAAA,oBAAgCjB,YAAhC;AACA;AACA;AACA;AACAiB,gCAAgBH,aAAaE,OAAOE,cAAP,IAAyB,EAAtC,EAA0C,KAA1C,EAAiDH,MAAjD,CAAhB;AACA,oBAAI;AACAf,mCAAee,OAAOX,KAAP,CAAaY,OAAOhB,YAApB,CAAf;AACH,iBAFD,CAGA,OAAOrtC,CAAP,EAAU;AACN;AACA;AACH;AACDqtC,+BAAeA,gBAAgBc,aAAaE,OAAOhB,YAAP,IAAuB,EAApC,EAAwC,KAAxC,EAA+Ce,MAA/C,CAA/B;AACA,oBAAIp3C,SAASq2C,YAAT,CAAJ,EAA4B;AACxB/zC,4BAAQ+zC,YAAR,EAAsB,UAAU5lB,WAAV,EAAuB+mB,WAAvB,EAAoC;AACtD,4BAAI72C,SAAS8vB,WAAT,CAAJ,EAA2B;AACvB,gCAAI9xB,MAAMg1C,cAAcljB,WAAd,CAAV;AACAgnB,qCAAS94C,IAAIN,KAAb,EAAoB+4C,OAAOX,KAAP,CAAa93C,IAAIk1C,SAAjB,CAApB,EAAiD2D,WAAjD;AACH;AACJ,qBALD;AAMH;AACD;AACA,qBAAKd,cAAL,GAAsB,UAAUgB,QAAV,EAAoBrrB,SAApB,EAA+B;AACjD;AACA;AACA,wBAAIrsB,SAASq2C,YAAT,KAA0B14B,OAAOljB,MAAP,GAAgB,CAA9C,EAAiD;AAC7C;AACH;AACD,wBAAIs3B,aAAa0lB,SAASC,QAAT,EAAmBrrB,SAAnB,EAA8BgqB,YAA9B,CAAjB;AACAxb;AACA,2BAAO9I,UAAP;AACH,iBATD;AAUA,yBAAS4lB,qBAAT,CAA+BhrC,KAA/B,EAAsC;AAClCA,0BAAM7D,OAAN,CAAc+B,IAAd,CAAmBgwB,MAAnB;AACH;AACDuc,uBAAO3F,GAAP,CAAW,qBAAX,EAAkC5W,MAAlC;AACAuc,uBAAO3F,GAAP,CAAW,UAAX,EAAuBiB,UAAUl9B,iBAAV,CAA4BsP,OAA5B,CAAoC,EAApC,EAAwC6yB,qBAAxC,CAAvB;AACA,oBAAIjF,UAAUnuB,OAAV,CAAkB3T,UAAtB,EAAkC;AAC9B+mC,0CAAsBjF,UAAUnuB,OAAV,CAAkB3T,UAAxC;AACH;AACD,yBAAS6mC,QAAT,CAAkBhnC,SAAlB,EAA6BmnC,WAA7B,EAA0CJ,WAA1C,EAAuD;AACnD,wBAAIn5C,QAAQ+R,OAAO6Q,GAAP,CAAWxQ,SAAX,EAAsBM,aAAamjC,QAAb,CAAtB,CAAZ;AACA,wBAAI2D,YAAY;AACZx5C,+BAAOA,SAAS,EAAE9C,MAAMkV,SAAR,EADJ;AAEZpR,gCAAQu4C,WAFI;AAGZJ,qCAAaA;AAHD,qBAAhB;AAKA75B,2BAAOvZ,IAAP,CAAYyzC,SAAZ;AACA,2BAAO,SAASC,WAAT,GAAuB;AAC1Bh0C,mCAAW6Z,MAAX,EAAmBk6B,SAAnB;AACH,qBAFD;AAGH;AACD;AACA,yBAAShd,MAAT,GAAkB;AACd,wBAAIkd,eAAe,SAAfA,YAAe,CAAU3uB,GAAV,EAAe;AAC9B,+BAAOA,IAAIxtB,KAAJ,CAAU,IAAV,EAAgB0D,MAAhB,CAAuBuD,QAAvB,CAAP;AACH,qBAFD;AAGA,wBAAIm1C,aAAa,SAAbA,UAAa,CAAUC,SAAV,EAAqB;AAClC,+BAAOA,UAAUp8C,GAAV,CAAc,UAAUU,CAAV,EAAa;AAAE,mCAAOA,EAAEi7C,WAAT;AAAuB,yBAApD,EAAsD37C,GAAtD,CAA0Dk8C,YAA1D,EAAwE17C,MAAxE,CAA+E4J,OAA/E,EAAwF,EAAxF,CAAP;AACH,qBAFD;AAGA,wBAAIiyC,aAAaF,WAAWr6B,MAAX,EAAmB/iB,MAAnB,CAA0Bm9C,aAAaT,aAAb,CAA1B,EAAuDj7C,MAAvD,CAA8D+J,KAA9D,EAAqE,EAArE,CAAjB;AACA,wBAAI+xC,eAAeH,WAAWr6B,OAAOre,MAAP,CAAc,UAAU/C,CAAV,EAAa;AAAE,+BAAO6T,OAAOwW,QAAP,CAAgBrqB,EAAE8B,KAAF,CAAQ9C,IAAxB,EAA8BgB,EAAE8C,MAAhC,CAAP;AAAiD,qBAA9E,CAAX,CAAnB;AACA,wBAAI+4C,oBAAoB,CAAC,CAACz6B,OAAOre,MAAP,CAAc,UAAU/C,CAAV,EAAa;AAAE,+BAAO6T,OAAO3T,EAAP,CAAUF,EAAE8B,KAAF,CAAQ9C,IAAlB,EAAwBgB,EAAE8C,MAA1B,CAAP;AAA2C,qBAAxE,EAA0E5E,MAApG;AACA,wBAAI49C,eAAeD,oBAAoBL,aAAaT,aAAb,CAApB,GAAkD,EAArE;AACA,wBAAIgB,aAAaH,aAAav9C,MAAb,CAAoBy9C,YAApB,EAAkCh8C,MAAlC,CAAyC+J,KAAzC,EAAgD,EAAhD,CAAjB;AACA,wBAAImyC,gBAAgBL,WAAW54C,MAAX,CAAkB,UAAUk5C,GAAV,EAAe;AAAE,+BAAO,CAAC90C,QAAQ40C,UAAR,EAAoBE,GAApB,CAAR;AAAmC,qBAAtE,CAApB;AACApB,2BAAOqB,UAAP,CAAkB,YAAY;AAC1BH,mCAAWh2C,OAAX,CAAmB,UAAUo2C,SAAV,EAAqB;AAAE,mCAAOxE,SAASyE,QAAT,CAAkBD,SAAlB,CAAP;AAAsC,yBAAhF;AACAH,sCAAcj2C,OAAd,CAAsB,UAAUo2C,SAAV,EAAqB;AAAE,mCAAOxE,SAAS0E,WAAT,CAAqBF,SAArB,CAAP;AAAyC,yBAAtF;AACH,qBAHD;AAIH;AACD7d;AACH,aA1EO;AAFT,SAAP;AA8EH,KAhFU,CAAf;AAiFA0R,OAAG3yC,MAAH,CAAU,iBAAV,EACKi/C,SADL,CACe,QADf,EACyB5C,MADzB,EAEK4C,SAFL,CAEe,cAFf,EAE+BxC,YAF/B,EAGKwC,SAHL,CAGe,gBAHf,EAGiCxC,YAHjC,EAIKwC,SAJL,CAIe,SAJf,EAI0B1E,OAJ1B;;AAMA,sBAnpS2C,CAmpSxB;AACnB;;;;;;;;;;AAUA2E,mBAAejR,OAAf,GAAyB,CAAC,QAAD,CAAzB;AACA,aAASiR,cAAT,CAAwB1oC,MAAxB,EAAgC;AAC5B,YAAI2oC,WAAW,SAAXA,QAAW,CAAU16C,KAAV,EAAiBgB,MAAjB,EAAyB0L,OAAzB,EAAkC;AAC7C,mBAAOqF,OAAO3T,EAAP,CAAU4B,KAAV,EAAiBgB,MAAjB,EAAyB0L,OAAzB,CAAP;AACH,SAFD;AAGAguC,iBAASC,SAAT,GAAqB,IAArB;AACA,eAAOD,QAAP;AACH;AACD;;;;;;;;;;AAUAE,2BAAuBpR,OAAvB,GAAiC,CAAC,QAAD,CAAjC;AACA,aAASoR,sBAAT,CAAgC7oC,MAAhC,EAAwC;AACpC,YAAI8oC,iBAAiB,SAAjBA,cAAiB,CAAU76C,KAAV,EAAiBgB,MAAjB,EAAyB0L,OAAzB,EAAkC;AACnD,mBAAOqF,OAAOwW,QAAP,CAAgBvoB,KAAhB,EAAuBgB,MAAvB,EAA+B0L,OAA/B,CAAP;AACH,SAFD;AAGAmuC,uBAAeF,SAAf,GAA2B,IAA3B;AACA,eAAOE,cAAP;AACH;AACD3M,OAAG3yC,MAAH,CAAU,iBAAV,EACK0F,MADL,CACY,SADZ,EACuBw5C,cADvB,EAEKx5C,MAFL,CAEY,iBAFZ,EAE+B25C,sBAF/B;;AAIA;;;OA5rS2C,CA+rSvC;AACJ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6HA,QAAInc,MAAJ;AACAA,aAAS,CAAC,OAAD,EAAU,UAAV,EAAsB,eAAtB,EAAuC,cAAvC,EAAuD,IAAvD,EACL,SAASqc,cAAT,CAAwBz7B,KAAxB,EAA+B07B,QAA/B,EAAyCC,aAAzC,EAAwDlC,YAAxD,EAAsEvJ,KAAtE,EAA6E;AACzE,iBAAS0L,WAAT,CAAqBtJ,KAArB,EAA4B96B,KAA5B,EAAmC;AAC/B,mBAAO;AACHqkC,uBAAO,eAAU9D,OAAV,EAAmBxyC,MAAnB,EAA2BsE,EAA3B,EAA+B;AAClC,wBAAIglC,GAAG8B,OAAH,CAAWC,KAAX,GAAmB,CAAvB,EAA0B;AACtB8K,iCAASG,KAAT,CAAe9D,OAAf,EAAwB,IAAxB,EAA8BxyC,MAA9B,EAAsC4H,IAAtC,CAA2CtD,EAA3C;AACH,qBAFD,MAGK;AACD6xC,iCAASG,KAAT,CAAe9D,OAAf,EAAwB,IAAxB,EAA8BxyC,MAA9B,EAAsCsE,EAAtC;AACH;AACJ,iBARE;AASHiyC,uBAAO,eAAU/D,OAAV,EAAmBluC,EAAnB,EAAuB;AAC1B,wBAAIglC,GAAG8B,OAAH,CAAWC,KAAX,GAAmB,CAAvB,EAA0B;AACtB8K,iCAASI,KAAT,CAAe/D,OAAf,EAAwB5qC,IAAxB,CAA6BtD,EAA7B;AACH,qBAFD,MAGK;AACD6xC,iCAASI,KAAT,CAAe/D,OAAf,EAAwBluC,EAAxB;AACH;AACJ;AAhBE,aAAP;AAkBH;AACD,iBAASkyC,YAAT,CAAsBC,OAAtB,EAA+BC,OAA/B,EAAwC;AACpC,mBAAOD,YAAYC,OAAnB;AACH;AACD,YAAIC,WAAW;AACXC,kBAAM,EAAE5tC,UAAU,EAAEC,UAAUwR,MAAMjJ,UAAN,CAAiBunB,gBAAjB,EAAZ,EAAZ,EADK;AAEX+X,qBAAS;AAFE,SAAf;AAIA,YAAI8E,YAAY;AACZ5b,mBAAO,CADK;AAEZkZ,sBAAU,KAFE;AAGZ2D,sBAAU,IAHE;AAIZ3lC,sBAAU,GAJE;AAKZ4lC,wBAAY,SALA;AAMZ1sB,qBAAS,iBAAU2sB,QAAV,EAAoBC,MAApB,EAA4BC,WAA5B,EAAyC;AAC9C,uBAAO,UAAUhlC,KAAV,EAAiBg/B,QAAjB,EAA2BlE,KAA3B,EAAkC;AACrC,wBAAImK,UAAJ;AAAA,wBAAgBC,SAAhB;AAAA,wBAA2BC,YAA3B;AAAA,wBAAyCC,UAAzC;AAAA,wBAAqDC,YAAYvK,MAAM,QAAN,KAAmB,EAApF;AAAA,wBAAwFwK,gBAAgBxK,MAAM,YAAN,CAAxG;AAAA,wBAA6HyK,WAAWnB,YAAYtJ,KAAZ,EAAmB96B,KAAnB,CAAxI;AAAA,wBAAmKlJ,aAAatK,SAAhL;AAAA,wBAA2LvC,YAAY+0C,SAASF,aAAT,CAAuB,SAAvB,KAAqC4F,QAA5O;AAAA,wBAAsPr+C,OAAO47C,aAAanH,MAAM,QAAN,KAAmBA,MAAM,MAAN,CAAnB,IAAoC,EAAjD,EAAqD96B,KAArD,KAA+D,UAA5T;AACA,wBAAIwlC,eAAe;AACfne,+BAAO,KADQ;AAEf98B,4BAAIo5C,UAAU5b,KAAV,EAFW;AAGf1hC,8BAAMA,IAHS;AAIfqD,6BAAKO,UAAU40C,OAAV,CAAkBn1C,GAAlB,GAAwBO,UAAU40C,OAAV,CAAkBn1C,GAAlB,GAAwB,GAAxB,GAA8BrD,IAAtD,GAA6DA,IAJnD;AAKf0C,gCAAQ,IALO;AAMfu/B,uCAAemd,qBANA;AAOf,4BAAI7uC,eAAJ,GAAsB;AAClB,gCAAI8uC,sBAAsBj/C,MAAM,wBAAN,EAAgCwD,SAAhC,CAA1B;AACA;AACA;AACA,gCAAI07C,gBAAgBl/C,MAAM,yBAAN,EAAiCwD,SAAjC,CAApB;AACA,mCAAOy7C,uBAAuBC,aAA9B;AACH;AAbc,qBAAnB;AAeAlrC,0BAAMT,gBAAN,CAAuB,SAAvB,EAAkCwrC,YAAlC;AACA,6BAASC,qBAAT,CAA+B18C,MAA/B,EAAuC;AACnC,4BAAIA,UAAU,EAAEA,kBAAkByuC,aAApB,CAAd,EACI;AACJ,4BAAI+M,aAAaztC,UAAb,EAAyB/N,MAAzB,CAAJ,EACI;AACJ0R,8BAAMN,wBAAN,CAA+BqrC,YAA/B,EAA6Cz8C,UAAUA,OAAOgO,QAAjB,IAA6BhO,OAAOgO,QAAP,CAAgBC,QAA1F;AACAF,qCAAa/N,MAAb;AACA68C,mCAAW78C,MAAX;AACH;AACDi2C,6BAASrlC,IAAT,CAAc,SAAd,EAAyB,EAAEklC,SAAS2G,YAAX,EAAzB;AACAI;AACAR,iCAAa58B,MAAM+f,cAAN,CAAqBid,YAArB,CAAb;AACAxlC,0BAAMu8B,GAAN,CAAU,UAAV,EAAsB,YAAY;AAC9B9hC,8BAAMT,gBAAN,CAAuB,0BAAvB,EAAmDwrC,YAAnD;AACAJ;AACH,qBAHD;AAIA,6BAASS,eAAT,GAA2B;AACvB,4BAAIZ,UAAJ,EAAgB;AACZxqC,kCAAMT,gBAAN,CAAuB,wBAAvB,EAAiDirC,WAAWtrC,IAAX,CAAgB,SAAhB,CAAjD;AACAsrC,uCAAWrwC,MAAX;AACAqwC,yCAAa,IAAb;AACH;AACD,4BAAIE,YAAJ,EAAkB;AACd1qC,kCAAMT,gBAAN,CAAuB,kBAAvB,EAA2CwrC,YAA3C;AACAL,yCAAaW,QAAb;AACAX,2CAAe,IAAf;AACH;AACD,4BAAID,SAAJ,EAAe;AACX,gCAAIa,cAAcb,UAAUvrC,IAAV,CAAe,aAAf,CAAlB;AACAc,kCAAMT,gBAAN,CAAuB,aAAvB,EAAsC+rC,WAAtC;AACAR,qCAASjB,KAAT,CAAeY,SAAf,EAA0B,YAAY;AAClCa,4CAAYC,WAAZ,CAAwBr6B,OAAxB;AACAs5B,6CAAa,IAAb;AACH,6BAHD;AAIAA,yCAAaC,SAAb;AACAA,wCAAY,IAAZ;AACH;AACJ;AACD,6BAASU,UAAT,CAAoB78C,MAApB,EAA4B;AACxB,4BAAIk9C,WAAWjmC,MAAMkmC,IAAN,EAAf;AACA,4BAAIC,YAAYzN,MAAMvpB,KAAN,EAAhB;AAAA,4BAA+Bi3B,YAAY1N,MAAMvpB,KAAN,EAA3C;AACA,4BAAIk3B,cAAc;AACd1B,kCAAM57C,MADQ;AAEd81C,qCAAS2G;AAFK,yBAAlB;AAIA,4BAAIc,cAAc;AACdC,wCAAYJ,UAAUvyC,OADR;AAEd4yC,wCAAYJ,UAAUxyC,OAFR;AAGdoyC,yCAAaI;AAHC,yBAAlB;AAKA;;;;;;;;;;;;AAYAH,iCAASQ,KAAT,CAAe,qBAAf,EAAsCpgD,IAAtC;AACA,4BAAI4jB,SAAS+6B,YAAYiB,QAAZ,EAAsB,UAAU1+B,KAAV,EAAiB;AAChDA,kCAAM5N,IAAN,CAAW,aAAX,EAA0B2sC,WAA1B;AACA/+B,kCAAM5N,IAAN,CAAW,SAAX,EAAsB0sC,WAAtB;AACAd,qCAASlB,KAAT,CAAe98B,KAAf,EAAsBy3B,QAAtB,EAAgC,SAAS0H,aAAT,GAAyB;AACrDP,0CAAUx6B,OAAV;AACA,oCAAIw5B,YAAJ,EACIA,aAAasB,KAAb,CAAmB,4BAAnB;AACJ,oCAAIr7C,UAAUk6C,aAAV,KAA4B,CAACA,aAA7B,IAA8CtlC,MAAMuhC,KAAN,CAAY+D,aAAZ,CAAlD,EAA8E;AAC1EnB,kDAAc58B,KAAd;AACH;AACJ,6BAPD;AAQAs+B;AACH,yBAZY,CAAb;AAaAX,oCAAYj7B,MAAZ;AACAk7B,uCAAec,QAAf;AACA;;;;;;;;;;AAUAd,qCAAasB,KAAb,CAAmB,oBAAnB,EAAyC19C,UAAU+N,UAAnD;AACAquC,qCAAa5D,KAAb,CAAmB8D,SAAnB;AACH;AACJ,iBA7GD;AA8GH;AArHW,SAAhB;AAuHA,eAAO1B,SAAP;AACH,KArJI,CAAT;AAsJAgD,uBAAmBhU,OAAnB,GAA6B,CAAC,UAAD,EAAa,aAAb,EAA4B,cAA5B,EAA4C,OAA5C,EAAqD,IAArD,EAA2D,UAA3D,CAA7B;AACA;AACA,aAASgU,kBAAT,CAA4BC,QAA5B,EAAsCC,WAAtC,EAAmD/lC,YAAnD,EAAiE0H,KAAjE,EAAwEkwB,KAAxE,EAA+EkH,QAA/E,EAAyF;AACrF,YAAIkH,kBAAkBrgD,MAAM,uBAAN,CAAtB;AACA,YAAIsgD,eAAetgD,MAAM,oBAAN,CAAnB;AACA,eAAO;AACHw6C,sBAAU,KADP;AAEHhiC,sBAAU,CAAC,GAFR;AAGHkZ,qBAAS,iBAAU2sB,QAAV,EAAoB;AACzB,oBAAIve,UAAUue,SAASzqC,IAAT,EAAd;AACAyqC,yBAASkC,KAAT;AACA,uBAAO,UAAUhnC,KAAV,EAAiBg/B,QAAjB,EAA2B;AAC9B,wBAAIrlC,OAAOqlC,SAASrlC,IAAT,CAAc,SAAd,CAAX;AACA,wBAAI,CAACA,IAAL,EAAW;AACPqlC,iCAAS3kC,IAAT,CAAcksB,OAAd;AACAqgB,iCAAS5H,SAASiI,QAAT,EAAT,EAA8BjnC,KAA9B;AACA;AACH;AACD,wBAAIoE,MAAMzK,KAAKgrC,IAAL,IAAa,EAAE5tC,UAAU,EAAZ,EAAgBuhC,aAAavzC,eAAeoyC,IAA5C,EAAvB;AACA,wBAAI+P,aAAa9iC,IAAIrU,IAAJ,IAAY,IAAIsd,cAAJ,CAAmBjJ,IAAIrU,IAAvB,CAA7B;AACAivC,6BAAS3kC,IAAT,CAAc+J,IAAIk0B,WAAJ,CAAgB0G,QAAhB,EAA0BkI,UAA1B,KAAyC3gB,OAAvD;AACA9rB,0BAAML,eAAN,CAAsBT,KAAKklC,OAA3B,EAAoCG,SAAS3kC,IAAT,EAApC;AACA,wBAAI6mC,OAAO0F,SAAS5H,SAASiI,QAAT,EAAT,CAAX;AACA,wBAAItO,aAAav0B,IAAIu0B,UAArB;AACA,wBAAIwO,eAAeL,gBAAgB1iC,GAAhB,CAAnB;AACA,wBAAI8zB,YAAY6O,aAAa3iC,GAAb,CAAhB;AACA,wBAAIquB,SAASyU,cAAcxL,UAAUwL,UAAV,CAA3B;AACAlnC,0BAAMk4B,SAAN,IAAmBzF,MAAnB;AACA,wBAAIkG,UAAJ,EAAgB;AACZ,4BAAIyO,qBAAqBP,YAAYlO,UAAZ,EAAwBrrC,OAAO,EAAP,EAAWmlC,MAAX,EAAmB,EAAEyP,QAAQliC,KAAV,EAAiBg/B,UAAUA,QAA3B,EAAnB,CAAxB,CAAzB;AACA,4BAAImI,YAAJ,EAAkB;AACdnnC,kCAAMmnC,YAAN,IAAsBC,kBAAtB;AACApnC,kCAAMmnC,YAAN,EAAoBjP,SAApB,IAAiCzF,MAAjC;AACH;AACD;AACA;AACA;AACA;AACAuM,iCAASrlC,IAAT,CAAc,yBAAd,EAAyCytC,kBAAzC;AACApI,iCAAShhB,QAAT,GAAoBrkB,IAApB,CAAyB,yBAAzB,EAAoDytC,kBAApD;AACAC,oDAA4B3O,KAA5B,EAAmC53B,YAAnC,EAAiDsmC,kBAAjD,EAAqEpnC,KAArE,EAA4EoE,GAA5E;AACH;AACD;AACA,wBAAI3Y,SAAS2Y,IAAIrN,QAAJ,CAAakhC,SAAtB,CAAJ,EAAsC;AAClC,4BAAIqP,QAAQljC,IAAIrN,QAAJ,CAAakhC,SAAzB;AACA,4BAAI+C,YAAY7mB,YAAYmzB,KAAZ,CAAhB;AACA,4BAAIC,cAAc,IAAI/+C,MAAJ,CAAW,iBAAiBwyC,SAAjB,GAA6B,GAAxC,EAA6C,GAA7C,CAAlB;AACA,4BAAIwM,yBAAyB,SAAzBA,sBAAyB,GAAY;AACrC,gCAAIC,cAAc,GAAGtiD,KAAH,CAASY,IAAT,CAAci5C,SAAS,CAAT,EAAYhhB,QAA1B,EACb5zB,MADa,CACN,UAAUw0C,EAAV,EAAc;AAAE,uCAAOA,MAAMA,GAAG8I,OAAT,IAAoBH,YAAY3+C,IAAZ,CAAiBg2C,GAAG8I,OAApB,CAA3B;AAA0D,6BADpE,CAAlB;AAEA,mCAAOD,eAAepQ,GAAGkJ,OAAH,CAAWkH,WAAX,EAAwB9tC,IAAxB,CAA6B,MAAM2tC,KAAN,GAAc,YAA3C,CAAtB;AACH,yBAJD;AAKA,4BAAIK,oBAAoB3nC,MAAMo+B,MAAN,CAAaoJ,sBAAb,EAAqC,UAAUI,YAAV,EAAwB;AACjF,gCAAI,CAACA,YAAL,EACI;AACJP,wDAA4B3O,KAA5B,EAAmC53B,YAAnC,EAAiD8mC,YAAjD,EAA+D5nC,KAA/D,EAAsEoE,GAAtE;AACAujC;AACH,yBALuB,CAAxB;AAMH;AACDzG,yBAAKlhC,KAAL;AACH,iBAjDD;AAkDH;AAxDE,SAAP;AA0DH;AACD;AACA,QAAI6nC,mBAAmB,OAAOxQ,GAAG3yC,MAAH,CAAU,WAAV,EAAuB,WAAvB,CAAP,KAA+C,UAAtE;AACA;AACA,QAAIojD,eAAe,CAAnB;AACA;AACA,aAAST,2BAAT,CAAqC3O,KAArC,EAA4C53B,YAA5C,EAA0DsmC,kBAA1D,EAA8ElF,MAA9E,EAAsF99B,GAAtF,EAA2F;AACvF;AACA,YAAIxZ,WAAWw8C,mBAAmBW,OAA9B,KAA0C,EAAE3jC,IAAIrN,QAAJ,CAAakhC,SAAb,IAA0B4P,gBAA5B,CAA9C,EAA6F;AACzFT,+BAAmBW,OAAnB;AACH;AACD,YAAIC,YAAY/7C,KAAKmY,IAAIrU,IAAT,EAAe5G,KAAf,CAAqBG,IAArC;AACA,YAAI2+C,cAAc,EAAEl7C,MAAMq6C,kBAAR,EAAlB;AACA;AACA,YAAIx8C,WAAWw8C,mBAAmBc,iBAA9B,CAAJ,EAAsD;AAClD,gBAAIt8B,iBAAiB,IAAIyB,cAAJ,CAAmBjJ,IAAIrU,IAAvB,CAArB;AACA,gBAAIo4C,sBAAsBv8B,eAAe4B,aAAf,CAA6B,cAA7B,EAA6C7T,IAAvE;AACA;AACA,gBAAIyuC,gBAAgB,SAAhBA,aAAgB,CAAUxM,YAAV,EAAwB;AACxC;AACA;AACA,oBAAIA,iBAAiBuM,mBAAjB,IAAwCvM,aAAazxB,OAAb,GAAuBxb,OAAvB,CAA+Bq5C,SAA/B,MAA8C,CAAC,CAA3F,EACI;AACJ,oBAAI9/B,WAAW0zB,aAAazxC,MAAb,CAAoB,IAApB,CAAf;AACA,oBAAI4pB,aAAa6nB,aAAazxC,MAAb,CAAoB,MAApB,CAAjB;AACA,oBAAIk+C,WAAWzM,aAAal8B,WAAb,GAA2B+F,EAA3B,CAA8B9e,GAA9B,CAAkC,UAAU0Y,IAAV,EAAgB;AAAE,2BAAOA,KAAK8H,WAAZ;AAA0B,iBAA9E,EAAgFhgB,MAAhF,CAAuF4J,OAAvF,EAAgG,EAAhG,CAAf;AACA,oBAAIu3C,aAAa1M,aAAal8B,WAAb,GAA2B8F,IAA3B,CAAgC7e,GAAhC,CAAoC,UAAU0Y,IAAV,EAAgB;AAAE,2BAAOA,KAAK8H,WAAZ;AAA0B,iBAAhF,EAAkFhgB,MAAlF,CAAyF4J,OAAzF,EAAkG,EAAlG,CAAjB;AACA;AACA,oBAAIw3C,kBAAkBF,SAASj+C,MAAT,CAAgB,UAAUC,KAAV,EAAiB;AACnD,wBAAIyE,MAAMw5C,WAAW35C,OAAX,CAAmBtE,KAAnB,CAAV;AACA,2BAAOyE,QAAQ,CAAC,CAAT,IAAc,CAACw5C,WAAWx5C,GAAX,EAAgBmG,IAAhB,CAAqBxH,MAArB,CAA4Bya,SAAS7d,MAAME,EAAf,CAA5B,EAAgDwpB,WAAW1pB,MAAME,EAAjB,CAAhD,CAAtB;AACH,iBAHqB,CAAtB;AAIA;AACA,oBAAIg+C,gBAAgBhjD,MAApB,EAA4B;AACxB,wBAAIijD,gBAAgBD,gBAAgB5hD,GAAhB,CAAoB,UAAUU,CAAV,EAAa;AAAE,+BAAOA,EAAEkD,EAAT;AAAc,qBAAjD,CAApB;AACA;AACA,wBAAIk+C,YAAYr+C,OAAO8d,QAAP,EAAiB,UAAUnc,MAAV,EAAkBsE,GAAlB,EAAuB;AAAE,+BAAOm4C,cAAc75C,OAAd,CAAsB0B,GAAtB,MAA+B,CAAC,CAAvC;AAA2C,qBAArF,CAAhB;AACA+2C,uCAAmBc,iBAAnB,CAAqCO,SAArC,EAAgD7M,YAAhD;AACH;AACJ,aArBD;AAsBAsG,mBAAO3F,GAAP,CAAW,UAAX,EAAuBz7B,aAAamP,SAAb,CAAuB,EAAvB,EAA2Bm4B,aAA3B,EAA0CH,WAA1C,CAAvB;AACH;AACD;AACA,YAAIr9C,WAAWw8C,mBAAmBsB,SAA9B,CAAJ,EAA8C;AAC1C,gBAAIC,OAAOb,cAAX;AACA,gBAAIc,cAAc,eAAlB;AACA;AACA,gBAAIC,qBAAqB,SAArBA,kBAAqB,CAAUpxC,KAAV,EAAiB;AACtC,uBAAO,CAAC,CAACA,KAAF,KAAYA,MAAMmxC,WAAN,KAAsBnxC,MAAMmxC,WAAN,EAAmBD,IAAnB,MAA6B,IAAnD,IAA2DE,mBAAmBpxC,MAAMsZ,cAAN,EAAnB,CAAvE,CAAP;AACH,aAFD;AAGA;AACA,gBAAI+3B,cAAc,SAAdA,WAAc,CAAUrxC,KAAV,EAAiB;AAC/B,oBAAI7D,OAAJ;AAAA,oBAAam1C,MAAMtxC,MAAMmxC,WAAN,IAAqBnxC,MAAMmxC,WAAN,KAAsB,EAA9D;AACA,oBAAI,CAACC,mBAAmBpxC,KAAnB,CAAL,EAAgC;AAC5B7D,8BAAU8kC,MAAMn/B,IAAN,CAAW6tC,mBAAmBsB,SAAnB,CAA6BjxC,KAA7B,CAAX,CAAV;AACA7D,4BAAQ+B,IAAR,CAAa,UAAU5J,MAAV,EAAkB;AAAE,+BAAOg9C,IAAIJ,IAAJ,IAAa58C,WAAW,KAA/B;AAAwC,qBAAzE;AACH;AACD,uBAAO6H,OAAP;AACH,aAPD;AAQA,gBAAI+L,WAAW,EAAEwK,SAAS69B,UAAU3hD,IAArB,EAAf;AACA67C,mBAAO3F,GAAP,CAAW,UAAX,EAAuBz7B,aAAa6O,QAAb,CAAsBhQ,QAAtB,EAAgCmpC,WAAhC,EAA6Cb,WAA7C,CAAvB;AACH;AACJ;AACD5Q,OAAG3yC,MAAH,CAAU,iBAAV,EAA6Bi/C,SAA7B,CAAuC,QAAvC,EAAiD/b,MAAjD;AACAyP,OAAG3yC,MAAH,CAAU,iBAAV,EAA6Bi/C,SAA7B,CAAuC,QAAvC,EAAiDgD,kBAAjD;;AAEA,sBArlT2C,CAqlTxB;AACnB;AACA,aAASqC,mBAAT,GAA+B;AAC3B,YAAIC,kBAAkB,KAAtB;AACA,aAAKA,eAAL,GAAuB,YAAY;AAC/BA,8BAAkB,IAAlB;AACH,SAFD;AAGA,aAAKzmB,IAAL,GAAY,CAAC,eAAD,EAAkB,UAAlB,EAA8B,UAAU0mB,aAAV,EAAyBtJ,QAAzB,EAAmC;AACrE,gBAAIqJ,eAAJ,EAAqB;AACjB,uBAAOC,aAAP;AACH;AACD,mBAAO,UAAUlK,QAAV,EAAoB;AACvB,uBAAOY,SAAS,YAAY;AACxBZ,6BAAS,CAAT,EAAYmK,cAAZ;AACH,iBAFM,EAEJ,CAFI,EAED,KAFC,CAAP;AAGH,aAJD;AAKH,SATO,CAAZ;AAUH;AACD9R,OAAG3yC,MAAH,CAAU,iBAAV,EAA6Bo0C,QAA7B,CAAsC,eAAtC,EAAuDkQ,mBAAvD;;AAEA;;;OAzmT2C,CA4mTvC;AACJ,QAAIhpB,QAAQ,WAAZ;;AAEAv7B,YAAQ2kD,IAAR,GAAelS,OAAf;AACAzyC,YAAQ,SAAR,IAAqBu7B,KAArB;AACAv7B,YAAQoI,QAAR,GAAmBA,QAAnB;AACApI,YAAQuI,MAAR,GAAiBA,MAAjB;AACAvI,YAAQyI,IAAR,GAAeA,IAAf;AACAzI,YAAQ2I,OAAR,GAAkBA,OAAlB;AACA3I,YAAQ6I,MAAR,GAAiBA,MAAjB;AACA7I,YAAQgJ,MAAR,GAAiBA,MAAjB;AACAhJ,YAAQkJ,QAAR,GAAmBA,QAAnB;AACAlJ,YAAQ0yC,IAAR,GAAevpC,MAAf;AACAnJ,YAAQoJ,oBAAR,GAA+BA,oBAA/B;AACApJ,YAAQ2E,OAAR,GAAkBA,OAAlB;AACA3E,YAAQ+J,OAAR,GAAkBA,OAAlB;AACA/J,YAAQgK,QAAR,GAAmBA,QAAnB;AACAhK,YAAQmK,UAAR,GAAqBA,UAArB;AACAnK,YAAQoK,WAAR,GAAsBA,WAAtB;AACApK,YAAQuK,MAAR,GAAiBA,MAAjB;AACAvK,YAAQwK,OAAR,GAAkBA,OAAlB;AACAxK,YAAQ0K,QAAR,GAAmBA,QAAnB;AACA1K,YAAQsF,QAAR,GAAmBA,QAAnB;AACAtF,YAAQgL,MAAR,GAAiBA,MAAjB;AACAhL,YAAQmL,SAAR,GAAoBA,SAApB;AACAnL,YAAQ+K,IAAR,GAAeA,IAAf;AACA/K,YAAQ2L,IAAR,GAAeA,IAAf;AACA3L,YAAQ6L,KAAR,GAAgBA,KAAhB;AACA7L,YAAQ2F,MAAR,GAAiBA,MAAjB;AACA3F,YAAQiG,IAAR,GAAeA,IAAf;AACAjG,YAAQkM,MAAR,GAAiBA,MAAjB;AACAlM,YAAQkC,GAAR,GAAcA,GAAd;AACAlC,YAAQyF,MAAR,GAAiBA,MAAjB;AACAzF,YAAQmM,QAAR,GAAmBA,QAAnB;AACAnM,YAAQqM,QAAR,GAAmBA,QAAnB;AACArM,YAAQsM,OAAR,GAAkBA,OAAlB;AACAtM,YAAQuM,QAAR,GAAmBA,QAAnB;AACAvM,YAAQwM,KAAR,GAAgBA,KAAhB;AACAxM,YAAQyM,KAAR,GAAgBA,KAAhB;AACAzM,YAAQ2M,MAAR,GAAiBA,MAAjB;AACA3M,YAAQ4M,OAAR,GAAkBA,OAAlB;AACA5M,YAAQ6M,eAAR,GAA0BA,eAA1B;AACA7M,YAAQ+M,SAAR,GAAoBA,SAApB;AACA/M,YAAQ8M,QAAR,GAAmBA,QAAnB;AACA9M,YAAQkN,KAAR,GAAgBA,KAAhB;AACAlN,YAAQmN,WAAR,GAAsBA,WAAtB;AACAnN,YAAQuN,UAAR,GAAqBA,UAArB;AACAvN,YAAQwH,IAAR,GAAeA,IAAf;AACAxH,YAAQ+I,OAAR,GAAkBA,OAAlB;AACA/I,YAAQ0O,MAAR,GAAiBA,MAAjB;AACA1O,YAAQ8O,WAAR,GAAsBA,WAAtB;AACA9O,YAAQkP,wBAAR,GAAmCA,wBAAnC;AACAlP,YAAQsP,eAAR,GAA0BA,eAA1B;AACAtP,YAAQ0H,cAAR,GAAyBA,cAAzB;AACA1H,YAAQ6H,QAAR,GAAmBA,QAAnB;AACA7H,YAAQwD,IAAR,GAAeA,IAAf;AACAxD,YAAQO,KAAR,GAAgBA,KAAhB;AACAP,YAAQkB,OAAR,GAAkBA,OAAlB;AACAlB,YAAQuB,IAAR,GAAeA,IAAf;AACAvB,YAAQ2B,IAAR,GAAeA,IAAf;AACA3B,YAAQ8B,MAAR,GAAiBA,MAAjB;AACA9B,YAAQgC,KAAR,GAAgBA,KAAhB;AACAhC,YAAQmC,GAAR,GAAcA,GAAd;AACAnC,YAAQoC,GAAR,GAAcA,GAAd;AACApC,YAAQuC,EAAR,GAAaA,EAAb;AACAvC,YAAQwC,GAAR,GAAcA,GAAd;AACAxC,YAAQ6C,GAAR,GAAcA,GAAd;AACA7C,YAAQ8C,EAAR,GAAaA,EAAb;AACA9C,YAAQiD,EAAR,GAAaA,EAAb;AACAjD,YAAQ+B,GAAR,GAAcA,GAAd;AACA/B,YAAQoD,MAAR,GAAiBA,MAAjB;AACApD,YAAQsD,OAAR,GAAkBA,OAAlB;AACAtD,YAAQ0G,WAAR,GAAsBA,WAAtB;AACA1G,YAAQ2G,SAAR,GAAoBA,SAApB;AACA3G,YAAQ4G,MAAR,GAAiBA,MAAjB;AACA5G,YAAQ8G,iBAAR,GAA4BA,iBAA5B;AACA9G,YAAQmG,UAAR,GAAqBA,UAArB;AACAnG,YAAQ+G,QAAR,GAAmBA,QAAnB;AACA/G,YAAQgH,QAAR,GAAmBA,QAAnB;AACAhH,YAAQqG,QAAR,GAAmBA,QAAnB;AACArG,YAAQiH,OAAR,GAAkBA,OAAlB;AACAjH,YAAQmH,MAAR,GAAiBA,MAAjB;AACAnH,YAAQoH,QAAR,GAAmBA,QAAnB;AACApH,YAAQoG,OAAR,GAAkBA,OAAlB;AACApG,YAAQqH,YAAR,GAAuBA,YAAvB;AACArH,YAAQyH,SAAR,GAAoBA,SAApB;AACAzH,YAAQyP,KAAR,GAAgBA,KAAhB;AACAzP,YAAQyU,SAAR,GAAoBA,SAApB;AACAzU,YAAQyV,SAAR,GAAoBA,SAApB;AACAzV,YAAQ0vB,WAAR,GAAsBA,WAAtB;AACA1vB,YAAQuU,gBAAR,GAA2BA,gBAA3B;AACAvU,YAAQ+Y,UAAR,GAAqBA,UAArB;AACA/Y,YAAQwI,SAAR,GAAoBA,SAApB;AACAxI,YAAQswB,iBAAR,GAA4BA,iBAA5B;AACAtwB,YAAQwwB,YAAR,GAAuBA,YAAvB;AACAxwB,YAAQ2wB,cAAR,GAAyBA,cAAzB;AACA3wB,YAAQiT,KAAR,GAAgBA,KAAhB;AACAjT,YAAQgW,KAAR,GAAgBA,KAAhB;AACAhW,YAAQihB,KAAR,GAAgBA,KAAhB;AACAjhB,YAAQ4wB,UAAR,GAAqBA,UAArB;AACA5wB,YAAQwyB,WAAR,GAAsBA,WAAtB;AACAxyB,YAAQ+d,SAAR,GAAoBA,SAApB;AACA/d,YAAQwiB,QAAR,GAAmBA,QAAnB;AACAxiB,YAAQqjB,SAAR,GAAoBA,SAApB;AACArjB,YAAQmoB,eAAR,GAA0BA,eAA1B;AACAnoB,YAAQqmB,oBAAR,GAA+BA,oBAA/B;AACArmB,YAAQumB,UAAR,GAAqBA,UAArB;AACAvmB,YAAQ2oB,qBAAR,GAAgCA,qBAAhC;AACA3oB,YAAQ4oB,cAAR,GAAyBA,cAAzB;AACA5oB,YAAQ80B,kBAAR,GAA6BA,kBAA7B;AACA90B,YAAQg2B,YAAR,GAAuBA,YAAvB;AACAh2B,YAAQqE,WAAR,GAAsBA,WAAtB;AACArE,YAAQ22B,YAAR,GAAuBA,YAAvB;AACA32B,YAAQq3B,iBAAR,GAA4BA,iBAA5B;AACAr3B,YAAQ04B,aAAR,GAAwBA,aAAxB;AACA14B,YAAQumC,YAAR,GAAuBA,YAAvB;AACAvmC,YAAQmW,WAAR,GAAsBA,WAAtB;AACAnW,YAAQkc,WAAR,GAAsBA,WAAtB;AACAlc,YAAQ8Z,UAAR,GAAqBA,UAArB;AACA9Z,YAAQqa,cAAR,GAAyBA,cAAzB;AACAra,YAAQ2b,SAAR,GAAoBA,SAApB;AACA3b,YAAQuQ,SAAR,GAAoBA,SAApB;AACAvQ,YAAQwqB,UAAR,GAAqBA,UAArB;AACAxqB,YAAQmX,cAAR,GAAyBA,cAAzB;AACAnX,YAAQspC,mBAAR,GAA8BA,mBAA9B;AACAtpC,YAAQ6pC,gBAAR,GAA2BA,gBAA3B;AACA7pC,YAAQqmC,iBAAR,GAA4BA,iBAA5B;AACArmC,YAAQq6B,UAAR,GAAqBA,UAArB;AACAr6B,YAAQw9B,iBAAR,GAA4BA,iBAA5B;AACAx9B,YAAQ2/B,SAAR,GAAoBA,SAApB;AACA3/B,YAAQg+B,cAAR,GAAyBA,cAAzB;AACAh+B,YAAQw+B,WAAR,GAAsBA,WAAtB;AACAx+B,YAAQylC,UAAR,GAAqBA,UAArB;AACAzlC,YAAQiiC,WAAR,GAAsBA,WAAtB;AACAjiC,YAAQilC,eAAR,GAA0BA,eAA1B;AACAjlC,YAAQkmC,QAAR,GAAmBA,QAAnB;AACAlmC,YAAQ8H,EAAR,GAAaA,EAAb;AACA9H,YAAQgI,SAAR,GAAoBA,SAApB;AACAhI,YAAQwvC,oBAAR,GAA+BA,oBAA/B;AACAxvC,YAAQuwC,mBAAR,GAA8BA,mBAA9B;AACAvwC,YAAQ6wC,qBAAR,GAAgCA,qBAAhC;AACA7wC,YAAQgxC,wBAAR,GAAmCA,wBAAnC;AACAhxC,YAAQqxC,oBAAR,GAA+BA,oBAA/B;AACArxC,YAAQ4xC,qBAAR,GAAgCA,qBAAhC;AACA5xC,YAAQouC,SAAR,GAAoBA,SAApB;AACApuC,YAAQquC,UAAR,GAAqBA,UAArB;AACAruC,YAAQsuC,UAAR,GAAqBA,UAArB;AACAtuC,YAAQuuC,WAAR,GAAsBA,WAAtB;AACAvuC,YAAQwuC,gBAAR,GAA2BA,gBAA3B;AACAxuC,YAAQ0uC,SAAR,GAAoBA,SAApB;AACA1uC,YAAQ+yB,QAAR,GAAmB4b,UAAnB;AACA3uC,YAAQ+uC,QAAR,GAAmBA,QAAnB;AACA/uC,YAAQmvC,qBAAR,GAAgCA,qBAAhC;AACAnvC,YAAQoyC,cAAR,GAAyBA,cAAzB;AACApyC,YAAQqyC,kBAAR,GAA6BA,kBAA7B;AACAryC,YAAQsyC,uBAAR,GAAkCA,uBAAlC;AACAtyC,YAAQuyC,oBAAR,GAA+BA,oBAA/B;AACAvyC,YAAQwyC,kBAAR,GAA6BA,kBAA7B;AACAxyC,YAAQ05C,YAAR,GAAuBA,YAAvB;AACA15C,YAAQi3C,SAAR,GAAoBA,SAApB;AACAj3C,YAAQ6yC,uBAAR,GAAkCA,uBAAlC;AACA7yC,YAAQizC,eAAR,GAA0BA,eAA1B;AACAjzC,YAAQ+yC,aAAR,GAAwBA,aAAxB;AACA/yC,YAAQ62C,aAAR,GAAwBA,aAAxB;AACA72C,YAAQm4C,iBAAR,GAA4BA,iBAA5B;;AAEA5xC,WAAOwlC,cAAP,CAAsB/rC,OAAtB,EAA+B,YAA/B,EAA6C,EAAEyN,OAAO,IAAT,EAA7C;AAEC,CAxxTA,CAAD;AAyxTA","file":"http_cdnjs.cloudflare.com_ajax_libs_angular-ui-router_1.0.3_angular-ui-router.js","sourcesContent":["/**\n * State-based routing for AngularJS 1.x\n * NOTICE: This monolithic bundle also bundles the @uirouter/core code.\n *         This causes it to be incompatible with plugins that depend on @uirouter/core.\n *         We recommend switching to the ui-router-core.js and ui-router-angularjs.js bundles instead.\n *         For more information, see http://ui-router.github.io/blog/angular-ui-router-umd-bundles\n * @version v1.0.3\n * @link https://ui-router.github.io\n * @license MIT License, http://www.opensource.org/licenses/MIT\n */\n(function (global, factory) {\n    typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, require('angular')) :\n    typeof define === 'function' && define.amd ? define(['exports', 'angular'], factory) :\n    (factory((global['@uirouter/angularjs'] = global['@uirouter/angularjs'] || {}),global.angular));\n}(this, (function (exports,ng_from_import) { 'use strict';\n\n/**\n * Higher order functions\n *\n * These utility functions are exported, but are subject to change without notice.\n *\n * @module common_hof\n */ /** */\n/**\n * Returns a new function for [Partial Application](https://en.wikipedia.org/wiki/Partial_application) of the original function.\n *\n * Given a function with N parameters, returns a new function that supports partial application.\n * The new function accepts anywhere from 1 to N parameters.  When that function is called with M parameters,\n * where M is less than N, it returns a new function that accepts the remaining parameters.  It continues to\n * accept more parameters until all N parameters have been supplied.\n *\n *\n * This contrived example uses a partially applied function as an predicate, which returns true\n * if an object is found in both arrays.\n * @example\n * ```\n * // returns true if an object is in both of the two arrays\n * function inBoth(array1, array2, object) {\n *   return array1.indexOf(object) !== -1 &&\n *          array2.indexOf(object) !== 1;\n * }\n * let obj1, obj2, obj3, obj4, obj5, obj6, obj7\n * let foos = [obj1, obj3]\n * let bars = [obj3, obj4, obj5]\n *\n * // A curried \"copy\" of inBoth\n * let curriedInBoth = curry(inBoth);\n * // Partially apply both the array1 and array2\n * let inFoosAndBars = curriedInBoth(foos, bars);\n *\n * // Supply the final argument; since all arguments are\n * // supplied, the original inBoth function is then called.\n * let obj1InBoth = inFoosAndBars(obj1); // false\n *\n * // Use the inFoosAndBars as a predicate.\n * // Filter, on each iteration, supplies the final argument\n * let allObjs = [ obj1, obj2, obj3, obj4, obj5, obj6, obj7 ];\n * let foundInBoth = allObjs.filter(inFoosAndBars); // [ obj3 ]\n *\n * ```\n *\n * Stolen from: http://stackoverflow.com/questions/4394747/javascript-curry-function\n *\n * @param fn\n * @returns {*|function(): (*|any)}\n */\nfunction curry(fn) {\n    var initial_args = [].slice.apply(arguments, [1]);\n    var func_args_length = fn.length;\n    function curried(args) {\n        if (args.length >= func_args_length)\n            return fn.apply(null, args);\n        return function () {\n            return curried(args.concat([].slice.apply(arguments)));\n        };\n    }\n    return curried(initial_args);\n}\n/**\n * Given a varargs list of functions, returns a function that composes the argument functions, right-to-left\n * given: f(x), g(x), h(x)\n * let composed = compose(f,g,h)\n * then, composed is: f(g(h(x)))\n */\nfunction compose() {\n    var args = arguments;\n    var start = args.length - 1;\n    return function () {\n        var i = start, result = args[start].apply(this, arguments);\n        while (i--)\n            result = args[i].call(this, result);\n        return result;\n    };\n}\n/**\n * Given a varargs list of functions, returns a function that is composes the argument functions, left-to-right\n * given: f(x), g(x), h(x)\n * let piped = pipe(f,g,h);\n * then, piped is: h(g(f(x)))\n */\nfunction pipe() {\n    var funcs = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        funcs[_i] = arguments[_i];\n    }\n    return compose.apply(null, [].slice.call(arguments).reverse());\n}\n/**\n * Given a property name, returns a function that returns that property from an object\n * let obj = { foo: 1, name: \"blarg\" };\n * let getName = prop(\"name\");\n * getName(obj) === \"blarg\"\n */\nvar prop = function (name) {\n    return function (obj) { return obj && obj[name]; };\n};\n/**\n * Given a property name and a value, returns a function that returns a boolean based on whether\n * the passed object has a property that matches the value\n * let obj = { foo: 1, name: \"blarg\" };\n * let getName = propEq(\"name\", \"blarg\");\n * getName(obj) === true\n */\nvar propEq = curry(function (name, val, obj) { return obj && obj[name] === val; });\n/**\n * Given a dotted property name, returns a function that returns a nested property from an object, or undefined\n * let obj = { id: 1, nestedObj: { foo: 1, name: \"blarg\" }, };\n * let getName = prop(\"nestedObj.name\");\n * getName(obj) === \"blarg\"\n * let propNotFound = prop(\"this.property.doesnt.exist\");\n * propNotFound(obj) === undefined\n */\nvar parse = function (name) {\n    return pipe.apply(null, name.split(\".\").map(prop));\n};\n/**\n * Given a function that returns a truthy or falsey value, returns a\n * function that returns the opposite (falsey or truthy) value given the same inputs\n */\nvar not = function (fn) {\n    return function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        return !fn.apply(null, args);\n    };\n};\n/**\n * Given two functions that return truthy or falsey values, returns a function that returns truthy\n * if both functions return truthy for the given arguments\n */\nfunction and(fn1, fn2) {\n    return function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        return fn1.apply(null, args) && fn2.apply(null, args);\n    };\n}\n/**\n * Given two functions that return truthy or falsey values, returns a function that returns truthy\n * if at least one of the functions returns truthy for the given arguments\n */\nfunction or(fn1, fn2) {\n    return function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        return fn1.apply(null, args) || fn2.apply(null, args);\n    };\n}\n/**\n * Check if all the elements of an array match a predicate function\n *\n * @param fn1 a predicate function `fn1`\n * @returns a function which takes an array and returns true if `fn1` is true for all elements of the array\n */\nvar all = function (fn1) {\n    return function (arr) { return arr.reduce(function (b, x) { return b && !!fn1(x); }, true); };\n};\nvar any = function (fn1) {\n    return function (arr) { return arr.reduce(function (b, x) { return b || !!fn1(x); }, false); };\n};\n/** Given a class, returns a Predicate function that returns true if the object is of that class */\nvar is = function (ctor) {\n    return function (obj) {\n        return (obj != null && obj.constructor === ctor || obj instanceof ctor);\n    };\n};\n/** Given a value, returns a Predicate function that returns true if another value is === equal to the original value */\nvar eq = function (val) { return function (other) {\n    return val === other;\n}; };\n/** Given a value, returns a function which returns the value */\nvar val = function (v) { return function () { return v; }; };\nfunction invoke(fnName, args) {\n    return function (obj) {\n        return obj[fnName].apply(obj, args);\n    };\n}\n/**\n * Sorta like Pattern Matching (a functional programming conditional construct)\n *\n * See http://c2.com/cgi/wiki?PatternMatching\n *\n * This is a conditional construct which allows a series of predicates and output functions\n * to be checked and then applied.  Each predicate receives the input.  If the predicate\n * returns truthy, then its matching output function (mapping function) is provided with\n * the input and, then the result is returned.\n *\n * Each combination (2-tuple) of predicate + output function should be placed in an array\n * of size 2: [ predicate, mapFn ]\n *\n * These 2-tuples should be put in an outer array.\n *\n * @example\n * ```\n *\n * // Here's a 2-tuple where the first element is the isString predicate\n * // and the second element is a function that returns a description of the input\n * let firstTuple = [ angular.isString, (input) => `Heres your string ${input}` ];\n *\n * // Second tuple: predicate \"isNumber\", mapfn returns a description\n * let secondTuple = [ angular.isNumber, (input) => `(${input}) That's a number!` ];\n *\n * let third = [ (input) => input === null,  (input) => `Oh, null...` ];\n *\n * let fourth = [ (input) => input === undefined,  (input) => `notdefined` ];\n *\n * let descriptionOf = pattern([ firstTuple, secondTuple, third, fourth ]);\n *\n * console.log(descriptionOf(undefined)); // 'notdefined'\n * console.log(descriptionOf(55)); // '(55) That's a number!'\n * console.log(descriptionOf(\"foo\")); // 'Here's your string foo'\n * ```\n *\n * @param struct A 2D array.  Each element of the array should be an array, a 2-tuple,\n * with a Predicate and a mapping/output function\n * @returns {function(any): *}\n */\nfunction pattern(struct) {\n    return function (x) {\n        for (var i = 0; i < struct.length; i++) {\n            if (struct[i][0](x))\n                return struct[i][1](x);\n        }\n    };\n}\n\n/**\n * @coreapi\n * @module core\n */\n/**\n * Matches state names using glob-like pattern strings.\n *\n * Globs can be used in specific APIs including:\n *\n * - [[StateService.is]]\n * - [[StateService.includes]]\n * - The first argument to Hook Registration functions like [[TransitionService.onStart]]\n *    - [[HookMatchCriteria]] and [[HookMatchCriterion]]\n *\n * A `Glob` string is a pattern which matches state names.\n * Nested state names are split into segments (separated by a dot) when processing.\n * The state named `foo.bar.baz` is split into three segments ['foo', 'bar', 'baz']\n *\n * Globs work according to the following rules:\n *\n * ### Exact match:\n *\n * The glob `'A.B'` matches the state named exactly `'A.B'`.\n *\n * | Glob        |Matches states named|Does not match state named|\n * |:------------|:--------------------|:---------------------|\n * | `'A'`       | `'A'`               | `'B'` , `'A.C'`      |\n * | `'A.B'`     | `'A.B'`             | `'A'` , `'A.B.C'`    |\n * | `'foo'`     | `'foo'`             | `'FOO'` , `'foo.bar'`|\n *\n * ### Single star (`*`)\n *\n * A single star (`*`) is a wildcard that matches exactly one segment.\n *\n * | Glob        |Matches states named  |Does not match state named |\n * |:------------|:---------------------|:--------------------------|\n * | `'*'`       | `'A'` , `'Z'`        | `'A.B'` , `'Z.Y.X'`       |\n * | `'A.*'`     | `'A.B'` , `'A.C'`    | `'A'` , `'A.B.C'`         |\n * | `'A.*.*'`   | `'A.B.C'` , `'A.X.Y'`| `'A'`, `'A.B'` , `'Z.Y.X'`|\n *\n * ### Double star (`**`)\n *\n * A double star (`'**'`) is a wildcard that matches *zero or more segments*\n *\n * | Glob        |Matches states named                           |Does not match state named         |\n * |:------------|:----------------------------------------------|:----------------------------------|\n * | `'**'`      | `'A'` , `'A.B'`, `'Z.Y.X'`                    | (matches all states)              |\n * | `'A.**'`    | `'A'` , `'A.B'` , `'A.C.X'`                   | `'Z.Y.X'`                         |\n * | `'**.X'`    | `'X'` , `'A.X'` , `'Z.Y.X'`                   | `'A'` , `'A.login.Z'`             |\n * | `'A.**.X'`  | `'A.X'` , `'A.B.X'` , `'A.B.C.X'`             | `'A'` , `'A.B.C'`                 |\n *\n */\nvar Glob = (function () {\n    function Glob(text) {\n        this.text = text;\n        this.glob = text.split('.');\n        var regexpString = this.text.split('.')\n            .map(function (seg) {\n            if (seg === '**')\n                return '(?:|(?:\\\\.[^.]*)*)';\n            if (seg === '*')\n                return '\\\\.[^.]*';\n            return '\\\\.' + seg;\n        }).join('');\n        this.regexp = new RegExp(\"^\" + regexpString + \"$\");\n    }\n    Glob.prototype.matches = function (name) {\n        return this.regexp.test('.' + name);\n    };\n    /** Returns true if the string has glob-like characters in it */\n    Glob.is = function (text) {\n        return !!/[!,*]+/.exec(text);\n    };\n    /** Returns a glob from the string, or null if the string isn't Glob-like */\n    Glob.fromString = function (text) {\n        return Glob.is(text) ? new Glob(text) : null;\n    };\n    return Glob;\n}());\n\n/**\n * Internal representation of a UI-Router state.\n *\n * Instances of this class are created when a [[StateDeclaration]] is registered with the [[StateRegistry]].\n *\n * A registered [[StateDeclaration]] is augmented with a getter ([[StateDeclaration.$$state]]) which returns the corresponding [[StateObject]] object.\n *\n * This class prototypally inherits from the corresponding [[StateDeclaration]].\n * Each of its own properties (i.e., `hasOwnProperty`) are built using builders from the [[StateBuilder]].\n */\nvar StateObject = (function () {\n    /** @deprecated use State.create() */\n    function StateObject(config) {\n        return StateObject.create(config || {});\n    }\n    /**\n     * Create a state object to put the private/internal implementation details onto.\n     * The object's prototype chain looks like:\n     * (Internal State Object) -> (Copy of State.prototype) -> (State Declaration object) -> (State Declaration's prototype...)\n     *\n     * @param stateDecl the user-supplied State Declaration\n     * @returns {StateObject} an internal State object\n     */\n    StateObject.create = function (stateDecl) {\n        stateDecl = StateObject.isStateClass(stateDecl) ? new stateDecl() : stateDecl;\n        var state = inherit(inherit(stateDecl, StateObject.prototype));\n        stateDecl.$$state = function () { return state; };\n        state.self = stateDecl;\n        state.__stateObjectCache = {\n            nameGlob: Glob.fromString(state.name) // might return null\n        };\n        return state;\n    };\n    /**\n     * Returns true if the provided parameter is the same state.\n     *\n     * Compares the identity of the state against the passed value, which is either an object\n     * reference to the actual `State` instance, the original definition object passed to\n     * `$stateProvider.state()`, or the fully-qualified name.\n     *\n     * @param ref Can be one of (a) a `State` instance, (b) an object that was passed\n     *        into `$stateProvider.state()`, (c) the fully-qualified name of a state as a string.\n     * @returns Returns `true` if `ref` matches the current `State` instance.\n     */\n    StateObject.prototype.is = function (ref) {\n        return this === ref || this.self === ref || this.fqn() === ref;\n    };\n    /**\n     * @deprecated this does not properly handle dot notation\n     * @returns Returns a dot-separated name of the state.\n     */\n    StateObject.prototype.fqn = function () {\n        if (!this.parent || !(this.parent instanceof this.constructor))\n            return this.name;\n        var name = this.parent.fqn();\n        return name ? name + \".\" + this.name : this.name;\n    };\n    /**\n     * Returns the root node of this state's tree.\n     *\n     * @returns The root of this state's tree.\n     */\n    StateObject.prototype.root = function () {\n        return this.parent && this.parent.root() || this;\n    };\n    /**\n     * Gets the state's `Param` objects\n     *\n     * Gets the list of [[Param]] objects owned by the state.\n     * If `opts.inherit` is true, it also includes the ancestor states' [[Param]] objects.\n     * If `opts.matchingKeys` exists, returns only `Param`s whose `id` is a key on the `matchingKeys` object\n     *\n     * @param opts options\n     */\n    StateObject.prototype.parameters = function (opts) {\n        opts = defaults(opts, { inherit: true, matchingKeys: null });\n        var inherited = opts.inherit && this.parent && this.parent.parameters() || [];\n        return inherited.concat(values(this.params))\n            .filter(function (param) { return !opts.matchingKeys || opts.matchingKeys.hasOwnProperty(param.id); });\n    };\n    /**\n     * Returns a single [[Param]] that is owned by the state\n     *\n     * If `opts.inherit` is true, it also searches the ancestor states` [[Param]]s.\n     * @param id the name of the [[Param]] to return\n     * @param opts options\n     */\n    StateObject.prototype.parameter = function (id, opts) {\n        if (opts === void 0) { opts = {}; }\n        return (this.url && this.url.parameter(id, opts) ||\n            find(values(this.params), propEq('id', id)) ||\n            opts.inherit && this.parent && this.parent.parameter(id));\n    };\n    StateObject.prototype.toString = function () {\n        return this.fqn();\n    };\n    return StateObject;\n}());\n/** Predicate which returns true if the object is an class with @State() decorator */\nStateObject.isStateClass = function (stateDecl) {\n    return isFunction(stateDecl) && stateDecl['__uiRouterState'] === true;\n};\n/** Predicate which returns true if the object is an internal [[StateObject]] object */\nStateObject.isState = function (obj) {\n    return isObject(obj['__stateObjectCache']);\n};\n\n/** Predicates\n *\n * These predicates return true/false based on the input.\n * Although these functions are exported, they are subject to change without notice.\n *\n * @module common_predicates\n */\n/** */\nvar toStr = Object.prototype.toString;\nvar tis = function (t) { return function (x) { return typeof (x) === t; }; };\nvar isUndefined = tis('undefined');\nvar isDefined = not(isUndefined);\nvar isNull = function (o) { return o === null; };\nvar isNullOrUndefined = or(isNull, isUndefined);\nvar isFunction = tis('function');\nvar isNumber = tis('number');\nvar isString = tis('string');\nvar isObject = function (x) { return x !== null && typeof x === 'object'; };\nvar isArray = Array.isArray;\nvar isDate = (function (x) { return toStr.call(x) === '[object Date]'; });\nvar isRegExp = (function (x) { return toStr.call(x) === '[object RegExp]'; });\nvar isState = StateObject.isState;\n/**\n * Predicate which checks if a value is injectable\n *\n * A value is \"injectable\" if it is a function, or if it is an ng1 array-notation-style array\n * where all the elements in the array are Strings, except the last one, which is a Function\n */\nfunction isInjectable(val$$1) {\n    if (isArray(val$$1) && val$$1.length) {\n        var head = val$$1.slice(0, -1), tail = val$$1.slice(-1);\n        return !(head.filter(not(isString)).length || tail.filter(not(isFunction)).length);\n    }\n    return isFunction(val$$1);\n}\n/**\n * Predicate which checks if a value looks like a Promise\n *\n * It is probably a Promise if it's an object, and it has a `then` property which is a Function\n */\nvar isPromise = and(isObject, pipe(prop('then'), isFunction));\n\nvar notImplemented = function (fnname) { return function () {\n    throw new Error(fnname + \"(): No coreservices implementation for UI-Router is loaded.\");\n}; };\nvar services = {\n    $q: undefined,\n    $injector: undefined,\n};\n\n/**\n * Random utility functions used in the UI-Router code\n *\n * These functions are exported, but are subject to change without notice.\n *\n * @preferred\n * @module common\n */\n/** for typedoc */\nvar w = typeof window === 'undefined' ? {} : window;\nvar angular$1 = w.angular || {};\nvar fromJson = angular$1.fromJson || JSON.parse.bind(JSON);\nvar toJson = angular$1.toJson || JSON.stringify.bind(JSON);\nvar copy = angular$1.copy || _copy;\nvar forEach = angular$1.forEach || _forEach;\nvar extend = Object.assign || _extend;\nvar equals = angular$1.equals || _equals;\nfunction identity(x) { return x; }\nfunction noop$1() { }\n/**\n * Builds proxy functions on the `to` object which pass through to the `from` object.\n *\n * For each key in `fnNames`, creates a proxy function on the `to` object.\n * The proxy function calls the real function on the `from` object.\n *\n *\n * #### Example:\n * This example creates an new class instance whose functions are prebound to the new'd object.\n * ```js\n * class Foo {\n *   constructor(data) {\n *     // Binds all functions from Foo.prototype to 'this',\n *     // then copies them to 'this'\n *     bindFunctions(Foo.prototype, this, this);\n *     this.data = data;\n *   }\n *\n *   log() {\n *     console.log(this.data);\n *   }\n * }\n *\n * let myFoo = new Foo([1,2,3]);\n * var logit = myFoo.log;\n * logit(); // logs [1, 2, 3] from the myFoo 'this' instance\n * ```\n *\n * #### Example:\n * This example creates a bound version of a service function, and copies it to another object\n * ```\n *\n * var SomeService = {\n *   this.data = [3, 4, 5];\n *   this.log = function() {\n *     console.log(this.data);\n *   }\n * }\n *\n * // Constructor fn\n * function OtherThing() {\n *   // Binds all functions from SomeService to SomeService,\n *   // then copies them to 'this'\n *   bindFunctions(SomeService, this, SomeService);\n * }\n *\n * let myOtherThing = new OtherThing();\n * myOtherThing.log(); // logs [3, 4, 5] from SomeService's 'this'\n * ```\n *\n * @param source A function that returns the source object which contains the original functions to be bound\n * @param target A function that returns the target object which will receive the bound functions\n * @param bind A function that returns the object which the functions will be bound to\n * @param fnNames The function names which will be bound (Defaults to all the functions found on the 'from' object)\n * @param latebind If true, the binding of the function is delayed until the first time it's invoked\n */\nfunction createProxyFunctions(source, target, bind, fnNames, latebind) {\n    if (latebind === void 0) { latebind = false; }\n    var bindFunction = function (fnName) {\n        return source()[fnName].bind(bind());\n    };\n    var makeLateRebindFn = function (fnName) { return function lateRebindFunction() {\n        target[fnName] = bindFunction(fnName);\n        return target[fnName].apply(null, arguments);\n    }; };\n    fnNames = fnNames || Object.keys(source());\n    return fnNames.reduce(function (acc, name) {\n        acc[name] = latebind ? makeLateRebindFn(name) : bindFunction(name);\n        return acc;\n    }, target);\n}\n/**\n * prototypal inheritance helper.\n * Creates a new object which has `parent` object as its prototype, and then copies the properties from `extra` onto it\n */\nvar inherit = function (parent, extra) {\n    return extend(Object.create(parent), extra);\n};\n/** Given an array, returns true if the object is found in the array, (using indexOf) */\nvar inArray = curry(_inArray);\nfunction _inArray(array, obj) {\n    return array.indexOf(obj) !== -1;\n}\n/**\n * Given an array, and an item, if the item is found in the array, it removes it (in-place).\n * The same array is returned\n */\nvar removeFrom = curry(_removeFrom);\nfunction _removeFrom(array, obj) {\n    var idx = array.indexOf(obj);\n    if (idx >= 0)\n        array.splice(idx, 1);\n    return array;\n}\n/** pushes a values to an array and returns the value */\nvar pushTo = curry(_pushTo);\nfunction _pushTo(arr, val$$1) {\n    return (arr.push(val$$1), val$$1);\n}\n/** Given an array of (deregistration) functions, calls all functions and removes each one from the source array */\nvar deregAll = function (functions) {\n    return functions.slice().forEach(function (fn) {\n        typeof fn === 'function' && fn();\n        removeFrom(functions, fn);\n    });\n};\n/**\n * Applies a set of defaults to an options object.  The options object is filtered\n * to only those properties of the objects in the defaultsList.\n * Earlier objects in the defaultsList take precedence when applying defaults.\n */\nfunction defaults(opts) {\n    var defaultsList = [];\n    for (var _i = 1; _i < arguments.length; _i++) {\n        defaultsList[_i - 1] = arguments[_i];\n    }\n    var _defaultsList = defaultsList.concat({}).reverse();\n    var defaultVals = extend.apply(null, _defaultsList);\n    return extend({}, defaultVals, pick(opts || {}, Object.keys(defaultVals)));\n}\n/** Reduce function that merges each element of the list into a single object, using extend */\nvar mergeR = function (memo, item) { return extend(memo, item); };\n/**\n * Finds the common ancestor path between two states.\n *\n * @param {Object} first The first state.\n * @param {Object} second The second state.\n * @return {Array} Returns an array of state names in descending order, not including the root.\n */\nfunction ancestors(first, second) {\n    var path = [];\n    for (var n in first.path) {\n        if (first.path[n] !== second.path[n])\n            break;\n        path.push(first.path[n]);\n    }\n    return path;\n}\n/**\n * Return a copy of the object only containing the whitelisted properties.\n *\n * #### Example:\n * ```\n * var foo = { a: 1, b: 2, c: 3 };\n * var ab = pick(foo, ['a', 'b']); // { a: 1, b: 2 }\n * ```\n * @param obj the source object\n * @param propNames an Array of strings, which are the whitelisted property names\n */\nfunction pick(obj, propNames) {\n    var objCopy = {};\n    for (var prop_1 in obj) {\n        if (propNames.indexOf(prop_1) !== -1) {\n            objCopy[prop_1] = obj[prop_1];\n        }\n    }\n    return objCopy;\n}\n/**\n * Return a copy of the object omitting the blacklisted properties.\n *\n * @example\n * ```\n *\n * var foo = { a: 1, b: 2, c: 3 };\n * var ab = omit(foo, ['a', 'b']); // { c: 3 }\n * ```\n * @param obj the source object\n * @param propNames an Array of strings, which are the blacklisted property names\n */\nfunction omit(obj, propNames) {\n    return Object.keys(obj)\n        .filter(not(inArray(propNames)))\n        .reduce(function (acc, key) { return (acc[key] = obj[key], acc); }, {});\n}\n/**\n * Maps an array, or object to a property (by name)\n */\nfunction pluck(collection, propName) {\n    return map(collection, prop(propName));\n}\n/** Filters an Array or an Object's properties based on a predicate */\nfunction filter(collection, callback) {\n    var arr = isArray(collection), result = arr ? [] : {};\n    var accept = arr ? function (x) { return result.push(x); } : function (x, key) { return result[key] = x; };\n    forEach(collection, function (item, i) {\n        if (callback(item, i))\n            accept(item, i);\n    });\n    return result;\n}\n/** Finds an object from an array, or a property of an object, that matches a predicate */\nfunction find(collection, callback) {\n    var result;\n    forEach(collection, function (item, i) {\n        if (result)\n            return;\n        if (callback(item, i))\n            result = item;\n    });\n    return result;\n}\n/** Given an object, returns a new object, where each property is transformed by the callback function */\nvar mapObj = map;\n/** Maps an array or object properties using a callback function */\nfunction map(collection, callback) {\n    var result = isArray(collection) ? [] : {};\n    forEach(collection, function (item, i) { return result[i] = callback(item, i); });\n    return result;\n}\n/**\n * Given an object, return its enumerable property values\n *\n * @example\n * ```\n *\n * let foo = { a: 1, b: 2, c: 3 }\n * let vals = values(foo); // [ 1, 2, 3 ]\n * ```\n */\nvar values = function (obj) {\n    return Object.keys(obj).map(function (key) { return obj[key]; });\n};\n/**\n * Reduce function that returns true if all of the values are truthy.\n *\n * @example\n * ```\n *\n * let vals = [ 1, true, {}, \"hello world\"];\n * vals.reduce(allTrueR, true); // true\n *\n * vals.push(0);\n * vals.reduce(allTrueR, true); // false\n * ```\n */\nvar allTrueR = function (memo, elem) { return memo && elem; };\n/**\n * Reduce function that returns true if any of the values are truthy.\n *\n *  * @example\n * ```\n *\n * let vals = [ 0, null, undefined ];\n * vals.reduce(anyTrueR, true); // false\n *\n * vals.push(\"hello world\");\n * vals.reduce(anyTrueR, true); // true\n * ```\n */\nvar anyTrueR = function (memo, elem) { return memo || elem; };\n/**\n * Reduce function which un-nests a single level of arrays\n * @example\n * ```\n *\n * let input = [ [ \"a\", \"b\" ], [ \"c\", \"d\" ], [ [ \"double\", \"nested\" ] ] ];\n * input.reduce(unnestR, []) // [ \"a\", \"b\", \"c\", \"d\", [ \"double, \"nested\" ] ]\n * ```\n */\nvar unnestR = function (memo, elem) { return memo.concat(elem); };\n/**\n * Reduce function which recursively un-nests all arrays\n *\n * @example\n * ```\n *\n * let input = [ [ \"a\", \"b\" ], [ \"c\", \"d\" ], [ [ \"double\", \"nested\" ] ] ];\n * input.reduce(unnestR, []) // [ \"a\", \"b\", \"c\", \"d\", \"double, \"nested\" ]\n * ```\n */\nvar flattenR = function (memo, elem) {\n    return isArray(elem) ? memo.concat(elem.reduce(flattenR, [])) : pushR(memo, elem);\n};\n/**\n * Reduce function that pushes an object to an array, then returns the array.\n * Mostly just for [[flattenR]] and [[uniqR]]\n */\nfunction pushR(arr, obj) {\n    arr.push(obj);\n    return arr;\n}\n/** Reduce function that filters out duplicates */\nvar uniqR = function (acc, token) {\n    return inArray(acc, token) ? acc : pushR(acc, token);\n};\n/**\n * Return a new array with a single level of arrays unnested.\n *\n * @example\n * ```\n *\n * let input = [ [ \"a\", \"b\" ], [ \"c\", \"d\" ], [ [ \"double\", \"nested\" ] ] ];\n * unnest(input) // [ \"a\", \"b\", \"c\", \"d\", [ \"double, \"nested\" ] ]\n * ```\n */\nvar unnest = function (arr) { return arr.reduce(unnestR, []); };\n/**\n * Return a completely flattened version of an array.\n *\n * @example\n * ```\n *\n * let input = [ [ \"a\", \"b\" ], [ \"c\", \"d\" ], [ [ \"double\", \"nested\" ] ] ];\n * flatten(input) // [ \"a\", \"b\", \"c\", \"d\", \"double, \"nested\" ]\n * ```\n */\nvar flatten = function (arr) { return arr.reduce(flattenR, []); };\n/**\n * Given a .filter Predicate, builds a .filter Predicate which throws an error if any elements do not pass.\n * @example\n * ```\n *\n * let isNumber = (obj) => typeof(obj) === 'number';\n * let allNumbers = [ 1, 2, 3, 4, 5 ];\n * allNumbers.filter(assertPredicate(isNumber)); //OK\n *\n * let oneString = [ 1, 2, 3, 4, \"5\" ];\n * oneString.filter(assertPredicate(isNumber, \"Not all numbers\")); // throws Error(\"\"Not all numbers\"\");\n * ```\n */\nvar assertPredicate = assertFn;\n/**\n * Given a .map function, builds a .map function which throws an error if any mapped elements do not pass a truthyness test.\n * @example\n * ```\n *\n * var data = { foo: 1, bar: 2 };\n *\n * let keys = [ 'foo', 'bar' ]\n * let values = keys.map(assertMap(key => data[key], \"Key not found\"));\n * // values is [1, 2]\n *\n * let keys = [ 'foo', 'bar', 'baz' ]\n * let values = keys.map(assertMap(key => data[key], \"Key not found\"));\n * // throws Error(\"Key not found\")\n * ```\n */\nvar assertMap = assertFn;\nfunction assertFn(predicateOrMap, errMsg) {\n    if (errMsg === void 0) { errMsg = \"assert failure\"; }\n    return function (obj) {\n        var result = predicateOrMap(obj);\n        if (!result) {\n            throw new Error(isFunction(errMsg) ? errMsg(obj) : errMsg);\n        }\n        return result;\n    };\n}\n/**\n * Like _.pairs: Given an object, returns an array of key/value pairs\n *\n * @example\n * ```\n *\n * pairs({ foo: \"FOO\", bar: \"BAR }) // [ [ \"foo\", \"FOO\" ], [ \"bar\": \"BAR\" ] ]\n * ```\n */\nvar pairs = function (obj) {\n    return Object.keys(obj).map(function (key) { return [key, obj[key]]; });\n};\n/**\n * Given two or more parallel arrays, returns an array of tuples where\n * each tuple is composed of [ a[i], b[i], ... z[i] ]\n *\n * @example\n * ```\n *\n * let foo = [ 0, 2, 4, 6 ];\n * let bar = [ 1, 3, 5, 7 ];\n * let baz = [ 10, 30, 50, 70 ];\n * arrayTuples(foo, bar);       // [ [0, 1], [2, 3], [4, 5], [6, 7] ]\n * arrayTuples(foo, bar, baz);  // [ [0, 1, 10], [2, 3, 30], [4, 5, 50], [6, 7, 70] ]\n * ```\n */\nfunction arrayTuples() {\n    var args = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n    }\n    if (args.length === 0)\n        return [];\n    var maxArrayLen = args.reduce(function (min, arr) { return Math.min(arr.length, min); }, 9007199254740991); // aka 2^53  1 aka Number.MAX_SAFE_INTEGER\n    var i, result = [];\n    for (i = 0; i < maxArrayLen; i++) {\n        // This is a hot function\n        // Unroll when there are 1-4 arguments\n        switch (args.length) {\n            case 1:\n                result.push([args[0][i]]);\n                break;\n            case 2:\n                result.push([args[0][i], args[1][i]]);\n                break;\n            case 3:\n                result.push([args[0][i], args[1][i], args[2][i]]);\n                break;\n            case 4:\n                result.push([args[0][i], args[1][i], args[2][i], args[3][i]]);\n                break;\n            default:\n                result.push(args.map(function (array) { return array[i]; }));\n                break;\n        }\n    }\n    return result;\n}\n/**\n * Reduce function which builds an object from an array of [key, value] pairs.\n *\n * Each iteration sets the key/val pair on the memo object, then returns the memo for the next iteration.\n *\n * Each keyValueTuple should be an array with values [ key: string, value: any ]\n *\n * @example\n * ```\n *\n * var pairs = [ [\"fookey\", \"fooval\"], [\"barkey\", \"barval\"] ]\n *\n * var pairsToObj = pairs.reduce((memo, pair) => applyPairs(memo, pair), {})\n * // pairsToObj == { fookey: \"fooval\", barkey: \"barval\" }\n *\n * // Or, more simply:\n * var pairsToObj = pairs.reduce(applyPairs, {})\n * // pairsToObj == { fookey: \"fooval\", barkey: \"barval\" }\n * ```\n */\nfunction applyPairs(memo, keyValTuple) {\n    var key, value;\n    if (isArray(keyValTuple))\n        key = keyValTuple[0], value = keyValTuple[1];\n    if (!isString(key))\n        throw new Error(\"invalid parameters to applyPairs\");\n    memo[key] = value;\n    return memo;\n}\n/** Get the last element of an array */\nfunction tail(arr) {\n    return arr.length && arr[arr.length - 1] || undefined;\n}\n/**\n * shallow copy from src to dest\n *\n * note: This is a shallow copy, while angular.copy is a deep copy.\n * ui-router uses `copy` only to make copies of state parameters.\n */\nfunction _copy(src, dest) {\n    if (dest)\n        Object.keys(dest).forEach(function (key) { return delete dest[key]; });\n    if (!dest)\n        dest = {};\n    return extend(dest, src);\n}\n/** Naive forEach implementation works with Objects or Arrays */\nfunction _forEach(obj, cb, _this) {\n    if (isArray(obj))\n        return obj.forEach(cb, _this);\n    Object.keys(obj).forEach(function (key) { return cb(obj[key], key); });\n}\nfunction _extend(toObj) {\n    for (var i = 1; i < arguments.length; i++) {\n        var obj = arguments[i];\n        if (!obj)\n            continue;\n        var keys = Object.keys(obj);\n        for (var j = 0; j < keys.length; j++) {\n            toObj[keys[j]] = obj[keys[j]];\n        }\n    }\n    return toObj;\n}\nfunction _equals(o1, o2) {\n    if (o1 === o2)\n        return true;\n    if (o1 === null || o2 === null)\n        return false;\n    if (o1 !== o1 && o2 !== o2)\n        return true; // NaN === NaN\n    var t1 = typeof o1, t2 = typeof o2;\n    if (t1 !== t2 || t1 !== 'object')\n        return false;\n    var tup = [o1, o2];\n    if (all(isArray)(tup))\n        return _arraysEq(o1, o2);\n    if (all(isDate)(tup))\n        return o1.getTime() === o2.getTime();\n    if (all(isRegExp)(tup))\n        return o1.toString() === o2.toString();\n    if (all(isFunction)(tup))\n        return true; // meh\n    var predicates = [isFunction, isArray, isDate, isRegExp];\n    if (predicates.map(any).reduce(function (b, fn) { return b || !!fn(tup); }, false))\n        return false;\n    var key, keys = {};\n    for (key in o1) {\n        if (!_equals(o1[key], o2[key]))\n            return false;\n        keys[key] = true;\n    }\n    for (key in o2) {\n        if (!keys[key])\n            return false;\n    }\n    return true;\n}\nfunction _arraysEq(a1, a2) {\n    if (a1.length !== a2.length)\n        return false;\n    return arrayTuples(a1, a2).reduce(function (b, t) { return b && _equals(t[0], t[1]); }, true);\n}\n/**\n * Create a sort function\n *\n * Creates a sort function which sorts by a numeric property.\n *\n * The `propFn` should return the property as a number which can be sorted.\n *\n * #### Example:\n * This example returns the `priority` prop.\n * ```js\n * var sortfn = sortBy(obj => obj.priority)\n * // equivalent to:\n * var longhandSortFn = (a, b) => a.priority - b.priority;\n * ```\n *\n * #### Example:\n * This example uses [[prop]]\n * ```js\n * var sortfn = sortBy(prop('priority'))\n * ```\n *\n * The `checkFn` can be used to exclude objects from sorting.\n *\n * #### Example:\n * This example only sorts objects with type === 'FOO'\n * ```js\n * var sortfn = sortBy(prop('priority'), propEq('type', 'FOO'))\n * ```\n *\n * @param propFn a function that returns the property (as a number)\n * @param checkFn a predicate\n *\n * @return a sort function like: `(a, b) => (checkFn(a) && checkFn(b)) ? propFn(a) - propFn(b) : 0`\n */\nvar sortBy = function (propFn, checkFn) {\n    if (checkFn === void 0) { checkFn = val(true); }\n    return function (a, b) {\n        return (checkFn(a) && checkFn(b)) ? propFn(a) - propFn(b) : 0;\n    };\n};\n/**\n * Composes a list of sort functions\n *\n * Creates a sort function composed of multiple sort functions.\n * Each sort function is invoked in series.\n * The first sort function to return non-zero \"wins\".\n *\n * @param sortFns list of sort functions\n */\nvar composeSort = function () {\n    var sortFns = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        sortFns[_i] = arguments[_i];\n    }\n    return function composedSort(a, b) {\n        return sortFns.reduce(function (prev, fn) { return prev || fn(a, b); }, 0);\n    };\n};\n// issue #2676\nvar silenceUncaughtInPromise = function (promise) {\n    return promise.catch(function (e) { return 0; }) && promise;\n};\nvar silentRejection = function (error) {\n    return silenceUncaughtInPromise(services.$q.reject(error));\n};\n\n/**\n * @module common\n */ /** for typedoc */\nvar Queue = (function () {\n    function Queue(_items, _limit) {\n        if (_items === void 0) { _items = []; }\n        if (_limit === void 0) { _limit = null; }\n        this._items = _items;\n        this._limit = _limit;\n    }\n    Queue.prototype.enqueue = function (item) {\n        var items = this._items;\n        items.push(item);\n        if (this._limit && items.length > this._limit)\n            items.shift();\n        return item;\n    };\n    Queue.prototype.dequeue = function () {\n        if (this.size())\n            return this._items.splice(0, 1)[0];\n    };\n    Queue.prototype.clear = function () {\n        var current = this._items;\n        this._items = [];\n        return current;\n    };\n    Queue.prototype.size = function () {\n        return this._items.length;\n    };\n    Queue.prototype.remove = function (item) {\n        var idx = this._items.indexOf(item);\n        return idx > -1 && this._items.splice(idx, 1)[0];\n    };\n    Queue.prototype.peekTail = function () {\n        return this._items[this._items.length - 1];\n    };\n    Queue.prototype.peekHead = function () {\n        if (this.size())\n            return this._items[0];\n    };\n    return Queue;\n}());\n\n/**\n * @coreapi\n * @module transition\n */ /** for typedoc */\n\n(function (RejectType) {\n    RejectType[RejectType[\"SUPERSEDED\"] = 2] = \"SUPERSEDED\";\n    RejectType[RejectType[\"ABORTED\"] = 3] = \"ABORTED\";\n    RejectType[RejectType[\"INVALID\"] = 4] = \"INVALID\";\n    RejectType[RejectType[\"IGNORED\"] = 5] = \"IGNORED\";\n    RejectType[RejectType[\"ERROR\"] = 6] = \"ERROR\";\n})(exports.RejectType || (exports.RejectType = {}));\n/** @hidden */ var id = 0;\nvar Rejection = (function () {\n    function Rejection(type, message, detail) {\n        this.$id = id++;\n        this.type = type;\n        this.message = message;\n        this.detail = detail;\n    }\n    Rejection.prototype.toString = function () {\n        var detailString = function (d) {\n            return d && d.toString !== Object.prototype.toString ? d.toString() : stringify(d);\n        };\n        var detail = detailString(this.detail);\n        var _a = this, $id = _a.$id, type = _a.type, message = _a.message;\n        return \"Transition Rejection($id: \" + $id + \" type: \" + type + \", message: \" + message + \", detail: \" + detail + \")\";\n    };\n    Rejection.prototype.toPromise = function () {\n        return extend(silentRejection(this), { _transitionRejection: this });\n    };\n    /** Returns true if the obj is a rejected promise created from the `asPromise` factory */\n    Rejection.isRejectionPromise = function (obj) {\n        return obj && (typeof obj.then === 'function') && is(Rejection)(obj._transitionRejection);\n    };\n    /** Returns a Rejection due to transition superseded */\n    Rejection.superseded = function (detail, options) {\n        var message = \"The transition has been superseded by a different transition\";\n        var rejection = new Rejection(exports.RejectType.SUPERSEDED, message, detail);\n        if (options && options.redirected) {\n            rejection.redirected = true;\n        }\n        return rejection;\n    };\n    /** Returns a Rejection due to redirected transition */\n    Rejection.redirected = function (detail) {\n        return Rejection.superseded(detail, { redirected: true });\n    };\n    /** Returns a Rejection due to invalid transition */\n    Rejection.invalid = function (detail) {\n        var message = \"This transition is invalid\";\n        return new Rejection(exports.RejectType.INVALID, message, detail);\n    };\n    /** Returns a Rejection due to ignored transition */\n    Rejection.ignored = function (detail) {\n        var message = \"The transition was ignored\";\n        return new Rejection(exports.RejectType.IGNORED, message, detail);\n    };\n    /** Returns a Rejection due to aborted transition */\n    Rejection.aborted = function (detail) {\n        var message = \"The transition has been aborted\";\n        return new Rejection(exports.RejectType.ABORTED, message, detail);\n    };\n    /** Returns a Rejection due to aborted transition */\n    Rejection.errored = function (detail) {\n        var message = \"The transition errored\";\n        return new Rejection(exports.RejectType.ERROR, message, detail);\n    };\n    /**\n     * Returns a Rejection\n     *\n     * Normalizes a value as a Rejection.\n     * If the value is already a Rejection, returns it.\n     * Otherwise, wraps and returns the value as a Rejection (Rejection type: ERROR).\n     *\n     * @returns `detail` if it is already a `Rejection`, else returns an ERROR Rejection.\n     */\n    Rejection.normalize = function (detail) {\n        return is(Rejection)(detail) ? detail : Rejection.errored(detail);\n    };\n    return Rejection;\n}());\n\n/**\n * # Transition tracing (debug)\n *\n * Enable transition tracing to print transition information to the console,\n * in order to help debug your application.\n * Tracing logs detailed information about each Transition to your console.\n *\n * To enable tracing, import the [[Trace]] singleton and enable one or more categories.\n *\n * ### ES6\n * ```js\n * import {trace} from \"ui-router-ng2\"; // or \"angular-ui-router\"\n * trace.enable(1, 5); // TRANSITION and VIEWCONFIG\n * ```\n *\n * ### CJS\n * ```js\n * let trace = require(\"angular-ui-router\").trace; // or \"ui-router-ng2\"\n * trace.enable(\"TRANSITION\", \"VIEWCONFIG\");\n * ```\n *\n * ### Globals\n * ```js\n * let trace = window[\"angular-ui-router\"].trace; // or \"ui-router-ng2\"\n * trace.enable(); // Trace everything (very verbose)\n * ```\n *\n * ### Angular 1:\n * ```js\n * app.run($trace => $trace.enable());\n * ```\n *\n * @coreapi\n * @module trace\n */ /** for typedoc */\n/** @hidden */\nfunction uiViewString(viewData) {\n    if (!viewData)\n        return 'ui-view (defunct)';\n    return \"[ui-view#\" + viewData.id + \" tag \" +\n        (\"in template from '\" + (viewData.creationContext && viewData.creationContext.name || '(root)') + \"' state]: \") +\n        (\"fqn: '\" + viewData.fqn + \"', \") +\n        (\"name: '\" + viewData.name + \"@\" + viewData.creationContext + \"')\");\n}\n/** @hidden */\nvar viewConfigString = function (viewConfig) {\n    return \"[ViewConfig#\" + viewConfig.$id + \" from '\" + (viewConfig.viewDecl.$context.name || '(root)') + \"' state]: target ui-view: '\" + viewConfig.viewDecl.$uiViewName + \"@\" + viewConfig.viewDecl.$uiViewContextAnchor + \"'\";\n};\n/** @hidden */\nfunction normalizedCat(input) {\n    return isNumber(input) ? exports.Category[input] : exports.Category[exports.Category[input]];\n}\n/**\n * Trace categories Enum\n *\n * Enable or disable a category using [[Trace.enable]] or [[Trace.disable]]\n *\n * `trace.enable(Category.TRANSITION)`\n *\n * These can also be provided using a matching string, or position ordinal\n *\n * `trace.enable(\"TRANSITION\")`\n *\n * `trace.enable(1)`\n */\n\n(function (Category) {\n    Category[Category[\"RESOLVE\"] = 0] = \"RESOLVE\";\n    Category[Category[\"TRANSITION\"] = 1] = \"TRANSITION\";\n    Category[Category[\"HOOK\"] = 2] = \"HOOK\";\n    Category[Category[\"UIVIEW\"] = 3] = \"UIVIEW\";\n    Category[Category[\"VIEWCONFIG\"] = 4] = \"VIEWCONFIG\";\n})(exports.Category || (exports.Category = {}));\n/** @hidden */ var _tid = parse(\"$id\");\n/** @hidden */ var _rid = parse(\"router.$id\");\n/** @hidden */ var transLbl = function (trans) { return \"Transition #\" + _tid(trans) + \"-\" + _rid(trans); };\n/**\n * Prints UI-Router Transition trace information to the console.\n */\nvar Trace = (function () {\n    /** @hidden */\n    function Trace() {\n        /** @hidden */\n        this._enabled = {};\n        this.approximateDigests = 0;\n    }\n    /** @hidden */\n    Trace.prototype._set = function (enabled, categories) {\n        var _this = this;\n        if (!categories.length) {\n            categories = Object.keys(exports.Category)\n                .map(function (k) { return parseInt(k, 10); })\n                .filter(function (k) { return !isNaN(k); })\n                .map(function (key) { return exports.Category[key]; });\n        }\n        categories.map(normalizedCat).forEach(function (category) { return _this._enabled[category] = enabled; });\n    };\n    /**\n     * Enables a trace [[Category]]\n     *\n     * ```js\n     * trace.enable(\"TRANSITION\");\n     * ```\n     *\n     * @param categories categories to enable. If `categories` is omitted, all categories are enabled.\n     *        Also takes strings (category name) or ordinal (category position)\n     */\n    Trace.prototype.enable = function () {\n        var categories = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            categories[_i] = arguments[_i];\n        }\n        this._set(true, categories);\n    };\n    /**\n     * Disables a trace [[Category]]\n     *\n     * ```js\n     * trace.disable(\"VIEWCONFIG\");\n     * ```\n     *\n     * @param categories categories to disable. If `categories` is omitted, all categories are disabled.\n     *        Also takes strings (category name) or ordinal (category position)\n     */\n    Trace.prototype.disable = function () {\n        var categories = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            categories[_i] = arguments[_i];\n        }\n        this._set(false, categories);\n    };\n    /**\n     * Retrieves the enabled stateus of a [[Category]]\n     *\n     * ```js\n     * trace.enabled(\"VIEWCONFIG\"); // true or false\n     * ```\n     *\n     * @returns boolean true if the category is enabled\n     */\n    Trace.prototype.enabled = function (category) {\n        return !!this._enabled[normalizedCat(category)];\n    };\n    /** @internalapi called by ui-router code */\n    Trace.prototype.traceTransitionStart = function (trans) {\n        if (!this.enabled(exports.Category.TRANSITION))\n            return;\n        console.log(transLbl(trans) + \": Started  -> \" + stringify(trans));\n    };\n    /** @internalapi called by ui-router code */\n    Trace.prototype.traceTransitionIgnored = function (trans) {\n        if (!this.enabled(exports.Category.TRANSITION))\n            return;\n        console.log(transLbl(trans) + \": Ignored  <> \" + stringify(trans));\n    };\n    /** @internalapi called by ui-router code */\n    Trace.prototype.traceHookInvocation = function (step, trans, options) {\n        if (!this.enabled(exports.Category.HOOK))\n            return;\n        var event = parse(\"traceData.hookType\")(options) || \"internal\", context = parse(\"traceData.context.state.name\")(options) || parse(\"traceData.context\")(options) || \"unknown\", name = functionToString(step.registeredHook.callback);\n        console.log(transLbl(trans) + \":   Hook -> \" + event + \" context: \" + context + \", \" + maxLength(200, name));\n    };\n    /** @internalapi called by ui-router code */\n    Trace.prototype.traceHookResult = function (hookResult, trans, transitionOptions) {\n        if (!this.enabled(exports.Category.HOOK))\n            return;\n        console.log(transLbl(trans) + \":   <- Hook returned: \" + maxLength(200, stringify(hookResult)));\n    };\n    /** @internalapi called by ui-router code */\n    Trace.prototype.traceResolvePath = function (path, when, trans) {\n        if (!this.enabled(exports.Category.RESOLVE))\n            return;\n        console.log(transLbl(trans) + \":         Resolving \" + path + \" (\" + when + \")\");\n    };\n    /** @internalapi called by ui-router code */\n    Trace.prototype.traceResolvableResolved = function (resolvable, trans) {\n        if (!this.enabled(exports.Category.RESOLVE))\n            return;\n        console.log(transLbl(trans) + \":               <- Resolved  \" + resolvable + \" to: \" + maxLength(200, stringify(resolvable.data)));\n    };\n    /** @internalapi called by ui-router code */\n    Trace.prototype.traceError = function (reason, trans) {\n        if (!this.enabled(exports.Category.TRANSITION))\n            return;\n        console.log(transLbl(trans) + \": <- Rejected \" + stringify(trans) + \", reason: \" + reason);\n    };\n    /** @internalapi called by ui-router code */\n    Trace.prototype.traceSuccess = function (finalState, trans) {\n        if (!this.enabled(exports.Category.TRANSITION))\n            return;\n        console.log(transLbl(trans) + \": <- Success  \" + stringify(trans) + \", final state: \" + finalState.name);\n    };\n    /** @internalapi called by ui-router code */\n    Trace.prototype.traceUIViewEvent = function (event, viewData, extra) {\n        if (extra === void 0) { extra = \"\"; }\n        if (!this.enabled(exports.Category.UIVIEW))\n            return;\n        console.log(\"ui-view: \" + padString(30, event) + \" \" + uiViewString(viewData) + extra);\n    };\n    /** @internalapi called by ui-router code */\n    Trace.prototype.traceUIViewConfigUpdated = function (viewData, context) {\n        if (!this.enabled(exports.Category.UIVIEW))\n            return;\n        this.traceUIViewEvent(\"Updating\", viewData, \" with ViewConfig from context='\" + context + \"'\");\n    };\n    /** @internalapi called by ui-router code */\n    Trace.prototype.traceUIViewFill = function (viewData, html) {\n        if (!this.enabled(exports.Category.UIVIEW))\n            return;\n        this.traceUIViewEvent(\"Fill\", viewData, \" with: \" + maxLength(200, html));\n    };\n    /** @internalapi called by ui-router code */\n    Trace.prototype.traceViewServiceEvent = function (event, viewConfig) {\n        if (!this.enabled(exports.Category.VIEWCONFIG))\n            return;\n        console.log(\"VIEWCONFIG: \" + event + \" \" + viewConfigString(viewConfig));\n    };\n    /** @internalapi called by ui-router code */\n    Trace.prototype.traceViewServiceUIViewEvent = function (event, viewData) {\n        if (!this.enabled(exports.Category.VIEWCONFIG))\n            return;\n        console.log(\"VIEWCONFIG: \" + event + \" \" + uiViewString(viewData));\n    };\n    return Trace;\n}());\n/**\n * The [[Trace]] singleton\n *\n * #### Example:\n * ```js\n * import {trace} from \"angular-ui-router\";\n * trace.enable(1, 5);\n * ```\n */\nvar trace = new Trace();\n\n(function (TransitionHookPhase) {\n    TransitionHookPhase[TransitionHookPhase[\"CREATE\"] = 0] = \"CREATE\";\n    TransitionHookPhase[TransitionHookPhase[\"BEFORE\"] = 1] = \"BEFORE\";\n    TransitionHookPhase[TransitionHookPhase[\"RUN\"] = 2] = \"RUN\";\n    TransitionHookPhase[TransitionHookPhase[\"SUCCESS\"] = 3] = \"SUCCESS\";\n    TransitionHookPhase[TransitionHookPhase[\"ERROR\"] = 4] = \"ERROR\";\n})(exports.TransitionHookPhase || (exports.TransitionHookPhase = {}));\n\n(function (TransitionHookScope) {\n    TransitionHookScope[TransitionHookScope[\"TRANSITION\"] = 0] = \"TRANSITION\";\n    TransitionHookScope[TransitionHookScope[\"STATE\"] = 1] = \"STATE\";\n})(exports.TransitionHookScope || (exports.TransitionHookScope = {}));\n\n/**\n * @coreapi\n * @module state\n */ /** for typedoc */\n/**\n * Encapsulate the target (destination) state/params/options of a [[Transition]].\n *\n * This class is frequently used to redirect a transition to a new destination.\n *\n * See:\n *\n * - [[HookResult]]\n * - [[TransitionHookFn]]\n * - [[TransitionService.onStart]]\n *\n * To create a `TargetState`, use [[StateService.target]].\n *\n * ---\n *\n * This class wraps:\n *\n * 1) an identifier for a state\n * 2) a set of parameters\n * 3) and transition options\n * 4) the registered state object (the [[StateDeclaration]])\n *\n * Many UI-Router APIs such as [[StateService.go]] take a [[StateOrName]] argument which can\n * either be a *state object* (a [[StateDeclaration]] or [[StateObject]]) or a *state name* (a string).\n * The `TargetState` class normalizes those options.\n *\n * A `TargetState` may be valid (the state being targeted exists in the registry)\n * or invalid (the state being targeted is not registered).\n */\nvar TargetState = (function () {\n    /**\n     * The TargetState constructor\n     *\n     * Note: Do not construct a `TargetState` manually.\n     * To create a `TargetState`, use the [[StateService.target]] factory method.\n     *\n     * @param _identifier An identifier for a state.\n     *    Either a fully-qualified state name, or the object used to define the state.\n     * @param _definition The internal state representation, if exists.\n     * @param _params Parameters for the target state\n     * @param _options Transition options.\n     *\n     * @internalapi\n     */\n    function TargetState(_identifier, _definition, _params, _options) {\n        if (_options === void 0) { _options = {}; }\n        this._identifier = _identifier;\n        this._definition = _definition;\n        this._options = _options;\n        this._params = _params || {};\n    }\n    /** The name of the state this object targets */\n    TargetState.prototype.name = function () {\n        return this._definition && this._definition.name || this._identifier;\n    };\n    /** The identifier used when creating this TargetState */\n    TargetState.prototype.identifier = function () {\n        return this._identifier;\n    };\n    /** The target parameter values */\n    TargetState.prototype.params = function () {\n        return this._params;\n    };\n    /** The internal state object (if it was found) */\n    TargetState.prototype.$state = function () {\n        return this._definition;\n    };\n    /** The internal state declaration (if it was found) */\n    TargetState.prototype.state = function () {\n        return this._definition && this._definition.self;\n    };\n    /** The target options */\n    TargetState.prototype.options = function () {\n        return this._options;\n    };\n    /** True if the target state was found */\n    TargetState.prototype.exists = function () {\n        return !!(this._definition && this._definition.self);\n    };\n    /** True if the object is valid */\n    TargetState.prototype.valid = function () {\n        return !this.error();\n    };\n    /** If the object is invalid, returns the reason why */\n    TargetState.prototype.error = function () {\n        var base = this.options().relative;\n        if (!this._definition && !!base) {\n            var stateName = base.name ? base.name : base;\n            return \"Could not resolve '\" + this.name() + \"' from state '\" + stateName + \"'\";\n        }\n        if (!this._definition)\n            return \"No such state '\" + this.name() + \"'\";\n        if (!this._definition.self)\n            return \"State '\" + this.name() + \"' has an invalid definition\";\n    };\n    TargetState.prototype.toString = function () {\n        return \"'\" + this.name() + \"'\" + toJson(this.params());\n    };\n    return TargetState;\n}());\n/** Returns true if the object has a state property that might be a state or state name */\nTargetState.isDef = function (obj) {\n    return obj && obj.state && (isString(obj.state) || isString(obj.state.name));\n};\n\n/**\n * @coreapi\n * @module transition\n */\n/** for typedoc */\nvar defaultOptions = {\n    current: noop$1,\n    transition: null,\n    traceData: {},\n    bind: null,\n};\n/** @hidden */\nvar TransitionHook = (function () {\n    function TransitionHook(transition, stateContext, registeredHook, options) {\n        var _this = this;\n        this.transition = transition;\n        this.stateContext = stateContext;\n        this.registeredHook = registeredHook;\n        this.options = options;\n        this.isSuperseded = function () {\n            return _this.type.hookPhase === exports.TransitionHookPhase.RUN && !_this.options.transition.isActive();\n        };\n        this.options = defaults(options, defaultOptions);\n        this.type = registeredHook.eventType;\n    }\n    TransitionHook.prototype.logError = function (err) {\n        this.transition.router.stateService.defaultErrorHandler()(err);\n    };\n    TransitionHook.prototype.invokeHook = function () {\n        var _this = this;\n        var hook = this.registeredHook;\n        if (hook._deregistered)\n            return;\n        var notCurrent = this.getNotCurrentRejection();\n        if (notCurrent)\n            return notCurrent;\n        var options = this.options;\n        trace.traceHookInvocation(this, this.transition, options);\n        var invokeCallback = function () {\n            return hook.callback.call(options.bind, _this.transition, _this.stateContext);\n        };\n        var normalizeErr = function (err) {\n            return Rejection.normalize(err).toPromise();\n        };\n        var handleError = function (err) {\n            return hook.eventType.getErrorHandler(_this)(err);\n        };\n        var handleResult = function (result) {\n            return hook.eventType.getResultHandler(_this)(result);\n        };\n        try {\n            var result = invokeCallback();\n            if (!this.type.synchronous && isPromise(result)) {\n                return result.catch(normalizeErr)\n                    .then(handleResult, handleError);\n            }\n            else {\n                return handleResult(result);\n            }\n        }\n        catch (err) {\n            // If callback throws (synchronously)\n            return handleError(Rejection.normalize(err));\n        }\n    };\n    /**\n     * This method handles the return value of a Transition Hook.\n     *\n     * A hook can return false (cancel), a TargetState (redirect),\n     * or a promise (which may later resolve to false or a redirect)\n     *\n     * This also handles \"transition superseded\" -- when a new transition\n     * was started while the hook was still running\n     */\n    TransitionHook.prototype.handleHookResult = function (result) {\n        var _this = this;\n        var notCurrent = this.getNotCurrentRejection();\n        if (notCurrent)\n            return notCurrent;\n        // Hook returned a promise\n        if (isPromise(result)) {\n            // Wait for the promise, then reprocess with the resulting value\n            return result.then(function (val$$1) { return _this.handleHookResult(val$$1); });\n        }\n        trace.traceHookResult(result, this.transition, this.options);\n        // Hook returned false\n        if (result === false) {\n            // Abort this Transition\n            return Rejection.aborted(\"Hook aborted transition\").toPromise();\n        }\n        var isTargetState = is(TargetState);\n        // hook returned a TargetState\n        if (isTargetState(result)) {\n            // Halt the current Transition and redirect (a new Transition) to the TargetState.\n            return Rejection.redirected(result).toPromise();\n        }\n    };\n    /**\n     * Return a Rejection promise if the transition is no longer current due\n     * to a stopped router (disposed), or a new transition has started and superseded this one.\n     */\n    TransitionHook.prototype.getNotCurrentRejection = function () {\n        var router = this.transition.router;\n        // The router is stopped\n        if (router._disposed) {\n            return Rejection.aborted(\"UIRouter instance #\" + router.$id + \" has been stopped (disposed)\").toPromise();\n        }\n        if (this.transition._aborted) {\n            return Rejection.aborted().toPromise();\n        }\n        // This transition is no longer current.\n        // Another transition started while this hook was still running.\n        if (this.isSuperseded()) {\n            // Abort this transition\n            return Rejection.superseded(this.options.current()).toPromise();\n        }\n    };\n    TransitionHook.prototype.toString = function () {\n        var _a = this, options = _a.options, registeredHook = _a.registeredHook;\n        var event = parse(\"traceData.hookType\")(options) || \"internal\", context = parse(\"traceData.context.state.name\")(options) || parse(\"traceData.context\")(options) || \"unknown\", name = fnToString(registeredHook.callback);\n        return event + \" context: \" + context + \", \" + maxLength(200, name);\n    };\n    /**\n     * Chains together an array of TransitionHooks.\n     *\n     * Given a list of [[TransitionHook]] objects, chains them together.\n     * Each hook is invoked after the previous one completes.\n     *\n     * #### Example:\n     * ```js\n     * var hooks: TransitionHook[] = getHooks();\n     * let promise: Promise<any> = TransitionHook.chain(hooks);\n     *\n     * promise.then(handleSuccess, handleError);\n     * ```\n     *\n     * @param hooks the list of hooks to chain together\n     * @param waitFor if provided, the chain is `.then()`'ed off this promise\n     * @returns a `Promise` for sequentially invoking the hooks (in order)\n     */\n    TransitionHook.chain = function (hooks, waitFor) {\n        // Chain the next hook off the previous\n        var createHookChainR = function (prev, nextHook) {\n            return prev.then(function () { return nextHook.invokeHook(); });\n        };\n        return hooks.reduce(createHookChainR, waitFor || services.$q.when());\n    };\n    /**\n     * Invokes all the provided TransitionHooks, in order.\n     * Each hook's return value is checked.\n     * If any hook returns a promise, then the rest of the hooks are chained off that promise, and the promise is returned.\n     * If no hook returns a promise, then all hooks are processed synchronously.\n     *\n     * @param hooks the list of TransitionHooks to invoke\n     * @param doneCallback a callback that is invoked after all the hooks have successfully completed\n     *\n     * @returns a promise for the async result, or the result of the callback\n     */\n    TransitionHook.invokeHooks = function (hooks, doneCallback) {\n        for (var idx = 0; idx < hooks.length; idx++) {\n            var hookResult = hooks[idx].invokeHook();\n            if (isPromise(hookResult)) {\n                var remainingHooks = hooks.slice(idx + 1);\n                return TransitionHook.chain(remainingHooks, hookResult)\n                    .then(doneCallback);\n            }\n        }\n        return doneCallback();\n    };\n    /**\n     * Run all TransitionHooks, ignoring their return value.\n     */\n    TransitionHook.runAllHooks = function (hooks) {\n        hooks.forEach(function (hook) { return hook.invokeHook(); });\n    };\n    return TransitionHook;\n}());\n/**\n * These GetResultHandler(s) are used by [[invokeHook]] below\n * Each HookType chooses a GetResultHandler (See: [[TransitionService._defineCoreEvents]])\n */\nTransitionHook.HANDLE_RESULT = function (hook) { return function (result) {\n    return hook.handleHookResult(result);\n}; };\n/**\n * If the result is a promise rejection, log it.\n * Otherwise, ignore the result.\n */\nTransitionHook.LOG_REJECTED_RESULT = function (hook) { return function (result) {\n    isPromise(result) && result.catch(function (err) {\n        return hook.logError(Rejection.normalize(err));\n    });\n    return undefined;\n}; };\n/**\n * These GetErrorHandler(s) are used by [[invokeHook]] below\n * Each HookType chooses a GetErrorHandler (See: [[TransitionService._defineCoreEvents]])\n */\nTransitionHook.LOG_ERROR = function (hook) { return function (error) {\n    return hook.logError(error);\n}; };\nTransitionHook.REJECT_ERROR = function (hook) { return function (error) {\n    return silentRejection(error);\n}; };\nTransitionHook.THROW_ERROR = function (hook) { return function (error) {\n    throw error;\n}; };\n\n/**\n * @coreapi\n * @module transition\n */ /** for typedoc */\n/**\n * Determines if the given state matches the matchCriteria\n *\n * @hidden\n *\n * @param state a State Object to test against\n * @param criterion\n * - If a string, matchState uses the string as a glob-matcher against the state name\n * - If an array (of strings), matchState uses each string in the array as a glob-matchers against the state name\n *   and returns a positive match if any of the globs match.\n * - If a function, matchState calls the function with the state and returns true if the function's result is truthy.\n * @returns {boolean}\n */\nfunction matchState(state, criterion) {\n    var toMatch = isString(criterion) ? [criterion] : criterion;\n    function matchGlobs(_state) {\n        var globStrings = toMatch;\n        for (var i = 0; i < globStrings.length; i++) {\n            var glob = new Glob(globStrings[i]);\n            if ((glob && glob.matches(_state.name)) || (!glob && globStrings[i] === _state.name)) {\n                return true;\n            }\n        }\n        return false;\n    }\n    var matchFn = (isFunction(toMatch) ? toMatch : matchGlobs);\n    return !!matchFn(state);\n}\n/**\n * @internalapi\n * The registration data for a registered transition hook\n */\nvar RegisteredHook = (function () {\n    function RegisteredHook(tranSvc, eventType, callback, matchCriteria, options) {\n        if (options === void 0) { options = {}; }\n        this.tranSvc = tranSvc;\n        this.eventType = eventType;\n        this.callback = callback;\n        this.matchCriteria = matchCriteria;\n        this.priority = options.priority || 0;\n        this.bind = options.bind || null;\n        this._deregistered = false;\n    }\n    /**\n     * Gets the matching [[PathNode]]s\n     *\n     * Given an array of [[PathNode]]s, and a [[HookMatchCriterion]], returns an array containing\n     * the [[PathNode]]s that the criteria matches, or `null` if there were no matching nodes.\n     *\n     * Returning `null` is significant to distinguish between the default\n     * \"match-all criterion value\" of `true` compared to a `() => true` function,\n     * when the nodes is an empty array.\n     *\n     * This is useful to allow a transition match criteria of `entering: true`\n     * to still match a transition, even when `entering === []`.  Contrast that\n     * with `entering: (state) => true` which only matches when a state is actually\n     * being entered.\n     */\n    RegisteredHook.prototype._matchingNodes = function (nodes, criterion) {\n        if (criterion === true)\n            return nodes;\n        var matching = nodes.filter(function (node) { return matchState(node.state, criterion); });\n        return matching.length ? matching : null;\n    };\n    /**\n     * Gets the default match criteria (all `true`)\n     *\n     * Returns an object which has all the criteria match paths as keys and `true` as values, i.e.:\n     *\n     * ```js\n     * {\n     *   to: true,\n     *   from: true,\n     *   entering: true,\n     *   exiting: true,\n     *   retained: true,\n     * }\n     */\n    RegisteredHook.prototype._getDefaultMatchCriteria = function () {\n        return map(this.tranSvc._pluginapi._getPathTypes(), function () { return true; });\n    };\n    /**\n     * Gets matching nodes as [[IMatchingNodes]]\n     *\n     * Create a IMatchingNodes object from the TransitionHookTypes that is roughly equivalent to:\n     *\n     * ```js\n     * let matches: IMatchingNodes = {\n     *   to:       _matchingNodes([tail(treeChanges.to)],   mc.to),\n     *   from:     _matchingNodes([tail(treeChanges.from)], mc.from),\n     *   exiting:  _matchingNodes(treeChanges.exiting,      mc.exiting),\n     *   retained: _matchingNodes(treeChanges.retained,     mc.retained),\n     *   entering: _matchingNodes(treeChanges.entering,     mc.entering),\n     * };\n     * ```\n     */\n    RegisteredHook.prototype._getMatchingNodes = function (treeChanges) {\n        var _this = this;\n        var criteria = extend(this._getDefaultMatchCriteria(), this.matchCriteria);\n        var paths = values(this.tranSvc._pluginapi._getPathTypes());\n        return paths.reduce(function (mn, pathtype) {\n            // STATE scope criteria matches against every node in the path.\n            // TRANSITION scope criteria matches against only the last node in the path\n            var isStateHook = pathtype.scope === exports.TransitionHookScope.STATE;\n            var path = treeChanges[pathtype.name] || [];\n            var nodes = isStateHook ? path : [tail(path)];\n            mn[pathtype.name] = _this._matchingNodes(nodes, criteria[pathtype.name]);\n            return mn;\n        }, {});\n    };\n    /**\n     * Determines if this hook's [[matchCriteria]] match the given [[TreeChanges]]\n     *\n     * @returns an IMatchingNodes object, or null. If an IMatchingNodes object is returned, its values\n     * are the matching [[PathNode]]s for each [[HookMatchCriterion]] (to, from, exiting, retained, entering)\n     */\n    RegisteredHook.prototype.matches = function (treeChanges) {\n        var matches = this._getMatchingNodes(treeChanges);\n        // Check if all the criteria matched the TreeChanges object\n        var allMatched = values(matches).every(identity);\n        return allMatched ? matches : null;\n    };\n    return RegisteredHook;\n}());\n/** @hidden Return a registration function of the requested type. */\nfunction makeEvent(registry, transitionService, eventType) {\n    // Create the object which holds the registered transition hooks.\n    var _registeredHooks = registry._registeredHooks = (registry._registeredHooks || {});\n    var hooks = _registeredHooks[eventType.name] = [];\n    // Create hook registration function on the IHookRegistry for the event\n    registry[eventType.name] = hookRegistrationFn;\n    function hookRegistrationFn(matchObject, callback, options) {\n        if (options === void 0) { options = {}; }\n        var registeredHook = new RegisteredHook(transitionService, eventType, callback, matchObject, options);\n        hooks.push(registeredHook);\n        return function deregisterEventHook() {\n            registeredHook._deregistered = true;\n            removeFrom(hooks)(registeredHook);\n        };\n    }\n    return hookRegistrationFn;\n}\n\n/**\n * @coreapi\n * @module transition\n */ /** for typedoc */\n/**\n * This class returns applicable TransitionHooks for a specific Transition instance.\n *\n * Hooks ([[RegisteredHook]]) may be registered globally, e.g., $transitions.onEnter(...), or locally, e.g.\n * myTransition.onEnter(...).  The HookBuilder finds matching RegisteredHooks (where the match criteria is\n * determined by the type of hook)\n *\n * The HookBuilder also converts RegisteredHooks objects to TransitionHook objects, which are used to run a Transition.\n *\n * The HookBuilder constructor is given the $transitions service and a Transition instance.  Thus, a HookBuilder\n * instance may only be used for one specific Transition object. (side note: the _treeChanges accessor is private\n * in the Transition class, so we must also provide the Transition's _treeChanges)\n *\n */\nvar HookBuilder = (function () {\n    function HookBuilder(transition) {\n        this.transition = transition;\n    }\n    HookBuilder.prototype.buildHooksForPhase = function (phase) {\n        var _this = this;\n        var $transitions = this.transition.router.transitionService;\n        return $transitions._pluginapi._getEvents(phase)\n            .map(function (type) { return _this.buildHooks(type); })\n            .reduce(unnestR, [])\n            .filter(identity);\n    };\n    /**\n     * Returns an array of newly built TransitionHook objects.\n     *\n     * - Finds all RegisteredHooks registered for the given `hookType` which matched the transition's [[TreeChanges]].\n     * - Finds [[PathNode]] (or `PathNode[]`) to use as the TransitionHook context(s)\n     * - For each of the [[PathNode]]s, creates a TransitionHook\n     *\n     * @param hookType the type of the hook registration function, e.g., 'onEnter', 'onFinish'.\n     */\n    HookBuilder.prototype.buildHooks = function (hookType) {\n        var transition = this.transition;\n        var treeChanges = transition.treeChanges();\n        // Find all the matching registered hooks for a given hook type\n        var matchingHooks = this.getMatchingHooks(hookType, treeChanges);\n        if (!matchingHooks)\n            return [];\n        var baseHookOptions = {\n            transition: transition,\n            current: transition.options().current\n        };\n        var makeTransitionHooks = function (hook) {\n            // Fetch the Nodes that caused this hook to match.\n            var matches = hook.matches(treeChanges);\n            // Select the PathNode[] that will be used as TransitionHook context objects\n            var matchingNodes = matches[hookType.criteriaMatchPath.name];\n            // Return an array of HookTuples\n            return matchingNodes.map(function (node) {\n                var _options = extend({\n                    bind: hook.bind,\n                    traceData: { hookType: hookType.name, context: node }\n                }, baseHookOptions);\n                var state = hookType.criteriaMatchPath.scope === exports.TransitionHookScope.STATE ? node.state.self : null;\n                var transitionHook = new TransitionHook(transition, state, hook, _options);\n                return { hook: hook, node: node, transitionHook: transitionHook };\n            });\n        };\n        return matchingHooks.map(makeTransitionHooks)\n            .reduce(unnestR, [])\n            .sort(tupleSort(hookType.reverseSort))\n            .map(function (tuple) { return tuple.transitionHook; });\n    };\n    /**\n     * Finds all RegisteredHooks from:\n     * - The Transition object instance hook registry\n     * - The TransitionService ($transitions) global hook registry\n     *\n     * which matched:\n     * - the eventType\n     * - the matchCriteria (to, from, exiting, retained, entering)\n     *\n     * @returns an array of matched [[RegisteredHook]]s\n     */\n    HookBuilder.prototype.getMatchingHooks = function (hookType, treeChanges) {\n        var isCreate = hookType.hookPhase === exports.TransitionHookPhase.CREATE;\n        // Instance and Global hook registries\n        var $transitions = this.transition.router.transitionService;\n        var registries = isCreate ? [$transitions] : [this.transition, $transitions];\n        return registries.map(function (reg) { return reg.getHooks(hookType.name); }) // Get named hooks from registries\n            .filter(assertPredicate(isArray, \"broken event named: \" + hookType.name)) // Sanity check\n            .reduce(unnestR, []) // Un-nest RegisteredHook[][] to RegisteredHook[] array\n            .filter(function (hook) { return hook.matches(treeChanges); }); // Only those satisfying matchCriteria\n    };\n    return HookBuilder;\n}());\n/**\n * A factory for a sort function for HookTuples.\n *\n * The sort function first compares the PathNode depth (how deep in the state tree a node is), then compares\n * the EventHook priority.\n *\n * @param reverseDepthSort a boolean, when true, reverses the sort order for the node depth\n * @returns a tuple sort function\n */\nfunction tupleSort(reverseDepthSort) {\n    if (reverseDepthSort === void 0) { reverseDepthSort = false; }\n    return function nodeDepthThenPriority(l, r) {\n        var factor = reverseDepthSort ? -1 : 1;\n        var depthDelta = (l.node.state.path.length - r.node.state.path.length) * factor;\n        return depthDelta !== 0 ? depthDelta : r.hook.priority - l.hook.priority;\n    };\n}\n\n/**\n * @coreapi\n * @module params\n */\n/** */\n/**\n * An internal class which implements [[ParamTypeDefinition]].\n *\n * A [[ParamTypeDefinition]] is a plain javascript object used to register custom parameter types.\n * When a param type definition is registered, an instance of this class is created internally.\n *\n * This class has naive implementations for all the [[ParamTypeDefinition]] methods.\n *\n * Used by [[UrlMatcher]] when matching or formatting URLs, or comparing and validating parameter values.\n *\n * #### Example:\n * ```js\n * var paramTypeDef = {\n *   decode: function(val) { return parseInt(val, 10); },\n *   encode: function(val) { return val && val.toString(); },\n *   equals: function(a, b) { return this.is(a) && a === b; },\n *   is: function(val) { return angular.isNumber(val) && isFinite(val) && val % 1 === 0; },\n *   pattern: /\\d+/\n * }\n *\n * var paramType = new ParamType(paramTypeDef);\n * ```\n * @internalapi\n */\nvar ParamType = (function () {\n    /**\n     * @param def  A configuration object which contains the custom type definition.  The object's\n     *        properties will override the default methods and/or pattern in `ParamType`'s public interface.\n     * @returns a new ParamType object\n     */\n    function ParamType(def) {\n        /** @inheritdoc */\n        this.pattern = /.*/;\n        /** @inheritdoc */\n        this.inherit = true;\n        extend(this, def);\n    }\n    // consider these four methods to be \"abstract methods\" that should be overridden\n    /** @inheritdoc */\n    ParamType.prototype.is = function (val, key) { return true; };\n    /** @inheritdoc */\n    ParamType.prototype.encode = function (val, key) { return val; };\n    /** @inheritdoc */\n    ParamType.prototype.decode = function (val, key) { return val; };\n    /** @inheritdoc */\n    ParamType.prototype.equals = function (a, b) { return a == b; };\n    ParamType.prototype.$subPattern = function () {\n        var sub = this.pattern.toString();\n        return sub.substr(1, sub.length - 2);\n    };\n    ParamType.prototype.toString = function () {\n        return \"{ParamType:\" + this.name + \"}\";\n    };\n    /** Given an encoded string, or a decoded object, returns a decoded object */\n    ParamType.prototype.$normalize = function (val) {\n        return this.is(val) ? val : this.decode(val);\n    };\n    /**\n     * Wraps an existing custom ParamType as an array of ParamType, depending on 'mode'.\n     * e.g.:\n     * - urlmatcher pattern \"/path?{queryParam[]:int}\"\n     * - url: \"/path?queryParam=1&queryParam=2\n     * - $stateParams.queryParam will be [1, 2]\n     * if `mode` is \"auto\", then\n     * - url: \"/path?queryParam=1 will create $stateParams.queryParam: 1\n     * - url: \"/path?queryParam=1&queryParam=2 will create $stateParams.queryParam: [1, 2]\n     */\n    ParamType.prototype.$asArray = function (mode, isSearch) {\n        if (!mode)\n            return this;\n        if (mode === \"auto\" && !isSearch)\n            throw new Error(\"'auto' array mode is for query parameters only\");\n        return new ArrayType(this, mode);\n    };\n    return ParamType;\n}());\n/**\n * Wraps up a `ParamType` object to handle array values.\n * @internalapi\n */\nfunction ArrayType(type, mode) {\n    var _this = this;\n    // Wrap non-array value as array\n    function arrayWrap(val) {\n        return isArray(val) ? val : (isDefined(val) ? [val] : []);\n    }\n    // Unwrap array value for \"auto\" mode. Return undefined for empty array.\n    function arrayUnwrap(val) {\n        switch (val.length) {\n            case 0: return undefined;\n            case 1: return mode === \"auto\" ? val[0] : val;\n            default: return val;\n        }\n    }\n    // Wraps type (.is/.encode/.decode) functions to operate on each value of an array\n    function arrayHandler(callback, allTruthyMode) {\n        return function handleArray(val) {\n            if (isArray(val) && val.length === 0)\n                return val;\n            var arr = arrayWrap(val);\n            var result = map(arr, callback);\n            return (allTruthyMode === true) ? filter(result, function (x) { return !x; }).length === 0 : arrayUnwrap(result);\n        };\n    }\n    // Wraps type (.equals) functions to operate on each value of an array\n    function arrayEqualsHandler(callback) {\n        return function handleArray(val1, val2) {\n            var left = arrayWrap(val1), right = arrayWrap(val2);\n            if (left.length !== right.length)\n                return false;\n            for (var i = 0; i < left.length; i++) {\n                if (!callback(left[i], right[i]))\n                    return false;\n            }\n            return true;\n        };\n    }\n    ['encode', 'decode', 'equals', '$normalize'].forEach(function (name) {\n        var paramTypeFn = type[name].bind(type);\n        var wrapperFn = name === 'equals' ? arrayEqualsHandler : arrayHandler;\n        _this[name] = wrapperFn(paramTypeFn);\n    });\n    extend(this, {\n        dynamic: type.dynamic,\n        name: type.name,\n        pattern: type.pattern,\n        inherit: type.inherit,\n        is: arrayHandler(type.is.bind(type), true),\n        $arrayMode: mode\n    });\n}\n\n/**\n * @coreapi\n * @module params\n */ /** for typedoc */\n/** @hidden */ var hasOwn = Object.prototype.hasOwnProperty;\n/** @hidden */ var isShorthand = function (cfg) {\n    return [\"value\", \"type\", \"squash\", \"array\", \"dynamic\"].filter(hasOwn.bind(cfg || {})).length === 0;\n};\n/** @internalapi */\n\n(function (DefType) {\n    DefType[DefType[\"PATH\"] = 0] = \"PATH\";\n    DefType[DefType[\"SEARCH\"] = 1] = \"SEARCH\";\n    DefType[DefType[\"CONFIG\"] = 2] = \"CONFIG\";\n})(exports.DefType || (exports.DefType = {}));\n/** @hidden */\nfunction unwrapShorthand(cfg) {\n    cfg = isShorthand(cfg) && { value: cfg } || cfg;\n    getStaticDefaultValue['__cacheable'] = true;\n    function getStaticDefaultValue() {\n        return cfg.value;\n    }\n    return extend(cfg, {\n        $$fn: isInjectable(cfg.value) ? cfg.value : getStaticDefaultValue,\n    });\n}\n/** @hidden */\nfunction getType(cfg, urlType, location, id, paramTypes) {\n    if (cfg.type && urlType && urlType.name !== 'string')\n        throw new Error(\"Param '\" + id + \"' has two type configurations.\");\n    if (cfg.type && urlType && urlType.name === 'string' && paramTypes.type(cfg.type))\n        return paramTypes.type(cfg.type);\n    if (urlType)\n        return urlType;\n    if (!cfg.type) {\n        var type = location === exports.DefType.CONFIG ? \"any\" :\n            location === exports.DefType.PATH ? \"path\" :\n                location === exports.DefType.SEARCH ? \"query\" : \"string\";\n        return paramTypes.type(type);\n    }\n    return cfg.type instanceof ParamType ? cfg.type : paramTypes.type(cfg.type);\n}\n/**\n * @internalapi\n * returns false, true, or the squash value to indicate the \"default parameter url squash policy\".\n */\nfunction getSquashPolicy(config, isOptional, defaultPolicy) {\n    var squash = config.squash;\n    if (!isOptional || squash === false)\n        return false;\n    if (!isDefined(squash) || squash == null)\n        return defaultPolicy;\n    if (squash === true || isString(squash))\n        return squash;\n    throw new Error(\"Invalid squash policy: '\" + squash + \"'. Valid policies: false, true, or arbitrary string\");\n}\n/** @internalapi */\nfunction getReplace(config, arrayMode, isOptional, squash) {\n    var replace, configuredKeys, defaultPolicy = [\n        { from: \"\", to: (isOptional || arrayMode ? undefined : \"\") },\n        { from: null, to: (isOptional || arrayMode ? undefined : \"\") },\n    ];\n    replace = isArray(config.replace) ? config.replace : [];\n    if (isString(squash))\n        replace.push({ from: squash, to: undefined });\n    configuredKeys = map(replace, prop(\"from\"));\n    return filter(defaultPolicy, function (item) { return configuredKeys.indexOf(item.from) === -1; }).concat(replace);\n}\n/** @internalapi */\nvar Param = (function () {\n    function Param(id, type, config, location, urlMatcherFactory) {\n        config = unwrapShorthand(config);\n        type = getType(config, type, location, id, urlMatcherFactory.paramTypes);\n        var arrayMode = getArrayMode();\n        type = arrayMode ? type.$asArray(arrayMode, location === exports.DefType.SEARCH) : type;\n        var isOptional = config.value !== undefined || location === exports.DefType.SEARCH;\n        var dynamic = isDefined(config.dynamic) ? !!config.dynamic : !!type.dynamic;\n        var raw = isDefined(config.raw) ? !!config.raw : !!type.raw;\n        var squash = getSquashPolicy(config, isOptional, urlMatcherFactory.defaultSquashPolicy());\n        var replace = getReplace(config, arrayMode, isOptional, squash);\n        var inherit$$1 = isDefined(config.inherit) ? !!config.inherit : !!type.inherit;\n        // array config: param name (param[]) overrides default settings.  explicit config overrides param name.\n        function getArrayMode() {\n            var arrayDefaults = { array: (location === exports.DefType.SEARCH ? \"auto\" : false) };\n            var arrayParamNomenclature = id.match(/\\[\\]$/) ? { array: true } : {};\n            return extend(arrayDefaults, arrayParamNomenclature, config).array;\n        }\n        extend(this, { id: id, type: type, location: location, isOptional: isOptional, dynamic: dynamic, raw: raw, squash: squash, replace: replace, inherit: inherit$$1, array: arrayMode, config: config });\n    }\n    Param.prototype.isDefaultValue = function (value) {\n        return this.isOptional && this.type.equals(this.value(), value);\n    };\n    /**\n     * [Internal] Gets the decoded representation of a value if the value is defined, otherwise, returns the\n     * default value, which may be the result of an injectable function.\n     */\n    Param.prototype.value = function (value) {\n        var _this = this;\n        /**\n         * [Internal] Get the default value of a parameter, which may be an injectable function.\n         */\n        var getDefaultValue = function () {\n            if (_this._defaultValueCache)\n                return _this._defaultValueCache.defaultValue;\n            if (!services.$injector)\n                throw new Error(\"Injectable functions cannot be called at configuration time\");\n            var defaultValue = services.$injector.invoke(_this.config.$$fn);\n            if (defaultValue !== null && defaultValue !== undefined && !_this.type.is(defaultValue))\n                throw new Error(\"Default value (\" + defaultValue + \") for parameter '\" + _this.id + \"' is not an instance of ParamType (\" + _this.type.name + \")\");\n            if (_this.config.$$fn['__cacheable']) {\n                _this._defaultValueCache = { defaultValue: defaultValue };\n            }\n            return defaultValue;\n        };\n        var replaceSpecialValues = function (val$$1) {\n            for (var _i = 0, _a = _this.replace; _i < _a.length; _i++) {\n                var tuple = _a[_i];\n                if (tuple.from === val$$1)\n                    return tuple.to;\n            }\n            return val$$1;\n        };\n        value = replaceSpecialValues(value);\n        return isUndefined(value) ? getDefaultValue() : this.type.$normalize(value);\n    };\n    Param.prototype.isSearch = function () {\n        return this.location === exports.DefType.SEARCH;\n    };\n    Param.prototype.validates = function (value) {\n        // There was no parameter value, but the param is optional\n        if ((isUndefined(value) || value === null) && this.isOptional)\n            return true;\n        // The value was not of the correct ParamType, and could not be decoded to the correct ParamType\n        var normalized = this.type.$normalize(value);\n        if (!this.type.is(normalized))\n            return false;\n        // The value was of the correct type, but when encoded, did not match the ParamType's regexp\n        var encoded = this.type.encode(normalized);\n        return !(isString(encoded) && !this.type.pattern.exec(encoded));\n    };\n    Param.prototype.toString = function () {\n        return \"{Param:\" + this.id + \" \" + this.type + \" squash: '\" + this.squash + \"' optional: \" + this.isOptional + \"}\";\n    };\n    Param.values = function (params, values$$1) {\n        if (values$$1 === void 0) { values$$1 = {}; }\n        var paramValues = {};\n        for (var _i = 0, params_1 = params; _i < params_1.length; _i++) {\n            var param = params_1[_i];\n            paramValues[param.id] = param.value(values$$1[param.id]);\n        }\n        return paramValues;\n    };\n    /**\n     * Finds [[Param]] objects which have different param values\n     *\n     * Filters a list of [[Param]] objects to only those whose parameter values differ in two param value objects\n     *\n     * @param params: The list of Param objects to filter\n     * @param values1: The first set of parameter values\n     * @param values2: the second set of parameter values\n     *\n     * @returns any Param objects whose values were different between values1 and values2\n     */\n    Param.changed = function (params, values1, values2) {\n        if (values1 === void 0) { values1 = {}; }\n        if (values2 === void 0) { values2 = {}; }\n        return params.filter(function (param) { return !param.type.equals(values1[param.id], values2[param.id]); });\n    };\n    /**\n     * Checks if two param value objects are equal (for a set of [[Param]] objects)\n     *\n     * @param params The list of [[Param]] objects to check\n     * @param values1 The first set of param values\n     * @param values2 The second set of param values\n     *\n     * @returns true if the param values in values1 and values2 are equal\n     */\n    Param.equals = function (params, values1, values2) {\n        if (values1 === void 0) { values1 = {}; }\n        if (values2 === void 0) { values2 = {}; }\n        return Param.changed(params, values1, values2).length === 0;\n    };\n    /** Returns true if a the parameter values are valid, according to the Param definitions */\n    Param.validates = function (params, values$$1) {\n        if (values$$1 === void 0) { values$$1 = {}; }\n        return params.map(function (param) { return param.validates(values$$1[param.id]); }).reduce(allTrueR, true);\n    };\n    return Param;\n}());\n\n/** @module path */ /** for typedoc */\n/**\n * @internalapi\n *\n * A node in a [[TreeChanges]] path\n *\n * For a [[TreeChanges]] path, this class holds the stateful information for a single node in the path.\n * Each PathNode corresponds to a state being entered, exited, or retained.\n * The stateful information includes parameter values and resolve data.\n */\nvar PathNode = (function () {\n    function PathNode(stateOrNode) {\n        if (stateOrNode instanceof PathNode) {\n            var node = stateOrNode;\n            this.state = node.state;\n            this.paramSchema = node.paramSchema.slice();\n            this.paramValues = extend({}, node.paramValues);\n            this.resolvables = node.resolvables.slice();\n            this.views = node.views && node.views.slice();\n        }\n        else {\n            var state = stateOrNode;\n            this.state = state;\n            this.paramSchema = state.parameters({ inherit: false });\n            this.paramValues = {};\n            this.resolvables = state.resolvables.map(function (res) { return res.clone(); });\n        }\n    }\n    /** Sets [[paramValues]] for the node, from the values of an object hash */\n    PathNode.prototype.applyRawParams = function (params) {\n        var getParamVal = function (paramDef) { return [paramDef.id, paramDef.value(params[paramDef.id])]; };\n        this.paramValues = this.paramSchema.reduce(function (memo, pDef) { return applyPairs(memo, getParamVal(pDef)); }, {});\n        return this;\n    };\n    /** Gets a specific [[Param]] metadata that belongs to the node */\n    PathNode.prototype.parameter = function (name) {\n        return find(this.paramSchema, propEq(\"id\", name));\n    };\n    /**\n     * @returns true if the state and parameter values for another PathNode are\n     * equal to the state and param values for this PathNode\n     */\n    PathNode.prototype.equals = function (node, paramsFn) {\n        var diff = this.diff(node, paramsFn);\n        return diff && diff.length === 0;\n    };\n    /**\n     * Finds Params with different parameter values on another PathNode.\n     *\n     * Given another node (of the same state), finds the parameter values which differ.\n     * Returns the [[Param]] (schema objects) whose parameter values differ.\n     *\n     * Given another node for a different state, returns `false`\n     *\n     * @param node The node to compare to\n     * @param paramsFn A function that returns which parameters should be compared.\n     * @returns The [[Param]]s which differ, or null if the two nodes are for different states\n     */\n    PathNode.prototype.diff = function (node, paramsFn) {\n        if (this.state !== node.state)\n            return false;\n        var params = paramsFn ? paramsFn(this) : this.paramSchema;\n        return Param.changed(params, this.paramValues, node.paramValues);\n    };\n    /** Returns a clone of the PathNode */\n    PathNode.clone = function (node) {\n        return new PathNode(node);\n    };\n    return PathNode;\n}());\n\n/** @module path */ /** for typedoc */\n/**\n * This class contains functions which convert TargetStates, Nodes and paths from one type to another.\n */\nvar PathUtils = (function () {\n    function PathUtils() {\n    }\n    /** Given a PathNode[], create an TargetState */\n    PathUtils.makeTargetState = function (path) {\n        var state = tail(path).state;\n        return new TargetState(state, state, path.map(prop(\"paramValues\")).reduce(mergeR, {}));\n    };\n    PathUtils.buildPath = function (targetState) {\n        var toParams = targetState.params();\n        return targetState.$state().path.map(function (state) { return new PathNode(state).applyRawParams(toParams); });\n    };\n    /** Given a fromPath: PathNode[] and a TargetState, builds a toPath: PathNode[] */\n    PathUtils.buildToPath = function (fromPath, targetState) {\n        var toPath = PathUtils.buildPath(targetState);\n        if (targetState.options().inherit) {\n            return PathUtils.inheritParams(fromPath, toPath, Object.keys(targetState.params()));\n        }\n        return toPath;\n    };\n    /**\n     * Creates ViewConfig objects and adds to nodes.\n     *\n     * On each [[PathNode]], creates ViewConfig objects from the views: property of the node's state\n     */\n    PathUtils.applyViewConfigs = function ($view, path, states) {\n        // Only apply the viewConfigs to the nodes for the given states\n        path.filter(function (node) { return inArray(states, node.state); }).forEach(function (node) {\n            var viewDecls = values(node.state.views || {});\n            var subPath = PathUtils.subPath(path, function (n) { return n === node; });\n            var viewConfigs = viewDecls.map(function (view) { return $view.createViewConfig(subPath, view); });\n            node.views = viewConfigs.reduce(unnestR, []);\n        });\n    };\n    /**\n     * Given a fromPath and a toPath, returns a new to path which inherits parameters from the fromPath\n     *\n     * For a parameter in a node to be inherited from the from path:\n     * - The toPath's node must have a matching node in the fromPath (by state).\n     * - The parameter name must not be found in the toKeys parameter array.\n     *\n     * Note: the keys provided in toKeys are intended to be those param keys explicitly specified by some\n     * caller, for instance, $state.transitionTo(..., toParams).  If a key was found in toParams,\n     * it is not inherited from the fromPath.\n     */\n    PathUtils.inheritParams = function (fromPath, toPath, toKeys) {\n        if (toKeys === void 0) { toKeys = []; }\n        function nodeParamVals(path, state) {\n            var node = find(path, propEq('state', state));\n            return extend({}, node && node.paramValues);\n        }\n        var noInherit = fromPath.map(function (node) { return node.paramSchema; })\n            .reduce(unnestR, [])\n            .filter(function (param) { return !param.inherit; })\n            .map(prop('id'));\n        /**\n         * Given an [[PathNode]] \"toNode\", return a new [[PathNode]] with param values inherited from the\n         * matching node in fromPath.  Only inherit keys that aren't found in \"toKeys\" from the node in \"fromPath\"\"\n         */\n        function makeInheritedParamsNode(toNode) {\n            // All param values for the node (may include default key/vals, when key was not found in toParams)\n            var toParamVals = extend({}, toNode && toNode.paramValues);\n            // limited to only those keys found in toParams\n            var incomingParamVals = pick(toParamVals, toKeys);\n            toParamVals = omit(toParamVals, toKeys);\n            var fromParamVals = omit(nodeParamVals(fromPath, toNode.state) || {}, noInherit);\n            // extend toParamVals with any fromParamVals, then override any of those those with incomingParamVals\n            var ownParamVals = extend(toParamVals, fromParamVals, incomingParamVals);\n            return new PathNode(toNode.state).applyRawParams(ownParamVals);\n        }\n        // The param keys specified by the incoming toParams\n        return toPath.map(makeInheritedParamsNode);\n    };\n    /**\n     * Computes the tree changes (entering, exiting) between a fromPath and toPath.\n     */\n    PathUtils.treeChanges = function (fromPath, toPath, reloadState) {\n        var keep = 0, max = Math.min(fromPath.length, toPath.length);\n        var nodesMatch = function (node1, node2) {\n            return node1.equals(node2, PathUtils.nonDynamicParams);\n        };\n        while (keep < max && fromPath[keep].state !== reloadState && nodesMatch(fromPath[keep], toPath[keep])) {\n            keep++;\n        }\n        /** Given a retained node, return a new node which uses the to node's param values */\n        function applyToParams(retainedNode, idx) {\n            var cloned = PathNode.clone(retainedNode);\n            cloned.paramValues = toPath[idx].paramValues;\n            return cloned;\n        }\n        var from, retained, exiting, entering, to;\n        from = fromPath;\n        retained = from.slice(0, keep);\n        exiting = from.slice(keep);\n        // Create a new retained path (with shallow copies of nodes) which have the params of the toPath mapped\n        var retainedWithToParams = retained.map(applyToParams);\n        entering = toPath.slice(keep);\n        to = (retainedWithToParams).concat(entering);\n        return { from: from, to: to, retained: retained, exiting: exiting, entering: entering };\n    };\n    /**\n     * Returns a new path which is: the subpath of the first path which matches the second path.\n     *\n     * The new path starts from root and contains any nodes that match the nodes in the second path.\n     * It stops before the first non-matching node.\n     *\n     * Nodes are compared using their state property and their parameter values.\n     * If a `paramsFn` is provided, only the [[Param]] returned by the function will be considered when comparing nodes.\n     *\n     * @param pathA the first path\n     * @param pathB the second path\n     * @param paramsFn a function which returns the parameters to consider when comparing\n     *\n     * @returns an array of PathNodes from the first path which match the nodes in the second path\n     */\n    PathUtils.matching = function (pathA, pathB, paramsFn) {\n        var done = false;\n        var tuples = arrayTuples(pathA, pathB);\n        return tuples.reduce(function (matching, _a) {\n            var nodeA = _a[0], nodeB = _a[1];\n            done = done || !nodeA.equals(nodeB, paramsFn);\n            return done ? matching : matching.concat(nodeA);\n        }, []);\n    };\n    /**\n     * Returns true if two paths are identical.\n     *\n     * @param pathA\n     * @param pathB\n     * @param paramsFn a function which returns the parameters to consider when comparing\n     * @returns true if the the states and parameter values for both paths are identical\n     */\n    PathUtils.equals = function (pathA, pathB, paramsFn) {\n        return pathA.length === pathB.length &&\n            PathUtils.matching(pathA, pathB, paramsFn).length === pathA.length;\n    };\n    /**\n     * Return a subpath of a path, which stops at the first matching node\n     *\n     * Given an array of nodes, returns a subset of the array starting from the first node,\n     * stopping when the first node matches the predicate.\n     *\n     * @param path a path of [[PathNode]]s\n     * @param predicate a [[Predicate]] fn that matches [[PathNode]]s\n     * @returns a subpath up to the matching node, or undefined if no match is found\n     */\n    PathUtils.subPath = function (path, predicate) {\n        var node = find(path, predicate);\n        var elementIdx = path.indexOf(node);\n        return elementIdx === -1 ? undefined : path.slice(0, elementIdx + 1);\n    };\n    return PathUtils;\n}());\nPathUtils.nonDynamicParams = function (node) {\n    return node.state.parameters({ inherit: false })\n        .filter(function (param) { return !param.dynamic; });\n};\n/** Gets the raw parameter values from a path */\nPathUtils.paramValues = function (path) {\n    return path.reduce(function (acc, node) { return extend(acc, node.paramValues); }, {});\n};\n\n/**\n * @coreapi\n * @module resolve\n */ /** for typedoc */\n// TODO: explicitly make this user configurable\nvar defaultResolvePolicy = {\n    when: \"LAZY\",\n    async: \"WAIT\"\n};\n/**\n * The basic building block for the resolve system.\n *\n * Resolvables encapsulate a state's resolve's resolveFn, the resolveFn's declared dependencies, the wrapped (.promise),\n * and the unwrapped-when-complete (.data) result of the resolveFn.\n *\n * Resolvable.get() either retrieves the Resolvable's existing promise, or else invokes resolve() (which invokes the\n * resolveFn) and returns the resulting promise.\n *\n * Resolvable.get() and Resolvable.resolve() both execute within a context path, which is passed as the first\n * parameter to those fns.\n */\nvar Resolvable = (function () {\n    function Resolvable(arg1, resolveFn, deps, policy, data) {\n        this.resolved = false;\n        this.promise = undefined;\n        if (arg1 instanceof Resolvable) {\n            extend(this, arg1);\n        }\n        else if (isFunction(resolveFn)) {\n            if (arg1 == null || arg1 == undefined)\n                throw new Error(\"new Resolvable(): token argument is required\");\n            if (!isFunction(resolveFn))\n                throw new Error(\"new Resolvable(): resolveFn argument must be a function\");\n            this.token = arg1;\n            this.policy = policy;\n            this.resolveFn = resolveFn;\n            this.deps = deps || [];\n            this.data = data;\n            this.resolved = data !== undefined;\n            this.promise = this.resolved ? services.$q.when(this.data) : undefined;\n        }\n        else if (isObject(arg1) && arg1.token && isFunction(arg1.resolveFn)) {\n            var literal = arg1;\n            return new Resolvable(literal.token, literal.resolveFn, literal.deps, literal.policy, literal.data);\n        }\n    }\n    Resolvable.prototype.getPolicy = function (state) {\n        var thisPolicy = this.policy || {};\n        var statePolicy = state && state.resolvePolicy || {};\n        return {\n            when: thisPolicy.when || statePolicy.when || defaultResolvePolicy.when,\n            async: thisPolicy.async || statePolicy.async || defaultResolvePolicy.async,\n        };\n    };\n    /**\n     * Asynchronously resolve this Resolvable's data\n     *\n     * Given a ResolveContext that this Resolvable is found in:\n     * Wait for this Resolvable's dependencies, then invoke this Resolvable's function\n     * and update the Resolvable's state\n     */\n    Resolvable.prototype.resolve = function (resolveContext, trans) {\n        var _this = this;\n        var $q = services.$q;\n        // Gets all dependencies from ResolveContext and wait for them to be resolved\n        var getResolvableDependencies = function () {\n            return $q.all(resolveContext.getDependencies(_this).map(function (resolvable) {\n                return resolvable.get(resolveContext, trans);\n            }));\n        };\n        // Invokes the resolve function passing the resolved dependencies as arguments\n        var invokeResolveFn = function (resolvedDeps) {\n            return _this.resolveFn.apply(null, resolvedDeps);\n        };\n        /**\n         * For RXWAIT policy:\n         *\n         * Given an observable returned from a resolve function:\n         * - enables .cache() mode (this allows multicast subscribers)\n         * - then calls toPromise() (this triggers subscribe() and thus fetches)\n         * - Waits for the promise, then return the cached observable (not the first emitted value).\n         */\n        var waitForRx = function (observable$) {\n            var cached = observable$.cache(1);\n            return cached.take(1).toPromise().then(function () { return cached; });\n        };\n        // If the resolve policy is RXWAIT, wait for the observable to emit something. otherwise pass through.\n        var node = resolveContext.findNode(this);\n        var state = node && node.state;\n        var maybeWaitForRx = this.getPolicy(state).async === \"RXWAIT\" ? waitForRx : identity;\n        // After the final value has been resolved, update the state of the Resolvable\n        var applyResolvedValue = function (resolvedValue) {\n            _this.data = resolvedValue;\n            _this.resolved = true;\n            trace.traceResolvableResolved(_this, trans);\n            return _this.data;\n        };\n        // Sets the promise property first, then getsResolvableDependencies in the context of the promise chain. Always waits one tick.\n        return this.promise = $q.when()\n            .then(getResolvableDependencies)\n            .then(invokeResolveFn)\n            .then(maybeWaitForRx)\n            .then(applyResolvedValue);\n    };\n    /**\n     * Gets a promise for this Resolvable's data.\n     *\n     * Fetches the data and returns a promise.\n     * Returns the existing promise if it has already been fetched once.\n     */\n    Resolvable.prototype.get = function (resolveContext, trans) {\n        return this.promise || this.resolve(resolveContext, trans);\n    };\n    Resolvable.prototype.toString = function () {\n        return \"Resolvable(token: \" + stringify(this.token) + \", requires: [\" + this.deps.map(stringify) + \"])\";\n    };\n    Resolvable.prototype.clone = function () {\n        return new Resolvable(this);\n    };\n    return Resolvable;\n}());\nResolvable.fromData = function (token, data) {\n    return new Resolvable(token, function () { return data; }, null, null, data);\n};\n\n/** @internalapi */\nvar resolvePolicies = {\n    when: {\n        LAZY: \"LAZY\",\n        EAGER: \"EAGER\"\n    },\n    async: {\n        WAIT: \"WAIT\",\n        NOWAIT: \"NOWAIT\",\n        RXWAIT: \"RXWAIT\"\n    }\n};\n\n/** @module resolve */\n/** for typedoc */\nvar when = resolvePolicies.when;\nvar ALL_WHENS = [when.EAGER, when.LAZY];\nvar EAGER_WHENS = [when.EAGER];\nvar NATIVE_INJECTOR_TOKEN = \"Native Injector\";\n/**\n * Encapsulates Dependency Injection for a path of nodes\n *\n * UI-Router states are organized as a tree.\n * A nested state has a path of ancestors to the root of the tree.\n * When a state is being activated, each element in the path is wrapped as a [[PathNode]].\n * A `PathNode` is a stateful object that holds things like parameters and resolvables for the state being activated.\n *\n * The ResolveContext closes over the [[PathNode]]s, and provides DI for the last node in the path.\n */\nvar ResolveContext = (function () {\n    function ResolveContext(_path) {\n        this._path = _path;\n    }\n    /** Gets all the tokens found in the resolve context, de-duplicated */\n    ResolveContext.prototype.getTokens = function () {\n        return this._path.reduce(function (acc, node) { return acc.concat(node.resolvables.map(function (r) { return r.token; })); }, []).reduce(uniqR, []);\n    };\n    /**\n     * Gets the Resolvable that matches the token\n     *\n     * Gets the last Resolvable that matches the token in this context, or undefined.\n     * Throws an error if it doesn't exist in the ResolveContext\n     */\n    ResolveContext.prototype.getResolvable = function (token) {\n        var matching = this._path.map(function (node) { return node.resolvables; })\n            .reduce(unnestR, [])\n            .filter(function (r) { return r.token === token; });\n        return tail(matching);\n    };\n    /** Returns the [[ResolvePolicy]] for the given [[Resolvable]] */\n    ResolveContext.prototype.getPolicy = function (resolvable) {\n        var node = this.findNode(resolvable);\n        return resolvable.getPolicy(node.state);\n    };\n    /**\n     * Returns a ResolveContext that includes a portion of this one\n     *\n     * Given a state, this method creates a new ResolveContext from this one.\n     * The new context starts at the first node (root) and stops at the node for the `state` parameter.\n     *\n     * #### Why\n     *\n     * When a transition is created, the nodes in the \"To Path\" are injected from a ResolveContext.\n     * A ResolveContext closes over a path of [[PathNode]]s and processes the resolvables.\n     * The \"To State\" can inject values from its own resolvables, as well as those from all its ancestor state's (node's).\n     * This method is used to create a narrower context when injecting ancestor nodes.\n     *\n     * @example\n     * `let ABCD = new ResolveContext([A, B, C, D]);`\n     *\n     * Given a path `[A, B, C, D]`, where `A`, `B`, `C` and `D` are nodes for states `a`, `b`, `c`, `d`:\n     * When injecting `D`, `D` should have access to all resolvables from `A`, `B`, `C`, `D`.\n     * However, `B` should only be able to access resolvables from `A`, `B`.\n     *\n     * When resolving for the `B` node, first take the full \"To Path\" Context `[A,B,C,D]` and limit to the subpath `[A,B]`.\n     * `let AB = ABCD.subcontext(a)`\n     */\n    ResolveContext.prototype.subContext = function (state) {\n        return new ResolveContext(PathUtils.subPath(this._path, function (node) { return node.state === state; }));\n    };\n    /**\n     * Adds Resolvables to the node that matches the state\n     *\n     * This adds a [[Resolvable]] (generally one created on the fly; not declared on a [[StateDeclaration.resolve]] block).\n     * The resolvable is added to the node matching the `state` parameter.\n     *\n     * These new resolvables are not automatically fetched.\n     * The calling code should either fetch them, fetch something that depends on them,\n     * or rely on [[resolvePath]] being called when some state is being entered.\n     *\n     * Note: each resolvable's [[ResolvePolicy]] is merged with the state's policy, and the global default.\n     *\n     * @param newResolvables the new Resolvables\n     * @param state Used to find the node to put the resolvable on\n     */\n    ResolveContext.prototype.addResolvables = function (newResolvables, state) {\n        var node = find(this._path, propEq('state', state));\n        var keys = newResolvables.map(function (r) { return r.token; });\n        node.resolvables = node.resolvables.filter(function (r) { return keys.indexOf(r.token) === -1; }).concat(newResolvables);\n    };\n    /**\n     * Returns a promise for an array of resolved path Element promises\n     *\n     * @param when\n     * @param trans\n     * @returns {Promise<any>|any}\n     */\n    ResolveContext.prototype.resolvePath = function (when, trans) {\n        var _this = this;\n        if (when === void 0) { when = \"LAZY\"; }\n        // This option determines which 'when' policy Resolvables we are about to fetch.\n        var whenOption = inArray(ALL_WHENS, when) ? when : \"LAZY\";\n        // If the caller specified EAGER, only the EAGER Resolvables are fetched.\n        // if the caller specified LAZY, both EAGER and LAZY Resolvables are fetched.`\n        var matchedWhens = whenOption === resolvePolicies.when.EAGER ? EAGER_WHENS : ALL_WHENS;\n        // get the subpath to the state argument, if provided\n        trace.traceResolvePath(this._path, when, trans);\n        var matchesPolicy = function (acceptedVals, whenOrAsync) {\n            return function (resolvable) {\n                return inArray(acceptedVals, _this.getPolicy(resolvable)[whenOrAsync]);\n            };\n        };\n        // Trigger all the (matching) Resolvables in the path\n        // Reduce all the \"WAIT\" Resolvables into an array\n        var promises = this._path.reduce(function (acc, node) {\n            var nodeResolvables = node.resolvables.filter(matchesPolicy(matchedWhens, 'when'));\n            var nowait = nodeResolvables.filter(matchesPolicy(['NOWAIT'], 'async'));\n            var wait = nodeResolvables.filter(not(matchesPolicy(['NOWAIT'], 'async')));\n            // For the matching Resolvables, start their async fetch process.\n            var subContext = _this.subContext(node.state);\n            var getResult = function (r) { return r.get(subContext, trans)\n                .then(function (value) { return ({ token: r.token, value: value }); }); };\n            nowait.forEach(getResult);\n            return acc.concat(wait.map(getResult));\n        }, []);\n        // Wait for all the \"WAIT\" resolvables\n        return services.$q.all(promises);\n    };\n    ResolveContext.prototype.injector = function () {\n        return this._injector || (this._injector = new UIInjectorImpl(this));\n    };\n    ResolveContext.prototype.findNode = function (resolvable) {\n        return find(this._path, function (node) { return inArray(node.resolvables, resolvable); });\n    };\n    /**\n     * Gets the async dependencies of a Resolvable\n     *\n     * Given a Resolvable, returns its dependencies as a Resolvable[]\n     */\n    ResolveContext.prototype.getDependencies = function (resolvable) {\n        var _this = this;\n        var node = this.findNode(resolvable);\n        // Find which other resolvables are \"visible\" to the `resolvable` argument\n        // subpath stopping at resolvable's node, or the whole path (if the resolvable isn't in the path)\n        var subPath = PathUtils.subPath(this._path, function (x) { return x === node; }) || this._path;\n        var availableResolvables = subPath\n            .reduce(function (acc, node) { return acc.concat(node.resolvables); }, []) //all of subpath's resolvables\n            .filter(function (res) { return res !== resolvable; }); // filter out the `resolvable` argument\n        var getDependency = function (token) {\n            var matching = availableResolvables.filter(function (r) { return r.token === token; });\n            if (matching.length)\n                return tail(matching);\n            var fromInjector = _this.injector().getNative(token);\n            if (!fromInjector) {\n                throw new Error(\"Could not find Dependency Injection token: \" + stringify(token));\n            }\n            return new Resolvable(token, function () { return fromInjector; }, [], fromInjector);\n        };\n        return resolvable.deps.map(getDependency);\n    };\n    return ResolveContext;\n}());\nvar UIInjectorImpl = (function () {\n    function UIInjectorImpl(context) {\n        this.context = context;\n        this.native = this.get(NATIVE_INJECTOR_TOKEN) || services.$injector;\n    }\n    UIInjectorImpl.prototype.get = function (token) {\n        var resolvable = this.context.getResolvable(token);\n        if (resolvable) {\n            if (this.context.getPolicy(resolvable).async === 'NOWAIT') {\n                return resolvable.get(this.context);\n            }\n            if (!resolvable.resolved) {\n                throw new Error(\"Resolvable async .get() not complete:\" + stringify(resolvable.token));\n            }\n            return resolvable.data;\n        }\n        return this.native && this.native.get(token);\n    };\n    UIInjectorImpl.prototype.getAsync = function (token) {\n        var resolvable = this.context.getResolvable(token);\n        if (resolvable)\n            return resolvable.get(this.context);\n        return services.$q.when(this.native.get(token));\n    };\n    UIInjectorImpl.prototype.getNative = function (token) {\n        return this.native && this.native.get(token);\n    };\n    return UIInjectorImpl;\n}());\n\n/**\n * @coreapi\n * @module transition\n */\n/** for typedoc */\n/** @hidden */\nvar stateSelf = prop(\"self\");\n/**\n * Represents a transition between two states.\n *\n * When navigating to a state, we are transitioning **from** the current state **to** the new state.\n *\n * This object contains all contextual information about the to/from states, parameters, resolves.\n * It has information about all states being entered and exited as a result of the transition.\n */\nvar Transition = (function () {\n    /**\n     * Creates a new Transition object.\n     *\n     * If the target state is not valid, an error is thrown.\n     *\n     * @internalapi\n     *\n     * @param fromPath The path of [[PathNode]]s from which the transition is leaving.  The last node in the `fromPath`\n     *        encapsulates the \"from state\".\n     * @param targetState The target state and parameters being transitioned to (also, the transition options)\n     * @param router The [[UIRouter]] instance\n     */\n    function Transition(fromPath, targetState, router) {\n        var _this = this;\n        /** @hidden */\n        this._deferred = services.$q.defer();\n        /**\n         * This promise is resolved or rejected based on the outcome of the Transition.\n         *\n         * When the transition is successful, the promise is resolved\n         * When the transition is unsuccessful, the promise is rejected with the [[Rejection]] or javascript error\n         */\n        this.promise = this._deferred.promise;\n        /** @hidden Holds the hook registration functions such as those passed to Transition.onStart() */\n        this._registeredHooks = {};\n        /** @hidden */\n        this._hookBuilder = new HookBuilder(this);\n        /** Checks if this transition is currently active/running. */\n        this.isActive = function () {\n            return _this.router.globals.transition === _this;\n        };\n        this.router = router;\n        this._targetState = targetState;\n        if (!targetState.valid()) {\n            throw new Error(targetState.error());\n        }\n        // current() is assumed to come from targetState.options, but provide a naive implementation otherwise.\n        this._options = extend({ current: val(this) }, targetState.options());\n        this.$id = router.transitionService._transitionCount++;\n        var toPath = PathUtils.buildToPath(fromPath, targetState);\n        this._treeChanges = PathUtils.treeChanges(fromPath, toPath, this._options.reloadState);\n        this.createTransitionHookRegFns();\n        var onCreateHooks = this._hookBuilder.buildHooksForPhase(exports.TransitionHookPhase.CREATE);\n        TransitionHook.invokeHooks(onCreateHooks, function () { return null; });\n        this.applyViewConfigs(router);\n    }\n    /** @hidden */\n    Transition.prototype.onBefore = function (criteria, callback, options) { return; };\n    /** @inheritdoc */\n    Transition.prototype.onStart = function (criteria, callback, options) { return; };\n    /** @inheritdoc */\n    Transition.prototype.onExit = function (criteria, callback, options) { return; };\n    /** @inheritdoc */\n    Transition.prototype.onRetain = function (criteria, callback, options) { return; };\n    /** @inheritdoc */\n    Transition.prototype.onEnter = function (criteria, callback, options) { return; };\n    /** @inheritdoc */\n    Transition.prototype.onFinish = function (criteria, callback, options) { return; };\n    /** @inheritdoc */\n    Transition.prototype.onSuccess = function (criteria, callback, options) { return; };\n    /** @inheritdoc */\n    Transition.prototype.onError = function (criteria, callback, options) { return; };\n    /** @hidden\n     * Creates the transition-level hook registration functions\n     * (which can then be used to register hooks)\n     */\n    Transition.prototype.createTransitionHookRegFns = function () {\n        var _this = this;\n        this.router.transitionService._pluginapi._getEvents()\n            .filter(function (type) { return type.hookPhase !== exports.TransitionHookPhase.CREATE; })\n            .forEach(function (type) { return makeEvent(_this, _this.router.transitionService, type); });\n    };\n    /** @internalapi */\n    Transition.prototype.getHooks = function (hookName) {\n        return this._registeredHooks[hookName];\n    };\n    Transition.prototype.applyViewConfigs = function (router) {\n        var enteringStates = this._treeChanges.entering.map(function (node) { return node.state; });\n        PathUtils.applyViewConfigs(router.transitionService.$view, this._treeChanges.to, enteringStates);\n    };\n    /**\n     * @internalapi\n     *\n     * @returns the internal from [State] object\n     */\n    Transition.prototype.$from = function () {\n        return tail(this._treeChanges.from).state;\n    };\n    /**\n     * @internalapi\n     *\n     * @returns the internal to [State] object\n     */\n    Transition.prototype.$to = function () {\n        return tail(this._treeChanges.to).state;\n    };\n    /**\n     * Returns the \"from state\"\n     *\n     * Returns the state that the transition is coming *from*.\n     *\n     * @returns The state declaration object for the Transition's (\"from state\").\n     */\n    Transition.prototype.from = function () {\n        return this.$from().self;\n    };\n    /**\n     * Returns the \"to state\"\n     *\n     * Returns the state that the transition is going *to*.\n     *\n     * @returns The state declaration object for the Transition's target state (\"to state\").\n     */\n    Transition.prototype.to = function () {\n        return this.$to().self;\n    };\n    /**\n     * Gets the Target State\n     *\n     * A transition's [[TargetState]] encapsulates the [[to]] state, the [[params]], and the [[options]] as a single object.\n     *\n     * @returns the [[TargetState]] of this Transition\n     */\n    Transition.prototype.targetState = function () {\n        return this._targetState;\n    };\n    /**\n     * Determines whether two transitions are equivalent.\n     * @deprecated\n     */\n    Transition.prototype.is = function (compare) {\n        if (compare instanceof Transition) {\n            // TODO: Also compare parameters\n            return this.is({ to: compare.$to().name, from: compare.$from().name });\n        }\n        return !((compare.to && !matchState(this.$to(), compare.to)) ||\n            (compare.from && !matchState(this.$from(), compare.from)));\n    };\n    Transition.prototype.params = function (pathname) {\n        if (pathname === void 0) { pathname = \"to\"; }\n        return Object.freeze(this._treeChanges[pathname].map(prop(\"paramValues\")).reduce(mergeR, {}));\n    };\n    /**\n     * Creates a [[UIInjector]] Dependency Injector\n     *\n     * Returns a Dependency Injector for the Transition's target state (to state).\n     * The injector provides resolve values which the target state has access to.\n     *\n     * The `UIInjector` can also provide values from the native root/global injector (ng1/ng2).\n     *\n     * #### Example:\n     * ```js\n     * .onEnter({ entering: 'myState' }, trans => {\n     *   var myResolveValue = trans.injector().get('myResolve');\n     *   // Inject a global service from the global/native injector (if it exists)\n     *   var MyService = trans.injector().get('MyService');\n     * })\n     * ```\n     *\n     * In some cases (such as `onBefore`), you may need access to some resolve data but it has not yet been fetched.\n     * You can use [[UIInjector.getAsync]] to get a promise for the data.\n     * #### Example:\n     * ```js\n     * .onBefore({}, trans => {\n     *   return trans.injector().getAsync('myResolve').then(myResolveValue =>\n     *     return myResolveValue !== 'ABORT';\n     *   });\n     * });\n     * ```\n     *\n     * If a `state` is provided, the injector that is returned will be limited to resolve values that the provided state has access to.\n     * This can be useful if both a parent state `foo` and a child state `foo.bar` have both defined a resolve such as `data`.\n     * #### Example:\n     * ```js\n     * .onEnter({ to: 'foo.bar' }, trans => {\n     *   // returns result of `foo` state's `data` resolve\n     *   // even though `foo.bar` also has a `data` resolve\n     *   var fooData = trans.injector('foo').get('data');\n     * });\n     * ```\n     *\n     * If you need resolve data from the exiting states, pass `'from'` as `pathName`.\n     * The resolve data from the `from` path will be returned.\n     * #### Example:\n     * ```js\n     * .onExit({ exiting: 'foo.bar' }, trans => {\n     *   // Gets the resolve value of `data` from the exiting state.\n     *   var fooData = trans.injector(null, 'foo.bar').get('data');\n     * });\n     * ```\n     *\n     *\n     * @param state Limits the resolves provided to only the resolves the provided state has access to.\n     * @param pathName Default: `'to'`: Chooses the path for which to create the injector. Use this to access resolves for `exiting` states.\n     *\n     * @returns a [[UIInjector]]\n     */\n    Transition.prototype.injector = function (state, pathName) {\n        if (pathName === void 0) { pathName = \"to\"; }\n        var path = this._treeChanges[pathName];\n        if (state)\n            path = PathUtils.subPath(path, function (node) { return node.state === state || node.state.name === state; });\n        return new ResolveContext(path).injector();\n    };\n    /**\n     * Gets all available resolve tokens (keys)\n     *\n     * This method can be used in conjunction with [[injector]] to inspect the resolve values\n     * available to the Transition.\n     *\n     * This returns all the tokens defined on [[StateDeclaration.resolve]] blocks, for the states\n     * in the Transition's [[TreeChanges.to]] path.\n     *\n     * #### Example:\n     * This example logs all resolve values\n     * ```js\n     * let tokens = trans.getResolveTokens();\n     * tokens.forEach(token => console.log(token + \" = \" + trans.injector().get(token)));\n     * ```\n     *\n     * #### Example:\n     * This example creates promises for each resolve value.\n     * This triggers fetches of resolves (if any have not yet been fetched).\n     * When all promises have all settled, it logs the resolve values.\n     * ```js\n     * let tokens = trans.getResolveTokens();\n     * let promise = tokens.map(token => trans.injector().getAsync(token));\n     * Promise.all(promises).then(values => console.log(\"Resolved values: \" + values));\n     * ```\n     *\n     * Note: Angular 1 users whould use `$q.all()`\n     *\n     * @param pathname resolve context's path name (e.g., `to` or `from`)\n     *\n     * @returns an array of resolve tokens (keys)\n     */\n    Transition.prototype.getResolveTokens = function (pathname) {\n        if (pathname === void 0) { pathname = \"to\"; }\n        return new ResolveContext(this._treeChanges[pathname]).getTokens();\n    };\n    /**\n     * Dynamically adds a new [[Resolvable]] (i.e., [[StateDeclaration.resolve]]) to this transition.\n     *\n     * #### Example:\n     * ```js\n     * transitionService.onBefore({}, transition => {\n     *   transition.addResolvable({\n     *     token: 'myResolve',\n     *     deps: ['MyService'],\n     *     resolveFn: myService => myService.getData()\n     *   });\n     * });\n     * ```\n     *\n     * @param resolvable a [[ResolvableLiteral]] object (or a [[Resolvable]])\n     * @param state the state in the \"to path\" which should receive the new resolve (otherwise, the root state)\n     */\n    Transition.prototype.addResolvable = function (resolvable, state) {\n        if (state === void 0) { state = \"\"; }\n        resolvable = is(Resolvable)(resolvable) ? resolvable : new Resolvable(resolvable);\n        var stateName = (typeof state === \"string\") ? state : state.name;\n        var topath = this._treeChanges.to;\n        var targetNode = find(topath, function (node) { return node.state.name === stateName; });\n        var resolveContext = new ResolveContext(topath);\n        resolveContext.addResolvables([resolvable], targetNode.state);\n    };\n    /**\n     * Gets the transition from which this transition was redirected.\n     *\n     * If the current transition is a redirect, this method returns the transition that was redirected.\n     *\n     * #### Example:\n     * ```js\n     * let transitionA = $state.go('A').transition\n     * transitionA.onStart({}, () => $state.target('B'));\n     * $transitions.onSuccess({ to: 'B' }, (trans) => {\n     *   trans.to().name === 'B'; // true\n     *   trans.redirectedFrom() === transitionA; // true\n     * });\n     * ```\n     *\n     * @returns The previous Transition, or null if this Transition is not the result of a redirection\n     */\n    Transition.prototype.redirectedFrom = function () {\n        return this._options.redirectedFrom || null;\n    };\n    /**\n     * Gets the original transition in a redirect chain\n     *\n     * A transition might belong to a long chain of multiple redirects.\n     * This method walks the [[redirectedFrom]] chain back to the original (first) transition in the chain.\n     *\n     * #### Example:\n     * ```js\n     * // states\n     * registry.register({ name: 'A', redirectTo: 'B' });\n     * registry.register({ name: 'B', redirectTo: 'C' });\n     * registry.register({ name: 'C', redirectTo: 'D' });\n     * registry.register({ name: 'D' });\n     *\n     * let transitionA = $state.go('A').transition\n     *\n     * $transitions.onSuccess({ to: 'D' }, (trans) => {\n     *   trans.to().name === 'D'; // true\n     *   trans.redirectedFrom().to().name === 'C'; // true\n     *   trans.originalTransition() === transitionA; // true\n     *   trans.originalTransition().to().name === 'A'; // true\n     * });\n     * ```\n     *\n     * @returns The original Transition that started a redirect chain\n     */\n    Transition.prototype.originalTransition = function () {\n        var rf = this.redirectedFrom();\n        return (rf && rf.originalTransition()) || this;\n    };\n    /**\n     * Get the transition options\n     *\n     * @returns the options for this Transition.\n     */\n    Transition.prototype.options = function () {\n        return this._options;\n    };\n    /**\n     * Gets the states being entered.\n     *\n     * @returns an array of states that will be entered during this transition.\n     */\n    Transition.prototype.entering = function () {\n        return map(this._treeChanges.entering, prop('state')).map(stateSelf);\n    };\n    /**\n     * Gets the states being exited.\n     *\n     * @returns an array of states that will be exited during this transition.\n     */\n    Transition.prototype.exiting = function () {\n        return map(this._treeChanges.exiting, prop('state')).map(stateSelf).reverse();\n    };\n    /**\n     * Gets the states being retained.\n     *\n     * @returns an array of states that are already entered from a previous Transition, that will not be\n     *    exited during this Transition\n     */\n    Transition.prototype.retained = function () {\n        return map(this._treeChanges.retained, prop('state')).map(stateSelf);\n    };\n    /**\n     * Get the [[ViewConfig]]s associated with this Transition\n     *\n     * Each state can define one or more views (template/controller), which are encapsulated as `ViewConfig` objects.\n     * This method fetches the `ViewConfigs` for a given path in the Transition (e.g., \"to\" or \"entering\").\n     *\n     * @param pathname the name of the path to fetch views for:\n     *   (`'to'`, `'from'`, `'entering'`, `'exiting'`, `'retained'`)\n     * @param state If provided, only returns the `ViewConfig`s for a single state in the path\n     *\n     * @returns a list of ViewConfig objects for the given path.\n     */\n    Transition.prototype.views = function (pathname, state) {\n        if (pathname === void 0) { pathname = \"entering\"; }\n        var path = this._treeChanges[pathname];\n        path = !state ? path : path.filter(propEq('state', state));\n        return path.map(prop(\"views\")).filter(identity).reduce(unnestR, []);\n    };\n    Transition.prototype.treeChanges = function (pathname) {\n        return pathname ? this._treeChanges[pathname] : this._treeChanges;\n    };\n    /**\n     * Creates a new transition that is a redirection of the current one.\n     *\n     * This transition can be returned from a [[TransitionService]] hook to\n     * redirect a transition to a new state and/or set of parameters.\n     *\n     * @internalapi\n     *\n     * @returns Returns a new [[Transition]] instance.\n     */\n    Transition.prototype.redirect = function (targetState) {\n        var redirects = 1, trans = this;\n        while ((trans = trans.redirectedFrom()) != null) {\n            if (++redirects > 20)\n                throw new Error(\"Too many consecutive Transition redirects (20+)\");\n        }\n        var redirectOpts = { redirectedFrom: this, source: \"redirect\" };\n        // If the original transition was caused by URL sync, then use { location: 'replace' }\n        // on the new transition (unless the target state explicitly specifies location: false).\n        // This causes the original url to be replaced with the url for the redirect target\n        // so the original url disappears from the browser history.\n        if (this.options().source === 'url' && targetState.options().location !== false) {\n            redirectOpts.location = 'replace';\n        }\n        var newOptions = extend({}, this.options(), targetState.options(), redirectOpts);\n        targetState = new TargetState(targetState.identifier(), targetState.$state(), targetState.params(), newOptions);\n        var newTransition = this.router.transitionService.create(this._treeChanges.from, targetState);\n        var originalEnteringNodes = this._treeChanges.entering;\n        var redirectEnteringNodes = newTransition._treeChanges.entering;\n        // --- Re-use resolve data from original transition ---\n        // When redirecting from a parent state to a child state where the parent parameter values haven't changed\n        // (because of the redirect), the resolves fetched by the original transition are still valid in the\n        // redirected transition.\n        //\n        // This allows you to define a redirect on a parent state which depends on an async resolve value.\n        // You can wait for the resolve, then redirect to a child state based on the result.\n        // The redirected transition does not have to re-fetch the resolve.\n        // ---------------------------------------------------------\n        var nodeIsReloading = function (reloadState) { return function (node) {\n            return reloadState && node.state.includes[reloadState.name];\n        }; };\n        // Find any \"entering\" nodes in the redirect path that match the original path and aren't being reloaded\n        var matchingEnteringNodes = PathUtils.matching(redirectEnteringNodes, originalEnteringNodes, PathUtils.nonDynamicParams)\n            .filter(not(nodeIsReloading(targetState.options().reloadState)));\n        // Use the existing (possibly pre-resolved) resolvables for the matching entering nodes.\n        matchingEnteringNodes.forEach(function (node, idx) {\n            node.resolvables = originalEnteringNodes[idx].resolvables;\n        });\n        return newTransition;\n    };\n    /** @hidden If a transition doesn't exit/enter any states, returns any [[Param]] whose value changed */\n    Transition.prototype._changedParams = function () {\n        var tc = this._treeChanges;\n        /** Return undefined if it's not a \"dynamic\" transition, for the following reasons */\n        // If user explicitly wants a reload\n        if (this._options.reload)\n            return undefined;\n        // If any states are exiting or entering\n        if (tc.exiting.length || tc.entering.length)\n            return undefined;\n        // If to/from path lengths differ\n        if (tc.to.length !== tc.from.length)\n            return undefined;\n        // If the to/from paths are different\n        var pathsDiffer = arrayTuples(tc.to, tc.from)\n            .map(function (tuple) { return tuple[0].state !== tuple[1].state; })\n            .reduce(anyTrueR, false);\n        if (pathsDiffer)\n            return undefined;\n        // Find any parameter values that differ\n        var nodeSchemas = tc.to.map(function (node) { return node.paramSchema; });\n        var _a = [tc.to, tc.from].map(function (path) { return path.map(function (x) { return x.paramValues; }); }), toValues = _a[0], fromValues = _a[1];\n        var tuples = arrayTuples(nodeSchemas, toValues, fromValues);\n        return tuples.map(function (_a) {\n            var schema = _a[0], toVals = _a[1], fromVals = _a[2];\n            return Param.changed(schema, toVals, fromVals);\n        }).reduce(unnestR, []);\n    };\n    /**\n     * Returns true if the transition is dynamic.\n     *\n     * A transition is dynamic if no states are entered nor exited, but at least one dynamic parameter has changed.\n     *\n     * @returns true if the Transition is dynamic\n     */\n    Transition.prototype.dynamic = function () {\n        var changes = this._changedParams();\n        return !changes ? false : changes.map(function (x) { return x.dynamic; }).reduce(anyTrueR, false);\n    };\n    /**\n     * Returns true if the transition is ignored.\n     *\n     * A transition is ignored if no states are entered nor exited, and no parameter values have changed.\n     *\n     * @returns true if the Transition is ignored.\n     */\n    Transition.prototype.ignored = function () {\n        return !!this._ignoredReason();\n    };\n    /** @hidden */\n    Transition.prototype._ignoredReason = function () {\n        var pending = this.router.globals.transition;\n        var reloadState = this._options.reloadState;\n        var same = function (pathA, pathB) {\n            if (pathA.length !== pathB.length)\n                return false;\n            var matching = PathUtils.matching(pathA, pathB);\n            return pathA.length === matching.filter(function (node) { return !reloadState || !node.state.includes[reloadState.name]; }).length;\n        };\n        var newTC = this.treeChanges();\n        var pendTC = pending && pending.treeChanges();\n        if (pendTC && same(pendTC.to, newTC.to) && same(pendTC.exiting, newTC.exiting))\n            return \"SameAsPending\";\n        if (newTC.exiting.length === 0 && newTC.entering.length === 0 && same(newTC.from, newTC.to))\n            return \"SameAsCurrent\";\n    };\n    /**\n     * Runs the transition\n     *\n     * This method is generally called from the [[StateService.transitionTo]]\n     *\n     * @internalapi\n     *\n     * @returns a promise for a successful transition.\n     */\n    Transition.prototype.run = function () {\n        var _this = this;\n        var runAllHooks = TransitionHook.runAllHooks;\n        // Gets transition hooks array for the given phase\n        var getHooksFor = function (phase) {\n            return _this._hookBuilder.buildHooksForPhase(phase);\n        };\n        // When the chain is complete, then resolve or reject the deferred\n        var transitionSuccess = function () {\n            trace.traceSuccess(_this.$to(), _this);\n            _this.success = true;\n            _this._deferred.resolve(_this.to());\n            runAllHooks(getHooksFor(exports.TransitionHookPhase.SUCCESS));\n        };\n        var transitionError = function (reason) {\n            trace.traceError(reason, _this);\n            _this.success = false;\n            _this._deferred.reject(reason);\n            _this._error = reason;\n            runAllHooks(getHooksFor(exports.TransitionHookPhase.ERROR));\n        };\n        var runTransition = function () {\n            // Wait to build the RUN hook chain until the BEFORE hooks are done\n            // This allows a BEFORE hook to dynamically add additional RUN hooks via the Transition object.\n            var allRunHooks = getHooksFor(exports.TransitionHookPhase.RUN);\n            var done = function () { return services.$q.when(undefined); };\n            return TransitionHook.invokeHooks(allRunHooks, done);\n        };\n        var startTransition = function () {\n            var globals = _this.router.globals;\n            globals.lastStartedTransitionId = _this.$id;\n            globals.transition = _this;\n            globals.transitionHistory.enqueue(_this);\n            trace.traceTransitionStart(_this);\n            return services.$q.when(undefined);\n        };\n        var allBeforeHooks = getHooksFor(exports.TransitionHookPhase.BEFORE);\n        TransitionHook.invokeHooks(allBeforeHooks, startTransition)\n            .then(runTransition)\n            .then(transitionSuccess, transitionError);\n        return this.promise;\n    };\n    /**\n     * Checks if the Transition is valid\n     *\n     * @returns true if the Transition is valid\n     */\n    Transition.prototype.valid = function () {\n        return !this.error() || this.success !== undefined;\n    };\n    /**\n     * Aborts this transition\n     *\n     * Imperative API to abort a Transition.\n     * This only applies to Transitions that are not yet complete.\n     */\n    Transition.prototype.abort = function () {\n        // Do not set flag if the transition is already complete\n        if (isUndefined(this.success)) {\n            this._aborted = true;\n        }\n    };\n    /**\n     * The Transition error reason.\n     *\n     * If the transition is invalid (and could not be run), returns the reason the transition is invalid.\n     * If the transition was valid and ran, but was not successful, returns the reason the transition failed.\n     *\n     * @returns an error message explaining why the transition is invalid, or the reason the transition failed.\n     */\n    Transition.prototype.error = function () {\n        var state = this.$to();\n        if (state.self.abstract)\n            return \"Cannot transition to abstract state '\" + state.name + \"'\";\n        if (!Param.validates(state.parameters(), this.params()))\n            return \"Param values not valid for state '\" + state.name + \"'\";\n        if (this.success === false)\n            return this._error;\n    };\n    /**\n     * A string representation of the Transition\n     *\n     * @returns A string representation of the Transition\n     */\n    Transition.prototype.toString = function () {\n        var fromStateOrName = this.from();\n        var toStateOrName = this.to();\n        var avoidEmptyHash = function (params) {\n            return (params[\"#\"] !== null && params[\"#\"] !== undefined) ? params : omit(params, [\"#\"]);\n        };\n        // (X) means the to state is invalid.\n        var id = this.$id, from = isObject(fromStateOrName) ? fromStateOrName.name : fromStateOrName, fromParams = toJson(avoidEmptyHash(this._treeChanges.from.map(prop('paramValues')).reduce(mergeR, {}))), toValid = this.valid() ? \"\" : \"(X) \", to = isObject(toStateOrName) ? toStateOrName.name : toStateOrName, toParams = toJson(avoidEmptyHash(this.params()));\n        return \"Transition#\" + id + \"( '\" + from + \"'\" + fromParams + \" -> \" + toValid + \"'\" + to + \"'\" + toParams + \" )\";\n    };\n    return Transition;\n}());\n/** @hidden */\nTransition.diToken = Transition;\n\n/**\n * Functions that manipulate strings\n *\n * Although these functions are exported, they are subject to change without notice.\n *\n * @module common_strings\n */ /** */\n/**\n * Returns a string shortened to a maximum length\n *\n * If the string is already less than the `max` length, return the string.\n * Else return the string, shortened to `max - 3` and append three dots (\"...\").\n *\n * @param max the maximum length of the string to return\n * @param str the input string\n */\nfunction maxLength(max, str) {\n    if (str.length <= max)\n        return str;\n    return str.substr(0, max - 3) + \"...\";\n}\n/**\n * Returns a string, with spaces added to the end, up to a desired str length\n *\n * If the string is already longer than the desired length, return the string.\n * Else returns the string, with extra spaces on the end, such that it reaches `length` characters.\n *\n * @param length the desired length of the string to return\n * @param str the input string\n */\nfunction padString(length, str) {\n    while (str.length < length)\n        str += \" \";\n    return str;\n}\nfunction kebobString(camelCase) {\n    return camelCase\n        .replace(/^([A-Z])/, function ($1) { return $1.toLowerCase(); }) // replace first char\n        .replace(/([A-Z])/g, function ($1) { return \"-\" + $1.toLowerCase(); }); // replace rest\n}\nfunction functionToString(fn) {\n    var fnStr = fnToString(fn);\n    var namedFunctionMatch = fnStr.match(/^(function [^ ]+\\([^)]*\\))/);\n    var toStr = namedFunctionMatch ? namedFunctionMatch[1] : fnStr;\n    var fnName = fn['name'] || \"\";\n    if (fnName && toStr.match(/function \\(/)) {\n        return 'function ' + fnName + toStr.substr(9);\n    }\n    return toStr;\n}\nfunction fnToString(fn) {\n    var _fn = isArray(fn) ? fn.slice(-1)[0] : fn;\n    return _fn && _fn.toString() || \"undefined\";\n}\nvar stringifyPatternFn = null;\nvar stringifyPattern = function (value) {\n    var isRejection = Rejection.isRejectionPromise;\n    stringifyPatternFn = stringifyPatternFn || pattern([\n        [not(isDefined), val(\"undefined\")],\n        [isNull, val(\"null\")],\n        [isPromise, val(\"[Promise]\")],\n        [isRejection, function (x) { return x._transitionRejection.toString(); }],\n        [is(Rejection), invoke(\"toString\")],\n        [is(Transition), invoke(\"toString\")],\n        [is(Resolvable), invoke(\"toString\")],\n        [isInjectable, functionToString],\n        [val(true), identity]\n    ]);\n    return stringifyPatternFn(value);\n};\nfunction stringify(o) {\n    var seen = [];\n    function format(val$$1) {\n        if (isObject(val$$1)) {\n            if (seen.indexOf(val$$1) !== -1)\n                return '[circular ref]';\n            seen.push(val$$1);\n        }\n        return stringifyPattern(val$$1);\n    }\n    return JSON.stringify(o, function (key, val$$1) { return format(val$$1); }).replace(/\\\\\"/g, '\"');\n}\n/** Returns a function that splits a string on a character or substring */\nvar beforeAfterSubstr = function (char) { return function (str) {\n    if (!str)\n        return [\"\", \"\"];\n    var idx = str.indexOf(char);\n    if (idx === -1)\n        return [str, \"\"];\n    return [str.substr(0, idx), str.substr(idx + 1)];\n}; };\n/**\n * Splits on a delimiter, but returns the delimiters in the array\n *\n * #### Example:\n * ```js\n * var splitOnSlashes = splitOnDelim('/');\n * splitOnSlashes(\"/foo\"); // [\"/\", \"foo\"]\n * splitOnSlashes(\"/foo/\"); // [\"/\", \"foo\", \"/\"]\n * ```\n */\nfunction splitOnDelim(delim) {\n    var re = new RegExp(\"(\" + delim + \")\", \"g\");\n    return function (str) {\n        return str.split(re).filter(identity);\n    };\n}\n\n/**\n * Reduce fn that joins neighboring strings\n *\n * Given an array of strings, returns a new array\n * where all neighboring strings have been joined.\n *\n * #### Example:\n * ```js\n * let arr = [\"foo\", \"bar\", 1, \"baz\", \"\", \"qux\" ];\n * arr.reduce(joinNeighborsR, []) // [\"foobar\", 1, \"bazqux\" ]\n * ```\n */\nfunction joinNeighborsR(acc, x) {\n    if (isString(tail(acc)) && isString(x))\n        return acc.slice(0, -1).concat(tail(acc) + x);\n    return pushR(acc, x);\n}\n\n/** @module common */ /** for typedoc */\n\n/**\n * @coreapi\n * @module params\n */\n/** */\n/**\n * A registry for parameter types.\n *\n * This registry manages the built-in (and custom) parameter types.\n *\n * The built-in parameter types are:\n *\n * - [[string]]\n * - [[path]]\n * - [[query]]\n * - [[hash]]\n * - [[int]]\n * - [[bool]]\n * - [[date]]\n * - [[json]]\n * - [[any]]\n */\nvar ParamTypes = (function () {\n    /** @internalapi */\n    function ParamTypes() {\n        /** @hidden */\n        this.enqueue = true;\n        /** @hidden */\n        this.typeQueue = [];\n        /** @internalapi */\n        this.defaultTypes = pick(ParamTypes.prototype, [\"hash\", \"string\", \"query\", \"path\", \"int\", \"bool\", \"date\", \"json\", \"any\"]);\n        // Register default types. Store them in the prototype of this.types.\n        var makeType = function (definition, name) {\n            return new ParamType(extend({ name: name }, definition));\n        };\n        this.types = inherit(map(this.defaultTypes, makeType), {});\n    }\n    /** @internalapi */\n    ParamTypes.prototype.dispose = function () {\n        this.types = {};\n    };\n    /**\n     * Registers a parameter type\n     *\n     * End users should call [[UrlMatcherFactory.type]], which delegates to this method.\n     */\n    ParamTypes.prototype.type = function (name, definition, definitionFn) {\n        if (!isDefined(definition))\n            return this.types[name];\n        if (this.types.hasOwnProperty(name))\n            throw new Error(\"A type named '\" + name + \"' has already been defined.\");\n        this.types[name] = new ParamType(extend({ name: name }, definition));\n        if (definitionFn) {\n            this.typeQueue.push({ name: name, def: definitionFn });\n            if (!this.enqueue)\n                this._flushTypeQueue();\n        }\n        return this;\n    };\n    /** @internalapi */\n    ParamTypes.prototype._flushTypeQueue = function () {\n        while (this.typeQueue.length) {\n            var type = this.typeQueue.shift();\n            if (type.pattern)\n                throw new Error(\"You cannot override a type's .pattern at runtime.\");\n            extend(this.types[type.name], services.$injector.invoke(type.def));\n        }\n    };\n    return ParamTypes;\n}());\n/** @hidden */\nfunction initDefaultTypes() {\n    var makeDefaultType = function (def) {\n        var valToString = function (val$$1) {\n            return val$$1 != null ? val$$1.toString() : val$$1;\n        };\n        var defaultTypeBase = {\n            encode: valToString,\n            decode: valToString,\n            is: is(String),\n            pattern: /.*/,\n            equals: function (a, b) { return a == b; },\n        };\n        return extend({}, defaultTypeBase, def);\n    };\n    // Default Parameter Type Definitions\n    extend(ParamTypes.prototype, {\n        string: makeDefaultType({}),\n        path: makeDefaultType({\n            pattern: /[^/]*/,\n        }),\n        query: makeDefaultType({}),\n        hash: makeDefaultType({\n            inherit: false,\n        }),\n        int: makeDefaultType({\n            decode: function (val$$1) { return parseInt(val$$1, 10); },\n            is: function (val$$1) {\n                return !isNullOrUndefined(val$$1) && this.decode(val$$1.toString()) === val$$1;\n            },\n            pattern: /-?\\d+/,\n        }),\n        bool: makeDefaultType({\n            encode: function (val$$1) { return val$$1 && 1 || 0; },\n            decode: function (val$$1) { return parseInt(val$$1, 10) !== 0; },\n            is: is(Boolean),\n            pattern: /0|1/\n        }),\n        date: makeDefaultType({\n            encode: function (val$$1) {\n                return !this.is(val$$1) ? undefined : [\n                    val$$1.getFullYear(),\n                    ('0' + (val$$1.getMonth() + 1)).slice(-2),\n                    ('0' + val$$1.getDate()).slice(-2)\n                ].join(\"-\");\n            },\n            decode: function (val$$1) {\n                if (this.is(val$$1))\n                    return val$$1;\n                var match = this.capture.exec(val$$1);\n                return match ? new Date(match[1], match[2] - 1, match[3]) : undefined;\n            },\n            is: function (val$$1) { return val$$1 instanceof Date && !isNaN(val$$1.valueOf()); },\n            equals: function (l, r) {\n                return ['getFullYear', 'getMonth', 'getDate']\n                    .reduce(function (acc, fn) { return acc && l[fn]() === r[fn](); }, true);\n            },\n            pattern: /[0-9]{4}-(?:0[1-9]|1[0-2])-(?:0[1-9]|[1-2][0-9]|3[0-1])/,\n            capture: /([0-9]{4})-(0[1-9]|1[0-2])-(0[1-9]|[1-2][0-9]|3[0-1])/\n        }),\n        json: makeDefaultType({\n            encode: toJson,\n            decode: fromJson,\n            is: is(Object),\n            equals: equals,\n            pattern: /[^/]*/\n        }),\n        // does not encode/decode\n        any: makeDefaultType({\n            encode: identity,\n            decode: identity,\n            is: function () { return true; },\n            equals: equals,\n        }),\n    });\n}\ninitDefaultTypes();\n\n/**\n * @coreapi\n * @module params\n */\n/** */\n/** @internalapi */\nvar StateParams = (function () {\n    function StateParams(params) {\n        if (params === void 0) { params = {}; }\n        extend(this, params);\n    }\n    /**\n     * Merges a set of parameters with all parameters inherited between the common parents of the\n     * current state and a given destination state.\n     *\n     * @param {Object} newParams The set of parameters which will be composited with inherited params.\n     * @param {Object} $current Internal definition of object representing the current state.\n     * @param {Object} $to Internal definition of object representing state to transition to.\n     */\n    StateParams.prototype.$inherit = function (newParams, $current, $to) {\n        var parents = ancestors($current, $to), parentParams, inherited = {}, inheritList = [];\n        for (var i in parents) {\n            if (!parents[i] || !parents[i].params)\n                continue;\n            parentParams = Object.keys(parents[i].params);\n            if (!parentParams.length)\n                continue;\n            for (var j in parentParams) {\n                if (inheritList.indexOf(parentParams[j]) >= 0)\n                    continue;\n                inheritList.push(parentParams[j]);\n                inherited[parentParams[j]] = this[parentParams[j]];\n            }\n        }\n        return extend({}, inherited, newParams);\n    };\n    \n    return StateParams;\n}());\n\n/** @module path */ /** for typedoc */\n\n/** @module resolve */ /** for typedoc */\n\n/** @module state */ /** for typedoc */\nvar parseUrl = function (url) {\n    if (!isString(url))\n        return false;\n    var root = url.charAt(0) === '^';\n    return { val: root ? url.substring(1) : url, root: root };\n};\nfunction nameBuilder(state) {\n    return state.name;\n}\nfunction selfBuilder(state) {\n    state.self.$$state = function () { return state; };\n    return state.self;\n}\nfunction dataBuilder(state) {\n    if (state.parent && state.parent.data) {\n        state.data = state.self.data = inherit(state.parent.data, state.data);\n    }\n    return state.data;\n}\nvar getUrlBuilder = function ($urlMatcherFactoryProvider, root) {\n    return function urlBuilder(state) {\n        var stateDec = state;\n        // For future states, i.e., states whose name ends with `.**`,\n        // match anything that starts with the url prefix\n        if (stateDec && stateDec.url && stateDec.name && stateDec.name.match(/\\.\\*\\*$/)) {\n            stateDec.url += \"{remainder:any}\"; // match any path (.*)\n        }\n        var parsed = parseUrl(stateDec.url), parent = state.parent;\n        var url = !parsed ? stateDec.url : $urlMatcherFactoryProvider.compile(parsed.val, {\n            params: state.params || {},\n            paramMap: function (paramConfig, isSearch) {\n                if (stateDec.reloadOnSearch === false && isSearch)\n                    paramConfig = extend(paramConfig || {}, { dynamic: true });\n                return paramConfig;\n            }\n        });\n        if (!url)\n            return null;\n        if (!$urlMatcherFactoryProvider.isMatcher(url))\n            throw new Error(\"Invalid url '\" + url + \"' in state '\" + state + \"'\");\n        return (parsed && parsed.root) ? url : ((parent && parent.navigable) || root()).url.append(url);\n    };\n};\nvar getNavigableBuilder = function (isRoot) {\n    return function navigableBuilder(state) {\n        return !isRoot(state) && state.url ? state : (state.parent ? state.parent.navigable : null);\n    };\n};\nvar getParamsBuilder = function (paramFactory) {\n    return function paramsBuilder(state) {\n        var makeConfigParam = function (config, id) { return paramFactory.fromConfig(id, null, config); };\n        var urlParams = (state.url && state.url.parameters({ inherit: false })) || [];\n        var nonUrlParams = values(mapObj(omit(state.params || {}, urlParams.map(prop('id'))), makeConfigParam));\n        return urlParams.concat(nonUrlParams).map(function (p) { return [p.id, p]; }).reduce(applyPairs, {});\n    };\n};\nfunction pathBuilder(state) {\n    return state.parent ? state.parent.path.concat(state) : [state];\n}\nfunction includesBuilder(state) {\n    var includes = state.parent ? extend({}, state.parent.includes) : {};\n    includes[state.name] = true;\n    return includes;\n}\n/**\n * This is a [[StateBuilder.builder]] function for the `resolve:` block on a [[StateDeclaration]].\n *\n * When the [[StateBuilder]] builds a [[StateObject]] object from a raw [[StateDeclaration]], this builder\n * validates the `resolve` property and converts it to a [[Resolvable]] array.\n *\n * resolve: input value can be:\n *\n * {\n *   // analyzed but not injected\n *   myFooResolve: function() { return \"myFooData\"; },\n *\n *   // function.toString() parsed, \"DependencyName\" dep as string (not min-safe)\n *   myBarResolve: function(DependencyName) { return DependencyName.fetchSomethingAsPromise() },\n *\n *   // Array split; \"DependencyName\" dep as string\n *   myBazResolve: [ \"DependencyName\", function(dep) { return dep.fetchSomethingAsPromise() },\n *\n *   // Array split; DependencyType dep as token (compared using ===)\n *   myQuxResolve: [ DependencyType, function(dep) { return dep.fetchSometingAsPromise() },\n *\n *   // val.$inject used as deps\n *   // where:\n *   //     corgeResolve.$inject = [\"DependencyName\"];\n *   //     function corgeResolve(dep) { dep.fetchSometingAsPromise() }\n *   // then \"DependencyName\" dep as string\n *   myCorgeResolve: corgeResolve,\n *\n *  // inject service by name\n *  // When a string is found, desugar creating a resolve that injects the named service\n *   myGraultResolve: \"SomeService\"\n * }\n *\n * or:\n *\n * [\n *   new Resolvable(\"myFooResolve\", function() { return \"myFooData\" }),\n *   new Resolvable(\"myBarResolve\", function(dep) { return dep.fetchSomethingAsPromise() }, [ \"DependencyName\" ]),\n *   { provide: \"myBazResolve\", useFactory: function(dep) { dep.fetchSomethingAsPromise() }, deps: [ \"DependencyName\" ] }\n * ]\n */\nfunction resolvablesBuilder(state) {\n    /** convert resolve: {} and resolvePolicy: {} objects to an array of tuples */\n    var objects2Tuples = function (resolveObj, resolvePolicies) {\n        return Object.keys(resolveObj || {}).map(function (token) { return ({ token: token, val: resolveObj[token], deps: undefined, policy: resolvePolicies[token] }); });\n    };\n    /** fetch DI annotations from a function or ng1-style array */\n    var annotate = function (fn) {\n        var $injector = services.$injector;\n        // ng1 doesn't have an $injector until runtime.\n        // If the $injector doesn't exist, use \"deferred\" literal as a\n        // marker indicating they should be annotated when runtime starts\n        return fn['$inject'] || ($injector && $injector.annotate(fn, $injector.strictDi)) || \"deferred\";\n    };\n    /** true if the object has both `token` and `resolveFn`, and is probably a [[ResolveLiteral]] */\n    var isResolveLiteral = function (obj) { return !!(obj.token && obj.resolveFn); };\n    /** true if the object looks like a provide literal, or a ng2 Provider */\n    var isLikeNg2Provider = function (obj) { return !!((obj.provide || obj.token) && (obj.useValue || obj.useFactory || obj.useExisting || obj.useClass)); };\n    /** true if the object looks like a tuple from obj2Tuples */\n    var isTupleFromObj = function (obj) { return !!(obj && obj.val && (isString(obj.val) || isArray(obj.val) || isFunction(obj.val))); };\n    /** extracts the token from a Provider or provide literal */\n    var token = function (p) { return p.provide || p.token; };\n    /** Given a literal resolve or provider object, returns a Resolvable */\n    var literal2Resolvable = pattern([\n        [prop('resolveFn'), function (p) { return new Resolvable(token(p), p.resolveFn, p.deps, p.policy); }],\n        [prop('useFactory'), function (p) { return new Resolvable(token(p), p.useFactory, (p.deps || p.dependencies), p.policy); }],\n        [prop('useClass'), function (p) { return new Resolvable(token(p), function () { return new p.useClass(); }, [], p.policy); }],\n        [prop('useValue'), function (p) { return new Resolvable(token(p), function () { return p.useValue; }, [], p.policy, p.useValue); }],\n        [prop('useExisting'), function (p) { return new Resolvable(token(p), identity, [p.useExisting], p.policy); }],\n    ]);\n    var tuple2Resolvable = pattern([\n        [pipe(prop(\"val\"), isString), function (tuple) { return new Resolvable(tuple.token, identity, [tuple.val], tuple.policy); }],\n        [pipe(prop(\"val\"), isArray), function (tuple) { return new Resolvable(tuple.token, tail(tuple.val), tuple.val.slice(0, -1), tuple.policy); }],\n        [pipe(prop(\"val\"), isFunction), function (tuple) { return new Resolvable(tuple.token, tuple.val, annotate(tuple.val), tuple.policy); }],\n    ]);\n    var item2Resolvable = pattern([\n        [is(Resolvable), function (r) { return r; }],\n        [isResolveLiteral, literal2Resolvable],\n        [isLikeNg2Provider, literal2Resolvable],\n        [isTupleFromObj, tuple2Resolvable],\n        [val(true), function (obj) { throw new Error(\"Invalid resolve value: \" + stringify(obj)); }]\n    ]);\n    // If resolveBlock is already an array, use it as-is.\n    // Otherwise, assume it's an object and convert to an Array of tuples\n    var decl = state.resolve;\n    var items = isArray(decl) ? decl : objects2Tuples(decl, state.resolvePolicy || {});\n    return items.map(item2Resolvable);\n}\n/**\n * @internalapi A internal global service\n *\n * StateBuilder is a factory for the internal [[StateObject]] objects.\n *\n * When you register a state with the [[StateRegistry]], you register a plain old javascript object which\n * conforms to the [[StateDeclaration]] interface.  This factory takes that object and builds the corresponding\n * [[StateObject]] object, which has an API and is used internally.\n *\n * Custom properties or API may be added to the internal [[StateObject]] object by registering a decorator function\n * using the [[builder]] method.\n */\nvar StateBuilder = (function () {\n    function StateBuilder(matcher, urlMatcherFactory) {\n        this.matcher = matcher;\n        var self = this;\n        var root = function () { return matcher.find(\"\"); };\n        var isRoot = function (state) { return state.name === \"\"; };\n        function parentBuilder(state) {\n            if (isRoot(state))\n                return null;\n            return matcher.find(self.parentName(state)) || root();\n        }\n        this.builders = {\n            name: [nameBuilder],\n            self: [selfBuilder],\n            parent: [parentBuilder],\n            data: [dataBuilder],\n            // Build a URLMatcher if necessary, either via a relative or absolute URL\n            url: [getUrlBuilder(urlMatcherFactory, root)],\n            // Keep track of the closest ancestor state that has a URL (i.e. is navigable)\n            navigable: [getNavigableBuilder(isRoot)],\n            params: [getParamsBuilder(urlMatcherFactory.paramFactory)],\n            // Each framework-specific ui-router implementation should define its own `views` builder\n            // e.g., src/ng1/statebuilders/views.ts\n            views: [],\n            // Keep a full path from the root down to this state as this is needed for state activation.\n            path: [pathBuilder],\n            // Speed up $state.includes() as it's used a lot\n            includes: [includesBuilder],\n            resolvables: [resolvablesBuilder]\n        };\n    }\n    /**\n     * Registers a [[BuilderFunction]] for a specific [[StateObject]] property (e.g., `parent`, `url`, or `path`).\n     * More than one BuilderFunction can be registered for a given property.\n     *\n     * The BuilderFunction(s) will be used to define the property on any subsequently built [[StateObject]] objects.\n     *\n     * @param name The name of the State property being registered for.\n     * @param fn The BuilderFunction which will be used to build the State property\n     * @returns a function which deregisters the BuilderFunction\n     */\n    StateBuilder.prototype.builder = function (name, fn) {\n        var builders = this.builders;\n        var array = builders[name] || [];\n        // Backwards compat: if only one builder exists, return it, else return whole arary.\n        if (isString(name) && !isDefined(fn))\n            return array.length > 1 ? array : array[0];\n        if (!isString(name) || !isFunction(fn))\n            return;\n        builders[name] = array;\n        builders[name].push(fn);\n        return function () { return builders[name].splice(builders[name].indexOf(fn, 1)) && null; };\n    };\n    /**\n     * Builds all of the properties on an essentially blank State object, returning a State object which has all its\n     * properties and API built.\n     *\n     * @param state an uninitialized State object\n     * @returns the built State object\n     */\n    StateBuilder.prototype.build = function (state) {\n        var _a = this, matcher = _a.matcher, builders = _a.builders;\n        var parent = this.parentName(state);\n        if (parent && !matcher.find(parent, undefined, false)) {\n            return null;\n        }\n        for (var key in builders) {\n            if (!builders.hasOwnProperty(key))\n                continue;\n            var chain = builders[key].reduce(function (parentFn, step) { return function (_state) { return step(_state, parentFn); }; }, noop$1);\n            state[key] = chain(state);\n        }\n        return state;\n    };\n    StateBuilder.prototype.parentName = function (state) {\n        var name = state.name || \"\";\n        var segments = name.split('.');\n        if (segments.length > 1) {\n            if (state.parent) {\n                throw new Error(\"States that specify the 'parent:' property should not have a '.' in their name (\" + name + \")\");\n            }\n            var lastSegment = segments.pop();\n            if (lastSegment === '**')\n                segments.pop();\n            return segments.join(\".\");\n        }\n        if (!state.parent)\n            return \"\";\n        return isString(state.parent) ? state.parent : state.parent.name;\n    };\n    StateBuilder.prototype.name = function (state) {\n        var name = state.name;\n        if (name.indexOf('.') !== -1 || !state.parent)\n            return name;\n        var parentName = isString(state.parent) ? state.parent : state.parent.name;\n        return parentName ? parentName + \".\" + name : name;\n    };\n    return StateBuilder;\n}());\n\n/** @module state */ /** for typedoc */\nvar StateMatcher = (function () {\n    function StateMatcher(_states) {\n        this._states = _states;\n    }\n    StateMatcher.prototype.isRelative = function (stateName) {\n        stateName = stateName || \"\";\n        return stateName.indexOf(\".\") === 0 || stateName.indexOf(\"^\") === 0;\n    };\n    StateMatcher.prototype.find = function (stateOrName, base, matchGlob) {\n        if (matchGlob === void 0) { matchGlob = true; }\n        if (!stateOrName && stateOrName !== \"\")\n            return undefined;\n        var isStr = isString(stateOrName);\n        var name = isStr ? stateOrName : stateOrName.name;\n        if (this.isRelative(name))\n            name = this.resolvePath(name, base);\n        var state = this._states[name];\n        if (state && (isStr || (!isStr && (state === stateOrName || state.self === stateOrName)))) {\n            return state;\n        }\n        else if (isStr && matchGlob) {\n            var _states = values(this._states);\n            var matches = _states.filter(function (state) {\n                return state.__stateObjectCache.nameGlob &&\n                    state.__stateObjectCache.nameGlob.matches(name);\n            });\n            if (matches.length > 1) {\n                console.log(\"stateMatcher.find: Found multiple matches for \" + name + \" using glob: \", matches.map(function (match) { return match.name; }));\n            }\n            return matches[0];\n        }\n        return undefined;\n    };\n    StateMatcher.prototype.resolvePath = function (name, base) {\n        if (!base)\n            throw new Error(\"No reference point given for path '\" + name + \"'\");\n        var baseState = this.find(base);\n        var splitName = name.split(\".\"), i = 0, pathLength = splitName.length, current = baseState;\n        for (; i < pathLength; i++) {\n            if (splitName[i] === \"\" && i === 0) {\n                current = baseState;\n                continue;\n            }\n            if (splitName[i] === \"^\") {\n                if (!current.parent)\n                    throw new Error(\"Path '\" + name + \"' not valid for state '\" + baseState.name + \"'\");\n                current = current.parent;\n                continue;\n            }\n            break;\n        }\n        var relName = splitName.slice(i).join(\".\");\n        return current.name + (current.name && relName ? \".\" : \"\") + relName;\n    };\n    return StateMatcher;\n}());\n\n/** @module state */ /** for typedoc */\n/** @internalapi */\nvar StateQueueManager = (function () {\n    function StateQueueManager($registry, $urlRouter, states, builder, listeners) {\n        this.$registry = $registry;\n        this.$urlRouter = $urlRouter;\n        this.states = states;\n        this.builder = builder;\n        this.listeners = listeners;\n        this.queue = [];\n        this.matcher = $registry.matcher;\n    }\n    /** @internalapi */\n    StateQueueManager.prototype.dispose = function () {\n        this.queue = [];\n    };\n    StateQueueManager.prototype.register = function (stateDecl) {\n        var queue = this.queue;\n        var state = StateObject.create(stateDecl);\n        var name = state.name;\n        if (!isString(name))\n            throw new Error(\"State must have a valid name\");\n        if (this.states.hasOwnProperty(name) || inArray(queue.map(prop('name')), name))\n            throw new Error(\"State '\" + name + \"' is already defined\");\n        queue.push(state);\n        this.flush();\n        return state;\n    };\n    StateQueueManager.prototype.flush = function () {\n        var _this = this;\n        var _a = this, queue = _a.queue, states = _a.states, builder = _a.builder;\n        var registered = [], // states that got registered\n        orphans = [], // states that don't yet have a parent registered\n        previousQueueLength = {}; // keep track of how long the queue when an orphan was first encountered\n        var getState = function (name) {\n            return _this.states.hasOwnProperty(name) && _this.states[name];\n        };\n        while (queue.length > 0) {\n            var state = queue.shift();\n            var name_1 = state.name;\n            var result = builder.build(state);\n            var orphanIdx = orphans.indexOf(state);\n            if (result) {\n                var existingState = getState(name_1);\n                if (existingState && existingState.name === name_1) {\n                    throw new Error(\"State '\" + name_1 + \"' is already defined\");\n                }\n                var existingFutureState = getState(name_1 + \".**\");\n                if (existingFutureState) {\n                    // Remove future state of the same name\n                    this.$registry.deregister(existingFutureState);\n                }\n                states[name_1] = state;\n                this.attachRoute(state);\n                if (orphanIdx >= 0)\n                    orphans.splice(orphanIdx, 1);\n                registered.push(state);\n                continue;\n            }\n            var prev = previousQueueLength[name_1];\n            previousQueueLength[name_1] = queue.length;\n            if (orphanIdx >= 0 && prev === queue.length) {\n                // Wait until two consecutive iterations where no additional states were dequeued successfully.\n                // throw new Error(`Cannot register orphaned state '${name}'`);\n                queue.push(state);\n                return states;\n            }\n            else if (orphanIdx < 0) {\n                orphans.push(state);\n            }\n            queue.push(state);\n        }\n        if (registered.length) {\n            this.listeners.forEach(function (listener) { return listener(\"registered\", registered.map(function (s) { return s.self; })); });\n        }\n        return states;\n    };\n    StateQueueManager.prototype.attachRoute = function (state) {\n        if (state.abstract || !state.url)\n            return;\n        this.$urlRouter.rule(this.$urlRouter.urlRuleFactory.create(state));\n    };\n    return StateQueueManager;\n}());\n\n/**\n * @coreapi\n * @module state\n */ /** for typedoc */\nvar StateRegistry = (function () {\n    /** @internalapi */\n    function StateRegistry(_router) {\n        this._router = _router;\n        this.states = {};\n        this.listeners = [];\n        this.matcher = new StateMatcher(this.states);\n        this.builder = new StateBuilder(this.matcher, _router.urlMatcherFactory);\n        this.stateQueue = new StateQueueManager(this, _router.urlRouter, this.states, this.builder, this.listeners);\n        this._registerRoot();\n    }\n    /** @internalapi */\n    StateRegistry.prototype._registerRoot = function () {\n        var rootStateDef = {\n            name: '',\n            url: '^',\n            views: null,\n            params: {\n                '#': { value: null, type: 'hash', dynamic: true }\n            },\n            abstract: true\n        };\n        var _root = this._root = this.stateQueue.register(rootStateDef);\n        _root.navigable = null;\n    };\n    /** @internalapi */\n    StateRegistry.prototype.dispose = function () {\n        var _this = this;\n        this.stateQueue.dispose();\n        this.listeners = [];\n        this.get().forEach(function (state) { return _this.get(state) && _this.deregister(state); });\n    };\n    /**\n     * Listen for a State Registry events\n     *\n     * Adds a callback that is invoked when states are registered or deregistered with the StateRegistry.\n     *\n     * #### Example:\n     * ```js\n     * let allStates = registry.get();\n     *\n     * // Later, invoke deregisterFn() to remove the listener\n     * let deregisterFn = registry.onStatesChanged((event, states) => {\n     *   switch(event) {\n     *     case: 'registered':\n     *       states.forEach(state => allStates.push(state));\n     *       break;\n     *     case: 'deregistered':\n     *       states.forEach(state => {\n     *         let idx = allStates.indexOf(state);\n     *         if (idx !== -1) allStates.splice(idx, 1);\n     *       });\n     *       break;\n     *   }\n     * });\n     * ```\n     *\n     * @param listener a callback function invoked when the registered states changes.\n     *        The function receives two parameters, `event` and `state`.\n     *        See [[StateRegistryListener]]\n     * @return a function that deregisters the listener\n     */\n    StateRegistry.prototype.onStatesChanged = function (listener) {\n        this.listeners.push(listener);\n        return function deregisterListener() {\n            removeFrom(this.listeners)(listener);\n        }.bind(this);\n    };\n    /**\n     * Gets the implicit root state\n     *\n     * Gets the root of the state tree.\n     * The root state is implicitly created by UI-Router.\n     * Note: this returns the internal [[StateObject]] representation, not a [[StateDeclaration]]\n     *\n     * @return the root [[StateObject]]\n     */\n    StateRegistry.prototype.root = function () {\n        return this._root;\n    };\n    /**\n     * Adds a state to the registry\n     *\n     * Registers a [[StateDeclaration]] or queues it for registration.\n     *\n     * Note: a state will be queued if the state's parent isn't yet registered.\n     *\n     * @param stateDefinition the definition of the state to register.\n     * @returns the internal [[StateObject]] object.\n     *          If the state was successfully registered, then the object is fully built (See: [[StateBuilder]]).\n     *          If the state was only queued, then the object is not fully built.\n     */\n    StateRegistry.prototype.register = function (stateDefinition) {\n        return this.stateQueue.register(stateDefinition);\n    };\n    /** @hidden */\n    StateRegistry.prototype._deregisterTree = function (state) {\n        var _this = this;\n        var all$$1 = this.get().map(function (s) { return s.$$state(); });\n        var getChildren = function (states) {\n            var children = all$$1.filter(function (s) { return states.indexOf(s.parent) !== -1; });\n            return children.length === 0 ? children : children.concat(getChildren(children));\n        };\n        var children = getChildren([state]);\n        var deregistered = [state].concat(children).reverse();\n        deregistered.forEach(function (state) {\n            var $ur = _this._router.urlRouter;\n            // Remove URL rule\n            $ur.rules().filter(propEq(\"state\", state)).forEach($ur.removeRule.bind($ur));\n            // Remove state from registry\n            delete _this.states[state.name];\n        });\n        return deregistered;\n    };\n    /**\n     * Removes a state from the registry\n     *\n     * This removes a state from the registry.\n     * If the state has children, they are are also removed from the registry.\n     *\n     * @param stateOrName the state's name or object representation\n     * @returns {StateObject[]} a list of removed states\n     */\n    StateRegistry.prototype.deregister = function (stateOrName) {\n        var _state = this.get(stateOrName);\n        if (!_state)\n            throw new Error(\"Can't deregister state; not found: \" + stateOrName);\n        var deregisteredStates = this._deregisterTree(_state.$$state());\n        this.listeners.forEach(function (listener) { return listener(\"deregistered\", deregisteredStates.map(function (s) { return s.self; })); });\n        return deregisteredStates;\n    };\n    StateRegistry.prototype.get = function (stateOrName, base) {\n        var _this = this;\n        if (arguments.length === 0)\n            return Object.keys(this.states).map(function (name) { return _this.states[name].self; });\n        var found = this.matcher.find(stateOrName, base);\n        return found && found.self || null;\n    };\n    StateRegistry.prototype.decorator = function (name, func) {\n        return this.builder.builder(name, func);\n    };\n    return StateRegistry;\n}());\n\n/**\n * @coreapi\n * @module url\n */\n/** for typedoc */\n/** @hidden */\nfunction quoteRegExp(string, param) {\n    var surroundPattern = ['', ''], result = string.replace(/[\\\\\\[\\]\\^$*+?.()|{}]/g, \"\\\\$&\");\n    if (!param)\n        return result;\n    switch (param.squash) {\n        case false:\n            surroundPattern = ['(', ')' + (param.isOptional ? '?' : '')];\n            break;\n        case true:\n            result = result.replace(/\\/$/, '');\n            surroundPattern = ['(?:\\/(', ')|\\/)?'];\n            break;\n        default:\n            surroundPattern = [\"(\" + param.squash + \"|\", ')?'];\n            break;\n    }\n    return result + surroundPattern[0] + param.type.pattern.source + surroundPattern[1];\n}\n/** @hidden */\nvar memoizeTo = function (obj, prop$$1, fn) {\n    return obj[prop$$1] = obj[prop$$1] || fn();\n};\n/** @hidden */\nvar splitOnSlash = splitOnDelim('/');\n/**\n * Matches URLs against patterns.\n *\n * Matches URLs against patterns and extracts named parameters from the path or the search\n * part of the URL.\n *\n * A URL pattern consists of a path pattern, optionally followed by '?' and a list of search (query)\n * parameters. Multiple search parameter names are separated by '&'. Search parameters\n * do not influence whether or not a URL is matched, but their values are passed through into\n * the matched parameters returned by [[UrlMatcher.exec]].\n *\n * - *Path parameters* are defined using curly brace placeholders (`/somepath/{param}`)\n * or colon placeholders (`/somePath/:param`).\n *\n * - *A parameter RegExp* may be defined for a param after a colon\n * (`/somePath/{param:[a-zA-Z0-9]+}`) in a curly brace placeholder.\n * The regexp must match for the url to be matched.\n * Should the regexp itself contain curly braces, they must be in matched pairs or escaped with a backslash.\n *\n * Note: a RegExp parameter will encode its value using either [[ParamTypes.path]] or [[ParamTypes.query]].\n *\n * - *Custom parameter types* may also be specified after a colon (`/somePath/{param:int}`) in curly brace parameters.\n *   See [[UrlMatcherFactory.type]] for more information.\n *\n * - *Catch-all parameters* are defined using an asterisk placeholder (`/somepath/*catchallparam`).\n *   A catch-all * parameter value will contain the remainder of the URL.\n *\n * ---\n *\n * Parameter names may contain only word characters (latin letters, digits, and underscore) and\n * must be unique within the pattern (across both path and search parameters).\n * A path parameter matches any number of characters other than '/'. For catch-all\n * placeholders the path parameter matches any number of characters.\n *\n * Examples:\n *\n * * `'/hello/'` - Matches only if the path is exactly '/hello/'. There is no special treatment for\n *   trailing slashes, and patterns have to match the entire path, not just a prefix.\n * * `'/user/:id'` - Matches '/user/bob' or '/user/1234!!!' or even '/user/' but not '/user' or\n *   '/user/bob/details'. The second path segment will be captured as the parameter 'id'.\n * * `'/user/{id}'` - Same as the previous example, but using curly brace syntax.\n * * `'/user/{id:[^/]*}'` - Same as the previous example.\n * * `'/user/{id:[0-9a-fA-F]{1,8}}'` - Similar to the previous example, but only matches if the id\n *   parameter consists of 1 to 8 hex digits.\n * * `'/files/{path:.*}'` - Matches any URL starting with '/files/' and captures the rest of the\n *   path into the parameter 'path'.\n * * `'/files/*path'` - ditto.\n * * `'/calendar/{start:date}'` - Matches \"/calendar/2014-11-12\" (because the pattern defined\n *   in the built-in  `date` ParamType matches `2014-11-12`) and provides a Date object in $stateParams.start\n *\n */\nvar UrlMatcher = (function () {\n    /**\n     * @param pattern The pattern to compile into a matcher.\n     * @param paramTypes The [[ParamTypes]] registry\n     * @param config  A configuration object\n     * - `caseInsensitive` - `true` if URL matching should be case insensitive, otherwise `false`, the default value (for backward compatibility) is `false`.\n     * - `strict` - `false` if matching against a URL with a trailing slash should be treated as equivalent to a URL without a trailing slash, the default value is `true`.\n     */\n    function UrlMatcher(pattern$$1, paramTypes, paramFactory, config) {\n        var _this = this;\n        this.config = config;\n        /** @hidden */\n        this._cache = { path: [this] };\n        /** @hidden */\n        this._children = [];\n        /** @hidden */\n        this._params = [];\n        /** @hidden */\n        this._segments = [];\n        /** @hidden */\n        this._compiled = [];\n        this.pattern = pattern$$1;\n        this.config = defaults(this.config, {\n            params: {},\n            strict: true,\n            caseInsensitive: false,\n            paramMap: identity\n        });\n        // Find all placeholders and create a compiled pattern, using either classic or curly syntax:\n        //   '*' name\n        //   ':' name\n        //   '{' name '}'\n        //   '{' name ':' regexp '}'\n        // The regular expression is somewhat complicated due to the need to allow curly braces\n        // inside the regular expression. The placeholder regexp breaks down as follows:\n        //    ([:*])([\\w\\[\\]]+)              - classic placeholder ($1 / $2) (search version has - for snake-case)\n        //    \\{([\\w\\[\\]]+)(?:\\:\\s*( ... ))?\\}  - curly brace placeholder ($3) with optional regexp/type ... ($4) (search version has - for snake-case\n        //    (?: ... | ... | ... )+         - the regexp consists of any number of atoms, an atom being either\n        //    [^{}\\\\]+                       - anything other than curly braces or backslash\n        //    \\\\.                            - a backslash escape\n        //    \\{(?:[^{}\\\\]+|\\\\.)*\\}          - a matched set of curly braces containing other atoms\n        var placeholder = /([:*])([\\w\\[\\]]+)|\\{([\\w\\[\\]]+)(?:\\:\\s*((?:[^{}\\\\]+|\\\\.|\\{(?:[^{}\\\\]+|\\\\.)*\\})+))?\\}/g, searchPlaceholder = /([:]?)([\\w\\[\\].-]+)|\\{([\\w\\[\\].-]+)(?:\\:\\s*((?:[^{}\\\\]+|\\\\.|\\{(?:[^{}\\\\]+|\\\\.)*\\})+))?\\}/g, last = 0, m, patterns = [];\n        var checkParamErrors = function (id) {\n            if (!UrlMatcher.nameValidator.test(id))\n                throw new Error(\"Invalid parameter name '\" + id + \"' in pattern '\" + pattern$$1 + \"'\");\n            if (find(_this._params, propEq('id', id)))\n                throw new Error(\"Duplicate parameter name '\" + id + \"' in pattern '\" + pattern$$1 + \"'\");\n        };\n        // Split into static segments separated by path parameter placeholders.\n        // The number of segments is always 1 more than the number of parameters.\n        var matchDetails = function (m, isSearch) {\n            // IE[78] returns '' for unmatched groups instead of null\n            var id = m[2] || m[3];\n            var regexp = isSearch ? m[4] : m[4] || (m[1] === '*' ? '.*' : null);\n            var makeRegexpType = function (regexp) { return inherit(paramTypes.type(isSearch ? \"query\" : \"path\"), {\n                pattern: new RegExp(regexp, _this.config.caseInsensitive ? 'i' : undefined)\n            }); };\n            return {\n                id: id,\n                regexp: regexp,\n                cfg: _this.config.params[id],\n                segment: pattern$$1.substring(last, m.index),\n                type: !regexp ? null : paramTypes.type(regexp) || makeRegexpType(regexp)\n            };\n        };\n        var p, segment;\n        while ((m = placeholder.exec(pattern$$1))) {\n            p = matchDetails(m, false);\n            if (p.segment.indexOf('?') >= 0)\n                break; // we're into the search part\n            checkParamErrors(p.id);\n            this._params.push(paramFactory.fromPath(p.id, p.type, this.config.paramMap(p.cfg, false)));\n            this._segments.push(p.segment);\n            patterns.push([p.segment, tail(this._params)]);\n            last = placeholder.lastIndex;\n        }\n        segment = pattern$$1.substring(last);\n        // Find any search parameter names and remove them from the last segment\n        var i = segment.indexOf('?');\n        if (i >= 0) {\n            var search = segment.substring(i);\n            segment = segment.substring(0, i);\n            if (search.length > 0) {\n                last = 0;\n                while ((m = searchPlaceholder.exec(search))) {\n                    p = matchDetails(m, true);\n                    checkParamErrors(p.id);\n                    this._params.push(paramFactory.fromSearch(p.id, p.type, this.config.paramMap(p.cfg, true)));\n                    last = placeholder.lastIndex;\n                    // check if ?&\n                }\n            }\n        }\n        this._segments.push(segment);\n        this._compiled = patterns.map(function (pattern$$1) { return quoteRegExp.apply(null, pattern$$1); }).concat(quoteRegExp(segment));\n    }\n    /**\n     * Creates a new concatenated UrlMatcher\n     *\n     * Builds a new UrlMatcher by appending another UrlMatcher to this one.\n     *\n     * @param url A `UrlMatcher` instance to append as a child of the current `UrlMatcher`.\n     */\n    UrlMatcher.prototype.append = function (url) {\n        this._children.push(url);\n        url._cache = {\n            path: this._cache.path.concat(url),\n            parent: this,\n            pattern: null,\n        };\n        return url;\n    };\n    /** @hidden */\n    UrlMatcher.prototype.isRoot = function () {\n        return this._cache.path[0] === this;\n    };\n    /** Returns the input pattern string */\n    UrlMatcher.prototype.toString = function () {\n        return this.pattern;\n    };\n    /**\n     * Tests the specified url/path against this matcher.\n     *\n     * Tests if the given url matches this matcher's pattern, and returns an object containing the captured\n     * parameter values.  Returns null if the path does not match.\n     *\n     * The returned object contains the values\n     * of any search parameters that are mentioned in the pattern, but their value may be null if\n     * they are not present in `search`. This means that search parameters are always treated\n     * as optional.\n     *\n     * #### Example:\n     * ```js\n     * new UrlMatcher('/user/{id}?q&r').exec('/user/bob', {\n     *   x: '1', q: 'hello'\n     * });\n     * // returns { id: 'bob', q: 'hello', r: null }\n     * ```\n     *\n     * @param path    The URL path to match, e.g. `$location.path()`.\n     * @param search  URL search parameters, e.g. `$location.search()`.\n     * @param hash    URL hash e.g. `$location.hash()`.\n     * @param options\n     *\n     * @returns The captured parameter values.\n     */\n    UrlMatcher.prototype.exec = function (path, search, hash, options) {\n        var _this = this;\n        if (search === void 0) { search = {}; }\n        if (options === void 0) { options = {}; }\n        var match = memoizeTo(this._cache, 'pattern', function () {\n            return new RegExp([\n                '^',\n                unnest(_this._cache.path.map(prop('_compiled'))).join(''),\n                _this.config.strict === false ? '\\/?' : '',\n                '$'\n            ].join(''), _this.config.caseInsensitive ? 'i' : undefined);\n        }).exec(path);\n        if (!match)\n            return null;\n        //options = defaults(options, { isolate: false });\n        var allParams = this.parameters(), pathParams = allParams.filter(function (param) { return !param.isSearch(); }), searchParams = allParams.filter(function (param) { return param.isSearch(); }), nPathSegments = this._cache.path.map(function (urlm) { return urlm._segments.length - 1; }).reduce(function (a, x) { return a + x; }), values$$1 = {};\n        if (nPathSegments !== match.length - 1)\n            throw new Error(\"Unbalanced capture group in route '\" + this.pattern + \"'\");\n        function decodePathArray(string) {\n            var reverseString = function (str) { return str.split(\"\").reverse().join(\"\"); };\n            var unquoteDashes = function (str) { return str.replace(/\\\\-/g, \"-\"); };\n            var split = reverseString(string).split(/-(?!\\\\)/);\n            var allReversed = map(split, reverseString);\n            return map(allReversed, unquoteDashes).reverse();\n        }\n        for (var i = 0; i < nPathSegments; i++) {\n            var param = pathParams[i];\n            var value = match[i + 1];\n            // if the param value matches a pre-replace pair, replace the value before decoding.\n            for (var j = 0; j < param.replace.length; j++) {\n                if (param.replace[j].from === value)\n                    value = param.replace[j].to;\n            }\n            if (value && param.array === true)\n                value = decodePathArray(value);\n            if (isDefined(value))\n                value = param.type.decode(value);\n            values$$1[param.id] = param.value(value);\n        }\n        searchParams.forEach(function (param) {\n            var value = search[param.id];\n            for (var j = 0; j < param.replace.length; j++) {\n                if (param.replace[j].from === value)\n                    value = param.replace[j].to;\n            }\n            if (isDefined(value))\n                value = param.type.decode(value);\n            values$$1[param.id] = param.value(value);\n        });\n        if (hash)\n            values$$1[\"#\"] = hash;\n        return values$$1;\n    };\n    /**\n     * @hidden\n     * Returns all the [[Param]] objects of all path and search parameters of this pattern in order of appearance.\n     *\n     * @returns {Array.<Param>}  An array of [[Param]] objects. Must be treated as read-only. If the\n     *    pattern has no parameters, an empty array is returned.\n     */\n    UrlMatcher.prototype.parameters = function (opts) {\n        if (opts === void 0) { opts = {}; }\n        if (opts.inherit === false)\n            return this._params;\n        return unnest(this._cache.path.map(function (matcher) { return matcher._params; }));\n    };\n    /**\n     * @hidden\n     * Returns a single parameter from this UrlMatcher by id\n     *\n     * @param id\n     * @param opts\n     * @returns {T|Param|any|boolean|UrlMatcher|null}\n     */\n    UrlMatcher.prototype.parameter = function (id, opts) {\n        var _this = this;\n        if (opts === void 0) { opts = {}; }\n        var findParam = function () {\n            for (var _i = 0, _a = _this._params; _i < _a.length; _i++) {\n                var param = _a[_i];\n                if (param.id === id)\n                    return param;\n            }\n        };\n        var parent = this._cache.parent;\n        return findParam() || (opts.inherit !== false && parent && parent.parameter(id, opts)) || null;\n    };\n    /**\n     * Validates the input parameter values against this UrlMatcher\n     *\n     * Checks an object hash of parameters to validate their correctness according to the parameter\n     * types of this `UrlMatcher`.\n     *\n     * @param params The object hash of parameters to validate.\n     * @returns Returns `true` if `params` validates, otherwise `false`.\n     */\n    UrlMatcher.prototype.validates = function (params) {\n        var validParamVal = function (param, val$$1) {\n            return !param || param.validates(val$$1);\n        };\n        params = params || {};\n        // I'm not sure why this checks only the param keys passed in, and not all the params known to the matcher\n        var paramSchema = this.parameters().filter(function (paramDef) { return params.hasOwnProperty(paramDef.id); });\n        return paramSchema.map(function (paramDef) { return validParamVal(paramDef, params[paramDef.id]); }).reduce(allTrueR, true);\n    };\n    /**\n     * Given a set of parameter values, creates a URL from this UrlMatcher.\n     *\n     * Creates a URL that matches this pattern by substituting the specified values\n     * for the path and search parameters.\n     *\n     * #### Example:\n     * ```js\n     * new UrlMatcher('/user/{id}?q').format({ id:'bob', q:'yes' });\n     * // returns '/user/bob?q=yes'\n     * ```\n     *\n     * @param values  the values to substitute for the parameters in this pattern.\n     * @returns the formatted URL (path and optionally search part).\n     */\n    UrlMatcher.prototype.format = function (values$$1) {\n        if (values$$1 === void 0) { values$$1 = {}; }\n        // Build the full path of UrlMatchers (including all parent UrlMatchers)\n        var urlMatchers = this._cache.path;\n        // Extract all the static segments and Params (processed as ParamDetails)\n        // into an ordered array\n        var pathSegmentsAndParams = urlMatchers.map(UrlMatcher.pathSegmentsAndParams)\n            .reduce(unnestR, [])\n            .map(function (x) { return isString(x) ? x : getDetails(x); });\n        // Extract the query params into a separate array\n        var queryParams = urlMatchers.map(UrlMatcher.queryParams)\n            .reduce(unnestR, [])\n            .map(getDetails);\n        var isInvalid = function (param) { return param.isValid === false; };\n        if (pathSegmentsAndParams.concat(queryParams).filter(isInvalid).length) {\n            return null;\n        }\n        /**\n         * Given a Param, applies the parameter value, then returns detailed information about it\n         */\n        function getDetails(param) {\n            // Normalize to typed value\n            var value = param.value(values$$1[param.id]);\n            var isValid = param.validates(value);\n            var isDefaultValue = param.isDefaultValue(value);\n            // Check if we're in squash mode for the parameter\n            var squash = isDefaultValue ? param.squash : false;\n            // Allow the Parameter's Type to encode the value\n            var encoded = param.type.encode(value);\n            return { param: param, value: value, isValid: isValid, isDefaultValue: isDefaultValue, squash: squash, encoded: encoded };\n        }\n        // Build up the path-portion from the list of static segments and parameters\n        var pathString = pathSegmentsAndParams.reduce(function (acc, x) {\n            // The element is a static segment (a raw string); just append it\n            if (isString(x))\n                return acc + x;\n            // Otherwise, it's a ParamDetails.\n            var squash = x.squash, encoded = x.encoded, param = x.param;\n            // If squash is === true, try to remove a slash from the path\n            if (squash === true)\n                return (acc.match(/\\/$/)) ? acc.slice(0, -1) : acc;\n            // If squash is a string, use the string for the param value\n            if (isString(squash))\n                return acc + squash;\n            if (squash !== false)\n                return acc; // ?\n            if (encoded == null)\n                return acc;\n            // If this parameter value is an array, encode the value using encodeDashes\n            if (isArray(encoded))\n                return acc + map(encoded, UrlMatcher.encodeDashes).join(\"-\");\n            // If the parameter type is \"raw\", then do not encodeURIComponent\n            if (param.raw)\n                return acc + encoded;\n            // Encode the value\n            return acc + encodeURIComponent(encoded);\n        }, \"\");\n        // Build the query string by applying parameter values (array or regular)\n        // then mapping to key=value, then flattening and joining using \"&\"\n        var queryString = queryParams.map(function (paramDetails) {\n            var param = paramDetails.param, squash = paramDetails.squash, encoded = paramDetails.encoded, isDefaultValue = paramDetails.isDefaultValue;\n            if (encoded == null || (isDefaultValue && squash !== false))\n                return;\n            if (!isArray(encoded))\n                encoded = [encoded];\n            if (encoded.length === 0)\n                return;\n            if (!param.raw)\n                encoded = map(encoded, encodeURIComponent);\n            return encoded.map(function (val$$1) { return param.id + \"=\" + val$$1; });\n        }).filter(identity).reduce(unnestR, []).join(\"&\");\n        // Concat the pathstring with the queryString (if exists) and the hashString (if exists)\n        return pathString + (queryString ? \"?\" + queryString : \"\") + (values$$1[\"#\"] ? \"#\" + values$$1[\"#\"] : \"\");\n    };\n    /** @hidden */\n    UrlMatcher.encodeDashes = function (str) {\n        return encodeURIComponent(str).replace(/-/g, function (c) { return \"%5C%\" + c.charCodeAt(0).toString(16).toUpperCase(); });\n    };\n    /** @hidden Given a matcher, return an array with the matcher's path segments and path params, in order */\n    UrlMatcher.pathSegmentsAndParams = function (matcher) {\n        var staticSegments = matcher._segments;\n        var pathParams = matcher._params.filter(function (p) { return p.location === exports.DefType.PATH; });\n        return arrayTuples(staticSegments, pathParams.concat(undefined))\n            .reduce(unnestR, [])\n            .filter(function (x) { return x !== \"\" && isDefined(x); });\n    };\n    /** @hidden Given a matcher, return an array with the matcher's query params */\n    UrlMatcher.queryParams = function (matcher) {\n        return matcher._params.filter(function (p) { return p.location === exports.DefType.SEARCH; });\n    };\n    /**\n     * Compare two UrlMatchers\n     *\n     * This comparison function converts a UrlMatcher into static and dynamic path segments.\n     * Each static path segment is a static string between a path separator (slash character).\n     * Each dynamic segment is a path parameter.\n     *\n     * The comparison function sorts static segments before dynamic ones.\n     */\n    UrlMatcher.compare = function (a, b) {\n        /**\n         * Turn a UrlMatcher and all its parent matchers into an array\n         * of slash literals '/', string literals, and Param objects\n         *\n         * This example matcher matches strings like \"/foo/:param/tail\":\n         * var matcher = $umf.compile(\"/foo\").append($umf.compile(\"/:param\")).append($umf.compile(\"/\")).append($umf.compile(\"tail\"));\n         * var result = segments(matcher); // [ '/', 'foo', '/', Param, '/', 'tail' ]\n         *\n         * Caches the result as `matcher._cache.segments`\n         */\n        var segments = function (matcher) {\n            return matcher._cache.segments = matcher._cache.segments ||\n                matcher._cache.path.map(UrlMatcher.pathSegmentsAndParams)\n                    .reduce(unnestR, [])\n                    .reduce(joinNeighborsR, [])\n                    .map(function (x) { return isString(x) ? splitOnSlash(x) : x; })\n                    .reduce(unnestR, []);\n        };\n        /**\n         * Gets the sort weight for each segment of a UrlMatcher\n         *\n         * Caches the result as `matcher._cache.weights`\n         */\n        var weights = function (matcher) {\n            return matcher._cache.weights = matcher._cache.weights ||\n                segments(matcher).map(function (segment) {\n                    // Sort slashes first, then static strings, the Params\n                    if (segment === '/')\n                        return 1;\n                    if (isString(segment))\n                        return 2;\n                    if (segment instanceof Param)\n                        return 3;\n                });\n        };\n        var cmp, i, pairs$$1 = arrayTuples(weights(a), weights(b));\n        for (i = 0; i < pairs$$1.length; i++) {\n            cmp = pairs$$1[i][0] - pairs$$1[i][1];\n            if (cmp !== 0)\n                return cmp;\n        }\n        return 0;\n    };\n    return UrlMatcher;\n}());\n/** @hidden */\nUrlMatcher.nameValidator = /^\\w+([-.]+\\w+)*(?:\\[\\])?$/;\n\n/**\n * @internalapi\n * @module url\n */ /** for typedoc */\n/**\n * Factory for [[UrlMatcher]] instances.\n *\n * The factory is available to ng1 services as\n * `$urlMatcherFactor` or ng1 providers as `$urlMatcherFactoryProvider`.\n */\nvar UrlMatcherFactory = (function () {\n    function UrlMatcherFactory() {\n        var _this = this;\n        /** @hidden */ this.paramTypes = new ParamTypes();\n        /** @hidden */ this._isCaseInsensitive = false;\n        /** @hidden */ this._isStrictMode = true;\n        /** @hidden */ this._defaultSquashPolicy = false;\n        /** @hidden */\n        this._getConfig = function (config) {\n            return extend({ strict: _this._isStrictMode, caseInsensitive: _this._isCaseInsensitive }, config);\n        };\n        /** @internalapi Creates a new [[Param]] for a given location (DefType) */\n        this.paramFactory = {\n            /** Creates a new [[Param]] from a CONFIG block */\n            fromConfig: function (id, type, config) {\n                return new Param(id, type, config, exports.DefType.CONFIG, _this);\n            },\n            /** Creates a new [[Param]] from a url PATH */\n            fromPath: function (id, type, config) {\n                return new Param(id, type, config, exports.DefType.PATH, _this);\n            },\n            /** Creates a new [[Param]] from a url SEARCH */\n            fromSearch: function (id, type, config) {\n                return new Param(id, type, config, exports.DefType.SEARCH, _this);\n            },\n        };\n        extend(this, { UrlMatcher: UrlMatcher, Param: Param });\n    }\n    /** @inheritdoc */\n    UrlMatcherFactory.prototype.caseInsensitive = function (value) {\n        return this._isCaseInsensitive = isDefined(value) ? value : this._isCaseInsensitive;\n    };\n    /** @inheritdoc */\n    UrlMatcherFactory.prototype.strictMode = function (value) {\n        return this._isStrictMode = isDefined(value) ? value : this._isStrictMode;\n    };\n    /** @inheritdoc */\n    UrlMatcherFactory.prototype.defaultSquashPolicy = function (value) {\n        if (isDefined(value) && value !== true && value !== false && !isString(value))\n            throw new Error(\"Invalid squash policy: \" + value + \". Valid policies: false, true, arbitrary-string\");\n        return this._defaultSquashPolicy = isDefined(value) ? value : this._defaultSquashPolicy;\n    };\n    /**\n     * Creates a [[UrlMatcher]] for the specified pattern.\n     *\n     * @param pattern  The URL pattern.\n     * @param config  The config object hash.\n     * @returns The UrlMatcher.\n     */\n    UrlMatcherFactory.prototype.compile = function (pattern, config) {\n        return new UrlMatcher(pattern, this.paramTypes, this.paramFactory, this._getConfig(config));\n    };\n    /**\n     * Returns true if the specified object is a [[UrlMatcher]], or false otherwise.\n     *\n     * @param object  The object to perform the type check against.\n     * @returns `true` if the object matches the `UrlMatcher` interface, by\n     *          implementing all the same methods.\n     */\n    UrlMatcherFactory.prototype.isMatcher = function (object) {\n        // TODO: typeof?\n        if (!isObject(object))\n            return false;\n        var result = true;\n        forEach(UrlMatcher.prototype, function (val, name) {\n            if (isFunction(val))\n                result = result && (isDefined(object[name]) && isFunction(object[name]));\n        });\n        return result;\n    };\n    \n    /**\n     * Creates and registers a custom [[ParamType]] object\n     *\n     * A [[ParamType]] can be used to generate URLs with typed parameters.\n     *\n     * @param name  The type name.\n     * @param definition The type definition. See [[ParamTypeDefinition]] for information on the values accepted.\n     * @param definitionFn A function that is injected before the app runtime starts.\n     *        The result of this function should be a [[ParamTypeDefinition]].\n     *        The result is merged into the existing `definition`.\n     *        See [[ParamType]] for information on the values accepted.\n     *\n     * @returns - if a type was registered: the [[UrlMatcherFactory]]\n     *   - if only the `name` parameter was specified: the currently registered [[ParamType]] object, or undefined\n     *\n     * Note: Register custom types *before using them* in a state definition.\n     *\n     * See [[ParamTypeDefinition]] for examples\n     */\n    UrlMatcherFactory.prototype.type = function (name, definition, definitionFn) {\n        var type = this.paramTypes.type(name, definition, definitionFn);\n        return !isDefined(definition) ? type : this;\n    };\n    \n    /** @hidden */\n    UrlMatcherFactory.prototype.$get = function () {\n        this.paramTypes.enqueue = false;\n        this.paramTypes._flushTypeQueue();\n        return this;\n    };\n    \n    /** @internalapi */\n    UrlMatcherFactory.prototype.dispose = function () {\n        this.paramTypes.dispose();\n    };\n    return UrlMatcherFactory;\n}());\n\n/**\n * @coreapi\n * @module url\n */ /** */\n/**\n * Creates a [[UrlRule]]\n *\n * Creates a [[UrlRule]] from a:\n *\n * - `string`\n * - [[UrlMatcher]]\n * - `RegExp`\n * - [[StateObject]]\n * @internalapi\n */\nvar UrlRuleFactory = (function () {\n    function UrlRuleFactory(router) {\n        this.router = router;\n    }\n    UrlRuleFactory.prototype.compile = function (str) {\n        return this.router.urlMatcherFactory.compile(str);\n    };\n    UrlRuleFactory.prototype.create = function (what, handler) {\n        var _this = this;\n        var makeRule = pattern([\n            [isString, function (_what) { return makeRule(_this.compile(_what)); }],\n            [is(UrlMatcher), function (_what) { return _this.fromUrlMatcher(_what, handler); }],\n            [isState, function (_what) { return _this.fromState(_what, _this.router); }],\n            [is(RegExp), function (_what) { return _this.fromRegExp(_what, handler); }],\n            [isFunction, function (_what) { return new BaseUrlRule(_what, handler); }],\n        ]);\n        var rule = makeRule(what);\n        if (!rule)\n            throw new Error(\"invalid 'what' in when()\");\n        return rule;\n    };\n    /**\n     * A UrlRule which matches based on a UrlMatcher\n     *\n     * The `handler` may be either a `string`, a [[UrlRuleHandlerFn]] or another [[UrlMatcher]]\n     *\n     * ## Handler as a function\n     *\n     * If `handler` is a function, the function is invoked with:\n     *\n     * - matched parameter values ([[RawParams]] from [[UrlMatcher.exec]])\n     * - url: the current Url ([[UrlParts]])\n     * - router: the router object ([[UIRouter]])\n     *\n     * #### Example:\n     * ```js\n     * var urlMatcher = $umf.compile(\"/foo/:fooId/:barId\");\n     * var rule = factory.fromUrlMatcher(urlMatcher, match => \"/home/\" + match.fooId + \"/\" + match.barId);\n     * var match = rule.match('/foo/123/456'); // results in { fooId: '123', barId: '456' }\n     * var result = rule.handler(match); // '/home/123/456'\n     * ```\n     *\n     * ## Handler as UrlMatcher\n     *\n     * If `handler` is a UrlMatcher, the handler matcher is used to create the new url.\n     * The `handler` UrlMatcher is formatted using the matched param from the first matcher.\n     * The url is replaced with the result.\n     *\n     * #### Example:\n     * ```js\n     * var urlMatcher = $umf.compile(\"/foo/:fooId/:barId\");\n     * var handler = $umf.compile(\"/home/:fooId/:barId\");\n     * var rule = factory.fromUrlMatcher(urlMatcher, handler);\n     * var match = rule.match('/foo/123/456'); // results in { fooId: '123', barId: '456' }\n     * var result = rule.handler(match); // '/home/123/456'\n     * ```\n     */\n    UrlRuleFactory.prototype.fromUrlMatcher = function (urlMatcher, handler) {\n        var _handler = handler;\n        if (isString(handler))\n            handler = this.router.urlMatcherFactory.compile(handler);\n        if (is(UrlMatcher)(handler))\n            _handler = function (match) { return handler.format(match); };\n        function match(url) {\n            var match = urlMatcher.exec(url.path, url.search, url.hash);\n            return urlMatcher.validates(match) && match;\n        }\n        // Prioritize URLs, lowest to highest:\n        // - Some optional URL parameters, but none matched\n        // - No optional parameters in URL\n        // - Some optional parameters, some matched\n        // - Some optional parameters, all matched\n        function matchPriority(params) {\n            var optional = urlMatcher.parameters().filter(function (param) { return param.isOptional; });\n            if (!optional.length)\n                return 0.000001;\n            var matched = optional.filter(function (param) { return params[param.id]; });\n            return matched.length / optional.length;\n        }\n        var details = { urlMatcher: urlMatcher, matchPriority: matchPriority, type: \"URLMATCHER\" };\n        return extend(new BaseUrlRule(match, _handler), details);\n    };\n    /**\n     * A UrlRule which matches a state by its url\n     *\n     * #### Example:\n     * ```js\n     * var rule = factory.fromState($state.get('foo'), router);\n     * var match = rule.match('/foo/123/456'); // results in { fooId: '123', barId: '456' }\n     * var result = rule.handler(match);\n     * // Starts a transition to 'foo' with params: { fooId: '123', barId: '456' }\n     * ```\n     */\n    UrlRuleFactory.prototype.fromState = function (state, router) {\n        /**\n         * Handles match by transitioning to matched state\n         *\n         * First checks if the router should start a new transition.\n         * A new transition is not required if the current state's URL\n         * and the new URL are already identical\n         */\n        var handler = function (match) {\n            var $state = router.stateService;\n            var globals = router.globals;\n            if ($state.href(state, match) !== $state.href(globals.current, globals.params)) {\n                $state.transitionTo(state, match, { inherit: true, source: \"url\" });\n            }\n        };\n        var details = { state: state, type: \"STATE\" };\n        return extend(this.fromUrlMatcher(state.url, handler), details);\n    };\n    /**\n     * A UrlRule which matches based on a regular expression\n     *\n     * The `handler` may be either a [[UrlRuleHandlerFn]] or a string.\n     *\n     * ## Handler as a function\n     *\n     * If `handler` is a function, the function is invoked with:\n     *\n     * - regexp match array (from `regexp`)\n     * - url: the current Url ([[UrlParts]])\n     * - router: the router object ([[UIRouter]])\n     *\n     * #### Example:\n     * ```js\n     * var rule = factory.fromRegExp(/^\\/foo\\/(bar|baz)$/, match => \"/home/\" + match[1])\n     * var match = rule.match('/foo/bar'); // results in [ '/foo/bar', 'bar' ]\n     * var result = rule.handler(match); // '/home/bar'\n     * ```\n     *\n     * ## Handler as string\n     *\n     * If `handler` is a string, the url is *replaced by the string* when the Rule is invoked.\n     * The string is first interpolated using `string.replace()` style pattern.\n     *\n     * #### Example:\n     * ```js\n     * var rule = factory.fromRegExp(/^\\/foo\\/(bar|baz)$/, \"/home/$1\")\n     * var match = rule.match('/foo/bar'); // results in [ '/foo/bar', 'bar' ]\n     * var result = rule.handler(match); // '/home/bar'\n     * ```\n     */\n    UrlRuleFactory.prototype.fromRegExp = function (regexp, handler) {\n        if (regexp.global || regexp.sticky)\n            throw new Error(\"Rule RegExp must not be global or sticky\");\n        /**\n         * If handler is a string, the url will be replaced by the string.\n         * If the string has any String.replace() style variables in it (like `$2`),\n         * they will be replaced by the captures from [[match]]\n         */\n        var redirectUrlTo = function (match) {\n            // Interpolates matched values into $1 $2, etc using a String.replace()-style pattern\n            return handler.replace(/\\$(\\$|\\d{1,2})/, function (m, what) {\n                return match[what === '$' ? 0 : Number(what)];\n            });\n        };\n        var _handler = isString(handler) ? redirectUrlTo : handler;\n        var match = function (url) {\n            return regexp.exec(url.path);\n        };\n        var details = { regexp: regexp, type: \"REGEXP\" };\n        return extend(new BaseUrlRule(match, _handler), details);\n    };\n    return UrlRuleFactory;\n}());\nUrlRuleFactory.isUrlRule = function (obj) {\n    return obj && ['type', 'match', 'handler'].every(function (key) { return isDefined(obj[key]); });\n};\n/**\n * A base rule which calls `match`\n *\n * The value from the `match` function is passed through to the `handler`.\n * @internalapi\n */\nvar BaseUrlRule = (function () {\n    function BaseUrlRule(match, handler) {\n        var _this = this;\n        this.match = match;\n        this.type = \"RAW\";\n        this.matchPriority = function (match) { return 0 - _this.$id; };\n        this.handler = handler || identity;\n    }\n    return BaseUrlRule;\n}());\n\n/**\n * @internalapi\n * @module url\n */\n/** for typedoc */\n/** @hidden */\nfunction appendBasePath(url, isHtml5, absolute, baseHref) {\n    if (baseHref === '/')\n        return url;\n    if (isHtml5)\n        return baseHref.slice(0, -1) + url;\n    if (absolute)\n        return baseHref.slice(1) + url;\n    return url;\n}\n/** @hidden */\nvar getMatcher = prop(\"urlMatcher\");\n/**\n * Default rule priority sorting function.\n *\n * Sorts rules by:\n *\n * - Explicit priority (set rule priority using [[UrlRulesApi.when]])\n * - Rule type (STATE: 4, URLMATCHER: 4, REGEXP: 3, RAW: 2, OTHER: 1)\n * - `UrlMatcher` specificity ([[UrlMatcher.compare]]): works for STATE and URLMATCHER types to pick the most specific rule.\n * - Registration order (for rule types other than STATE and URLMATCHER)\n *\n * @coreapi\n */\nvar defaultRuleSortFn;\ndefaultRuleSortFn = composeSort(sortBy(pipe(prop(\"priority\"), function (x) { return -x; })), sortBy(pipe(prop(\"type\"), function (type) { return ({ \"STATE\": 4, \"URLMATCHER\": 4, \"REGEXP\": 3, \"RAW\": 2, \"OTHER\": 1 })[type]; })), function (a, b) { return (getMatcher(a) && getMatcher(b)) ? UrlMatcher.compare(getMatcher(a), getMatcher(b)) : 0; }, sortBy(prop(\"$id\"), inArray([\"REGEXP\", \"RAW\", \"OTHER\"])));\n/**\n * Updates URL and responds to URL changes\n *\n * ### Deprecation warning:\n * This class is now considered to be an internal API\n * Use the [[UrlService]] instead.\n * For configuring URL rules, use the [[UrlRulesApi]] which can be found as [[UrlService.rules]].\n *\n * This class updates the URL when the state changes.\n * It also responds to changes in the URL.\n */\nvar UrlRouter = (function () {\n    /** @hidden */\n    function UrlRouter(router) {\n        /** @hidden */ this._sortFn = defaultRuleSortFn;\n        /** @hidden */ this._rules = [];\n        /** @hidden */ this.interceptDeferred = false;\n        /** @hidden */ this._id = 0;\n        /** @hidden */ this._sorted = false;\n        this._router = router;\n        this.urlRuleFactory = new UrlRuleFactory(router);\n        createProxyFunctions(val(UrlRouter.prototype), this, val(this));\n    }\n    /** @internalapi */\n    UrlRouter.prototype.dispose = function () {\n        this.listen(false);\n        this._rules = [];\n        delete this._otherwiseFn;\n    };\n    /** @inheritdoc */\n    UrlRouter.prototype.sort = function (compareFn) {\n        this._rules.sort(this._sortFn = compareFn || this._sortFn);\n        this._sorted = true;\n    };\n    UrlRouter.prototype.ensureSorted = function () {\n        this._sorted || this.sort();\n    };\n    /**\n     * Given a URL, check all rules and return the best [[MatchResult]]\n     * @param url\n     * @returns {MatchResult}\n     */\n    UrlRouter.prototype.match = function (url) {\n        var _this = this;\n        this.ensureSorted();\n        url = extend({ path: '', search: {}, hash: '' }, url);\n        var rules = this.rules();\n        if (this._otherwiseFn)\n            rules.push(this._otherwiseFn);\n        // Checks a single rule. Returns { rule: rule, match: match, weight: weight } if it matched, or undefined\n        var checkRule = function (rule) {\n            var match = rule.match(url, _this._router);\n            return match && { match: match, rule: rule, weight: rule.matchPriority(match) };\n        };\n        // The rules are pre-sorted.\n        // - Find the first matching rule.\n        // - Find any other matching rule that sorted *exactly the same*, according to `.sort()`.\n        // - Choose the rule with the highest match weight.\n        var best;\n        for (var i = 0; i < rules.length; i++) {\n            // Stop when there is a 'best' rule and the next rule sorts differently than it.\n            if (best && this._sortFn(rules[i], best.rule) !== 0)\n                break;\n            var current = checkRule(rules[i]);\n            // Pick the best MatchResult\n            best = (!best || current && current.weight > best.weight) ? current : best;\n        }\n        return best;\n    };\n    /** @inheritdoc */\n    UrlRouter.prototype.sync = function (evt) {\n        if (evt && evt.defaultPrevented)\n            return;\n        var router = this._router, $url = router.urlService, $state = router.stateService;\n        var url = {\n            path: $url.path(), search: $url.search(), hash: $url.hash(),\n        };\n        var best = this.match(url);\n        var applyResult = pattern([\n            [isString, function (newurl) { return $url.url(newurl, true); }],\n            [TargetState.isDef, function (def) { return $state.go(def.state, def.params, def.options); }],\n            [is(TargetState), function (target) { return $state.go(target.state(), target.params(), target.options()); }],\n        ]);\n        applyResult(best && best.rule.handler(best.match, url, router));\n    };\n    /** @inheritdoc */\n    UrlRouter.prototype.listen = function (enabled) {\n        var _this = this;\n        if (enabled === false) {\n            this._stopFn && this._stopFn();\n            delete this._stopFn;\n        }\n        else {\n            return this._stopFn = this._stopFn || this._router.urlService.onChange(function (evt) { return _this.sync(evt); });\n        }\n    };\n    /**\n     * Internal API.\n     * @internalapi\n     */\n    UrlRouter.prototype.update = function (read) {\n        var $url = this._router.locationService;\n        if (read) {\n            this.location = $url.path();\n            return;\n        }\n        if ($url.path() === this.location)\n            return;\n        $url.url(this.location, true);\n    };\n    /**\n     * Internal API.\n     *\n     * Pushes a new location to the browser history.\n     *\n     * @internalapi\n     * @param urlMatcher\n     * @param params\n     * @param options\n     */\n    UrlRouter.prototype.push = function (urlMatcher, params, options) {\n        var replace = options && !!options.replace;\n        this._router.urlService.url(urlMatcher.format(params || {}), replace);\n    };\n    /**\n     * Builds and returns a URL with interpolated parameters\n     *\n     * #### Example:\n     * ```js\n     * matcher = $umf.compile(\"/about/:person\");\n     * params = { person: \"bob\" };\n     * $bob = $urlRouter.href(matcher, params);\n     * // $bob == \"/about/bob\";\n     * ```\n     *\n     * @param urlMatcher The [[UrlMatcher]] object which is used as the template of the URL to generate.\n     * @param params An object of parameter values to fill the matcher's required parameters.\n     * @param options Options object. The options are:\n     *\n     * - **`absolute`** - {boolean=false},  If true will generate an absolute url, e.g. \"http://www.example.com/fullurl\".\n     *\n     * @returns Returns the fully compiled URL, or `null` if `params` fail validation against `urlMatcher`\n     */\n    UrlRouter.prototype.href = function (urlMatcher, params, options) {\n        var url = urlMatcher.format(params);\n        if (url == null)\n            return null;\n        options = options || { absolute: false };\n        var cfg = this._router.urlService.config;\n        var isHtml5 = cfg.html5Mode();\n        if (!isHtml5 && url !== null) {\n            url = \"#\" + cfg.hashPrefix() + url;\n        }\n        url = appendBasePath(url, isHtml5, options.absolute, cfg.baseHref());\n        if (!options.absolute || !url) {\n            return url;\n        }\n        var slash = (!isHtml5 && url ? '/' : ''), port = cfg.port();\n        port = (port === 80 || port === 443 ? '' : ':' + port);\n        return [cfg.protocol(), '://', cfg.host(), port, slash, url].join('');\n    };\n    /**\n     * Manually adds a URL Rule.\n     *\n     * Usually, a url rule is added using [[StateDeclaration.url]] or [[when]].\n     * This api can be used directly for more control (to register a [[BaseUrlRule]], for example).\n     * Rules can be created using [[UrlRouter.urlRuleFactory]], or create manually as simple objects.\n     *\n     * A rule should have a `match` function which returns truthy if the rule matched.\n     * It should also have a `handler` function which is invoked if the rule is the best match.\n     *\n     * @return a function that deregisters the rule\n     */\n    UrlRouter.prototype.rule = function (rule) {\n        var _this = this;\n        if (!UrlRuleFactory.isUrlRule(rule))\n            throw new Error(\"invalid rule\");\n        rule.$id = this._id++;\n        rule.priority = rule.priority || 0;\n        this._rules.push(rule);\n        this._sorted = false;\n        return function () { return _this.removeRule(rule); };\n    };\n    /** @inheritdoc */\n    UrlRouter.prototype.removeRule = function (rule) {\n        removeFrom(this._rules, rule);\n    };\n    /** @inheritdoc */\n    UrlRouter.prototype.rules = function () {\n        this.ensureSorted();\n        return this._rules.slice();\n    };\n    /** @inheritdoc */\n    UrlRouter.prototype.otherwise = function (handler) {\n        var handlerFn = getHandlerFn(handler);\n        this._otherwiseFn = this.urlRuleFactory.create(val(true), handlerFn);\n        this._sorted = false;\n    };\n    \n    /** @inheritdoc */\n    UrlRouter.prototype.initial = function (handler) {\n        var handlerFn = getHandlerFn(handler);\n        var matchFn = function (urlParts, router) {\n            return router.globals.transitionHistory.size() === 0 && !!/^\\/?$/.exec(urlParts.path);\n        };\n        this.rule(this.urlRuleFactory.create(matchFn, handlerFn));\n    };\n    \n    /** @inheritdoc */\n    UrlRouter.prototype.when = function (matcher, handler, options) {\n        var rule = this.urlRuleFactory.create(matcher, handler);\n        if (isDefined(options && options.priority))\n            rule.priority = options.priority;\n        this.rule(rule);\n        return rule;\n    };\n    \n    /** @inheritdoc */\n    UrlRouter.prototype.deferIntercept = function (defer) {\n        if (defer === undefined)\n            defer = true;\n        this.interceptDeferred = defer;\n    };\n    \n    return UrlRouter;\n}());\nfunction getHandlerFn(handler) {\n    if (!isFunction(handler) && !isString(handler) && !is(TargetState)(handler) && !TargetState.isDef(handler)) {\n        throw new Error(\"'handler' must be a string, function, TargetState, or have a state: 'newtarget' property\");\n    }\n    return isFunction(handler) ? handler : val(handler);\n}\n\n/**\n * @coreapi\n * @module view\n */ /** for typedoc */\n/**\n * The View service\n *\n * This service pairs existing `ui-view` components (which live in the DOM)\n * with view configs (from the state declaration objects: [[StateDeclaration.views]]).\n *\n * - After a successful Transition, the views from the newly entered states are activated via [[activateViewConfig]].\n *   The views from exited states are deactivated via [[deactivateViewConfig]].\n *   (See: the [[registerActivateViews]] Transition Hook)\n *\n * - As `ui-view` components pop in and out of existence, they register themselves using [[registerUIView]].\n *\n * - When the [[sync]] function is called, the registered `ui-view`(s) ([[ActiveUIView]])\n * are configured with the matching [[ViewConfig]](s)\n *\n */\nvar ViewService = (function () {\n    function ViewService() {\n        var _this = this;\n        this._uiViews = [];\n        this._viewConfigs = [];\n        this._viewConfigFactories = {};\n        this._pluginapi = {\n            _rootViewContext: this._rootViewContext.bind(this),\n            _viewConfigFactory: this._viewConfigFactory.bind(this),\n            _registeredUIViews: function () { return _this._uiViews; },\n            _activeViewConfigs: function () { return _this._viewConfigs; },\n        };\n    }\n    ViewService.prototype._rootViewContext = function (context) {\n        return this._rootContext = context || this._rootContext;\n    };\n    \n    ViewService.prototype._viewConfigFactory = function (viewType, factory) {\n        this._viewConfigFactories[viewType] = factory;\n    };\n    ViewService.prototype.createViewConfig = function (path, decl) {\n        var cfgFactory = this._viewConfigFactories[decl.$type];\n        if (!cfgFactory)\n            throw new Error(\"ViewService: No view config factory registered for type \" + decl.$type);\n        var cfgs = cfgFactory(path, decl);\n        return isArray(cfgs) ? cfgs : [cfgs];\n    };\n    /**\n     * Deactivates a ViewConfig.\n     *\n     * This function deactivates a `ViewConfig`.\n     * After calling [[sync]], it will un-pair from any `ui-view` with which it is currently paired.\n     *\n     * @param viewConfig The ViewConfig view to deregister.\n     */\n    ViewService.prototype.deactivateViewConfig = function (viewConfig) {\n        trace.traceViewServiceEvent(\"<- Removing\", viewConfig);\n        removeFrom(this._viewConfigs, viewConfig);\n    };\n    ViewService.prototype.activateViewConfig = function (viewConfig) {\n        trace.traceViewServiceEvent(\"-> Registering\", viewConfig);\n        this._viewConfigs.push(viewConfig);\n    };\n    ViewService.prototype.sync = function () {\n        var _this = this;\n        var uiViewsByFqn = this._uiViews.map(function (uiv) { return [uiv.fqn, uiv]; }).reduce(applyPairs, {});\n        // Return a weighted depth value for a uiView.\n        // The depth is the nesting depth of ui-views (based on FQN; times 10,000)\n        // plus the depth of the state that is populating the uiView\n        function uiViewDepth(uiView) {\n            var stateDepth = function (context) {\n                return context && context.parent ? stateDepth(context.parent) + 1 : 1;\n            };\n            return (uiView.fqn.split(\".\").length * 10000) + stateDepth(uiView.creationContext);\n        }\n        // Return the ViewConfig's context's depth in the context tree.\n        function viewConfigDepth(config) {\n            var context = config.viewDecl.$context, count = 0;\n            while (++count && context.parent)\n                context = context.parent;\n            return count;\n        }\n        // Given a depth function, returns a compare function which can return either ascending or descending order\n        var depthCompare = curry(function (depthFn, posNeg, left, right) { return posNeg * (depthFn(left) - depthFn(right)); });\n        var matchingConfigPair = function (uiView) {\n            var matchingConfigs = _this._viewConfigs.filter(ViewService.matches(uiViewsByFqn, uiView));\n            if (matchingConfigs.length > 1) {\n                // This is OK.  Child states can target a ui-view that the parent state also targets (the child wins)\n                // Sort by depth and return the match from the deepest child\n                // console.log(`Multiple matching view configs for ${uiView.fqn}`, matchingConfigs);\n                matchingConfigs.sort(depthCompare(viewConfigDepth, -1)); // descending\n            }\n            return [uiView, matchingConfigs[0]];\n        };\n        var configureUIView = function (_a) {\n            var uiView = _a[0], viewConfig = _a[1];\n            // If a parent ui-view is reconfigured, it could destroy child ui-views.\n            // Before configuring a child ui-view, make sure it's still in the active uiViews array.\n            if (_this._uiViews.indexOf(uiView) !== -1)\n                uiView.configUpdated(viewConfig);\n        };\n        // Sort views by FQN and state depth. Process uiviews nearest the root first.\n        this._uiViews.sort(depthCompare(uiViewDepth, 1)).map(matchingConfigPair).forEach(configureUIView);\n    };\n    \n    /**\n     * Registers a `ui-view` component\n     *\n     * When a `ui-view` component is created, it uses this method to register itself.\n     * After registration the [[sync]] method is used to ensure all `ui-view` are configured with the proper [[ViewConfig]].\n     *\n     * Note: the `ui-view` component uses the `ViewConfig` to determine what view should be loaded inside the `ui-view`,\n     * and what the view's state context is.\n     *\n     * Note: There is no corresponding `deregisterUIView`.\n     *       A `ui-view` should hang on to the return value of `registerUIView` and invoke it to deregister itself.\n     *\n     * @param uiView The metadata for a UIView\n     * @return a de-registration function used when the view is destroyed.\n     */\n    ViewService.prototype.registerUIView = function (uiView) {\n        trace.traceViewServiceUIViewEvent(\"-> Registering\", uiView);\n        var uiViews = this._uiViews;\n        var fqnMatches = function (uiv) { return uiv.fqn === uiView.fqn; };\n        if (uiViews.filter(fqnMatches).length)\n            trace.traceViewServiceUIViewEvent(\"!!!! duplicate uiView named:\", uiView);\n        uiViews.push(uiView);\n        this.sync();\n        return function () {\n            var idx = uiViews.indexOf(uiView);\n            if (idx === -1) {\n                trace.traceViewServiceUIViewEvent(\"Tried removing non-registered uiView\", uiView);\n                return;\n            }\n            trace.traceViewServiceUIViewEvent(\"<- Deregistering\", uiView);\n            removeFrom(uiViews)(uiView);\n        };\n    };\n    \n    /**\n     * Returns the list of views currently available on the page, by fully-qualified name.\n     *\n     * @return {Array} Returns an array of fully-qualified view names.\n     */\n    ViewService.prototype.available = function () {\n        return this._uiViews.map(prop(\"fqn\"));\n    };\n    /**\n     * Returns the list of views on the page containing loaded content.\n     *\n     * @return {Array} Returns an array of fully-qualified view names.\n     */\n    ViewService.prototype.active = function () {\n        return this._uiViews.filter(prop(\"$config\")).map(prop(\"name\"));\n    };\n    /**\n     * Normalizes a view's name from a state.views configuration block.\n     *\n     * This should be used by a framework implementation to calculate the values for\n     * [[_ViewDeclaration.$uiViewName]] and [[_ViewDeclaration.$uiViewContextAnchor]].\n     *\n     * @param context the context object (state declaration) that the view belongs to\n     * @param rawViewName the name of the view, as declared in the [[StateDeclaration.views]]\n     *\n     * @returns the normalized uiViewName and uiViewContextAnchor that the view targets\n     */\n    ViewService.normalizeUIViewTarget = function (context, rawViewName) {\n        if (rawViewName === void 0) { rawViewName = \"\"; }\n        // TODO: Validate incoming view name with a regexp to allow:\n        // ex: \"view.name@foo.bar\" , \"^.^.view.name\" , \"view.name@^.^\" , \"\" ,\n        // \"@\" , \"$default@^\" , \"!$default.$default\" , \"!foo.bar\"\n        var viewAtContext = rawViewName.split(\"@\");\n        var uiViewName = viewAtContext[0] || \"$default\"; // default to unnamed view\n        var uiViewContextAnchor = isString(viewAtContext[1]) ? viewAtContext[1] : \"^\"; // default to parent context\n        // Handle relative view-name sugar syntax.\n        // Matches rawViewName \"^.^.^.foo.bar\" into array: [\"^.^.^.foo.bar\", \"^.^.^\", \"foo.bar\"],\n        var relativeViewNameSugar = /^(\\^(?:\\.\\^)*)\\.(.*$)/.exec(uiViewName);\n        if (relativeViewNameSugar) {\n            // Clobbers existing contextAnchor (rawViewName validation will fix this)\n            uiViewContextAnchor = relativeViewNameSugar[1]; // set anchor to \"^.^.^\"\n            uiViewName = relativeViewNameSugar[2]; // set view-name to \"foo.bar\"\n        }\n        if (uiViewName.charAt(0) === '!') {\n            uiViewName = uiViewName.substr(1);\n            uiViewContextAnchor = \"\"; // target absolutely from root\n        }\n        // handle parent relative targeting \"^.^.^\"\n        var relativeMatch = /^(\\^(?:\\.\\^)*)$/;\n        if (relativeMatch.exec(uiViewContextAnchor)) {\n            var anchor = uiViewContextAnchor.split(\".\").reduce((function (anchor, x) { return anchor.parent; }), context);\n            uiViewContextAnchor = anchor.name;\n        }\n        else if (uiViewContextAnchor === '.') {\n            uiViewContextAnchor = context.name;\n        }\n        return { uiViewName: uiViewName, uiViewContextAnchor: uiViewContextAnchor };\n    };\n    return ViewService;\n}());\n/**\n * Given a ui-view and a ViewConfig, determines if they \"match\".\n *\n * A ui-view has a fully qualified name (fqn) and a context object.  The fqn is built from its overall location in\n * the DOM, describing its nesting relationship to any parent ui-view tags it is nested inside of.\n *\n * A ViewConfig has a target ui-view name and a context anchor.  The ui-view name can be a simple name, or\n * can be a segmented ui-view path, describing a portion of a ui-view fqn.\n *\n * In order for a ui-view to match ViewConfig, ui-view's $type must match the ViewConfig's $type\n *\n * If the ViewConfig's target ui-view name is a simple name (no dots), then a ui-view matches if:\n * - the ui-view's name matches the ViewConfig's target name\n * - the ui-view's context matches the ViewConfig's anchor\n *\n * If the ViewConfig's target ui-view name is a segmented name (with dots), then a ui-view matches if:\n * - There exists a parent ui-view where:\n *    - the parent ui-view's name matches the first segment (index 0) of the ViewConfig's target name\n *    - the parent ui-view's context matches the ViewConfig's anchor\n * - And the remaining segments (index 1..n) of the ViewConfig's target name match the tail of the ui-view's fqn\n *\n * Example:\n *\n * DOM:\n * <ui-view>                        <!-- created in the root context (name: \"\") -->\n *   <ui-view name=\"foo\">                <!-- created in the context named: \"A\"      -->\n *     <ui-view>                    <!-- created in the context named: \"A.B\"    -->\n *       <ui-view name=\"bar\">            <!-- created in the context named: \"A.B.C\"  -->\n *       </ui-view>\n *     </ui-view>\n *   </ui-view>\n * </ui-view>\n *\n * uiViews: [\n *  { fqn: \"$default\",                  creationContext: { name: \"\" } },\n *  { fqn: \"$default.foo\",              creationContext: { name: \"A\" } },\n *  { fqn: \"$default.foo.$default\",     creationContext: { name: \"A.B\" } }\n *  { fqn: \"$default.foo.$default.bar\", creationContext: { name: \"A.B.C\" } }\n * ]\n *\n * These four view configs all match the ui-view with the fqn: \"$default.foo.$default.bar\":\n *\n * - ViewConfig1: { uiViewName: \"bar\",                       uiViewContextAnchor: \"A.B.C\" }\n * - ViewConfig2: { uiViewName: \"$default.bar\",              uiViewContextAnchor: \"A.B\" }\n * - ViewConfig3: { uiViewName: \"foo.$default.bar\",          uiViewContextAnchor: \"A\" }\n * - ViewConfig4: { uiViewName: \"$default.foo.$default.bar\", uiViewContextAnchor: \"\" }\n *\n * Using ViewConfig3 as an example, it matches the ui-view with fqn \"$default.foo.$default.bar\" because:\n * - The ViewConfig's segmented target name is: [ \"foo\", \"$default\", \"bar\" ]\n * - There exists a parent ui-view (which has fqn: \"$default.foo\") where:\n *    - the parent ui-view's name \"foo\" matches the first segment \"foo\" of the ViewConfig's target name\n *    - the parent ui-view's context \"A\" matches the ViewConfig's anchor context \"A\"\n * - And the remaining segments [ \"$default\", \"bar\" ].join(\".\"_ of the ViewConfig's target name match\n *   the tail of the ui-view's fqn \"default.bar\"\n *\n * @internalapi\n */\nViewService.matches = function (uiViewsByFqn, uiView) { return function (viewConfig) {\n    // Don't supply an ng1 ui-view with an ng2 ViewConfig, etc\n    if (uiView.$type !== viewConfig.viewDecl.$type)\n        return false;\n    // Split names apart from both viewConfig and uiView into segments\n    var vc = viewConfig.viewDecl;\n    var vcSegments = vc.$uiViewName.split(\".\");\n    var uivSegments = uiView.fqn.split(\".\");\n    // Check if the tails of the segment arrays match. ex, these arrays' tails match:\n    // vc: [\"foo\", \"bar\"], uiv fqn: [\"$default\", \"foo\", \"bar\"]\n    if (!equals(vcSegments, uivSegments.slice(0 - vcSegments.length)))\n        return false;\n    // Now check if the fqn ending at the first segment of the viewConfig matches the context:\n    // [\"$default\", \"foo\"].join(\".\") == \"$default.foo\", does the ui-view $default.foo context match?\n    var negOffset = (1 - vcSegments.length) || undefined;\n    var fqnToFirstSegment = uivSegments.slice(0, negOffset).join(\".\");\n    var uiViewContext = uiViewsByFqn[fqnToFirstSegment].creationContext;\n    return vc.$uiViewContextAnchor === (uiViewContext && uiViewContext.name);\n}; };\n\n/**\n * @coreapi\n * @module core\n */ /** */\n/**\n * Global router state\n *\n * This is where we hold the global mutable state such as current state, current\n * params, current transition, etc.\n */\nvar UIRouterGlobals = (function () {\n    function UIRouterGlobals() {\n        /**\n         * Current parameter values\n         *\n         * The parameter values from the latest successful transition\n         */\n        this.params = new StateParams();\n        /** @internalapi */\n        this.lastStartedTransitionId = -1;\n        /** @internalapi */\n        this.transitionHistory = new Queue([], 1);\n        /** @internalapi */\n        this.successfulTransitions = new Queue([], 1);\n    }\n    UIRouterGlobals.prototype.dispose = function () {\n        this.transitionHistory.clear();\n        this.successfulTransitions.clear();\n        this.transition = null;\n    };\n    return UIRouterGlobals;\n}());\n\n/**\n * @coreapi\n * @module url\n */ /** */\n/** @hidden */\nvar makeStub = function (keys) {\n    return keys.reduce(function (acc, key) { return (acc[key] = notImplemented(key), acc); }, { dispose: noop$1 });\n};\n/** @hidden */ var locationServicesFns = [\"url\", \"path\", \"search\", \"hash\", \"onChange\"];\n/** @hidden */ var locationConfigFns = [\"port\", \"protocol\", \"host\", \"baseHref\", \"html5Mode\", \"hashPrefix\"];\n/** @hidden */ var umfFns = [\"type\", \"caseInsensitive\", \"strictMode\", \"defaultSquashPolicy\"];\n/** @hidden */ var rulesFns = [\"sort\", \"when\", \"initial\", \"otherwise\", \"rules\", \"rule\", \"removeRule\"];\n/** @hidden */ var syncFns = [\"deferIntercept\", \"listen\", \"sync\", \"match\"];\n/**\n * API for URL management\n */\nvar UrlService = (function () {\n    /** @hidden */\n    function UrlService(router, lateBind) {\n        if (lateBind === void 0) { lateBind = true; }\n        this.router = router;\n        this.rules = {};\n        this.config = {};\n        // proxy function calls from UrlService to the LocationService/LocationConfig\n        var locationServices = function () { return router.locationService; };\n        createProxyFunctions(locationServices, this, locationServices, locationServicesFns, lateBind);\n        var locationConfig = function () { return router.locationConfig; };\n        createProxyFunctions(locationConfig, this.config, locationConfig, locationConfigFns, lateBind);\n        var umf = function () { return router.urlMatcherFactory; };\n        createProxyFunctions(umf, this.config, umf, umfFns);\n        var urlRouter = function () { return router.urlRouter; };\n        createProxyFunctions(urlRouter, this.rules, urlRouter, rulesFns);\n        createProxyFunctions(urlRouter, this, urlRouter, syncFns);\n    }\n    UrlService.prototype.url = function (newurl, replace, state) { return; };\n    \n    /** @inheritdoc */\n    UrlService.prototype.path = function () { return; };\n    \n    /** @inheritdoc */\n    UrlService.prototype.search = function () { return; };\n    \n    /** @inheritdoc */\n    UrlService.prototype.hash = function () { return; };\n    \n    /** @inheritdoc */\n    UrlService.prototype.onChange = function (callback) { return; };\n    \n    /**\n     * Returns the current URL parts\n     *\n     * This method returns the current URL components as a [[UrlParts]] object.\n     *\n     * @returns the current url parts\n     */\n    UrlService.prototype.parts = function () {\n        return { path: this.path(), search: this.search(), hash: this.hash() };\n    };\n    UrlService.prototype.dispose = function () { };\n    /** @inheritdoc */\n    UrlService.prototype.sync = function (evt) { return; };\n    /** @inheritdoc */\n    UrlService.prototype.listen = function (enabled) { return; };\n    \n    /** @inheritdoc */\n    UrlService.prototype.deferIntercept = function (defer) { return; };\n    /** @inheritdoc */\n    UrlService.prototype.match = function (urlParts) { return; };\n    return UrlService;\n}());\n/** @hidden */\nUrlService.locationServiceStub = makeStub(locationServicesFns);\n/** @hidden */\nUrlService.locationConfigStub = makeStub(locationConfigFns);\n\n/**\n * @coreapi\n * @module core\n */ /** */\n/** @hidden */\nvar _routerInstance = 0;\n/**\n * The master class used to instantiate an instance of UI-Router.\n *\n * UI-Router (for each specific framework) will create an instance of this class during bootstrap.\n * This class instantiates and wires the UI-Router services together.\n *\n * After a new instance of the UIRouter class is created, it should be configured for your app.\n * For instance, app states should be registered with the [[UIRouter.stateRegistry]].\n *\n * ---\n *\n * Normally the framework code will bootstrap UI-Router.\n * If you are bootstrapping UIRouter manually, tell it to monitor the URL by calling\n * [[UrlService.listen]] then [[UrlService.sync]].\n */\nvar UIRouter = (function () {\n    /**\n     * Creates a new `UIRouter` object\n     *\n     * @param locationService a [[LocationServices]] implementation\n     * @param locationConfig a [[LocationConfig]] implementation\n     * @internalapi\n     */\n    function UIRouter(locationService, locationConfig) {\n        if (locationService === void 0) { locationService = UrlService.locationServiceStub; }\n        if (locationConfig === void 0) { locationConfig = UrlService.locationConfigStub; }\n        this.locationService = locationService;\n        this.locationConfig = locationConfig;\n        /** @hidden */ this.$id = _routerInstance++;\n        /** @hidden */ this._disposed = false;\n        /** @hidden */ this._disposables = [];\n        /** Provides trace information to the console */\n        this.trace = trace;\n        /** Provides services related to ui-view synchronization */\n        this.viewService = new ViewService();\n        /** Provides services related to Transitions */\n        this.transitionService = new TransitionService(this);\n        /** Global router state */\n        this.globals = new UIRouterGlobals();\n        /**\n         * Deprecated for public use. Use [[urlService]] instead.\n         * @deprecated Use [[urlService]] instead\n         */\n        this.urlMatcherFactory = new UrlMatcherFactory();\n        /**\n         * Deprecated for public use. Use [[urlService]] instead.\n         * @deprecated Use [[urlService]] instead\n         */\n        this.urlRouter = new UrlRouter(this);\n        /** Provides a registry for states, and related registration services */\n        this.stateRegistry = new StateRegistry(this);\n        /** Provides services related to states */\n        this.stateService = new StateService(this);\n        /** Provides services related to the URL */\n        this.urlService = new UrlService(this);\n        /** @hidden */\n        this._plugins = {};\n        this.viewService._pluginapi._rootViewContext(this.stateRegistry.root());\n        this.globals.$current = this.stateRegistry.root();\n        this.globals.current = this.globals.$current.self;\n        this.disposable(this.globals);\n        this.disposable(this.stateService);\n        this.disposable(this.stateRegistry);\n        this.disposable(this.transitionService);\n        this.disposable(this.urlRouter);\n        this.disposable(locationService);\n        this.disposable(locationConfig);\n    }\n    /** Registers an object to be notified when the router is disposed */\n    UIRouter.prototype.disposable = function (disposable) {\n        this._disposables.push(disposable);\n    };\n    /**\n     * Disposes this router instance\n     *\n     * When called, clears resources retained by the router by calling `dispose(this)` on all\n     * registered [[disposable]] objects.\n     *\n     * Or, if a `disposable` object is provided, calls `dispose(this)` on that object only.\n     *\n     * @param disposable (optional) the disposable to dispose\n     */\n    UIRouter.prototype.dispose = function (disposable) {\n        var _this = this;\n        if (disposable && isFunction(disposable.dispose)) {\n            disposable.dispose(this);\n            return undefined;\n        }\n        this._disposed = true;\n        this._disposables.slice().forEach(function (d) {\n            try {\n                typeof d.dispose === 'function' && d.dispose(_this);\n                removeFrom(_this._disposables, d);\n            }\n            catch (ignored) { }\n        });\n    };\n    /**\n     * Adds a plugin to UI-Router\n     *\n     * This method adds a UI-Router Plugin.\n     * A plugin can enhance or change UI-Router behavior using any public API.\n     *\n     * #### Example:\n     * ```js\n     * import { MyCoolPlugin } from \"ui-router-cool-plugin\";\n     *\n     * var plugin = router.addPlugin(MyCoolPlugin);\n     * ```\n     *\n     * ### Plugin authoring\n     *\n     * A plugin is simply a class (or constructor function) which accepts a [[UIRouter]] instance and (optionally) an options object.\n     *\n     * The plugin can implement its functionality using any of the public APIs of [[UIRouter]].\n     * For example, it may configure router options or add a Transition Hook.\n     *\n     * The plugin can then be published as a separate module.\n     *\n     * #### Example:\n     * ```js\n     * export class MyAuthPlugin implements UIRouterPlugin {\n     *   constructor(router: UIRouter, options: any) {\n     *     this.name = \"MyAuthPlugin\";\n     *     let $transitions = router.transitionService;\n     *     let $state = router.stateService;\n     *\n     *     let authCriteria = {\n     *       to: (state) => state.data && state.data.requiresAuth\n     *     };\n     *\n     *     function authHook(transition: Transition) {\n     *       let authService = transition.injector().get('AuthService');\n     *       if (!authService.isAuthenticated()) {\n     *         return $state.target('login');\n     *       }\n     *     }\n     *\n     *     $transitions.onStart(authCriteria, authHook);\n     *   }\n     * }\n     * ```\n     *\n     * @param plugin one of:\n     *        - a plugin class which implements [[UIRouterPlugin]]\n     *        - a constructor function for a [[UIRouterPlugin]] which accepts a [[UIRouter]] instance\n     *        - a factory function which accepts a [[UIRouter]] instance and returns a [[UIRouterPlugin]] instance\n     * @param options options to pass to the plugin class/factory\n     * @returns the registered plugin instance\n     */\n    UIRouter.prototype.plugin = function (plugin, options) {\n        if (options === void 0) { options = {}; }\n        var pluginInstance = new plugin(this, options);\n        if (!pluginInstance.name)\n            throw new Error(\"Required property `name` missing on plugin: \" + pluginInstance);\n        this._disposables.push(pluginInstance);\n        return this._plugins[pluginInstance.name] = pluginInstance;\n    };\n    UIRouter.prototype.getPlugin = function (pluginName) {\n        return pluginName ? this._plugins[pluginName] : values(this._plugins);\n    };\n    return UIRouter;\n}());\n\n/** @module hooks */ /** */\nfunction addCoreResolvables(trans) {\n    trans.addResolvable({ token: UIRouter, deps: [], resolveFn: function () { return trans.router; }, data: trans.router }, \"\");\n    trans.addResolvable({ token: Transition, deps: [], resolveFn: function () { return trans; }, data: trans }, \"\");\n    trans.addResolvable({ token: '$transition$', deps: [], resolveFn: function () { return trans; }, data: trans }, \"\");\n    trans.addResolvable({ token: '$stateParams', deps: [], resolveFn: function () { return trans.params(); }, data: trans.params() }, \"\");\n    trans.entering().forEach(function (state) {\n        trans.addResolvable({ token: '$state$', deps: [], resolveFn: function () { return state; }, data: state }, state);\n    });\n}\nvar registerAddCoreResolvables = function (transitionService) {\n    return transitionService.onCreate({}, addCoreResolvables);\n};\n\n/** @module hooks */ /** */\n/**\n * A [[TransitionHookFn]] that redirects to a different state or params\n *\n * Registered using `transitionService.onStart({ to: (state) => !!state.redirectTo }, redirectHook);`\n *\n * See [[StateDeclaration.redirectTo]]\n */\nvar redirectToHook = function (trans) {\n    var redirect = trans.to().redirectTo;\n    if (!redirect)\n        return;\n    var $state = trans.router.stateService;\n    function handleResult(result) {\n        if (!result)\n            return;\n        if (result instanceof TargetState)\n            return result;\n        if (isString(result))\n            return $state.target(result, trans.params(), trans.options());\n        if (result['state'] || result['params'])\n            return $state.target(result['state'] || trans.to(), result['params'] || trans.params(), trans.options());\n    }\n    if (isFunction(redirect)) {\n        return services.$q.when(redirect(trans)).then(handleResult);\n    }\n    return handleResult(redirect);\n};\nvar registerRedirectToHook = function (transitionService) {\n    return transitionService.onStart({ to: function (state) { return !!state.redirectTo; } }, redirectToHook);\n};\n\n/**\n * A factory which creates an onEnter, onExit or onRetain transition hook function\n *\n * The returned function invokes the (for instance) state.onEnter hook when the\n * state is being entered.\n *\n * @hidden\n */\nfunction makeEnterExitRetainHook(hookName) {\n    return function (transition, state) {\n        var _state = state.$$state();\n        var hookFn = _state[hookName];\n        return hookFn(transition, state);\n    };\n}\n/**\n * The [[TransitionStateHookFn]] for onExit\n *\n * When the state is being exited, the state's .onExit function is invoked.\n *\n * Registered using `transitionService.onExit({ exiting: (state) => !!state.onExit }, onExitHook);`\n *\n * See: [[IHookRegistry.onExit]]\n */\nvar onExitHook = makeEnterExitRetainHook('onExit');\nvar registerOnExitHook = function (transitionService) {\n    return transitionService.onExit({ exiting: function (state) { return !!state.onExit; } }, onExitHook);\n};\n/**\n * The [[TransitionStateHookFn]] for onRetain\n *\n * When the state was already entered, and is not being exited or re-entered, the state's .onRetain function is invoked.\n *\n * Registered using `transitionService.onRetain({ retained: (state) => !!state.onRetain }, onRetainHook);`\n *\n * See: [[IHookRegistry.onRetain]]\n */\nvar onRetainHook = makeEnterExitRetainHook('onRetain');\nvar registerOnRetainHook = function (transitionService) {\n    return transitionService.onRetain({ retained: function (state) { return !!state.onRetain; } }, onRetainHook);\n};\n/**\n * The [[TransitionStateHookFn]] for onEnter\n *\n * When the state is being entered, the state's .onEnter function is invoked.\n *\n * Registered using `transitionService.onEnter({ entering: (state) => !!state.onEnter }, onEnterHook);`\n *\n * See: [[IHookRegistry.onEnter]]\n */\nvar onEnterHook = makeEnterExitRetainHook('onEnter');\nvar registerOnEnterHook = function (transitionService) {\n    return transitionService.onEnter({ entering: function (state) { return !!state.onEnter; } }, onEnterHook);\n};\n\n/** @module hooks */\n/** for typedoc */\n/**\n * A [[TransitionHookFn]] which resolves all EAGER Resolvables in the To Path\n *\n * Registered using `transitionService.onStart({}, eagerResolvePath);`\n *\n * When a Transition starts, this hook resolves all the EAGER Resolvables, which the transition then waits for.\n *\n * See [[StateDeclaration.resolve]]\n */\nvar eagerResolvePath = function (trans) {\n    return new ResolveContext(trans.treeChanges().to)\n        .resolvePath(\"EAGER\", trans)\n        .then(noop$1);\n};\nvar registerEagerResolvePath = function (transitionService) {\n    return transitionService.onStart({}, eagerResolvePath, { priority: 1000 });\n};\n/**\n * A [[TransitionHookFn]] which resolves all LAZY Resolvables for the state (and all its ancestors) in the To Path\n *\n * Registered using `transitionService.onEnter({ entering: () => true }, lazyResolveState);`\n *\n * When a State is being entered, this hook resolves all the Resolvables for this state, which the transition then waits for.\n *\n * See [[StateDeclaration.resolve]]\n */\nvar lazyResolveState = function (trans, state) {\n    return new ResolveContext(trans.treeChanges().to)\n        .subContext(state.$$state())\n        .resolvePath(\"LAZY\", trans)\n        .then(noop$1);\n};\nvar registerLazyResolveState = function (transitionService) {\n    return transitionService.onEnter({ entering: val(true) }, lazyResolveState, { priority: 1000 });\n};\n\n/** @module hooks */ /** for typedoc */\n/**\n * A [[TransitionHookFn]] which waits for the views to load\n *\n * Registered using `transitionService.onStart({}, loadEnteringViews);`\n *\n * Allows the views to do async work in [[ViewConfig.load]] before the transition continues.\n * In angular 1, this includes loading the templates.\n */\nvar loadEnteringViews = function (transition) {\n    var $q = services.$q;\n    var enteringViews = transition.views(\"entering\");\n    if (!enteringViews.length)\n        return;\n    return $q.all(enteringViews.map(function (view) { return $q.when(view.load()); })).then(noop$1);\n};\nvar registerLoadEnteringViews = function (transitionService) {\n    return transitionService.onFinish({}, loadEnteringViews);\n};\n/**\n * A [[TransitionHookFn]] which activates the new views when a transition is successful.\n *\n * Registered using `transitionService.onSuccess({}, activateViews);`\n *\n * After a transition is complete, this hook deactivates the old views from the previous state,\n * and activates the new views from the destination state.\n *\n * See [[ViewService]]\n */\nvar activateViews = function (transition) {\n    var enteringViews = transition.views(\"entering\");\n    var exitingViews = transition.views(\"exiting\");\n    if (!enteringViews.length && !exitingViews.length)\n        return;\n    var $view = transition.router.viewService;\n    exitingViews.forEach(function (vc) { return $view.deactivateViewConfig(vc); });\n    enteringViews.forEach(function (vc) { return $view.activateViewConfig(vc); });\n    $view.sync();\n};\nvar registerActivateViews = function (transitionService) {\n    return transitionService.onSuccess({}, activateViews);\n};\n\n/**\n * A [[TransitionHookFn]] which updates global UI-Router state\n *\n * Registered using `transitionService.onBefore({}, updateGlobalState);`\n *\n * Before a [[Transition]] starts, updates the global value of \"the current transition\" ([[Globals.transition]]).\n * After a successful [[Transition]], updates the global values of \"the current state\"\n * ([[Globals.current]] and [[Globals.$current]]) and \"the current param values\" ([[Globals.params]]).\n *\n * See also the deprecated properties:\n * [[StateService.transition]], [[StateService.current]], [[StateService.params]]\n */\nvar updateGlobalState = function (trans) {\n    var globals = trans.router.globals;\n    var transitionSuccessful = function () {\n        globals.successfulTransitions.enqueue(trans);\n        globals.$current = trans.$to();\n        globals.current = globals.$current.self;\n        copy(trans.params(), globals.params);\n    };\n    var clearCurrentTransition = function () {\n        // Do not clear globals.transition if a different transition has started in the meantime\n        if (globals.transition === trans)\n            globals.transition = null;\n    };\n    trans.onSuccess({}, transitionSuccessful, { priority: 10000 });\n    trans.promise.then(clearCurrentTransition, clearCurrentTransition);\n};\nvar registerUpdateGlobalState = function (transitionService) {\n    return transitionService.onCreate({}, updateGlobalState);\n};\n\n/**\n * A [[TransitionHookFn]] which updates the URL after a successful transition\n *\n * Registered using `transitionService.onSuccess({}, updateUrl);`\n */\nvar updateUrl = function (transition) {\n    var options = transition.options();\n    var $state = transition.router.stateService;\n    var $urlRouter = transition.router.urlRouter;\n    // Dont update the url in these situations:\n    // The transition was triggered by a URL sync (options.source === 'url')\n    // The user doesn't want the url to update (options.location === false)\n    // The destination state, and all parents have no navigable url\n    if (options.source !== 'url' && options.location && $state.$current.navigable) {\n        var urlOptions = { replace: options.location === 'replace' };\n        $urlRouter.push($state.$current.navigable.url, $state.params, urlOptions);\n    }\n    $urlRouter.update(true);\n};\nvar registerUpdateUrl = function (transitionService) {\n    return transitionService.onSuccess({}, updateUrl, { priority: 9999 });\n};\n\n/**\n * A [[TransitionHookFn]] that performs lazy loading\n *\n * When entering a state \"abc\" which has a `lazyLoad` function defined:\n * - Invoke the `lazyLoad` function (unless it is already in process)\n *   - Flag the hook function as \"in process\"\n *   - The function should return a promise (that resolves when lazy loading is complete)\n * - Wait for the promise to settle\n *   - If the promise resolves to a [[LazyLoadResult]], then register those states\n *   - Flag the hook function as \"not in process\"\n * - If the hook was successful\n *   - Remove the `lazyLoad` function from the state declaration\n * - If all the hooks were successful\n *   - Retry the transition (by returning a TargetState)\n *\n * ```\n * .state('abc', {\n *   component: 'fooComponent',\n *   lazyLoad: () => System.import('./fooComponent')\n *   });\n * ```\n *\n * See [[StateDeclaration.lazyLoad]]\n */\nvar lazyLoadHook = function (transition) {\n    var router = transition.router;\n    function retryTransition() {\n        if (transition.originalTransition().options().source !== 'url') {\n            // The original transition was not triggered via url sync\n            // The lazy state should be loaded now, so re-try the original transition\n            var orig = transition.targetState();\n            return router.stateService.target(orig.identifier(), orig.params(), orig.options());\n        }\n        // The original transition was triggered via url sync\n        // Run the URL rules and find the best match\n        var $url = router.urlService;\n        var result = $url.match($url.parts());\n        var rule = result && result.rule;\n        // If the best match is a state, redirect the transition (instead\n        // of calling sync() which supersedes the current transition)\n        if (rule && rule.type === \"STATE\") {\n            var state = rule.state;\n            var params = result.match;\n            return router.stateService.target(state, params, transition.options());\n        }\n        // No matching state found, so let .sync() choose the best non-state match/otherwise\n        router.urlService.sync();\n    }\n    var promises = transition.entering()\n        .filter(function (state) { return !!state.$$state().lazyLoad; })\n        .map(function (state) { return lazyLoadState(transition, state); });\n    return services.$q.all(promises).then(retryTransition);\n};\nvar registerLazyLoadHook = function (transitionService) {\n    return transitionService.onBefore({ entering: function (state) { return !!state.lazyLoad; } }, lazyLoadHook);\n};\n/**\n * Invokes a state's lazy load function\n *\n * @param transition a Transition context\n * @param state the state to lazy load\n * @returns A promise for the lazy load result\n */\nfunction lazyLoadState(transition, state) {\n    var lazyLoadFn = state.$$state().lazyLoad;\n    // Store/get the lazy load promise on/from the hookfn so it doesn't get re-invoked\n    var promise = lazyLoadFn['_promise'];\n    if (!promise) {\n        var success = function (result) {\n            delete state.lazyLoad;\n            delete state.$$state().lazyLoad;\n            delete lazyLoadFn['_promise'];\n            return result;\n        };\n        var error = function (err) {\n            delete lazyLoadFn['_promise'];\n            return services.$q.reject(err);\n        };\n        promise = lazyLoadFn['_promise'] =\n            services.$q.when(lazyLoadFn(transition, state))\n                .then(updateStateRegistry)\n                .then(success, error);\n    }\n    /** Register any lazy loaded state definitions */\n    function updateStateRegistry(result) {\n        if (result && Array.isArray(result.states)) {\n            result.states.forEach(function (state) { return transition.router.stateRegistry.register(state); });\n        }\n        return result;\n    }\n    return promise;\n}\n\n/**\n * This class defines a type of hook, such as `onBefore` or `onEnter`.\n * Plugins can define custom hook types, such as sticky states does for `onInactive`.\n *\n * @interalapi\n */\nvar TransitionEventType = (function () {\n    function TransitionEventType(name, hookPhase, hookOrder, criteriaMatchPath, reverseSort, getResultHandler, getErrorHandler, synchronous) {\n        if (reverseSort === void 0) { reverseSort = false; }\n        if (getResultHandler === void 0) { getResultHandler = TransitionHook.HANDLE_RESULT; }\n        if (getErrorHandler === void 0) { getErrorHandler = TransitionHook.REJECT_ERROR; }\n        if (synchronous === void 0) { synchronous = false; }\n        this.name = name;\n        this.hookPhase = hookPhase;\n        this.hookOrder = hookOrder;\n        this.criteriaMatchPath = criteriaMatchPath;\n        this.reverseSort = reverseSort;\n        this.getResultHandler = getResultHandler;\n        this.getErrorHandler = getErrorHandler;\n        this.synchronous = synchronous;\n    }\n    return TransitionEventType;\n}());\n\n/** @module hooks */ /** */\n/**\n * A [[TransitionHookFn]] that skips a transition if it should be ignored\n *\n * This hook is invoked at the end of the onBefore phase.\n *\n * If the transition should be ignored (because no parameter or states changed)\n * then the transition is ignored and not processed.\n */\nfunction ignoredHook(trans) {\n    var ignoredReason = trans._ignoredReason();\n    if (!ignoredReason)\n        return;\n    trace.traceTransitionIgnored(trans);\n    var pending = trans.router.globals.transition;\n    // The user clicked a link going back to the *current state* ('A')\n    // However, there is also a pending transition in flight (to 'B')\n    // Abort the transition to 'B' because the user now wants to be back at 'A'.\n    if (ignoredReason === 'SameAsCurrent' && pending) {\n        pending.abort();\n    }\n    return Rejection.ignored().toPromise();\n}\nvar registerIgnoredTransitionHook = function (transitionService) {\n    return transitionService.onBefore({}, ignoredHook, { priority: -9999 });\n};\n\n/** @module hooks */ /** */\n/**\n * A [[TransitionHookFn]] that rejects the Transition if it is invalid\n *\n * This hook is invoked at the end of the onBefore phase.\n * If the transition is invalid (for example, param values do not validate)\n * then the transition is rejected.\n */\nfunction invalidTransitionHook(trans) {\n    if (!trans.valid()) {\n        throw new Error(trans.error());\n    }\n}\nvar registerInvalidTransitionHook = function (transitionService) {\n    return transitionService.onBefore({}, invalidTransitionHook, { priority: -10000 });\n};\n\n/**\n * @coreapi\n * @module transition\n */\n/** for typedoc */\n/**\n * The default [[Transition]] options.\n *\n * Include this object when applying custom defaults:\n * let reloadOpts = { reload: true, notify: true }\n * let options = defaults(theirOpts, customDefaults, defaultOptions);\n */\nvar defaultTransOpts = {\n    location: true,\n    relative: null,\n    inherit: false,\n    notify: true,\n    reload: false,\n    custom: {},\n    current: function () { return null; },\n    source: \"unknown\"\n};\n/**\n * This class provides services related to Transitions.\n *\n * - Most importantly, it allows global Transition Hooks to be registered.\n * - It allows the default transition error handler to be set.\n * - It also has a factory function for creating new [[Transition]] objects, (used internally by the [[StateService]]).\n *\n * At bootstrap, [[UIRouter]] creates a single instance (singleton) of this class.\n */\nvar TransitionService = (function () {\n    /** @hidden */\n    function TransitionService(_router) {\n        /** @hidden */\n        this._transitionCount = 0;\n        /** @hidden The transition hook types, such as `onEnter`, `onStart`, etc */\n        this._eventTypes = [];\n        /** @hidden The registered transition hooks */\n        this._registeredHooks = {};\n        /** @hidden The  paths on a criteria object */\n        this._criteriaPaths = {};\n        this._router = _router;\n        this.$view = _router.viewService;\n        this._deregisterHookFns = {};\n        this._pluginapi = createProxyFunctions(val(this), {}, val(this), [\n            '_definePathType',\n            '_defineEvent',\n            '_getPathTypes',\n            '_getEvents',\n            'getHooks',\n        ]);\n        this._defineCorePaths();\n        this._defineCoreEvents();\n        this._registerCoreTransitionHooks();\n    }\n    /**\n     * Registers a [[TransitionHookFn]], called *while a transition is being constructed*.\n     *\n     * Registers a transition lifecycle hook, which is invoked during transition construction.\n     *\n     * This low level hook should only be used by plugins.\n     * This can be a useful time for plugins to add resolves or mutate the transition as needed.\n     * The Sticky States plugin uses this hook to modify the treechanges.\n     *\n     * ### Lifecycle\n     *\n     * `onCreate` hooks are invoked *while a transition is being constructed*.\n     *\n     * ### Return value\n     *\n     * The hook's return value is ignored\n     *\n     * @internalapi\n     * @param criteria defines which Transitions the Hook should be invoked for.\n     * @param callback the hook function which will be invoked.\n     * @param options the registration options\n     * @returns a function which deregisters the hook.\n     */\n    TransitionService.prototype.onCreate = function (criteria, callback, options) { return; };\n    /** @inheritdoc */\n    TransitionService.prototype.onBefore = function (criteria, callback, options) { return; };\n    /** @inheritdoc */\n    TransitionService.prototype.onStart = function (criteria, callback, options) { return; };\n    /** @inheritdoc */\n    TransitionService.prototype.onExit = function (criteria, callback, options) { return; };\n    /** @inheritdoc */\n    TransitionService.prototype.onRetain = function (criteria, callback, options) { return; };\n    /** @inheritdoc */\n    TransitionService.prototype.onEnter = function (criteria, callback, options) { return; };\n    /** @inheritdoc */\n    TransitionService.prototype.onFinish = function (criteria, callback, options) { return; };\n    /** @inheritdoc */\n    TransitionService.prototype.onSuccess = function (criteria, callback, options) { return; };\n    /** @inheritdoc */\n    TransitionService.prototype.onError = function (criteria, callback, options) { return; };\n    /**\n     * dispose\n     * @internalapi\n     */\n    TransitionService.prototype.dispose = function (router) {\n        values(this._registeredHooks).forEach(function (hooksArray) { return hooksArray.forEach(function (hook) {\n            hook._deregistered = true;\n            removeFrom(hooksArray, hook);\n        }); });\n    };\n    /**\n     * Creates a new [[Transition]] object\n     *\n     * This is a factory function for creating new Transition objects.\n     * It is used internally by the [[StateService]] and should generally not be called by application code.\n     *\n     * @param fromPath the path to the current state (the from state)\n     * @param targetState the target state (destination)\n     * @returns a Transition\n     */\n    TransitionService.prototype.create = function (fromPath, targetState) {\n        return new Transition(fromPath, targetState, this._router);\n    };\n    /** @hidden */\n    TransitionService.prototype._defineCoreEvents = function () {\n        var Phase = exports.TransitionHookPhase;\n        var TH = TransitionHook;\n        var paths = this._criteriaPaths;\n        var NORMAL_SORT = false, REVERSE_SORT = true;\n        var ASYNCHRONOUS = false, SYNCHRONOUS = true;\n        this._defineEvent(\"onCreate\", Phase.CREATE, 0, paths.to, NORMAL_SORT, TH.LOG_REJECTED_RESULT, TH.THROW_ERROR, SYNCHRONOUS);\n        this._defineEvent(\"onBefore\", Phase.BEFORE, 0, paths.to);\n        this._defineEvent(\"onStart\", Phase.RUN, 0, paths.to);\n        this._defineEvent(\"onExit\", Phase.RUN, 100, paths.exiting, REVERSE_SORT);\n        this._defineEvent(\"onRetain\", Phase.RUN, 200, paths.retained);\n        this._defineEvent(\"onEnter\", Phase.RUN, 300, paths.entering);\n        this._defineEvent(\"onFinish\", Phase.RUN, 400, paths.to);\n        this._defineEvent(\"onSuccess\", Phase.SUCCESS, 0, paths.to, NORMAL_SORT, TH.LOG_REJECTED_RESULT, TH.LOG_ERROR, SYNCHRONOUS);\n        this._defineEvent(\"onError\", Phase.ERROR, 0, paths.to, NORMAL_SORT, TH.LOG_REJECTED_RESULT, TH.LOG_ERROR, SYNCHRONOUS);\n    };\n    /** @hidden */\n    TransitionService.prototype._defineCorePaths = function () {\n        var STATE = exports.TransitionHookScope.STATE, TRANSITION = exports.TransitionHookScope.TRANSITION;\n        this._definePathType(\"to\", TRANSITION);\n        this._definePathType(\"from\", TRANSITION);\n        this._definePathType(\"exiting\", STATE);\n        this._definePathType(\"retained\", STATE);\n        this._definePathType(\"entering\", STATE);\n    };\n    /** @hidden */\n    TransitionService.prototype._defineEvent = function (name, hookPhase, hookOrder, criteriaMatchPath, reverseSort, getResultHandler, getErrorHandler, synchronous) {\n        if (reverseSort === void 0) { reverseSort = false; }\n        if (getResultHandler === void 0) { getResultHandler = TransitionHook.HANDLE_RESULT; }\n        if (getErrorHandler === void 0) { getErrorHandler = TransitionHook.REJECT_ERROR; }\n        if (synchronous === void 0) { synchronous = false; }\n        var eventType = new TransitionEventType(name, hookPhase, hookOrder, criteriaMatchPath, reverseSort, getResultHandler, getErrorHandler, synchronous);\n        this._eventTypes.push(eventType);\n        makeEvent(this, this, eventType);\n    };\n    \n    /** @hidden */\n    TransitionService.prototype._getEvents = function (phase) {\n        var transitionHookTypes = isDefined(phase) ?\n            this._eventTypes.filter(function (type) { return type.hookPhase === phase; }) :\n            this._eventTypes.slice();\n        return transitionHookTypes.sort(function (l, r) {\n            var cmpByPhase = l.hookPhase - r.hookPhase;\n            return cmpByPhase === 0 ? l.hookOrder - r.hookOrder : cmpByPhase;\n        });\n    };\n    /**\n     * Adds a Path to be used as a criterion against a TreeChanges path\n     *\n     * For example: the `exiting` path in [[HookMatchCriteria]] is a STATE scoped path.\n     * It was defined by calling `defineTreeChangesCriterion('exiting', TransitionHookScope.STATE)`\n     * Each state in the exiting path is checked against the criteria and returned as part of the match.\n     *\n     * Another example: the `to` path in [[HookMatchCriteria]] is a TRANSITION scoped path.\n     * It was defined by calling `defineTreeChangesCriterion('to', TransitionHookScope.TRANSITION)`\n     * Only the tail of the `to` path is checked against the criteria and returned as part of the match.\n     *\n     * @hidden\n     */\n    TransitionService.prototype._definePathType = function (name, hookScope) {\n        this._criteriaPaths[name] = { name: name, scope: hookScope };\n    };\n    /** * @hidden */\n    TransitionService.prototype._getPathTypes = function () {\n        return this._criteriaPaths;\n    };\n    /** @hidden */\n    TransitionService.prototype.getHooks = function (hookName) {\n        return this._registeredHooks[hookName];\n    };\n    /** @hidden */\n    TransitionService.prototype._registerCoreTransitionHooks = function () {\n        var fns = this._deregisterHookFns;\n        fns.addCoreResolves = registerAddCoreResolvables(this);\n        fns.ignored = registerIgnoredTransitionHook(this);\n        fns.invalid = registerInvalidTransitionHook(this);\n        // Wire up redirectTo hook\n        fns.redirectTo = registerRedirectToHook(this);\n        // Wire up onExit/Retain/Enter state hooks\n        fns.onExit = registerOnExitHook(this);\n        fns.onRetain = registerOnRetainHook(this);\n        fns.onEnter = registerOnEnterHook(this);\n        // Wire up Resolve hooks\n        fns.eagerResolve = registerEagerResolvePath(this);\n        fns.lazyResolve = registerLazyResolveState(this);\n        // Wire up the View management hooks\n        fns.loadViews = registerLoadEnteringViews(this);\n        fns.activateViews = registerActivateViews(this);\n        // Updates global state after a transition\n        fns.updateGlobals = registerUpdateGlobalState(this);\n        // After globals.current is updated at priority: 10000\n        fns.updateUrl = registerUpdateUrl(this);\n        // Lazy load state trees\n        fns.lazyLoad = registerLazyLoadHook(this);\n    };\n    return TransitionService;\n}());\n\n/**\n * @coreapi\n * @module state\n */\n/** */\n/**\n * Provides state related service functions\n *\n * This class provides services related to ui-router states.\n * An instance of this class is located on the global [[UIRouter]] object.\n */\nvar StateService = (function () {\n    /** @internalapi */\n    function StateService(router) {\n        this.router = router;\n        /** @internalapi */\n        this.invalidCallbacks = [];\n        /** @hidden */\n        this._defaultErrorHandler = function $defaultErrorHandler($error$) {\n            if ($error$ instanceof Error && $error$.stack) {\n                console.error($error$);\n                console.error($error$.stack);\n            }\n            else if ($error$ instanceof Rejection) {\n                console.error($error$.toString());\n                if ($error$.detail && $error$.detail.stack)\n                    console.error($error$.detail.stack);\n            }\n            else {\n                console.error($error$);\n            }\n        };\n        var getters = ['current', '$current', 'params', 'transition'];\n        var boundFns = Object.keys(StateService.prototype).filter(not(inArray(getters)));\n        createProxyFunctions(val(StateService.prototype), this, val(this), boundFns);\n    }\n    Object.defineProperty(StateService.prototype, \"transition\", {\n        /**\n         * The [[Transition]] currently in progress (or null)\n         *\n         * This is a passthrough through to [[UIRouterGlobals.transition]]\n         */\n        get: function () { return this.router.globals.transition; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(StateService.prototype, \"params\", {\n        /**\n         * The latest successful state parameters\n         *\n         * This is a passthrough through to [[UIRouterGlobals.params]]\n         */\n        get: function () { return this.router.globals.params; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(StateService.prototype, \"current\", {\n        /**\n         * The current [[StateDeclaration]]\n         *\n         * This is a passthrough through to [[UIRouterGlobals.current]]\n         */\n        get: function () { return this.router.globals.current; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(StateService.prototype, \"$current\", {\n        /**\n         * The current [[StateObject]]\n         *\n         * This is a passthrough through to [[UIRouterGlobals.$current]]\n         */\n        get: function () { return this.router.globals.$current; },\n        enumerable: true,\n        configurable: true\n    });\n    /** @internalapi */\n    StateService.prototype.dispose = function () {\n        this.defaultErrorHandler(noop$1);\n        this.invalidCallbacks = [];\n    };\n    /**\n     * Handler for when [[transitionTo]] is called with an invalid state.\n     *\n     * Invokes the [[onInvalid]] callbacks, in natural order.\n     * Each callback's return value is checked in sequence until one of them returns an instance of TargetState.\n     * The results of the callbacks are wrapped in $q.when(), so the callbacks may return promises.\n     *\n     * If a callback returns an TargetState, then it is used as arguments to $state.transitionTo() and the result returned.\n     *\n     * @internalapi\n     */\n    StateService.prototype._handleInvalidTargetState = function (fromPath, toState) {\n        var _this = this;\n        var fromState = PathUtils.makeTargetState(fromPath);\n        var globals = this.router.globals;\n        var latestThing = function () { return globals.transitionHistory.peekTail(); };\n        var latest = latestThing();\n        var callbackQueue = new Queue(this.invalidCallbacks.slice());\n        var injector = new ResolveContext(fromPath).injector();\n        var checkForRedirect = function (result) {\n            if (!(result instanceof TargetState)) {\n                return;\n            }\n            var target = result;\n            // Recreate the TargetState, in case the state is now defined.\n            target = _this.target(target.identifier(), target.params(), target.options());\n            if (!target.valid()) {\n                return Rejection.invalid(target.error()).toPromise();\n            }\n            if (latestThing() !== latest) {\n                return Rejection.superseded().toPromise();\n            }\n            return _this.transitionTo(target.identifier(), target.params(), target.options());\n        };\n        function invokeNextCallback() {\n            var nextCallback = callbackQueue.dequeue();\n            if (nextCallback === undefined)\n                return Rejection.invalid(toState.error()).toPromise();\n            var callbackResult = services.$q.when(nextCallback(toState, fromState, injector));\n            return callbackResult.then(checkForRedirect).then(function (result) { return result || invokeNextCallback(); });\n        }\n        return invokeNextCallback();\n    };\n    /**\n     * Registers an Invalid State handler\n     *\n     * Registers a [[OnInvalidCallback]] function to be invoked when [[StateService.transitionTo]]\n     * has been called with an invalid state reference parameter\n     *\n     * Example:\n     * ```js\n     * stateService.onInvalid(function(to, from, injector) {\n     *   if (to.name() === 'foo') {\n     *     let lazyLoader = injector.get('LazyLoadService');\n     *     return lazyLoader.load('foo')\n     *         .then(() => stateService.target('foo'));\n     *   }\n     * });\n     * ```\n     *\n     * @param {function} callback invoked when the toState is invalid\n     *   This function receives the (invalid) toState, the fromState, and an injector.\n     *   The function may optionally return a [[TargetState]] or a Promise for a TargetState.\n     *   If one is returned, it is treated as a redirect.\n     *\n     * @returns a function which deregisters the callback\n     */\n    StateService.prototype.onInvalid = function (callback) {\n        this.invalidCallbacks.push(callback);\n        return function deregisterListener() {\n            removeFrom(this.invalidCallbacks)(callback);\n        }.bind(this);\n    };\n    /**\n     * Reloads the current state\n     *\n     * A method that force reloads the current state, or a partial state hierarchy.\n     * All resolves are re-resolved, and components reinstantiated.\n     *\n     * #### Example:\n     * ```js\n     * let app angular.module('app', ['ui.router']);\n     *\n     * app.controller('ctrl', function ($scope, $state) {\n     *   $scope.reload = function(){\n     *     $state.reload();\n     *   }\n     * });\n     * ```\n     *\n     * Note: `reload()` is just an alias for:\n     *\n     * ```js\n     * $state.transitionTo($state.current, $state.params, {\n     *   reload: true, inherit: false\n     * });\n     * ```\n     *\n     * @param reloadState A state name or a state object.\n     *    If present, this state and all its children will be reloaded, but ancestors will not reload.\n     *\n     * #### Example:\n     * ```js\n     * //assuming app application consists of 3 states: 'contacts', 'contacts.detail', 'contacts.detail.item'\n     * //and current state is 'contacts.detail.item'\n     * let app angular.module('app', ['ui.router']);\n     *\n     * app.controller('ctrl', function ($scope, $state) {\n     *   $scope.reload = function(){\n     *     //will reload 'contact.detail' and nested 'contact.detail.item' states\n     *     $state.reload('contact.detail');\n     *   }\n     * });\n     * ```\n     *\n     * @returns A promise representing the state of the new transition. See [[StateService.go]]\n     */\n    StateService.prototype.reload = function (reloadState) {\n        return this.transitionTo(this.current, this.params, {\n            reload: isDefined(reloadState) ? reloadState : true,\n            inherit: false,\n            notify: false,\n        });\n    };\n    \n    /**\n     * Transition to a different state and/or parameters\n     *\n     * Convenience method for transitioning to a new state.\n     *\n     * `$state.go` calls `$state.transitionTo` internally but automatically sets options to\n     * `{ location: true, inherit: true, relative: router.globals.$current, notify: true }`.\n     * This allows you to use either an absolute or relative `to` argument (because of `relative: router.globals.$current`).\n     * It also allows you to specify * only the parameters you'd like to update, while letting unspecified parameters\n     * inherit from the current parameter values (because of `inherit: true`).\n     *\n     * #### Example:\n     * ```js\n     * let app = angular.module('app', ['ui.router']);\n     *\n     * app.controller('ctrl', function ($scope, $state) {\n     *   $scope.changeState = function () {\n     *     $state.go('contact.detail');\n     *   };\n     * });\n     * ```\n     *\n     * @param to Absolute state name, state object, or relative state path (relative to current state).\n     *\n     * Some examples:\n     *\n     * - `$state.go('contact.detail')` - will go to the `contact.detail` state\n     * - `$state.go('^')` - will go to the parent state\n     * - `$state.go('^.sibling')` - if current state is `home.child`, will go to the `home.sibling` state\n     * - `$state.go('.child.grandchild')` - if current state is home, will go to the `home.child.grandchild` state\n     *\n     * @param params A map of the parameters that will be sent to the state, will populate $stateParams.\n     *\n     *    Any parameters that are not specified will be inherited from current parameter values (because of `inherit: true`).\n     *    This allows, for example, going to a sibling state that shares parameters defined by a parent state.\n     *\n     * @param options Transition options\n     *\n     * @returns {promise} A promise representing the state of the new transition.\n     */\n    StateService.prototype.go = function (to, params, options) {\n        var defautGoOpts = { relative: this.$current, inherit: true };\n        var transOpts = defaults(options, defautGoOpts, defaultTransOpts);\n        return this.transitionTo(to, params, transOpts);\n    };\n    \n    /**\n     * Creates a [[TargetState]]\n     *\n     * This is a factory method for creating a TargetState\n     *\n     * This may be returned from a Transition Hook to redirect a transition, for example.\n     */\n    StateService.prototype.target = function (identifier, params, options) {\n        if (options === void 0) { options = {}; }\n        // If we're reloading, find the state object to reload from\n        if (isObject(options.reload) && !options.reload.name)\n            throw new Error('Invalid reload state object');\n        var reg = this.router.stateRegistry;\n        options.reloadState = options.reload === true ? reg.root() : reg.matcher.find(options.reload, options.relative);\n        if (options.reload && !options.reloadState)\n            throw new Error(\"No such reload state '\" + (isString(options.reload) ? options.reload : options.reload.name) + \"'\");\n        var stateDefinition = reg.matcher.find(identifier, options.relative);\n        return new TargetState(identifier, stateDefinition, params, options);\n    };\n    \n    StateService.prototype.getCurrentPath = function () {\n        var _this = this;\n        var globals = this.router.globals;\n        var latestSuccess = globals.successfulTransitions.peekTail();\n        var rootPath = function () { return [new PathNode(_this.router.stateRegistry.root())]; };\n        return latestSuccess ? latestSuccess.treeChanges().to : rootPath();\n    };\n    /**\n     * Low-level method for transitioning to a new state.\n     *\n     * The [[go]] method (which uses `transitionTo` internally) is recommended in most situations.\n     *\n     * #### Example:\n     * ```js\n     * let app = angular.module('app', ['ui.router']);\n     *\n     * app.controller('ctrl', function ($scope, $state) {\n     *   $scope.changeState = function () {\n     *     $state.transitionTo('contact.detail');\n     *   };\n     * });\n     * ```\n     *\n     * @param to State name or state object.\n     * @param toParams A map of the parameters that will be sent to the state,\n     *      will populate $stateParams.\n     * @param options Transition options\n     *\n     * @returns A promise representing the state of the new transition. See [[go]]\n     */\n    StateService.prototype.transitionTo = function (to, toParams, options) {\n        var _this = this;\n        if (toParams === void 0) { toParams = {}; }\n        if (options === void 0) { options = {}; }\n        var router = this.router;\n        var globals = router.globals;\n        options = defaults(options, defaultTransOpts);\n        var getCurrent = function () {\n            return globals.transition;\n        };\n        options = extend(options, { current: getCurrent });\n        var ref = this.target(to, toParams, options);\n        var currentPath = this.getCurrentPath();\n        if (!ref.exists())\n            return this._handleInvalidTargetState(currentPath, ref);\n        if (!ref.valid())\n            return silentRejection(ref.error());\n        /**\n         * Special handling for Ignored, Aborted, and Redirected transitions\n         *\n         * The semantics for the transition.run() promise and the StateService.transitionTo()\n         * promise differ. For instance, the run() promise may be rejected because it was\n         * IGNORED, but the transitionTo() promise is resolved because from the user perspective\n         * no error occurred.  Likewise, the transition.run() promise may be rejected because of\n         * a Redirect, but the transitionTo() promise is chained to the new Transition's promise.\n         */\n        var rejectedTransitionHandler = function (transition) { return function (error) {\n            if (error instanceof Rejection) {\n                var isLatest = router.globals.lastStartedTransitionId === transition.$id;\n                if (error.type === exports.RejectType.IGNORED) {\n                    isLatest && router.urlRouter.update();\n                    // Consider ignored `Transition.run()` as a successful `transitionTo`\n                    return services.$q.when(globals.current);\n                }\n                var detail = error.detail;\n                if (error.type === exports.RejectType.SUPERSEDED && error.redirected && detail instanceof TargetState) {\n                    // If `Transition.run()` was redirected, allow the `transitionTo()` promise to resolve successfully\n                    // by returning the promise for the new (redirect) `Transition.run()`.\n                    var redirect = transition.redirect(detail);\n                    return redirect.run().catch(rejectedTransitionHandler(redirect));\n                }\n                if (error.type === exports.RejectType.ABORTED) {\n                    isLatest && router.urlRouter.update();\n                    return services.$q.reject(error);\n                }\n            }\n            var errorHandler = _this.defaultErrorHandler();\n            errorHandler(error);\n            return services.$q.reject(error);\n        }; };\n        var transition = this.router.transitionService.create(currentPath, ref);\n        var transitionToPromise = transition.run().catch(rejectedTransitionHandler(transition));\n        silenceUncaughtInPromise(transitionToPromise); // issue #2676\n        // Return a promise for the transition, which also has the transition object on it.\n        return extend(transitionToPromise, { transition: transition });\n    };\n    \n    /**\n     * Checks if the current state *is* the provided state\n     *\n     * Similar to [[includes]] but only checks for the full state name.\n     * If params is supplied then it will be tested for strict equality against the current\n     * active params object, so all params must match with none missing and no extras.\n     *\n     * #### Example:\n     * ```js\n     * $state.$current.name = 'contacts.details.item';\n     *\n     * // absolute name\n     * $state.is('contact.details.item'); // returns true\n     * $state.is(contactDetailItemStateObject); // returns true\n     * ```\n     *\n     * // relative name (. and ^), typically from a template\n     * // E.g. from the 'contacts.details' template\n     * ```html\n     * <div ng-class=\"{highlighted: $state.is('.item')}\">Item</div>\n     * ```\n     *\n     * @param stateOrName The state name (absolute or relative) or state object you'd like to check.\n     * @param params A param object, e.g. `{sectionId: section.id}`, that you'd like\n     * to test against the current active state.\n     * @param options An options object. The options are:\n     *   - `relative`: If `stateOrName` is a relative state name and `options.relative` is set, .is will\n     *     test relative to `options.relative` state (or name).\n     *\n     * @returns Returns true if it is the state.\n     */\n    StateService.prototype.is = function (stateOrName, params, options) {\n        options = defaults(options, { relative: this.$current });\n        var state = this.router.stateRegistry.matcher.find(stateOrName, options.relative);\n        if (!isDefined(state))\n            return undefined;\n        if (this.$current !== state)\n            return false;\n        if (!params)\n            return true;\n        var schema = state.parameters({ inherit: true, matchingKeys: params });\n        return Param.equals(schema, Param.values(schema, params), this.params);\n    };\n    \n    /**\n     * Checks if the current state *includes* the provided state\n     *\n     * A method to determine if the current active state is equal to or is the child of the\n     * state stateName. If any params are passed then they will be tested for a match as well.\n     * Not all the parameters need to be passed, just the ones you'd like to test for equality.\n     *\n     * #### Example when `$state.$current.name === 'contacts.details.item'`\n     * ```js\n     * // Using partial names\n     * $state.includes(\"contacts\"); // returns true\n     * $state.includes(\"contacts.details\"); // returns true\n     * $state.includes(\"contacts.details.item\"); // returns true\n     * $state.includes(\"contacts.list\"); // returns false\n     * $state.includes(\"about\"); // returns false\n     * ```\n     *\n     * #### Glob Examples when `* $state.$current.name === 'contacts.details.item.url'`:\n     * ```js\n     * $state.includes(\"*.details.*.*\"); // returns true\n     * $state.includes(\"*.details.**\"); // returns true\n     * $state.includes(\"**.item.**\"); // returns true\n     * $state.includes(\"*.details.item.url\"); // returns true\n     * $state.includes(\"*.details.*.url\"); // returns true\n     * $state.includes(\"*.details.*\"); // returns false\n     * $state.includes(\"item.**\"); // returns false\n     * ```\n     *\n     * @param stateOrName A partial name, relative name, glob pattern,\n     *   or state object to be searched for within the current state name.\n     * @param params A param object, e.g. `{sectionId: section.id}`,\n     *   that you'd like to test against the current active state.\n     * @param options An options object. The options are:\n     *   - `relative`: If `stateOrName` is a relative state name and `options.relative` is set, .is will\n     *     test relative to `options.relative` state (or name).\n     *\n     * @returns {boolean} Returns true if it does include the state\n     */\n    StateService.prototype.includes = function (stateOrName, params, options) {\n        options = defaults(options, { relative: this.$current });\n        var glob = isString(stateOrName) && Glob.fromString(stateOrName);\n        if (glob) {\n            if (!glob.matches(this.$current.name))\n                return false;\n            stateOrName = this.$current.name;\n        }\n        var state = this.router.stateRegistry.matcher.find(stateOrName, options.relative), include = this.$current.includes;\n        if (!isDefined(state))\n            return undefined;\n        if (!isDefined(include[state.name]))\n            return false;\n        if (!params)\n            return true;\n        var schema = state.parameters({ inherit: true, matchingKeys: params });\n        return Param.equals(schema, Param.values(schema, params), this.params);\n    };\n    \n    /**\n     * Generates a URL for a state and parameters\n     *\n     * Returns the url for the given state populated with the given params.\n     *\n     * #### Example:\n     * ```js\n     * expect($state.href(\"about.person\", { person: \"bob\" })).toEqual(\"/about/bob\");\n     * ```\n     *\n     * @param stateOrName The state name or state object you'd like to generate a url from.\n     * @param params An object of parameter values to fill the state's required parameters.\n     * @param options Options object. The options are:\n     *\n     * @returns {string} compiled state url\n     */\n    StateService.prototype.href = function (stateOrName, params, options) {\n        var defaultHrefOpts = {\n            lossy: true,\n            inherit: true,\n            absolute: false,\n            relative: this.$current,\n        };\n        options = defaults(options, defaultHrefOpts);\n        params = params || {};\n        var state = this.router.stateRegistry.matcher.find(stateOrName, options.relative);\n        if (!isDefined(state))\n            return null;\n        if (options.inherit)\n            params = this.params.$inherit(params, this.$current, state);\n        var nav = (state && options.lossy) ? state.navigable : state;\n        if (!nav || nav.url === undefined || nav.url === null) {\n            return null;\n        }\n        return this.router.urlRouter.href(nav.url, params, {\n            absolute: options.absolute,\n        });\n    };\n    \n    /**\n     * Sets or gets the default [[transitionTo]] error handler.\n     *\n     * The error handler is called when a [[Transition]] is rejected or when any error occurred during the Transition.\n     * This includes errors caused by resolves and transition hooks.\n     *\n     * Note:\n     * This handler does not receive certain Transition rejections.\n     * Redirected and Ignored Transitions are not considered to be errors by [[StateService.transitionTo]].\n     *\n     * The built-in default error handler logs the error to the console.\n     *\n     * You can provide your own custom handler.\n     *\n     * #### Example:\n     * ```js\n     * stateService.defaultErrorHandler(function() {\n     *   // Do not log transitionTo errors\n     * });\n     * ```\n     *\n     * @param handler a global error handler function\n     * @returns the current global error handler\n     */\n    StateService.prototype.defaultErrorHandler = function (handler) {\n        return this._defaultErrorHandler = handler || this._defaultErrorHandler;\n    };\n    StateService.prototype.get = function (stateOrName, base) {\n        var reg = this.router.stateRegistry;\n        if (arguments.length === 0)\n            return reg.get();\n        return reg.get(stateOrName, base || this.$current);\n    };\n    /**\n     * Lazy loads a state\n     *\n     * Explicitly runs a state's [[StateDeclaration.lazyLoad]] function.\n     *\n     * @param stateOrName the state that should be lazy loaded\n     * @param transition the optional Transition context to use (if the lazyLoad function requires an injector, etc)\n     * Note: If no transition is provided, a noop transition is created using the from the current state to the current state.\n     * This noop transition is not actually run.\n     *\n     * @returns a promise to lazy load\n     */\n    StateService.prototype.lazyLoad = function (stateOrName, transition) {\n        var state = this.get(stateOrName);\n        if (!state || !state.lazyLoad)\n            throw new Error(\"Can not lazy load \" + stateOrName);\n        var currentPath = this.getCurrentPath();\n        var target = PathUtils.makeTargetState(currentPath);\n        transition = transition || this.router.transitionService.create(currentPath, target);\n        return lazyLoadState(transition, state);\n    };\n    return StateService;\n}());\n\n/**\n * # Transition subsystem\n *\n * This module contains APIs related to a Transition.\n *\n * See:\n * - [[TransitionService]]\n * - [[Transition]]\n * - [[HookFn]], [[TransitionHookFn]], [[TransitionStateHookFn]], [[HookMatchCriteria]], [[HookResult]]\n *\n * @coreapi\n * @preferred\n * @module transition\n */ /** for typedoc */\n\n/**\n * @internalapi\n * @module vanilla\n */\n/** */\n/**\n * An angular1-like promise api\n *\n * This object implements four methods similar to the\n * [angular 1 promise api](https://docs.angularjs.org/api/ng/service/$q)\n *\n * UI-Router evolved from an angular 1 library to a framework agnostic library.\n * However, some of the `@uirouter/core` code uses these ng1 style APIs to support ng1 style dependency injection.\n *\n * This API provides native ES6 promise support wrapped as a $q-like API.\n * Internally, UI-Router uses this $q object to perform promise operations.\n * The `angular-ui-router` (ui-router for angular 1) uses the $q API provided by angular.\n *\n * $q-like promise api\n */\nvar $q = {\n    /** Normalizes a value as a promise */\n    when: function (val$$1) { return new Promise(function (resolve, reject) { return resolve(val$$1); }); },\n    /** Normalizes a value as a promise rejection */\n    reject: function (val$$1) { return new Promise(function (resolve, reject) { reject(val$$1); }); },\n    /** @returns a deferred object, which has `resolve` and `reject` functions */\n    defer: function () {\n        var deferred = {};\n        deferred.promise = new Promise(function (resolve, reject) {\n            deferred.resolve = resolve;\n            deferred.reject = reject;\n        });\n        return deferred;\n    },\n    /** Like Promise.all(), but also supports object key/promise notation like $q */\n    all: function (promises) {\n        if (isArray(promises)) {\n            return Promise.all(promises);\n        }\n        if (isObject(promises)) {\n            // Convert promises map to promises array.\n            // When each promise resolves, map it to a tuple { key: key, val: val }\n            var chain = Object.keys(promises)\n                .map(function (key) { return promises[key].then(function (val$$1) { return ({ key: key, val: val$$1 }); }); });\n            // Then wait for all promises to resolve, and convert them back to an object\n            return $q.all(chain).then(function (values$$1) {\n                return values$$1.reduce(function (acc, tuple) { acc[tuple.key] = tuple.val; return acc; }, {});\n            });\n        }\n    }\n};\n\n/**\n * @internalapi\n * @module vanilla\n */\n/** */\n// globally available injectables\nvar globals = {};\nvar STRIP_COMMENTS = /((\\/\\/.*$)|(\\/\\*[\\s\\S]*?\\*\\/))/mg;\nvar ARGUMENT_NAMES = /([^\\s,]+)/g;\n/**\n * A basic angular1-like injector api\n *\n * This object implements four methods similar to the\n * [angular 1 dependency injector](https://docs.angularjs.org/api/auto/service/$injector)\n *\n * UI-Router evolved from an angular 1 library to a framework agnostic library.\n * However, some of the `@uirouter/core` code uses these ng1 style APIs to support ng1 style dependency injection.\n *\n * This object provides a naive implementation of a globally scoped dependency injection system.\n * It supports the following DI approaches:\n *\n * ### Function parameter names\n *\n * A function's `.toString()` is called, and the parameter names are parsed.\n * This only works when the parameter names aren't \"mangled\" by a minifier such as UglifyJS.\n *\n * ```js\n * function injectedFunction(FooService, BarService) {\n *   // FooService and BarService are injected\n * }\n * ```\n *\n * ### Function annotation\n *\n * A function may be annotated with an array of dependency names as the `$inject` property.\n *\n * ```js\n * injectedFunction.$inject = [ 'FooService', 'BarService' ];\n * function injectedFunction(fs, bs) {\n *   // FooService and BarService are injected as fs and bs parameters\n * }\n * ```\n *\n * ### Array notation\n *\n * An array provides the names of the dependencies to inject (as strings).\n * The function is the last element of the array.\n *\n * ```js\n * [ 'FooService', 'BarService', function (fs, bs) {\n *   // FooService and BarService are injected as fs and bs parameters\n * }]\n * ```\n *\n * @type {$InjectorLike}\n */\nvar $injector = {\n    /** Gets an object from DI based on a string token */\n    get: function (name) { return globals[name]; },\n    /** Returns true if an object named `name` exists in global DI */\n    has: function (name) { return $injector.get(name) != null; },\n    /**\n     * Injects a function\n     *\n     * @param fn the function to inject\n     * @param context the function's `this` binding\n     * @param locals An object with additional DI tokens and values, such as `{ someToken: { foo: 1 } }`\n     */\n    invoke: function (fn, context, locals) {\n        var all$$1 = extend({}, globals, locals || {});\n        var params = $injector.annotate(fn);\n        var ensureExist = assertPredicate(function (key) { return all$$1.hasOwnProperty(key); }, function (key) { return \"DI can't find injectable: '\" + key + \"'\"; });\n        var args = params.filter(ensureExist).map(function (x) { return all$$1[x]; });\n        if (isFunction(fn))\n            return fn.apply(context, args);\n        else\n            return fn.slice(-1)[0].apply(context, args);\n    },\n    /**\n     * Returns a function's dependencies\n     *\n     * Analyzes a function (or array) and returns an array of DI tokens that the function requires.\n     * @return an array of `string`s\n     */\n    annotate: function (fn) {\n        if (!isInjectable(fn))\n            throw new Error(\"Not an injectable function: \" + fn);\n        if (fn && fn.$inject)\n            return fn.$inject;\n        if (isArray(fn))\n            return fn.slice(0, -1);\n        var fnStr = fn.toString().replace(STRIP_COMMENTS, '');\n        var result = fnStr.slice(fnStr.indexOf('(') + 1, fnStr.indexOf(')')).match(ARGUMENT_NAMES);\n        return result || [];\n    }\n};\n\n/**\n * @internalapi\n * @module vanilla\n */\n/** */\nvar beforeAfterSubstr$1 = function (char) { return function (str) {\n    if (!str)\n        return [\"\", \"\"];\n    var idx = str.indexOf(char);\n    if (idx === -1)\n        return [str, \"\"];\n    return [str.substr(0, idx), str.substr(idx + 1)];\n}; };\nvar splitHash = beforeAfterSubstr$1(\"#\");\nvar splitQuery = beforeAfterSubstr$1(\"?\");\nvar splitEqual = beforeAfterSubstr$1(\"=\");\nvar trimHashVal = function (str) { return str ? str.replace(/^#/, \"\") : \"\"; };\nvar keyValsToObjectR = function (accum, _a) {\n    var key = _a[0], val$$1 = _a[1];\n    if (!accum.hasOwnProperty(key)) {\n        accum[key] = val$$1;\n    }\n    else if (isArray(accum[key])) {\n        accum[key].push(val$$1);\n    }\n    else {\n        accum[key] = [accum[key], val$$1];\n    }\n    return accum;\n};\nvar getParams = function (queryString) {\n    return queryString.split(\"&\").filter(identity).map(splitEqual).reduce(keyValsToObjectR, {});\n};\nfunction parseUrl$1(url) {\n    var orEmptyString = function (x) { return x || \"\"; };\n    var _a = splitHash(url).map(orEmptyString), beforehash = _a[0], hash = _a[1];\n    var _b = splitQuery(beforehash).map(orEmptyString), path = _b[0], search = _b[1];\n    return { path: path, search: search, hash: hash, url: url };\n}\nvar buildUrl = function (loc) {\n    var path = loc.path();\n    var searchObject = loc.search();\n    var hash = loc.hash();\n    var search = Object.keys(searchObject).map(function (key) {\n        var param = searchObject[key];\n        var vals = isArray(param) ? param : [param];\n        return vals.map(function (val$$1) { return key + \"=\" + val$$1; });\n    }).reduce(unnestR, []).join(\"&\");\n    return path + (search ? \"?\" + search : \"\") + (hash ? \"#\" + hash : \"\");\n};\nfunction locationPluginFactory(name, isHtml5, serviceClass, configurationClass) {\n    return function (router) {\n        var service = router.locationService = new serviceClass(router);\n        var configuration = router.locationConfig = new configurationClass(router, isHtml5);\n        function dispose(router) {\n            router.dispose(service);\n            router.dispose(configuration);\n        }\n        return { name: name, service: service, configuration: configuration, dispose: dispose };\n    };\n}\n\n/**\n * @internalapi\n * @module vanilla\n */ /** */\n/** A base `LocationServices` */\nvar BaseLocationServices = (function () {\n    function BaseLocationServices(router, fireAfterUpdate) {\n        var _this = this;\n        this.fireAfterUpdate = fireAfterUpdate;\n        this._listener = function (evt) { return _this._listeners.forEach(function (cb) { return cb(evt); }); };\n        this._listeners = [];\n        this.hash = function () { return parseUrl$1(_this._get()).hash; };\n        this.path = function () { return parseUrl$1(_this._get()).path; };\n        this.search = function () { return getParams(parseUrl$1(_this._get()).search); };\n        this._location = window && window.location;\n        this._history = window && window.history;\n    }\n    BaseLocationServices.prototype.url = function (url, replace) {\n        if (replace === void 0) { replace = true; }\n        if (isDefined(url) && url !== this._get()) {\n            this._set(null, null, url, replace);\n            if (this.fireAfterUpdate) {\n                var evt_1 = extend(new Event(\"locationchange\"), { url: url });\n                this._listeners.forEach(function (cb) { return cb(evt_1); });\n            }\n        }\n        return buildUrl(this);\n    };\n    BaseLocationServices.prototype.onChange = function (cb) {\n        var _this = this;\n        this._listeners.push(cb);\n        return function () { return removeFrom(_this._listeners, cb); };\n    };\n    BaseLocationServices.prototype.dispose = function (router) {\n        deregAll(this._listeners);\n    };\n    return BaseLocationServices;\n}());\n\nvar __extends = (undefined && undefined.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n/**\n * @internalapi\n * @module vanilla\n */\n/** */\n/** A `LocationServices` that uses the browser hash \"#\" to get/set the current location */\nvar HashLocationService = (function (_super) {\n    __extends(HashLocationService, _super);\n    function HashLocationService(router) {\n        var _this = _super.call(this, router, false) || this;\n        window.addEventListener('hashchange', _this._listener, false);\n        return _this;\n    }\n    HashLocationService.prototype._get = function () {\n        return trimHashVal(this._location.hash);\n    };\n    HashLocationService.prototype._set = function (state, title, url, replace) {\n        this._location.hash = url;\n    };\n    HashLocationService.prototype.dispose = function (router) {\n        _super.prototype.dispose.call(this, router);\n        window.removeEventListener('hashchange', this._listener);\n    };\n    return HashLocationService;\n}(BaseLocationServices));\n\nvar __extends$1 = (undefined && undefined.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n/**\n * @internalapi\n * @module vanilla\n */\n/** */\n/** A `LocationServices` that gets/sets the current location from an in-memory object */\nvar MemoryLocationService = (function (_super) {\n    __extends$1(MemoryLocationService, _super);\n    function MemoryLocationService(router) {\n        return _super.call(this, router, true) || this;\n    }\n    MemoryLocationService.prototype._get = function () {\n        return this._url;\n    };\n    MemoryLocationService.prototype._set = function (state, title, url, replace) {\n        this._url = url;\n    };\n    return MemoryLocationService;\n}(BaseLocationServices));\n\nvar __extends$2 = (undefined && undefined.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n/**\n * A `LocationServices` that gets/sets the current location using the browser's `location` and `history` apis\n *\n * Uses `history.pushState` and `history.replaceState`\n */\nvar PushStateLocationService = (function (_super) {\n    __extends$2(PushStateLocationService, _super);\n    function PushStateLocationService(router) {\n        var _this = _super.call(this, router, true) || this;\n        _this._config = router.urlService.config;\n        window.addEventListener(\"popstate\", _this._listener, false);\n        return _this;\n    }\n    \n    PushStateLocationService.prototype._get = function () {\n        var _a = this._location, pathname = _a.pathname, hash = _a.hash, search = _a.search;\n        search = splitQuery(search)[1]; // strip ? if found\n        hash = splitHash(hash)[1]; // strip # if found\n        return pathname + (search ? \"?\" + search : \"\") + (hash ? \"$\" + search : \"\");\n    };\n    PushStateLocationService.prototype._set = function (state, title, url, replace) {\n        var _a = this, _config = _a._config, _history = _a._history;\n        var fullUrl = _config.baseHref() + url;\n        if (replace) {\n            _history.replaceState(state, title, fullUrl);\n        }\n        else {\n            _history.pushState(state, title, fullUrl);\n        }\n    };\n    PushStateLocationService.prototype.dispose = function (router) {\n        _super.prototype.dispose.call(this, router);\n        window.removeEventListener(\"popstate\", this._listener);\n    };\n    return PushStateLocationService;\n}(BaseLocationServices));\n\n/** A `LocationConfig` mock that gets/sets all config from an in-memory object */\nvar MemoryLocationConfig = (function () {\n    function MemoryLocationConfig() {\n        var _this = this;\n        this._baseHref = '';\n        this._port = 80;\n        this._protocol = \"http\";\n        this._host = \"localhost\";\n        this._hashPrefix = \"\";\n        this.port = function () { return _this._port; };\n        this.protocol = function () { return _this._protocol; };\n        this.host = function () { return _this._host; };\n        this.baseHref = function () { return _this._baseHref; };\n        this.html5Mode = function () { return false; };\n        this.hashPrefix = function (newval) { return isDefined(newval) ? _this._hashPrefix = newval : _this._hashPrefix; };\n        this.dispose = noop$1;\n    }\n    return MemoryLocationConfig;\n}());\n\n/**\n * @internalapi\n * @module vanilla\n */\n/** */\n/** A `LocationConfig` that delegates to the browser's `location` object */\nvar BrowserLocationConfig = (function () {\n    function BrowserLocationConfig(router, _isHtml5) {\n        if (_isHtml5 === void 0) { _isHtml5 = false; }\n        this._isHtml5 = _isHtml5;\n        this._baseHref = undefined;\n        this._hashPrefix = \"\";\n    }\n    BrowserLocationConfig.prototype.port = function () {\n        if (location.port) {\n            return Number(location.port);\n        }\n        return this.protocol() === 'https' ? 443 : 80;\n    };\n    BrowserLocationConfig.prototype.protocol = function () {\n        return location.protocol.replace(/:/g, '');\n    };\n    BrowserLocationConfig.prototype.host = function () {\n        return location.host;\n    };\n    BrowserLocationConfig.prototype.html5Mode = function () {\n        return this._isHtml5;\n    };\n    BrowserLocationConfig.prototype.hashPrefix = function (newprefix) {\n        return isDefined(newprefix) ? this._hashPrefix = newprefix : this._hashPrefix;\n    };\n    \n    BrowserLocationConfig.prototype.baseHref = function (href) {\n        return isDefined(href) ? this._baseHref = href : this._baseHref || this.applyDocumentBaseHref();\n    };\n    BrowserLocationConfig.prototype.applyDocumentBaseHref = function () {\n        var baseTags = document.getElementsByTagName(\"base\");\n        return this._baseHref = baseTags.length ? baseTags[0].href.substr(location.origin.length) : \"\";\n    };\n    BrowserLocationConfig.prototype.dispose = function () { };\n    return BrowserLocationConfig;\n}());\n\n/**\n * @internalapi\n * @module vanilla\n */\n/** */\nfunction servicesPlugin(router) {\n    services.$injector = $injector;\n    services.$q = $q;\n    return { name: \"vanilla.services\", $q: $q, $injector: $injector, dispose: function () { return null; } };\n}\n/** A `UIRouterPlugin` uses the browser hash to get/set the current location */\nvar hashLocationPlugin = locationPluginFactory('vanilla.hashBangLocation', false, HashLocationService, BrowserLocationConfig);\n/** A `UIRouterPlugin` that gets/sets the current location using the browser's `location` and `history` apis */\nvar pushStateLocationPlugin = locationPluginFactory(\"vanilla.pushStateLocation\", true, PushStateLocationService, BrowserLocationConfig);\n/** A `UIRouterPlugin` that gets/sets the current location from an in-memory object */\nvar memoryLocationPlugin = locationPluginFactory(\"vanilla.memoryLocation\", false, MemoryLocationService, MemoryLocationConfig);\n\n/**\n * @internalapi\n * @module vanilla\n */\n/** */\n\n/**\n * # Core classes and interfaces\n *\n * The classes and interfaces that are core to ui-router and do not belong\n * to a more specific subsystem (such as resolve).\n *\n * @coreapi\n * @preferred\n * @module core\n */ /** for typedoc */\n/** @internalapi */\nvar UIRouterPluginBase = (function () {\n    function UIRouterPluginBase() {\n    }\n    UIRouterPluginBase.prototype.dispose = function (router) { };\n    return UIRouterPluginBase;\n}());\n\n/**\n * @coreapi\n * @module common\n */ /** */\n\n\n\nvar index$1 = Object.freeze({\n\tfromJson: fromJson,\n\ttoJson: toJson,\n\tcopy: copy,\n\tforEach: forEach,\n\textend: extend,\n\tequals: equals,\n\tidentity: identity,\n\tnoop: noop$1,\n\tcreateProxyFunctions: createProxyFunctions,\n\tinherit: inherit,\n\tinArray: inArray,\n\t_inArray: _inArray,\n\tremoveFrom: removeFrom,\n\t_removeFrom: _removeFrom,\n\tpushTo: pushTo,\n\t_pushTo: _pushTo,\n\tderegAll: deregAll,\n\tdefaults: defaults,\n\tmergeR: mergeR,\n\tancestors: ancestors,\n\tpick: pick,\n\tomit: omit,\n\tpluck: pluck,\n\tfilter: filter,\n\tfind: find,\n\tmapObj: mapObj,\n\tmap: map,\n\tvalues: values,\n\tallTrueR: allTrueR,\n\tanyTrueR: anyTrueR,\n\tunnestR: unnestR,\n\tflattenR: flattenR,\n\tpushR: pushR,\n\tuniqR: uniqR,\n\tunnest: unnest,\n\tflatten: flatten,\n\tassertPredicate: assertPredicate,\n\tassertMap: assertMap,\n\tassertFn: assertFn,\n\tpairs: pairs,\n\tarrayTuples: arrayTuples,\n\tapplyPairs: applyPairs,\n\ttail: tail,\n\t_extend: _extend,\n\tsortBy: sortBy,\n\tcomposeSort: composeSort,\n\tsilenceUncaughtInPromise: silenceUncaughtInPromise,\n\tsilentRejection: silentRejection,\n\tnotImplemented: notImplemented,\n\tservices: services,\n\tGlob: Glob,\n\tcurry: curry,\n\tcompose: compose,\n\tpipe: pipe,\n\tprop: prop,\n\tpropEq: propEq,\n\tparse: parse,\n\tnot: not,\n\tand: and,\n\tor: or,\n\tall: all,\n\tany: any,\n\tis: is,\n\teq: eq,\n\tval: val,\n\tinvoke: invoke,\n\tpattern: pattern,\n\tisUndefined: isUndefined,\n\tisDefined: isDefined,\n\tisNull: isNull,\n\tisNullOrUndefined: isNullOrUndefined,\n\tisFunction: isFunction,\n\tisNumber: isNumber,\n\tisString: isString,\n\tisObject: isObject,\n\tisArray: isArray,\n\tisDate: isDate,\n\tisRegExp: isRegExp,\n\tisState: isState,\n\tisInjectable: isInjectable,\n\tisPromise: isPromise,\n\tQueue: Queue,\n\tmaxLength: maxLength,\n\tpadString: padString,\n\tkebobString: kebobString,\n\tfunctionToString: functionToString,\n\tfnToString: fnToString,\n\tstringify: stringify,\n\tbeforeAfterSubstr: beforeAfterSubstr,\n\tsplitOnDelim: splitOnDelim,\n\tjoinNeighborsR: joinNeighborsR,\n\tget Category () { return exports.Category; },\n\tTrace: Trace,\n\ttrace: trace,\n\tget DefType () { return exports.DefType; },\n\tParam: Param,\n\tParamTypes: ParamTypes,\n\tStateParams: StateParams,\n\tParamType: ParamType,\n\tPathNode: PathNode,\n\tPathUtils: PathUtils,\n\tresolvePolicies: resolvePolicies,\n\tdefaultResolvePolicy: defaultResolvePolicy,\n\tResolvable: Resolvable,\n\tNATIVE_INJECTOR_TOKEN: NATIVE_INJECTOR_TOKEN,\n\tResolveContext: ResolveContext,\n\tresolvablesBuilder: resolvablesBuilder,\n\tStateBuilder: StateBuilder,\n\tStateObject: StateObject,\n\tStateMatcher: StateMatcher,\n\tStateQueueManager: StateQueueManager,\n\tStateRegistry: StateRegistry,\n\tStateService: StateService,\n\tTargetState: TargetState,\n\tget TransitionHookPhase () { return exports.TransitionHookPhase; },\n\tget TransitionHookScope () { return exports.TransitionHookScope; },\n\tHookBuilder: HookBuilder,\n\tmatchState: matchState,\n\tRegisteredHook: RegisteredHook,\n\tmakeEvent: makeEvent,\n\tget RejectType () { return exports.RejectType; },\n\tRejection: Rejection,\n\tTransition: Transition,\n\tTransitionHook: TransitionHook,\n\tTransitionEventType: TransitionEventType,\n\tdefaultTransOpts: defaultTransOpts,\n\tTransitionService: TransitionService,\n\tUrlMatcher: UrlMatcher,\n\tUrlMatcherFactory: UrlMatcherFactory,\n\tUrlRouter: UrlRouter,\n\tUrlRuleFactory: UrlRuleFactory,\n\tBaseUrlRule: BaseUrlRule,\n\tUrlService: UrlService,\n\tViewService: ViewService,\n\tUIRouterGlobals: UIRouterGlobals,\n\tUIRouter: UIRouter,\n\t$q: $q,\n\t$injector: $injector,\n\tBaseLocationServices: BaseLocationServices,\n\tHashLocationService: HashLocationService,\n\tMemoryLocationService: MemoryLocationService,\n\tPushStateLocationService: PushStateLocationService,\n\tMemoryLocationConfig: MemoryLocationConfig,\n\tBrowserLocationConfig: BrowserLocationConfig,\n\tsplitHash: splitHash,\n\tsplitQuery: splitQuery,\n\tsplitEqual: splitEqual,\n\ttrimHashVal: trimHashVal,\n\tkeyValsToObjectR: keyValsToObjectR,\n\tgetParams: getParams,\n\tparseUrl: parseUrl$1,\n\tbuildUrl: buildUrl,\n\tlocationPluginFactory: locationPluginFactory,\n\tservicesPlugin: servicesPlugin,\n\thashLocationPlugin: hashLocationPlugin,\n\tpushStateLocationPlugin: pushStateLocationPlugin,\n\tmemoryLocationPlugin: memoryLocationPlugin,\n\tUIRouterPluginBase: UIRouterPluginBase\n});\n\nvar ng_from_global = angular;\nvar ng = (ng_from_import && ng_from_import.module) ? ng_from_import : ng_from_global;\n\nfunction getNg1ViewConfigFactory() {\n    var templateFactory = null;\n    return function (path, view) {\n        templateFactory = templateFactory || services.$injector.get(\"$templateFactory\");\n        return [new Ng1ViewConfig(path, view, templateFactory)];\n    };\n}\nvar hasAnyKey = function (keys, obj) {\n    return keys.reduce(function (acc, key) { return acc || isDefined(obj[key]); }, false);\n};\n/**\n * This is a [[StateBuilder.builder]] function for angular1 `views`.\n *\n * When the [[StateBuilder]] builds a [[StateObject]] object from a raw [[StateDeclaration]], this builder\n * handles the `views` property with logic specific to @uirouter/angularjs (ng1).\n *\n * If no `views: {}` property exists on the [[StateDeclaration]], then it creates the `views` object\n * and applies the state-level configuration to a view named `$default`.\n */\nfunction ng1ViewsBuilder(state) {\n    // Do not process root state\n    if (!state.parent)\n        return {};\n    var tplKeys = ['templateProvider', 'templateUrl', 'template', 'notify', 'async'], ctrlKeys = ['controller', 'controllerProvider', 'controllerAs', 'resolveAs'], compKeys = ['component', 'bindings', 'componentProvider'], nonCompKeys = tplKeys.concat(ctrlKeys), allViewKeys = compKeys.concat(nonCompKeys);\n    // Do not allow a state to have both state-level props and also a `views: {}` property.\n    // A state without a `views: {}` property can declare properties for the `$default` view as properties of the state.\n    // However, the `$default` approach should not be mixed with a separate `views: ` block.\n    if (isDefined(state.views) && hasAnyKey(allViewKeys, state)) {\n        throw new Error(\"State '\" + state.name + \"' has a 'views' object. \" +\n            \"It cannot also have \\\"view properties\\\" at the state level.  \" +\n            \"Move the following properties into a view (in the 'views' object): \" +\n            (\" \" + allViewKeys.filter(function (key) { return isDefined(state[key]); }).join(\", \")));\n    }\n    var views = {}, viewsObject = state.views || { \"$default\": pick(state, allViewKeys) };\n    forEach(viewsObject, function (config, name) {\n        // Account for views: { \"\": { template... } }\n        name = name || \"$default\";\n        // Account for views: { header: \"headerComponent\" }\n        if (isString(config))\n            config = { component: config };\n        // Make a shallow copy of the config object\n        config = extend({}, config);\n        // Do not allow a view to mix props for component-style view with props for template/controller-style view\n        if (hasAnyKey(compKeys, config) && hasAnyKey(nonCompKeys, config)) {\n            throw new Error(\"Cannot combine: \" + compKeys.join(\"|\") + \" with: \" + nonCompKeys.join(\"|\") + \" in stateview: '\" + name + \"@\" + state.name + \"'\");\n        }\n        config.resolveAs = config.resolveAs || '$resolve';\n        config.$type = \"ng1\";\n        config.$context = state;\n        config.$name = name;\n        var normalized = ViewService.normalizeUIViewTarget(config.$context, config.$name);\n        config.$uiViewName = normalized.uiViewName;\n        config.$uiViewContextAnchor = normalized.uiViewContextAnchor;\n        views[name] = config;\n    });\n    return views;\n}\nvar id$1 = 0;\nvar Ng1ViewConfig = (function () {\n    function Ng1ViewConfig(path, viewDecl, factory) {\n        var _this = this;\n        this.path = path;\n        this.viewDecl = viewDecl;\n        this.factory = factory;\n        this.$id = id$1++;\n        this.loaded = false;\n        this.getTemplate = function (uiView, context) {\n            return _this.component ? _this.factory.makeComponentTemplate(uiView, context, _this.component, _this.viewDecl.bindings) : _this.template;\n        };\n    }\n    Ng1ViewConfig.prototype.load = function () {\n        var _this = this;\n        var $q$$1 = services.$q;\n        var context = new ResolveContext(this.path);\n        var params = this.path.reduce(function (acc, node) { return extend(acc, node.paramValues); }, {});\n        var promises = {\n            template: $q$$1.when(this.factory.fromConfig(this.viewDecl, params, context)),\n            controller: $q$$1.when(this.getController(context))\n        };\n        return $q$$1.all(promises).then(function (results) {\n            trace.traceViewServiceEvent(\"Loaded\", _this);\n            _this.controller = results.controller;\n            extend(_this, results.template); // Either { template: \"tpl\" } or { component: \"cmpName\" }\n            return _this;\n        });\n    };\n    /**\n     * Gets the controller for a view configuration.\n     *\n     * @returns {Function|Promise.<Function>} Returns a controller, or a promise that resolves to a controller.\n     */\n    Ng1ViewConfig.prototype.getController = function (context) {\n        var provider = this.viewDecl.controllerProvider;\n        if (!isInjectable(provider))\n            return this.viewDecl.controller;\n        var deps = services.$injector.annotate(provider);\n        var providerFn = isArray(provider) ? tail(provider) : provider;\n        var resolvable = new Resolvable(\"\", providerFn, deps);\n        return resolvable.get(context);\n    };\n    return Ng1ViewConfig;\n}());\n\n/** @module view */\n/** for typedoc */\n/**\n * Service which manages loading of templates from a ViewConfig.\n */\nvar TemplateFactory = (function () {\n    function TemplateFactory() {\n        var _this = this;\n        /** @hidden */ this._useHttp = ng.version.minor < 3;\n        /** @hidden */ this.$get = ['$http', '$templateCache', '$injector', function ($http, $templateCache, $injector$$1) {\n                _this.$templateRequest = $injector$$1.has && $injector$$1.has('$templateRequest') && $injector$$1.get('$templateRequest');\n                _this.$http = $http;\n                _this.$templateCache = $templateCache;\n                return _this;\n            }];\n    }\n    /** @hidden */\n    TemplateFactory.prototype.useHttpService = function (value) {\n        this._useHttp = value;\n    };\n    \n    /**\n     * Creates a template from a configuration object.\n     *\n     * @param config Configuration object for which to load a template.\n     * The following properties are search in the specified order, and the first one\n     * that is defined is used to create the template:\n     *\n     * @param params  Parameters to pass to the template function.\n     * @param context The resolve context associated with the template's view\n     *\n     * @return {string|object}  The template html as a string, or a promise for\n     * that string,or `null` if no template is configured.\n     */\n    TemplateFactory.prototype.fromConfig = function (config, params, context) {\n        var defaultTemplate = \"<ui-view></ui-view>\";\n        var asTemplate = function (result) { return services.$q.when(result).then(function (str) { return ({ template: str }); }); };\n        var asComponent = function (result) { return services.$q.when(result).then(function (str) { return ({ component: str }); }); };\n        return (isDefined(config.template) ? asTemplate(this.fromString(config.template, params)) :\n            isDefined(config.templateUrl) ? asTemplate(this.fromUrl(config.templateUrl, params)) :\n                isDefined(config.templateProvider) ? asTemplate(this.fromProvider(config.templateProvider, params, context)) :\n                    isDefined(config.component) ? asComponent(config.component) :\n                        isDefined(config.componentProvider) ? asComponent(this.fromComponentProvider(config.componentProvider, params, context)) :\n                            asTemplate(defaultTemplate));\n    };\n    \n    /**\n     * Creates a template from a string or a function returning a string.\n     *\n     * @param template html template as a string or function that returns an html template as a string.\n     * @param params Parameters to pass to the template function.\n     *\n     * @return {string|object} The template html as a string, or a promise for that\n     * string.\n     */\n    TemplateFactory.prototype.fromString = function (template, params) {\n        return isFunction(template) ? template(params) : template;\n    };\n    \n    /**\n     * Loads a template from the a URL via `$http` and `$templateCache`.\n     *\n     * @param {string|Function} url url of the template to load, or a function\n     * that returns a url.\n     * @param {Object} params Parameters to pass to the url function.\n     * @return {string|Promise.<string>} The template html as a string, or a promise\n     * for that string.\n     */\n    TemplateFactory.prototype.fromUrl = function (url, params) {\n        if (isFunction(url))\n            url = url(params);\n        if (url == null)\n            return null;\n        if (this._useHttp) {\n            return this.$http.get(url, { cache: this.$templateCache, headers: { Accept: 'text/html' } })\n                .then(function (response) {\n                return response.data;\n            });\n        }\n        return this.$templateRequest(url);\n    };\n    \n    /**\n     * Creates a template by invoking an injectable provider function.\n     *\n     * @param provider Function to invoke via `locals`\n     * @param {Function} injectFn a function used to invoke the template provider\n     * @return {string|Promise.<string>} The template html as a string, or a promise\n     * for that string.\n     */\n    TemplateFactory.prototype.fromProvider = function (provider, params, context) {\n        var deps = services.$injector.annotate(provider);\n        var providerFn = isArray(provider) ? tail(provider) : provider;\n        var resolvable = new Resolvable(\"\", providerFn, deps);\n        return resolvable.get(context);\n    };\n    \n    /**\n     * Creates a component's template by invoking an injectable provider function.\n     *\n     * @param provider Function to invoke via `locals`\n     * @param {Function} injectFn a function used to invoke the template provider\n     * @return {string} The template html as a string: \"<component-name input1='::$resolve.foo'></component-name>\".\n     */\n    TemplateFactory.prototype.fromComponentProvider = function (provider, params, context) {\n        var deps = services.$injector.annotate(provider);\n        var providerFn = isArray(provider) ? tail(provider) : provider;\n        var resolvable = new Resolvable(\"\", providerFn, deps);\n        return resolvable.get(context);\n    };\n    \n    /**\n     * Creates a template from a component's name\n     *\n     * This implements route-to-component.\n     * It works by retrieving the component (directive) metadata from the injector.\n     * It analyses the component's bindings, then constructs a template that instantiates the component.\n     * The template wires input and output bindings to resolves or from the parent component.\n     *\n     * @param uiView {object} The parent ui-view (for binding outputs to callbacks)\n     * @param context The ResolveContext (for binding outputs to callbacks returned from resolves)\n     * @param component {string} Component's name in camel case.\n     * @param bindings An object defining the component's bindings: {foo: '<'}\n     * @return {string} The template as a string: \"<component-name input1='::$resolve.foo'></component-name>\".\n     */\n    TemplateFactory.prototype.makeComponentTemplate = function (uiView, context, component, bindings) {\n        bindings = bindings || {};\n        // Bind once prefix\n        var prefix = ng.version.minor >= 3 ? \"::\" : \"\";\n        // Convert to kebob name. Add x- prefix if the string starts with `x-` or `data-`\n        var kebob = function (camelCase) {\n            var kebobed = kebobString(camelCase);\n            return /^(x|data)-/.exec(kebobed) ? \"x-\" + kebobed : kebobed;\n        };\n        var attributeTpl = function (input) {\n            var name = input.name, type = input.type;\n            var attrName = kebob(name);\n            // If the ui-view has an attribute which matches a binding on the routed component\n            // then pass that attribute through to the routed component template.\n            // Prefer ui-view wired mappings to resolve data, unless the resolve was explicitly bound using `bindings:`\n            if (uiView.attr(attrName) && !bindings[name])\n                return attrName + \"='\" + uiView.attr(attrName) + \"'\";\n            var resolveName = bindings[name] || name;\n            // Pre-evaluate the expression for \"@\" bindings by enclosing in {{ }}\n            // some-attr=\"{{ ::$resolve.someResolveName }}\"\n            if (type === '@')\n                return attrName + \"='{{\" + prefix + \"$resolve.\" + resolveName + \"}}'\";\n            // Wire \"&\" callbacks to resolves that return a callback function\n            // Get the result of the resolve (should be a function) and annotate it to get its arguments.\n            // some-attr=\"$resolve.someResolveResultName(foo, bar)\"\n            if (type === '&') {\n                var res = context.getResolvable(resolveName);\n                var fn = res && res.data;\n                var args = fn && services.$injector.annotate(fn) || [];\n                // account for array style injection, i.e., ['foo', function(foo) {}]\n                var arrayIdxStr = isArray(fn) ? \"[\" + (fn.length - 1) + \"]\" : '';\n                return attrName + \"='$resolve.\" + resolveName + arrayIdxStr + \"(\" + args.join(\",\") + \")'\";\n            }\n            // some-attr=\"::$resolve.someResolveName\"\n            return attrName + \"='\" + prefix + \"$resolve.\" + resolveName + \"'\";\n        };\n        var attrs = getComponentBindings(component).map(attributeTpl).join(\" \");\n        var kebobName = kebob(component);\n        return \"<\" + kebobName + \" \" + attrs + \"></\" + kebobName + \">\";\n    };\n    \n    return TemplateFactory;\n}());\n// Gets all the directive(s)' inputs ('@', '=', and '<') and outputs ('&')\nfunction getComponentBindings(name) {\n    var cmpDefs = services.$injector.get(name + \"Directive\"); // could be multiple\n    if (!cmpDefs || !cmpDefs.length)\n        throw new Error(\"Unable to find component named '\" + name + \"'\");\n    return cmpDefs.map(getBindings).reduce(unnestR, []);\n}\n// Given a directive definition, find its object input attributes\n// Use different properties, depending on the type of directive (component, bindToController, normal)\nvar getBindings = function (def) {\n    if (isObject(def.bindToController))\n        return scopeBindings(def.bindToController);\n    return scopeBindings(def.scope);\n};\n// for ng 1.2 style, process the scope: { input: \"=foo\" }\n// for ng 1.3 through ng 1.5, process the component's bindToController: { input: \"=foo\" } object\nvar scopeBindings = function (bindingsObj) { return Object.keys(bindingsObj || {})\n    .map(function (key) { return [key, /^([=<@&])[?]?(.*)/.exec(bindingsObj[key])]; })\n    .filter(function (tuple) { return isDefined(tuple) && isArray(tuple[1]); })\n    .map(function (tuple) { return ({ name: tuple[1][2] || tuple[0], type: tuple[1][1] }); }); };\n\n/** @module ng1 */ /** for typedoc */\n/**\n * The Angular 1 `StateProvider`\n *\n * The `$stateProvider` works similar to Angular's v1 router, but it focuses purely\n * on state.\n *\n * A state corresponds to a \"place\" in the application in terms of the overall UI and\n * navigation. A state describes (via the controller / template / view properties) what\n * the UI looks like and does at that place.\n *\n * States often have things in common, and the primary way of factoring out these\n * commonalities in this model is via the state hierarchy, i.e. parent/child states aka\n * nested states.\n *\n * The `$stateProvider` provides interfaces to declare these states for your app.\n */\nvar StateProvider = (function () {\n    function StateProvider(stateRegistry, stateService) {\n        this.stateRegistry = stateRegistry;\n        this.stateService = stateService;\n        createProxyFunctions(val(StateProvider.prototype), this, val(this));\n    }\n    /**\n     * Decorates states when they are registered\n     *\n     * Allows you to extend (carefully) or override (at your own peril) the\n     * `stateBuilder` object used internally by [[StateRegistry]].\n     * This can be used to add custom functionality to ui-router,\n     * for example inferring templateUrl based on the state name.\n     *\n     * When passing only a name, it returns the current (original or decorated) builder\n     * function that matches `name`.\n     *\n     * The builder functions that can be decorated are listed below. Though not all\n     * necessarily have a good use case for decoration, that is up to you to decide.\n     *\n     * In addition, users can attach custom decorators, which will generate new\n     * properties within the state's internal definition. There is currently no clear\n     * use-case for this beyond accessing internal states (i.e. $state.$current),\n     * however, expect this to become increasingly relevant as we introduce additional\n     * meta-programming features.\n     *\n     * **Warning**: Decorators should not be interdependent because the order of\n     * execution of the builder functions in non-deterministic. Builder functions\n     * should only be dependent on the state definition object and super function.\n     *\n     *\n     * Existing builder functions and current return values:\n     *\n     * - **parent** `{object}` - returns the parent state object.\n     * - **data** `{object}` - returns state data, including any inherited data that is not\n     *   overridden by own values (if any).\n     * - **url** `{object}` - returns a {@link ui.router.util.type:UrlMatcher UrlMatcher}\n     *   or `null`.\n     * - **navigable** `{object}` - returns closest ancestor state that has a URL (aka is\n     *   navigable).\n     * - **params** `{object}` - returns an array of state params that are ensured to\n     *   be a super-set of parent's params.\n     * - **views** `{object}` - returns a views object where each key is an absolute view\n     *   name (i.e. \"viewName@stateName\") and each value is the config object\n     *   (template, controller) for the view. Even when you don't use the views object\n     *   explicitly on a state config, one is still created for you internally.\n     *   So by decorating this builder function you have access to decorating template\n     *   and controller properties.\n     * - **ownParams** `{object}` - returns an array of params that belong to the state,\n     *   not including any params defined by ancestor states.\n     * - **path** `{string}` - returns the full path from the root down to this state.\n     *   Needed for state activation.\n     * - **includes** `{object}` - returns an object that includes every state that\n     *   would pass a `$state.includes()` test.\n     *\n     * #### Example:\n     * Override the internal 'views' builder with a function that takes the state\n     * definition, and a reference to the internal function being overridden:\n     * ```js\n     * $stateProvider.decorator('views', function (state, parent) {\n     *   let result = {},\n     *       views = parent(state);\n     *\n     *   angular.forEach(views, function (config, name) {\n     *     let autoName = (state.name + '.' + name).replace('.', '/');\n     *     config.templateUrl = config.templateUrl || '/partials/' + autoName + '.html';\n     *     result[name] = config;\n     *   });\n     *   return result;\n     * });\n     *\n     * $stateProvider.state('home', {\n     *   views: {\n     *     'contact.list': { controller: 'ListController' },\n     *     'contact.item': { controller: 'ItemController' }\n     *   }\n     * });\n     * ```\n     *\n     *\n     * ```js\n     * // Auto-populates list and item views with /partials/home/contact/list.html,\n     * // and /partials/home/contact/item.html, respectively.\n     * $state.go('home');\n     * ```\n     *\n     * @param {string} name The name of the builder function to decorate.\n     * @param {object} func A function that is responsible for decorating the original\n     * builder function. The function receives two parameters:\n     *\n     *   - `{object}` - state - The state config object.\n     *   - `{object}` - super - The original builder function.\n     *\n     * @return {object} $stateProvider - $stateProvider instance\n     */\n    StateProvider.prototype.decorator = function (name, func) {\n        return this.stateRegistry.decorator(name, func) || this;\n    };\n    StateProvider.prototype.state = function (name, definition) {\n        if (isObject(name)) {\n            definition = name;\n        }\n        else {\n            definition.name = name;\n        }\n        this.stateRegistry.register(definition);\n        return this;\n    };\n    /**\n     * Registers an invalid state handler\n     *\n     * This is a passthrough to [[StateService.onInvalid]] for ng1.\n     */\n    StateProvider.prototype.onInvalid = function (callback) {\n        return this.stateService.onInvalid(callback);\n    };\n    return StateProvider;\n}());\n\n/** @module ng1 */ /** */\n/**\n * This is a [[StateBuilder.builder]] function for angular1 `onEnter`, `onExit`,\n * `onRetain` callback hooks on a [[Ng1StateDeclaration]].\n *\n * When the [[StateBuilder]] builds a [[StateObject]] object from a raw [[StateDeclaration]], this builder\n * ensures that those hooks are injectable for @uirouter/angularjs (ng1).\n */\nvar getStateHookBuilder = function (hookName) {\n    return function stateHookBuilder(state, parentFn) {\n        var hook = state[hookName];\n        var pathname = hookName === 'onExit' ? 'from' : 'to';\n        function decoratedNg1Hook(trans, state) {\n            var resolveContext = new ResolveContext(trans.treeChanges(pathname));\n            var locals = extend(getLocals(resolveContext), { $state$: state, $transition$: trans });\n            return services.$injector.invoke(hook, this, locals);\n        }\n        return hook ? decoratedNg1Hook : undefined;\n    };\n};\n\n/**\n * Implements UI-Router LocationServices and LocationConfig using Angular 1's $location service\n */\nvar Ng1LocationServices = (function () {\n    function Ng1LocationServices($locationProvider) {\n        // .onChange() registry\n        this._urlListeners = [];\n        this.$locationProvider = $locationProvider;\n        var _lp = val($locationProvider);\n        createProxyFunctions(_lp, this, _lp, ['hashPrefix']);\n    }\n    Ng1LocationServices.prototype.dispose = function () { };\n    Ng1LocationServices.prototype.onChange = function (callback) {\n        var _this = this;\n        this._urlListeners.push(callback);\n        return function () { return removeFrom(_this._urlListeners)(callback); };\n    };\n    Ng1LocationServices.prototype.html5Mode = function () {\n        var html5Mode = this.$locationProvider.html5Mode();\n        html5Mode = isObject(html5Mode) ? html5Mode.enabled : html5Mode;\n        return html5Mode && this.$sniffer.history;\n    };\n    Ng1LocationServices.prototype.url = function (newUrl, replace, state) {\n        if (replace === void 0) { replace = false; }\n        if (newUrl)\n            this.$location.url(newUrl);\n        if (replace)\n            this.$location.replace();\n        if (state)\n            this.$location.state(state);\n        return this.$location.url();\n    };\n    Ng1LocationServices.prototype._runtimeServices = function ($rootScope, $location, $sniffer, $browser) {\n        var _this = this;\n        this.$location = $location;\n        this.$sniffer = $sniffer;\n        // Bind $locationChangeSuccess to the listeners registered in LocationService.onChange\n        $rootScope.$on(\"$locationChangeSuccess\", function (evt) { return _this._urlListeners.forEach(function (fn) { return fn(evt); }); });\n        var _loc = val($location);\n        var _browser = val($browser);\n        // Bind these LocationService functions to $location\n        createProxyFunctions(_loc, this, _loc, [\"replace\", \"path\", \"search\", \"hash\"]);\n        // Bind these LocationConfig functions to $location\n        createProxyFunctions(_loc, this, _loc, ['port', 'protocol', 'host']);\n        // Bind these LocationConfig functions to $browser\n        createProxyFunctions(_browser, this, _browser, ['baseHref']);\n    };\n    /**\n     * Applys ng1-specific path parameter encoding\n     *\n     * The Angular 1 `$location` service is a bit weird.\n     * It doesn't allow slashes to be encoded/decoded bi-directionally.\n     *\n     * See the writeup at https://github.com/angular-ui/ui-router/issues/2598\n     *\n     * This code patches the `path` parameter type so it encoded/decodes slashes as ~2F\n     *\n     * @param router\n     */\n    Ng1LocationServices.monkeyPatchPathParameterType = function (router) {\n        var pathType = router.urlMatcherFactory.type('path');\n        pathType.encode = function (val$$1) {\n            return val$$1 != null ? val$$1.toString().replace(/(~|\\/)/g, function (m) { return ({ '~': '~~', '/': '~2F' }[m]); }) : val$$1;\n        };\n        pathType.decode = function (val$$1) {\n            return val$$1 != null ? val$$1.toString().replace(/(~~|~2F)/g, function (m) { return ({ '~~': '~', '~2F': '/' }[m]); }) : val$$1;\n        };\n    };\n    return Ng1LocationServices;\n}());\n\n/** @module url */ /** */\n/**\n * Manages rules for client-side URL\n *\n * ### Deprecation warning:\n * This class is now considered to be an internal API\n * Use the [[UrlService]] instead.\n * For configuring URL rules, use the [[UrlRulesApi]] which can be found as [[UrlService.rules]].\n *\n * This class manages the router rules for what to do when the URL changes.\n *\n * This provider remains for backwards compatibility.\n *\n * @deprecated\n */\nvar UrlRouterProvider = (function () {\n    /** @hidden */\n    function UrlRouterProvider(router) {\n        this._router = router;\n        this._urlRouter = router.urlRouter;\n    }\n    /** @hidden */\n    UrlRouterProvider.prototype.$get = function () {\n        var urlRouter = this._urlRouter;\n        urlRouter.update(true);\n        if (!urlRouter.interceptDeferred)\n            urlRouter.listen();\n        return urlRouter;\n    };\n    /**\n     * Registers a url handler function.\n     *\n     * Registers a low level url handler (a `rule`).\n     * A rule detects specific URL patterns and returns a redirect, or performs some action.\n     *\n     * If a rule returns a string, the URL is replaced with the string, and all rules are fired again.\n     *\n     * #### Example:\n     * ```js\n     * var app = angular.module('app', ['ui.router.router']);\n     *\n     * app.config(function ($urlRouterProvider) {\n     *   // Here's an example of how you might allow case insensitive urls\n     *   $urlRouterProvider.rule(function ($injector, $location) {\n     *     var path = $location.path(),\n     *         normalized = path.toLowerCase();\n     *\n     *     if (path !== normalized) {\n     *       return normalized;\n     *     }\n     *   });\n     * });\n     * ```\n     *\n     * @param ruleFn\n     * Handler function that takes `$injector` and `$location` services as arguments.\n     * You can use them to detect a url and return a different url as a string.\n     *\n     * @return [[UrlRouterProvider]] (`this`)\n     */\n    UrlRouterProvider.prototype.rule = function (ruleFn) {\n        var _this = this;\n        if (!isFunction(ruleFn))\n            throw new Error(\"'rule' must be a function\");\n        var match = function () {\n            return ruleFn(services.$injector, _this._router.locationService);\n        };\n        var rule = new BaseUrlRule(match, identity);\n        this._urlRouter.rule(rule);\n        return this;\n    };\n    \n    /**\n     * Defines the path or behavior to use when no url can be matched.\n     *\n     * #### Example:\n     * ```js\n     * var app = angular.module('app', ['ui.router.router']);\n     *\n     * app.config(function ($urlRouterProvider) {\n     *   // if the path doesn't match any of the urls you configured\n     *   // otherwise will take care of routing the user to the\n     *   // specified url\n     *   $urlRouterProvider.otherwise('/index');\n     *\n     *   // Example of using function rule as param\n     *   $urlRouterProvider.otherwise(function ($injector, $location) {\n     *     return '/a/valid/url';\n     *   });\n     * });\n     * ```\n     *\n     * @param rule\n     * The url path you want to redirect to or a function rule that returns the url path or performs a `$state.go()`.\n     * The function version is passed two params: `$injector` and `$location` services, and should return a url string.\n     *\n     * @return {object} `$urlRouterProvider` - `$urlRouterProvider` instance\n     */\n    UrlRouterProvider.prototype.otherwise = function (rule) {\n        var _this = this;\n        var urlRouter = this._urlRouter;\n        if (isString(rule)) {\n            urlRouter.otherwise(rule);\n        }\n        else if (isFunction(rule)) {\n            urlRouter.otherwise(function () { return rule(services.$injector, _this._router.locationService); });\n        }\n        else {\n            throw new Error(\"'rule' must be a string or function\");\n        }\n        return this;\n    };\n    \n    /**\n     * Registers a handler for a given url matching.\n     *\n     * If the handler is a string, it is\n     * treated as a redirect, and is interpolated according to the syntax of match\n     * (i.e. like `String.replace()` for `RegExp`, or like a `UrlMatcher` pattern otherwise).\n     *\n     * If the handler is a function, it is injectable.\n     * It gets invoked if `$location` matches.\n     * You have the option of inject the match object as `$match`.\n     *\n     * The handler can return\n     *\n     * - **falsy** to indicate that the rule didn't match after all, then `$urlRouter`\n     *   will continue trying to find another one that matches.\n     * - **string** which is treated as a redirect and passed to `$location.url()`\n     * - **void** or any **truthy** value tells `$urlRouter` that the url was handled.\n     *\n     * #### Example:\n     * ```js\n     * var app = angular.module('app', ['ui.router.router']);\n     *\n     * app.config(function ($urlRouterProvider) {\n     *   $urlRouterProvider.when($state.url, function ($match, $stateParams) {\n     *     if ($state.$current.navigable !== state ||\n     *         !equalForKeys($match, $stateParams) {\n     *      $state.transitionTo(state, $match, false);\n     *     }\n     *   });\n     * });\n     * ```\n     *\n     * @param what A pattern string to match, compiled as a [[UrlMatcher]].\n     * @param handler The path (or function that returns a path) that you want to redirect your user to.\n     * @param ruleCallback [optional] A callback that receives the `rule` registered with [[UrlMatcher.rule]]\n     *\n     * Note: the handler may also invoke arbitrary code, such as `$state.go()`\n     */\n    UrlRouterProvider.prototype.when = function (what, handler) {\n        if (isArray(handler) || isFunction(handler)) {\n            handler = UrlRouterProvider.injectableHandler(this._router, handler);\n        }\n        this._urlRouter.when(what, handler);\n        return this;\n    };\n    \n    UrlRouterProvider.injectableHandler = function (router, handler) {\n        return function (match) {\n            return services.$injector.invoke(handler, null, { $match: match, $stateParams: router.globals.params });\n        };\n    };\n    /**\n     * Disables monitoring of the URL.\n     *\n     * Call this method before UI-Router has bootstrapped.\n     * It will stop UI-Router from performing the initial url sync.\n     *\n     * This can be useful to perform some asynchronous initialization before the router starts.\n     * Once the initialization is complete, call [[listen]] to tell UI-Router to start watching and synchronizing the URL.\n     *\n     * #### Example:\n     * ```js\n     * var app = angular.module('app', ['ui.router']);\n     *\n     * app.config(function ($urlRouterProvider) {\n     *   // Prevent $urlRouter from automatically intercepting URL changes;\n     *   $urlRouterProvider.deferIntercept();\n     * })\n     *\n     * app.run(function (MyService, $urlRouter, $http) {\n     *   $http.get(\"/stuff\").then(function(resp) {\n     *     MyService.doStuff(resp.data);\n     *     $urlRouter.listen();\n     *     $urlRouter.sync();\n     *   });\n     * });\n     * ```\n     *\n     * @param defer Indicates whether to defer location change interception.\n     *        Passing no parameter is equivalent to `true`.\n     */\n    UrlRouterProvider.prototype.deferIntercept = function (defer) {\n        this._urlRouter.deferIntercept(defer);\n    };\n    \n    return UrlRouterProvider;\n}());\n\n/**\n * # Angular 1 types\n *\n * UI-Router core provides various Typescript types which you can use for code completion and validating parameter values, etc.\n * The customizations to the core types for Angular UI-Router are documented here.\n *\n * The optional [[$resolve]] service is also documented here.\n *\n * @module ng1\n * @preferred\n */\n/** for typedoc */\nng.module(\"ui.router.angular1\", []);\nvar mod_init = ng.module('ui.router.init', []);\nvar mod_util = ng.module('ui.router.util', ['ng', 'ui.router.init']);\nvar mod_rtr = ng.module('ui.router.router', ['ui.router.util']);\nvar mod_state = ng.module('ui.router.state', ['ui.router.router', 'ui.router.util', 'ui.router.angular1']);\nvar mod_main = ng.module('ui.router', ['ui.router.init', 'ui.router.state', 'ui.router.angular1']);\nvar mod_cmpt = ng.module('ui.router.compat', ['ui.router']); // tslint:disable-line\nvar router = null;\n$uiRouter.$inject = ['$locationProvider'];\n/** This angular 1 provider instantiates a Router and exposes its services via the angular injector */\nfunction $uiRouter($locationProvider) {\n    // Create a new instance of the Router when the $uiRouterProvider is initialized\n    router = this.router = new UIRouter();\n    router.stateProvider = new StateProvider(router.stateRegistry, router.stateService);\n    // Apply ng1 specific StateBuilder code for `views`, `resolve`, and `onExit/Retain/Enter` properties\n    router.stateRegistry.decorator(\"views\", ng1ViewsBuilder);\n    router.stateRegistry.decorator(\"onExit\", getStateHookBuilder(\"onExit\"));\n    router.stateRegistry.decorator(\"onRetain\", getStateHookBuilder(\"onRetain\"));\n    router.stateRegistry.decorator(\"onEnter\", getStateHookBuilder(\"onEnter\"));\n    router.viewService._pluginapi._viewConfigFactory('ng1', getNg1ViewConfigFactory());\n    var ng1LocationService = router.locationService = router.locationConfig = new Ng1LocationServices($locationProvider);\n    Ng1LocationServices.monkeyPatchPathParameterType(router);\n    // backwards compat: also expose router instance as $uiRouterProvider.router\n    router['router'] = router;\n    router['$get'] = $get;\n    $get.$inject = ['$location', '$browser', '$sniffer', '$rootScope', '$http', '$templateCache'];\n    function $get($location, $browser, $sniffer, $rootScope, $http, $templateCache) {\n        ng1LocationService._runtimeServices($rootScope, $location, $sniffer, $browser);\n        delete router['router'];\n        delete router['$get'];\n        return router;\n    }\n    return router;\n}\nvar getProviderFor = function (serviceName) { return ['$uiRouterProvider', function ($urp) {\n        var service = $urp.router[serviceName];\n        service[\"$get\"] = function () { return service; };\n        return service;\n    }]; };\n// This effectively calls $get() on `$uiRouterProvider` to trigger init (when ng enters runtime)\nrunBlock.$inject = ['$injector', '$q', '$uiRouter'];\nfunction runBlock($injector$$1, $q$$1, $uiRouter) {\n    services.$injector = $injector$$1;\n    services.$q = $q$$1;\n    // The $injector is now available.\n    // Find any resolvables that had dependency annotation deferred\n    $uiRouter.stateRegistry.get()\n        .map(function (x) { return x.$$state().resolvables; })\n        .reduce(unnestR, [])\n        .filter(function (x) { return x.deps === \"deferred\"; })\n        .forEach(function (resolvable) { return resolvable.deps = $injector$$1.annotate(resolvable.resolveFn); });\n}\n// $urlRouter service and $urlRouterProvider\nvar getUrlRouterProvider = function (uiRouter) {\n    return uiRouter.urlRouterProvider = new UrlRouterProvider(uiRouter);\n};\n// $state service and $stateProvider\n// $urlRouter service and $urlRouterProvider\nvar getStateProvider = function () {\n    return extend(router.stateProvider, { $get: function () { return router.stateService; } });\n};\nwatchDigests.$inject = ['$rootScope'];\nfunction watchDigests($rootScope) {\n    $rootScope.$watch(function () { trace.approximateDigests++; });\n}\nmod_init.provider(\"$uiRouter\", $uiRouter);\nmod_rtr.provider('$urlRouter', ['$uiRouterProvider', getUrlRouterProvider]);\nmod_util.provider('$urlService', getProviderFor('urlService'));\nmod_util.provider('$urlMatcherFactory', ['$uiRouterProvider', function () { return router.urlMatcherFactory; }]);\nmod_util.provider('$templateFactory', function () { return new TemplateFactory(); });\nmod_state.provider('$stateRegistry', getProviderFor('stateRegistry'));\nmod_state.provider('$uiRouterGlobals', getProviderFor('globals'));\nmod_state.provider('$transitions', getProviderFor('transitionService'));\nmod_state.provider('$state', ['$uiRouterProvider', getStateProvider]);\nmod_state.factory('$stateParams', ['$uiRouter', function ($uiRouter) { return $uiRouter.globals.params; }]);\nmod_main.factory('$view', function () { return router.viewService; });\nmod_main.service(\"$trace\", function () { return trace; });\nmod_main.run(watchDigests);\nmod_util.run(['$urlMatcherFactory', function ($urlMatcherFactory) { }]);\nmod_state.run(['$state', function ($state) { }]);\nmod_rtr.run(['$urlRouter', function ($urlRouter) { }]);\nmod_init.run(runBlock);\n/** @hidden TODO: find a place to move this */\nvar getLocals = function (ctx) {\n    var tokens = ctx.getTokens().filter(isString);\n    var tuples = tokens.map(function (key) {\n        var resolvable = ctx.getResolvable(key);\n        var waitPolicy = ctx.getPolicy(resolvable).async;\n        return [key, waitPolicy === 'NOWAIT' ? resolvable.promise : resolvable.data];\n    });\n    return tuples.reduce(applyPairs, {});\n};\n\n/**\n * # Angular 1 injectable services\n *\n * This is a list of the objects which can be injected using angular's injector.\n *\n * There are three different kind of injectable objects:\n *\n * ## **Provider** objects\n * #### injectable into a `.config()` block during configtime\n *\n * - [[$uiRouterProvider]]: The UI-Router instance\n * - [[$stateProvider]]: State registration\n * - [[$transitionsProvider]]: Transition hooks\n * - [[$urlServiceProvider]]: All URL related public APIs\n *\n * - [[$uiViewScrollProvider]]: Disable ui-router view scrolling\n * - [[$urlRouterProvider]]: (deprecated) Url matching rules\n * - [[$urlMatcherFactoryProvider]]: (deprecated) Url parsing config\n *\n * ## **Service** objects\n * #### injectable globally during runtime\n *\n * - [[$uiRouter]]: The UI-Router instance\n * - [[$trace]]: Enable transition trace/debug\n * - [[$transitions]]: Transition hooks\n * - [[$state]]: Imperative state related APIs\n * - [[$stateRegistry]]: State registration\n * - [[$urlService]]: All URL related public APIs\n * - [[$uiRouterGlobals]]: Global variables\n * - [[$uiViewScroll]]: Scroll an element into view\n *\n * - [[$stateParams]]: (deprecated) Global state param values\n * - [[$urlRouter]]: (deprecated) URL synchronization\n * - [[$urlMatcherFactory]]: (deprecated) URL parsing config\n *\n * ## **Per-Transition** objects\n *\n * - These kind of objects are injectable into:\n *   - Resolves ([[Ng1StateDeclaration.resolve]]),\n *   - Transition Hooks ([[TransitionService.onStart]], etc),\n *   - Routed Controllers ([[Ng1ViewDeclaration.controller]])\n *\n * #### Different instances are injected based on the [[Transition]]\n *\n * - [[$transition$]]: The current Transition object\n * - [[$stateParams]]: State param values for pending Transition (deprecated)\n * - Any resolve data defined using [[Ng1StateDeclaration.resolve]]\n *\n * @ng1api\n * @preferred\n * @module injectables\n */ /** */\n/**\n * The current (or pending) State Parameters\n *\n * An injectable global **Service Object** which holds the state parameters for the latest **SUCCESSFUL** transition.\n *\n * The values are not updated until *after* a `Transition` successfully completes.\n *\n * **Also:** an injectable **Per-Transition Object** object which holds the pending state parameters for the pending `Transition` currently running.\n *\n * ### Deprecation warning:\n *\n * The value injected for `$stateParams` is different depending on where it is injected.\n *\n * - When injected into an angular service, the object injected is the global **Service Object** with the parameter values for the latest successful `Transition`.\n * - When injected into transition hooks, resolves, or view controllers, the object is the **Per-Transition Object** with the parameter values for the running `Transition`.\n *\n * Because of these confusing details, this service is deprecated.\n *\n * ### Instead of using the global `$stateParams` service object,\n * inject [[$uiRouterGlobals]] and use [[UIRouterGlobals.params]]\n *\n * ```js\n * MyService.$inject = ['$uiRouterGlobals'];\n * function MyService($uiRouterGlobals) {\n *   return {\n *     paramValues: function () {\n *       return $uiRouterGlobals.params;\n *     }\n *   }\n * }\n * ```\n *\n * ### Instead of using the per-transition `$stateParams` object,\n * inject the current `Transition` (as [[$transition$]]) and use [[Transition.params]]\n *\n * ```js\n * MyController.$inject = ['$transition$'];\n * function MyController($transition$) {\n *   var username = $transition$.params().username;\n *   // .. do something with username\n * }\n * ```\n *\n * ---\n *\n * This object can be injected into other services.\n *\n * #### Deprecated Example:\n * ```js\n * SomeService.$inject = ['$http', '$stateParams'];\n * function SomeService($http, $stateParams) {\n *   return {\n *     getUser: function() {\n *       return $http.get('/api/users/' + $stateParams.username);\n *     }\n *   }\n * };\n * angular.service('SomeService', SomeService);\n * ```\n * @deprecated\n */\n\n/**\n * # Angular 1 Directives\n *\n * These are the directives included in UI-Router for Angular 1.\n * These directives are used in templates to create viewports and link/navigate to states.\n *\n * @ng1api\n * @preferred\n * @module directives\n */ /** for typedoc */\n/** @hidden */\nfunction parseStateRef(ref) {\n    var paramsOnly = ref.match(/^\\s*({[^}]*})\\s*$/), parsed;\n    if (paramsOnly)\n        ref = '(' + paramsOnly[1] + ')';\n    parsed = ref.replace(/\\n/g, \" \").match(/^\\s*([^(]*?)\\s*(\\((.*)\\))?\\s*$/);\n    if (!parsed || parsed.length !== 4)\n        throw new Error(\"Invalid state ref '\" + ref + \"'\");\n    return { state: parsed[1] || null, paramExpr: parsed[3] || null };\n}\n/** @hidden */\nfunction stateContext(el) {\n    var $uiView = el.parent().inheritedData('$uiView');\n    var path = parse('$cfg.path')($uiView);\n    return path ? tail(path).state.name : undefined;\n}\n/** @hidden */\nfunction processedDef($state, $element, def) {\n    var uiState = def.uiState || $state.current.name;\n    var uiStateOpts = extend(defaultOpts($element, $state), def.uiStateOpts || {});\n    var href = $state.href(uiState, def.uiStateParams, uiStateOpts);\n    return { uiState: uiState, uiStateParams: def.uiStateParams, uiStateOpts: uiStateOpts, href: href };\n}\n/** @hidden */\nfunction getTypeInfo(el) {\n    // SVGAElement does not use the href attribute, but rather the 'xlinkHref' attribute.\n    var isSvg = Object.prototype.toString.call(el.prop('href')) === '[object SVGAnimatedString]';\n    var isForm = el[0].nodeName === \"FORM\";\n    return {\n        attr: isForm ? \"action\" : (isSvg ? 'xlink:href' : 'href'),\n        isAnchor: el.prop(\"tagName\").toUpperCase() === \"A\",\n        clickable: !isForm\n    };\n}\n/** @hidden */\nfunction clickHook(el, $state, $timeout, type, getDef) {\n    return function (e) {\n        var button = e.which || e.button, target = getDef();\n        if (!(button > 1 || e.ctrlKey || e.metaKey || e.shiftKey || el.attr('target'))) {\n            // HACK: This is to allow ng-clicks to be processed before the transition is initiated:\n            var transition = $timeout(function () {\n                $state.go(target.uiState, target.uiStateParams, target.uiStateOpts);\n            });\n            e.preventDefault();\n            // if the state has no URL, ignore one preventDefault from the <a> directive.\n            var ignorePreventDefaultCount = type.isAnchor && !target.href ? 1 : 0;\n            e.preventDefault = function () {\n                if (ignorePreventDefaultCount-- <= 0)\n                    $timeout.cancel(transition);\n            };\n        }\n    };\n}\n/** @hidden */\nfunction defaultOpts(el, $state) {\n    return {\n        relative: stateContext(el) || $state.$current,\n        inherit: true,\n        source: \"sref\"\n    };\n}\n/** @hidden */\nfunction bindEvents(element, scope, hookFn, uiStateOpts) {\n    var events;\n    if (uiStateOpts) {\n        events = uiStateOpts.events;\n    }\n    if (!isArray(events)) {\n        events = ['click'];\n    }\n    var on = element.on ? 'on' : 'bind';\n    for (var _i = 0, events_1 = events; _i < events_1.length; _i++) {\n        var event_1 = events_1[_i];\n        element[on](event_1, hookFn);\n    }\n    scope.$on('$destroy', function () {\n        var off = element.off ? 'off' : 'unbind';\n        for (var _i = 0, events_2 = events; _i < events_2.length; _i++) {\n            var event_2 = events_2[_i];\n            element[off](event_2, hookFn);\n        }\n    });\n}\n/**\n * `ui-sref`: A directive for linking to a state\n *\n * A directive which links to a state (and optionally, parameters).\n * When clicked, this directive activates the linked state with the supplied parameter values.\n *\n * ### Linked State\n * The attribute value of the `ui-sref` is the name of the state to link to.\n *\n * #### Example:\n * This will activate the `home` state when the link is clicked.\n * ```html\n * <a ui-sref=\"home\">Home</a>\n * ```\n *\n * ### Relative Links\n * You can also use relative state paths within `ui-sref`, just like a relative path passed to `$state.go()` ([[StateService.go]]).\n * You just need to be aware that the path is relative to the state that *created* the link.\n * This allows a state to create a relative `ui-sref` which always targets the same destination.\n *\n * #### Example:\n * Both these links are relative to the parent state, even when a child state is currently active.\n * ```html\n * <a ui-sref=\".child1\">child 1 state</a>\n * <a ui-sref=\".child2\">child 2 state</a>\n * ```\n *\n * This link activates the parent state.\n * ```html\n * <a ui-sref=\"^\">Return</a>\n * ```\n *\n * ### hrefs\n * If the linked state has a URL, the directive will automatically generate and\n * update the `href` attribute (using the [[StateService.href]]  method).\n *\n * #### Example:\n * Assuming the `users` state has a url of `/users/`\n * ```html\n * <a ui-sref=\"users\" href=\"/users/\">Users</a>\n * ```\n *\n * ### Parameter Values\n * In addition to the state name, a `ui-sref` can include parameter values which are applied when activating the state.\n * Param values can be provided in the `ui-sref` value after the state name, enclosed by parentheses.\n * The content inside the parentheses is an expression, evaluated to the parameter values.\n *\n * #### Example:\n * This example renders a list of links to users.\n * The state's `userId` parameter value comes from each user's `user.id` property.\n * ```html\n * <li ng-repeat=\"user in users\">\n *   <a ui-sref=\"users.detail({ userId: user.id })\">{{ user.displayName }}</a>\n * </li>\n * ```\n *\n * Note:\n * The parameter values expression is `$watch`ed for updates.\n *\n * ### Transition Options\n * You can specify [[TransitionOptions]] to pass to [[StateService.go]] by using the `ui-sref-opts` attribute.\n * Options are restricted to `location`, `inherit`, and `reload`.\n *\n * #### Example:\n * ```html\n * <a ui-sref=\"home\" ui-sref-opts=\"{ reload: true }\">Home</a>\n * ```\n *\n * ### Other DOM Events\n *\n * You can also customize which DOM events to respond to (instead of `click`) by\n * providing an `events` array in the `ui-sref-opts` attribute.\n *\n * #### Example:\n * ```html\n * <input type=\"text\" ui-sref=\"contacts\" ui-sref-opts=\"{ events: ['change', 'blur'] }\">\n * ```\n *\n * ### Highlighting the active link\n * This directive can be used in conjunction with [[uiSrefActive]] to highlight the active link.\n *\n * ### Examples\n * If you have the following template:\n *\n * ```html\n * <a ui-sref=\"home\">Home</a>\n * <a ui-sref=\"about\">About</a>\n * <a ui-sref=\"{page: 2}\">Next page</a>\n *\n * <ul>\n *     <li ng-repeat=\"contact in contacts\">\n *         <a ui-sref=\"contacts.detail({ id: contact.id })\">{{ contact.name }}</a>\n *     </li>\n * </ul>\n * ```\n *\n * Then (assuming the current state is `contacts`) the rendered html including hrefs would be:\n *\n * ```html\n * <a href=\"#/home\" ui-sref=\"home\">Home</a>\n * <a href=\"#/about\" ui-sref=\"about\">About</a>\n * <a href=\"#/contacts?page=2\" ui-sref=\"{page: 2}\">Next page</a>\n *\n * <ul>\n *     <li ng-repeat=\"contact in contacts\">\n *         <a href=\"#/contacts/1\" ui-sref=\"contacts.detail({ id: contact.id })\">Joe</a>\n *     </li>\n *     <li ng-repeat=\"contact in contacts\">\n *         <a href=\"#/contacts/2\" ui-sref=\"contacts.detail({ id: contact.id })\">Alice</a>\n *     </li>\n *     <li ng-repeat=\"contact in contacts\">\n *         <a href=\"#/contacts/3\" ui-sref=\"contacts.detail({ id: contact.id })\">Bob</a>\n *     </li>\n * </ul>\n *\n * <a href=\"#/home\" ui-sref=\"home\" ui-sref-opts=\"{reload: true}\">Home</a>\n * ```\n *\n * ### Notes\n *\n * - You can use `ui-sref` to change **only the parameter values** by omitting the state name and parentheses.\n * #### Example:\n * Sets the `lang` parameter to `en` and remains on the same state.\n *\n * ```html\n * <a ui-sref=\"{ lang: 'en' }\">English</a>\n * ```\n *\n * - A middle-click, right-click, or ctrl-click is handled (natively) by the browser to open the href in a new window, for example.\n *\n * - Unlike the parameter values expression, the state name is not `$watch`ed (for performance reasons).\n * If you need to dynamically update the state being linked to, use the fully dynamic [[uiState]] directive.\n */\nvar uiSref;\nuiSref = ['$uiRouter', '$timeout',\n    function $StateRefDirective($uiRouter, $timeout) {\n        var $state = $uiRouter.stateService;\n        return {\n            restrict: 'A',\n            require: ['?^uiSrefActive', '?^uiSrefActiveEq'],\n            link: function (scope, element, attrs, uiSrefActive) {\n                var type = getTypeInfo(element);\n                var active = uiSrefActive[1] || uiSrefActive[0];\n                var unlinkInfoFn = null;\n                var hookFn;\n                var rawDef = {};\n                var getDef = function () { return processedDef($state, element, rawDef); };\n                var ref = parseStateRef(attrs.uiSref);\n                rawDef.uiState = ref.state;\n                rawDef.uiStateOpts = attrs.uiSrefOpts ? scope.$eval(attrs.uiSrefOpts) : {};\n                function update() {\n                    var def = getDef();\n                    if (unlinkInfoFn)\n                        unlinkInfoFn();\n                    if (active)\n                        unlinkInfoFn = active.$$addStateInfo(def.uiState, def.uiStateParams);\n                    if (def.href != null)\n                        attrs.$set(type.attr, def.href);\n                }\n                if (ref.paramExpr) {\n                    scope.$watch(ref.paramExpr, function (val$$1) {\n                        rawDef.uiStateParams = extend({}, val$$1);\n                        update();\n                    }, true);\n                    rawDef.uiStateParams = extend({}, scope.$eval(ref.paramExpr));\n                }\n                update();\n                scope.$on('$destroy', $uiRouter.stateRegistry.onStatesChanged(update));\n                scope.$on('$destroy', $uiRouter.transitionService.onSuccess({}, update));\n                if (!type.clickable)\n                    return;\n                hookFn = clickHook(element, $state, $timeout, type, getDef);\n                bindEvents(element, scope, hookFn, rawDef.uiStateOpts);\n            }\n        };\n    }];\n/**\n * `ui-state`: A fully dynamic directive for linking to a state\n *\n * A directive which links to a state (and optionally, parameters).\n * When clicked, this directive activates the linked state with the supplied parameter values.\n *\n * **This directive is very similar to [[uiSref]], but it `$observe`s and `$watch`es/evaluates all its inputs.**\n *\n * A directive which links to a state (and optionally, parameters).\n * When clicked, this directive activates the linked state with the supplied parameter values.\n *\n * ### Linked State\n * The attribute value of `ui-state` is an expression which is `$watch`ed and evaluated as the state to link to.\n * **This is in contrast with `ui-sref`, which takes a state name as a string literal.**\n *\n * #### Example:\n * Create a list of links.\n * ```html\n * <li ng-repeat=\"link in navlinks\">\n *   <a ui-state=\"link.state\">{{ link.displayName }}</a>\n * </li>\n * ```\n *\n * ### Relative Links\n * If the expression evaluates to a relative path, it is processed like [[uiSref]].\n * You just need to be aware that the path is relative to the state that *created* the link.\n * This allows a state to create relative `ui-state` which always targets the same destination.\n *\n * ### hrefs\n * If the linked state has a URL, the directive will automatically generate and\n * update the `href` attribute (using the [[StateService.href]]  method).\n *\n * ### Parameter Values\n * In addition to the state name expression, a `ui-state` can include parameter values which are applied when activating the state.\n * Param values should be provided using the `ui-state-params` attribute.\n * The `ui-state-params` attribute value is `$watch`ed and evaluated as an expression.\n *\n * #### Example:\n * This example renders a list of links with param values.\n * The state's `userId` parameter value comes from each user's `user.id` property.\n * ```html\n * <li ng-repeat=\"link in navlinks\">\n *   <a ui-state=\"link.state\" ui-state-params=\"link.params\">{{ link.displayName }}</a>\n * </li>\n * ```\n *\n * ### Transition Options\n * You can specify [[TransitionOptions]] to pass to [[StateService.go]] by using the `ui-state-opts` attribute.\n * Options are restricted to `location`, `inherit`, and `reload`.\n * The value of the `ui-state-opts` is `$watch`ed and evaluated as an expression.\n *\n * #### Example:\n * ```html\n * <a ui-state=\"returnto.state\" ui-state-opts=\"{ reload: true }\">Home</a>\n * ```\n *\n * ### Other DOM Events\n *\n * You can also customize which DOM events to respond to (instead of `click`) by\n * providing an `events` array in the `ui-state-opts` attribute.\n *\n * #### Example:\n * ```html\n * <input type=\"text\" ui-state=\"contacts\" ui-state-opts=\"{ events: ['change', 'blur'] }\">\n * ```\n *\n * ### Highlighting the active link\n * This directive can be used in conjunction with [[uiSrefActive]] to highlight the active link.\n *\n * ### Notes\n *\n * - You can use `ui-params` to change **only the parameter values** by omitting the state name and supplying only `ui-state-params`.\n *   However, it might be simpler to use [[uiSref]] parameter-only links.\n *\n * #### Example:\n * Sets the `lang` parameter to `en` and remains on the same state.\n *\n * ```html\n * <a ui-state=\"\" ui-state-params=\"{ lang: 'en' }\">English</a>\n * ```\n *\n * - A middle-click, right-click, or ctrl-click is handled (natively) by the browser to open the href in a new window, for example.\n * ```\n */\nvar uiState;\nuiState = ['$uiRouter', '$timeout',\n    function $StateRefDynamicDirective($uiRouter, $timeout) {\n        var $state = $uiRouter.stateService;\n        return {\n            restrict: 'A',\n            require: ['?^uiSrefActive', '?^uiSrefActiveEq'],\n            link: function (scope, element, attrs, uiSrefActive) {\n                var type = getTypeInfo(element);\n                var active = uiSrefActive[1] || uiSrefActive[0];\n                var unlinkInfoFn = null;\n                var hookFn;\n                var rawDef = {};\n                var getDef = function () { return processedDef($state, element, rawDef); };\n                var inputAttrs = ['uiState', 'uiStateParams', 'uiStateOpts'];\n                var watchDeregFns = inputAttrs.reduce(function (acc, attr) { return (acc[attr] = noop$1, acc); }, {});\n                function update() {\n                    var def = getDef();\n                    if (unlinkInfoFn)\n                        unlinkInfoFn();\n                    if (active)\n                        unlinkInfoFn = active.$$addStateInfo(def.uiState, def.uiStateParams);\n                    if (def.href != null)\n                        attrs.$set(type.attr, def.href);\n                }\n                inputAttrs.forEach(function (field) {\n                    rawDef[field] = attrs[field] ? scope.$eval(attrs[field]) : null;\n                    attrs.$observe(field, function (expr) {\n                        watchDeregFns[field]();\n                        watchDeregFns[field] = scope.$watch(expr, function (newval) {\n                            rawDef[field] = newval;\n                            update();\n                        }, true);\n                    });\n                });\n                update();\n                scope.$on('$destroy', $uiRouter.stateRegistry.onStatesChanged(update));\n                scope.$on('$destroy', $uiRouter.transitionService.onSuccess({}, update));\n                if (!type.clickable)\n                    return;\n                hookFn = clickHook(element, $state, $timeout, type, getDef);\n                bindEvents(element, scope, hookFn, rawDef.uiStateOpts);\n            }\n        };\n    }];\n/**\n * `ui-sref-active` and `ui-sref-active-eq`: A directive that adds a CSS class when a `ui-sref` is active\n *\n * A directive working alongside [[uiSref]] and [[uiState]] to add classes to an element when the\n * related directive's state is active (and remove them when it is inactive).\n *\n * The primary use-case is to highlight the active link in navigation menus,\n * distinguishing it from the inactive menu items.\n *\n * ### Linking to a `ui-sref` or `ui-state`\n * `ui-sref-active` can live on the same element as `ui-sref`/`ui-state`, or it can be on a parent element.\n * If a `ui-sref-active` is a parent to more than one `ui-sref`/`ui-state`, it will apply the CSS class when **any of the links are active**.\n *\n * ### Matching\n *\n * The `ui-sref-active` directive applies the CSS class when the `ui-sref`/`ui-state`'s target state **or any child state is active**.\n * This is a \"fuzzy match\" which uses [[StateService.includes]].\n *\n * The `ui-sref-active-eq` directive applies the CSS class when the `ui-sref`/`ui-state`'s target state is directly active (not when child states are active).\n * This is an \"exact match\" which uses [[StateService.is]].\n *\n * ### Parameter values\n * If the `ui-sref`/`ui-state` includes parameter values, the current parameter values must match the link's values for the link to be highlighted.\n * This allows a list of links to the same state with different parameters to be rendered, and the correct one highlighted.\n *\n * #### Example:\n * ```html\n * <li ng-repeat=\"user in users\" ui-sref-active=\"active\">\n *   <a ui-sref=\"user.details({ userId: user.id })\">{{ user.lastName }}</a>\n * </li>\n * ```\n *\n * ### Examples\n *\n * Given the following template:\n * #### Example:\n * ```html\n * <ul>\n *   <li ui-sref-active=\"active\" class=\"item\">\n *     <a href ui-sref=\"app.user({user: 'bilbobaggins'})\">@bilbobaggins</a>\n *   </li>\n * </ul>\n * ```\n *\n * When the app state is `app.user` (or any child state),\n * and contains the state parameter \"user\" with value \"bilbobaggins\",\n * the resulting HTML will appear as (note the 'active' class):\n *\n * ```html\n * <ul>\n *   <li ui-sref-active=\"active\" class=\"item active\">\n *     <a ui-sref=\"app.user({user: 'bilbobaggins'})\" href=\"/users/bilbobaggins\">@bilbobaggins</a>\n *   </li>\n * </ul>\n * ```\n *\n * ### Glob mode\n *\n * It is possible to pass `ui-sref-active` an expression that evaluates to an object.\n * The objects keys represent active class names and values represent the respective state names/globs.\n * `ui-sref-active` will match if the current active state **includes** any of\n * the specified state names/globs, even the abstract ones.\n *\n * #### Example:\n * Given the following template, with \"admin\" being an abstract state:\n * ```html\n * <div ui-sref-active=\"{'active': 'admin.**'}\">\n *   <a ui-sref-active=\"active\" ui-sref=\"admin.roles\">Roles</a>\n * </div>\n * ```\n *\n * When the current state is \"admin.roles\" the \"active\" class will be applied to both the <div> and <a> elements.\n * It is important to note that the state names/globs passed to `ui-sref-active` override any state provided by a linked `ui-sref`.\n *\n * ### Notes:\n *\n * - The class name is interpolated **once** during the directives link time (any further changes to the\n * interpolated value are ignored).\n *\n * - Multiple classes may be specified in a space-separated format: `ui-sref-active='class1 class2 class3'`\n */\nvar uiSrefActive;\nuiSrefActive = ['$state', '$stateParams', '$interpolate', '$uiRouter',\n    function $StateRefActiveDirective($state, $stateParams, $interpolate, $uiRouter) {\n        return {\n            restrict: \"A\",\n            controller: ['$scope', '$element', '$attrs',\n                function ($scope, $element, $attrs) {\n                    var states = [], activeEqClass, uiSrefActive;\n                    // There probably isn't much point in $observing this\n                    // uiSrefActive and uiSrefActiveEq share the same directive object with some\n                    // slight difference in logic routing\n                    activeEqClass = $interpolate($attrs.uiSrefActiveEq || '', false)($scope);\n                    try {\n                        uiSrefActive = $scope.$eval($attrs.uiSrefActive);\n                    }\n                    catch (e) {\n                        // Do nothing. uiSrefActive is not a valid expression.\n                        // Fall back to using $interpolate below\n                    }\n                    uiSrefActive = uiSrefActive || $interpolate($attrs.uiSrefActive || '', false)($scope);\n                    if (isObject(uiSrefActive)) {\n                        forEach(uiSrefActive, function (stateOrName, activeClass) {\n                            if (isString(stateOrName)) {\n                                var ref = parseStateRef(stateOrName);\n                                addState(ref.state, $scope.$eval(ref.paramExpr), activeClass);\n                            }\n                        });\n                    }\n                    // Allow uiSref to communicate with uiSrefActive[Equals]\n                    this.$$addStateInfo = function (newState, newParams) {\n                        // we already got an explicit state provided by ui-sref-active, so we\n                        // shadow the one that comes from ui-sref\n                        if (isObject(uiSrefActive) && states.length > 0) {\n                            return;\n                        }\n                        var deregister = addState(newState, newParams, uiSrefActive);\n                        update();\n                        return deregister;\n                    };\n                    function updateAfterTransition(trans) {\n                        trans.promise.then(update);\n                    }\n                    $scope.$on('$stateChangeSuccess', update);\n                    $scope.$on('$destroy', $uiRouter.transitionService.onStart({}, updateAfterTransition));\n                    if ($uiRouter.globals.transition) {\n                        updateAfterTransition($uiRouter.globals.transition);\n                    }\n                    function addState(stateName, stateParams, activeClass) {\n                        var state = $state.get(stateName, stateContext($element));\n                        var stateInfo = {\n                            state: state || { name: stateName },\n                            params: stateParams,\n                            activeClass: activeClass\n                        };\n                        states.push(stateInfo);\n                        return function removeState() {\n                            removeFrom(states)(stateInfo);\n                        };\n                    }\n                    // Update route state\n                    function update() {\n                        var splitClasses = function (str) {\n                            return str.split(/\\s/).filter(identity);\n                        };\n                        var getClasses = function (stateList) {\n                            return stateList.map(function (x) { return x.activeClass; }).map(splitClasses).reduce(unnestR, []);\n                        };\n                        var allClasses = getClasses(states).concat(splitClasses(activeEqClass)).reduce(uniqR, []);\n                        var fuzzyClasses = getClasses(states.filter(function (x) { return $state.includes(x.state.name, x.params); }));\n                        var exactlyMatchesAny = !!states.filter(function (x) { return $state.is(x.state.name, x.params); }).length;\n                        var exactClasses = exactlyMatchesAny ? splitClasses(activeEqClass) : [];\n                        var addClasses = fuzzyClasses.concat(exactClasses).reduce(uniqR, []);\n                        var removeClasses = allClasses.filter(function (cls) { return !inArray(addClasses, cls); });\n                        $scope.$evalAsync(function () {\n                            addClasses.forEach(function (className) { return $element.addClass(className); });\n                            removeClasses.forEach(function (className) { return $element.removeClass(className); });\n                        });\n                    }\n                    update();\n                }]\n        };\n    }];\nng.module('ui.router.state')\n    .directive('uiSref', uiSref)\n    .directive('uiSrefActive', uiSrefActive)\n    .directive('uiSrefActiveEq', uiSrefActive)\n    .directive('uiState', uiState);\n\n/** @module ng1 */ /** for typedoc */\n/**\n * `isState` Filter: truthy if the current state is the parameter\n *\n * Translates to [[StateService.is]] `$state.is(\"stateName\")`.\n *\n * #### Example:\n * ```html\n * <div ng-if=\"'stateName' | isState\">show if state is 'stateName'</div>\n * ```\n */\n$IsStateFilter.$inject = ['$state'];\nfunction $IsStateFilter($state) {\n    var isFilter = function (state, params, options) {\n        return $state.is(state, params, options);\n    };\n    isFilter.$stateful = true;\n    return isFilter;\n}\n/**\n * `includedByState` Filter: truthy if the current state includes the parameter\n *\n * Translates to [[StateService.includes]]` $state.is(\"fullOrPartialStateName\")`.\n *\n * #### Example:\n * ```html\n * <div ng-if=\"'fullOrPartialStateName' | includedByState\">show if state includes 'fullOrPartialStateName'</div>\n * ```\n */\n$IncludedByStateFilter.$inject = ['$state'];\nfunction $IncludedByStateFilter($state) {\n    var includesFilter = function (state, params, options) {\n        return $state.includes(state, params, options);\n    };\n    includesFilter.$stateful = true;\n    return includesFilter;\n}\nng.module('ui.router.state')\n    .filter('isState', $IsStateFilter)\n    .filter('includedByState', $IncludedByStateFilter);\n\n/**\n * @ng1api\n * @module directives\n */ /** for typedoc */\n/**\n * `ui-view`: A viewport directive which is filled in by a view from the active state.\n *\n * ### Attributes\n *\n * - `name`: (Optional) A view name.\n *   The name should be unique amongst the other views in the same state.\n *   You can have views of the same name that live in different states.\n *   The ui-view can be targeted in a View using the name ([[Ng1StateDeclaration.views]]).\n *\n * - `autoscroll`: an expression. When it evaluates to true, the `ui-view` will be scrolled into view when it is activated.\n *   Uses [[$uiViewScroll]] to do the scrolling.\n *\n * - `onload`: Expression to evaluate whenever the view updates.\n *\n * #### Example:\n * A view can be unnamed or named.\n * ```html\n * <!-- Unnamed -->\n * <div ui-view></div>\n *\n * <!-- Named -->\n * <div ui-view=\"viewName\"></div>\n *\n * <!-- Named (different style) -->\n * <ui-view name=\"viewName\"></ui-view>\n * ```\n *\n * You can only have one unnamed view within any template (or root html). If you are only using a\n * single view and it is unnamed then you can populate it like so:\n *\n * ```html\n * <div ui-view></div>\n * $stateProvider.state(\"home\", {\n *   template: \"<h1>HELLO!</h1>\"\n * })\n * ```\n *\n * The above is a convenient shortcut equivalent to specifying your view explicitly with the\n * [[Ng1StateDeclaration.views]] config property, by name, in this case an empty name:\n *\n * ```js\n * $stateProvider.state(\"home\", {\n *   views: {\n *     \"\": {\n *       template: \"<h1>HELLO!</h1>\"\n *     }\n *   }\n * })\n * ```\n *\n * But typically you'll only use the views property if you name your view or have more than one view\n * in the same template. There's not really a compelling reason to name a view if its the only one,\n * but you could if you wanted, like so:\n *\n * ```html\n * <div ui-view=\"main\"></div>\n * ```\n *\n * ```js\n * $stateProvider.state(\"home\", {\n *   views: {\n *     \"main\": {\n *       template: \"<h1>HELLO!</h1>\"\n *     }\n *   }\n * })\n * ```\n *\n * Really though, you'll use views to set up multiple views:\n *\n * ```html\n * <div ui-view></div>\n * <div ui-view=\"chart\"></div>\n * <div ui-view=\"data\"></div>\n * ```\n *\n * ```js\n * $stateProvider.state(\"home\", {\n *   views: {\n *     \"\": {\n *       template: \"<h1>HELLO!</h1>\"\n *     },\n *     \"chart\": {\n *       template: \"<chart_thing/>\"\n *     },\n *     \"data\": {\n *       template: \"<data_thing/>\"\n *     }\n *   }\n * })\n * ```\n *\n * #### Examples for `autoscroll`:\n * ```html\n * <!-- If autoscroll present with no expression,\n *      then scroll ui-view into view -->\n * <ui-view autoscroll/>\n *\n * <!-- If autoscroll present with valid expression,\n *      then scroll ui-view into view if expression evaluates to true -->\n * <ui-view autoscroll='true'/>\n * <ui-view autoscroll='false'/>\n * <ui-view autoscroll='scopeVariable'/>\n * ```\n *\n * Resolve data:\n *\n * The resolved data from the state's `resolve` block is placed on the scope as `$resolve` (this\n * can be customized using [[Ng1ViewDeclaration.resolveAs]]).  This can be then accessed from the template.\n *\n * Note that when `controllerAs` is being used, `$resolve` is set on the controller instance *after* the\n * controller is instantiated.  The `$onInit()` hook can be used to perform initialization code which\n * depends on `$resolve` data.\n *\n * #### Example:\n * ```js\n * $stateProvider.state('home', {\n *   template: '<my-component user=\"$resolve.user\"></my-component>',\n *   resolve: {\n *     user: function(UserService) { return UserService.fetchUser(); }\n *   }\n * });\n * ```\n */\nvar uiView;\nuiView = ['$view', '$animate', '$uiViewScroll', '$interpolate', '$q',\n    function $ViewDirective($view, $animate, $uiViewScroll, $interpolate, $q$$1) {\n        function getRenderer(attrs, scope) {\n            return {\n                enter: function (element, target, cb) {\n                    if (ng.version.minor > 2) {\n                        $animate.enter(element, null, target).then(cb);\n                    }\n                    else {\n                        $animate.enter(element, null, target, cb);\n                    }\n                },\n                leave: function (element, cb) {\n                    if (ng.version.minor > 2) {\n                        $animate.leave(element).then(cb);\n                    }\n                    else {\n                        $animate.leave(element, cb);\n                    }\n                }\n            };\n        }\n        function configsEqual(config1, config2) {\n            return config1 === config2;\n        }\n        var rootData = {\n            $cfg: { viewDecl: { $context: $view._pluginapi._rootViewContext() } },\n            $uiView: {}\n        };\n        var directive = {\n            count: 0,\n            restrict: 'ECA',\n            terminal: true,\n            priority: 400,\n            transclude: 'element',\n            compile: function (tElement, tAttrs, $transclude) {\n                return function (scope, $element, attrs) {\n                    var previousEl, currentEl, currentScope, unregister, onloadExp = attrs['onload'] || '', autoScrollExp = attrs['autoscroll'], renderer = getRenderer(attrs, scope), viewConfig = undefined, inherited = $element.inheritedData('$uiView') || rootData, name = $interpolate(attrs['uiView'] || attrs['name'] || '')(scope) || '$default';\n                    var activeUIView = {\n                        $type: 'ng1',\n                        id: directive.count++,\n                        name: name,\n                        fqn: inherited.$uiView.fqn ? inherited.$uiView.fqn + \".\" + name : name,\n                        config: null,\n                        configUpdated: configUpdatedCallback,\n                        get creationContext() {\n                            var fromParentTagConfig = parse('$cfg.viewDecl.$context')(inherited);\n                            // Allow <ui-view name=\"foo\"><ui-view name=\"bar\"></ui-view></ui-view>\n                            // See https://github.com/angular-ui/ui-router/issues/3355\n                            var fromParentTag = parse('$uiView.creationContext')(inherited);\n                            return fromParentTagConfig || fromParentTag;\n                        }\n                    };\n                    trace.traceUIViewEvent(\"Linking\", activeUIView);\n                    function configUpdatedCallback(config) {\n                        if (config && !(config instanceof Ng1ViewConfig))\n                            return;\n                        if (configsEqual(viewConfig, config))\n                            return;\n                        trace.traceUIViewConfigUpdated(activeUIView, config && config.viewDecl && config.viewDecl.$context);\n                        viewConfig = config;\n                        updateView(config);\n                    }\n                    $element.data('$uiView', { $uiView: activeUIView });\n                    updateView();\n                    unregister = $view.registerUIView(activeUIView);\n                    scope.$on(\"$destroy\", function () {\n                        trace.traceUIViewEvent(\"Destroying/Unregistering\", activeUIView);\n                        unregister();\n                    });\n                    function cleanupLastView() {\n                        if (previousEl) {\n                            trace.traceUIViewEvent(\"Removing (previous) el\", previousEl.data('$uiView'));\n                            previousEl.remove();\n                            previousEl = null;\n                        }\n                        if (currentScope) {\n                            trace.traceUIViewEvent(\"Destroying scope\", activeUIView);\n                            currentScope.$destroy();\n                            currentScope = null;\n                        }\n                        if (currentEl) {\n                            var _viewData_1 = currentEl.data('$uiViewAnim');\n                            trace.traceUIViewEvent(\"Animate out\", _viewData_1);\n                            renderer.leave(currentEl, function () {\n                                _viewData_1.$$animLeave.resolve();\n                                previousEl = null;\n                            });\n                            previousEl = currentEl;\n                            currentEl = null;\n                        }\n                    }\n                    function updateView(config) {\n                        var newScope = scope.$new();\n                        var animEnter = $q$$1.defer(), animLeave = $q$$1.defer();\n                        var $uiViewData = {\n                            $cfg: config,\n                            $uiView: activeUIView,\n                        };\n                        var $uiViewAnim = {\n                            $animEnter: animEnter.promise,\n                            $animLeave: animLeave.promise,\n                            $$animLeave: animLeave\n                        };\n                        /**\n                         * @ngdoc event\n                         * @name ui.router.state.directive:ui-view#$viewContentLoading\n                         * @eventOf ui.router.state.directive:ui-view\n                         * @eventType emits on ui-view directive scope\n                         * @description\n                         *\n                         * Fired once the view **begins loading**, *before* the DOM is rendered.\n                         *\n                         * @param {Object} event Event object.\n                         * @param {string} viewName Name of the view.\n                         */\n                        newScope.$emit('$viewContentLoading', name);\n                        var cloned = $transclude(newScope, function (clone) {\n                            clone.data('$uiViewAnim', $uiViewAnim);\n                            clone.data('$uiView', $uiViewData);\n                            renderer.enter(clone, $element, function onUIViewEnter() {\n                                animEnter.resolve();\n                                if (currentScope)\n                                    currentScope.$emit('$viewContentAnimationEnded');\n                                if (isDefined(autoScrollExp) && !autoScrollExp || scope.$eval(autoScrollExp)) {\n                                    $uiViewScroll(clone);\n                                }\n                            });\n                            cleanupLastView();\n                        });\n                        currentEl = cloned;\n                        currentScope = newScope;\n                        /**\n                         * @ngdoc event\n                         * @name ui.router.state.directive:ui-view#$viewContentLoaded\n                         * @eventOf ui.router.state.directive:ui-view\n                         * @eventType emits on ui-view directive scope\n                         * @description           *\n                         * Fired once the view is **loaded**, *after* the DOM is rendered.\n                         *\n                         * @param {Object} event Event object.\n                         */\n                        currentScope.$emit('$viewContentLoaded', config || viewConfig);\n                        currentScope.$eval(onloadExp);\n                    }\n                };\n            }\n        };\n        return directive;\n    }];\n$ViewDirectiveFill.$inject = ['$compile', '$controller', '$transitions', '$view', '$q', '$timeout'];\n/** @hidden */\nfunction $ViewDirectiveFill($compile, $controller, $transitions, $view, $q$$1, $timeout) {\n    var getControllerAs = parse('viewDecl.controllerAs');\n    var getResolveAs = parse('viewDecl.resolveAs');\n    return {\n        restrict: 'ECA',\n        priority: -400,\n        compile: function (tElement) {\n            var initial = tElement.html();\n            tElement.empty();\n            return function (scope, $element) {\n                var data = $element.data('$uiView');\n                if (!data) {\n                    $element.html(initial);\n                    $compile($element.contents())(scope);\n                    return;\n                }\n                var cfg = data.$cfg || { viewDecl: {}, getTemplate: ng_from_import.noop };\n                var resolveCtx = cfg.path && new ResolveContext(cfg.path);\n                $element.html(cfg.getTemplate($element, resolveCtx) || initial);\n                trace.traceUIViewFill(data.$uiView, $element.html());\n                var link = $compile($element.contents());\n                var controller = cfg.controller;\n                var controllerAs = getControllerAs(cfg);\n                var resolveAs = getResolveAs(cfg);\n                var locals = resolveCtx && getLocals(resolveCtx);\n                scope[resolveAs] = locals;\n                if (controller) {\n                    var controllerInstance = $controller(controller, extend({}, locals, { $scope: scope, $element: $element }));\n                    if (controllerAs) {\n                        scope[controllerAs] = controllerInstance;\n                        scope[controllerAs][resolveAs] = locals;\n                    }\n                    // TODO: Use $view service as a central point for registering component-level hooks\n                    // Then, when a component is created, tell the $view service, so it can invoke hooks\n                    // $view.componentLoaded(controllerInstance, { $scope: scope, $element: $element });\n                    // scope.$on('$destroy', () => $view.componentUnloaded(controllerInstance, { $scope: scope, $element: $element }));\n                    $element.data('$ngControllerController', controllerInstance);\n                    $element.children().data('$ngControllerController', controllerInstance);\n                    registerControllerCallbacks($q$$1, $transitions, controllerInstance, scope, cfg);\n                }\n                // Wait for the component to appear in the DOM\n                if (isString(cfg.viewDecl.component)) {\n                    var cmp_1 = cfg.viewDecl.component;\n                    var kebobName = kebobString(cmp_1);\n                    var tagRegexp_1 = new RegExp(\"^(x-|data-)?\" + kebobName + \"$\", \"i\");\n                    var getComponentController = function () {\n                        var directiveEl = [].slice.call($element[0].children)\n                            .filter(function (el) { return el && el.tagName && tagRegexp_1.exec(el.tagName); });\n                        return directiveEl && ng.element(directiveEl).data(\"$\" + cmp_1 + \"Controller\");\n                    };\n                    var deregisterWatch_1 = scope.$watch(getComponentController, function (ctrlInstance) {\n                        if (!ctrlInstance)\n                            return;\n                        registerControllerCallbacks($q$$1, $transitions, ctrlInstance, scope, cfg);\n                        deregisterWatch_1();\n                    });\n                }\n                link(scope);\n            };\n        }\n    };\n}\n/** @hidden */\nvar hasComponentImpl = typeof ng.module('ui.router')['component'] === 'function';\n/** @hidden incrementing id */\nvar _uiCanExitId = 0;\n/** @hidden TODO: move these callbacks to $view and/or `/hooks/components.ts` or something */\nfunction registerControllerCallbacks($q$$1, $transitions, controllerInstance, $scope, cfg) {\n    // Call $onInit() ASAP\n    if (isFunction(controllerInstance.$onInit) && !(cfg.viewDecl.component && hasComponentImpl)) {\n        controllerInstance.$onInit();\n    }\n    var viewState = tail(cfg.path).state.self;\n    var hookOptions = { bind: controllerInstance };\n    // Add component-level hook for onParamsChange\n    if (isFunction(controllerInstance.uiOnParamsChanged)) {\n        var resolveContext = new ResolveContext(cfg.path);\n        var viewCreationTrans_1 = resolveContext.getResolvable('$transition$').data;\n        // Fire callback on any successful transition\n        var paramsUpdated = function ($transition$) {\n            // Exit early if the $transition$ is the same as the view was created within.\n            // Exit early if the $transition$ will exit the state the view is for.\n            if ($transition$ === viewCreationTrans_1 || $transition$.exiting().indexOf(viewState) !== -1)\n                return;\n            var toParams = $transition$.params(\"to\");\n            var fromParams = $transition$.params(\"from\");\n            var toSchema = $transition$.treeChanges().to.map(function (node) { return node.paramSchema; }).reduce(unnestR, []);\n            var fromSchema = $transition$.treeChanges().from.map(function (node) { return node.paramSchema; }).reduce(unnestR, []);\n            // Find the to params that have different values than the from params\n            var changedToParams = toSchema.filter(function (param) {\n                var idx = fromSchema.indexOf(param);\n                return idx === -1 || !fromSchema[idx].type.equals(toParams[param.id], fromParams[param.id]);\n            });\n            // Only trigger callback if a to param has changed or is new\n            if (changedToParams.length) {\n                var changedKeys_1 = changedToParams.map(function (x) { return x.id; });\n                // Filter the params to only changed/new to params.  `$transition$.params()` may be used to get all params.\n                var newValues = filter(toParams, function (val$$1, key) { return changedKeys_1.indexOf(key) !== -1; });\n                controllerInstance.uiOnParamsChanged(newValues, $transition$);\n            }\n        };\n        $scope.$on('$destroy', $transitions.onSuccess({}, paramsUpdated, hookOptions));\n    }\n    // Add component-level hook for uiCanExit\n    if (isFunction(controllerInstance.uiCanExit)) {\n        var id_1 = _uiCanExitId++;\n        var cacheProp_1 = '_uiCanExitIds';\n        // Returns true if a redirect transition already answered truthy\n        var prevTruthyAnswer_1 = function (trans) {\n            return !!trans && (trans[cacheProp_1] && trans[cacheProp_1][id_1] === true || prevTruthyAnswer_1(trans.redirectedFrom()));\n        };\n        // If a user answered yes, but the transition was later redirected, don't also ask for the new redirect transition\n        var wrappedHook = function (trans) {\n            var promise, ids = trans[cacheProp_1] = trans[cacheProp_1] || {};\n            if (!prevTruthyAnswer_1(trans)) {\n                promise = $q$$1.when(controllerInstance.uiCanExit(trans));\n                promise.then(function (val$$1) { return ids[id_1] = (val$$1 !== false); });\n            }\n            return promise;\n        };\n        var criteria = { exiting: viewState.name };\n        $scope.$on('$destroy', $transitions.onBefore(criteria, wrappedHook, hookOptions));\n    }\n}\nng.module('ui.router.state').directive('uiView', uiView);\nng.module('ui.router.state').directive('uiView', $ViewDirectiveFill);\n\n/** @module ng1 */ /** */\n/** @hidden */\nfunction $ViewScrollProvider() {\n    var useAnchorScroll = false;\n    this.useAnchorScroll = function () {\n        useAnchorScroll = true;\n    };\n    this.$get = ['$anchorScroll', '$timeout', function ($anchorScroll, $timeout) {\n            if (useAnchorScroll) {\n                return $anchorScroll;\n            }\n            return function ($element) {\n                return $timeout(function () {\n                    $element[0].scrollIntoView();\n                }, 0, false);\n            };\n        }];\n}\nng.module('ui.router.state').provider('$uiViewScroll', $ViewScrollProvider);\n\n/**\n * Main entry point for angular 1.x build\n * @module ng1\n */ /** */\nvar index = \"ui.router\";\n\nexports.core = index$1;\nexports['default'] = index;\nexports.fromJson = fromJson;\nexports.toJson = toJson;\nexports.copy = copy;\nexports.forEach = forEach;\nexports.extend = extend;\nexports.equals = equals;\nexports.identity = identity;\nexports.noop = noop$1;\nexports.createProxyFunctions = createProxyFunctions;\nexports.inherit = inherit;\nexports.inArray = inArray;\nexports._inArray = _inArray;\nexports.removeFrom = removeFrom;\nexports._removeFrom = _removeFrom;\nexports.pushTo = pushTo;\nexports._pushTo = _pushTo;\nexports.deregAll = deregAll;\nexports.defaults = defaults;\nexports.mergeR = mergeR;\nexports.ancestors = ancestors;\nexports.pick = pick;\nexports.omit = omit;\nexports.pluck = pluck;\nexports.filter = filter;\nexports.find = find;\nexports.mapObj = mapObj;\nexports.map = map;\nexports.values = values;\nexports.allTrueR = allTrueR;\nexports.anyTrueR = anyTrueR;\nexports.unnestR = unnestR;\nexports.flattenR = flattenR;\nexports.pushR = pushR;\nexports.uniqR = uniqR;\nexports.unnest = unnest;\nexports.flatten = flatten;\nexports.assertPredicate = assertPredicate;\nexports.assertMap = assertMap;\nexports.assertFn = assertFn;\nexports.pairs = pairs;\nexports.arrayTuples = arrayTuples;\nexports.applyPairs = applyPairs;\nexports.tail = tail;\nexports._extend = _extend;\nexports.sortBy = sortBy;\nexports.composeSort = composeSort;\nexports.silenceUncaughtInPromise = silenceUncaughtInPromise;\nexports.silentRejection = silentRejection;\nexports.notImplemented = notImplemented;\nexports.services = services;\nexports.Glob = Glob;\nexports.curry = curry;\nexports.compose = compose;\nexports.pipe = pipe;\nexports.prop = prop;\nexports.propEq = propEq;\nexports.parse = parse;\nexports.not = not;\nexports.and = and;\nexports.or = or;\nexports.all = all;\nexports.any = any;\nexports.is = is;\nexports.eq = eq;\nexports.val = val;\nexports.invoke = invoke;\nexports.pattern = pattern;\nexports.isUndefined = isUndefined;\nexports.isDefined = isDefined;\nexports.isNull = isNull;\nexports.isNullOrUndefined = isNullOrUndefined;\nexports.isFunction = isFunction;\nexports.isNumber = isNumber;\nexports.isString = isString;\nexports.isObject = isObject;\nexports.isArray = isArray;\nexports.isDate = isDate;\nexports.isRegExp = isRegExp;\nexports.isState = isState;\nexports.isInjectable = isInjectable;\nexports.isPromise = isPromise;\nexports.Queue = Queue;\nexports.maxLength = maxLength;\nexports.padString = padString;\nexports.kebobString = kebobString;\nexports.functionToString = functionToString;\nexports.fnToString = fnToString;\nexports.stringify = stringify;\nexports.beforeAfterSubstr = beforeAfterSubstr;\nexports.splitOnDelim = splitOnDelim;\nexports.joinNeighborsR = joinNeighborsR;\nexports.Trace = Trace;\nexports.trace = trace;\nexports.Param = Param;\nexports.ParamTypes = ParamTypes;\nexports.StateParams = StateParams;\nexports.ParamType = ParamType;\nexports.PathNode = PathNode;\nexports.PathUtils = PathUtils;\nexports.resolvePolicies = resolvePolicies;\nexports.defaultResolvePolicy = defaultResolvePolicy;\nexports.Resolvable = Resolvable;\nexports.NATIVE_INJECTOR_TOKEN = NATIVE_INJECTOR_TOKEN;\nexports.ResolveContext = ResolveContext;\nexports.resolvablesBuilder = resolvablesBuilder;\nexports.StateBuilder = StateBuilder;\nexports.StateObject = StateObject;\nexports.StateMatcher = StateMatcher;\nexports.StateQueueManager = StateQueueManager;\nexports.StateRegistry = StateRegistry;\nexports.StateService = StateService;\nexports.TargetState = TargetState;\nexports.HookBuilder = HookBuilder;\nexports.matchState = matchState;\nexports.RegisteredHook = RegisteredHook;\nexports.makeEvent = makeEvent;\nexports.Rejection = Rejection;\nexports.Transition = Transition;\nexports.TransitionHook = TransitionHook;\nexports.TransitionEventType = TransitionEventType;\nexports.defaultTransOpts = defaultTransOpts;\nexports.TransitionService = TransitionService;\nexports.UrlMatcher = UrlMatcher;\nexports.UrlMatcherFactory = UrlMatcherFactory;\nexports.UrlRouter = UrlRouter;\nexports.UrlRuleFactory = UrlRuleFactory;\nexports.BaseUrlRule = BaseUrlRule;\nexports.UrlService = UrlService;\nexports.ViewService = ViewService;\nexports.UIRouterGlobals = UIRouterGlobals;\nexports.UIRouter = UIRouter;\nexports.$q = $q;\nexports.$injector = $injector;\nexports.BaseLocationServices = BaseLocationServices;\nexports.HashLocationService = HashLocationService;\nexports.MemoryLocationService = MemoryLocationService;\nexports.PushStateLocationService = PushStateLocationService;\nexports.MemoryLocationConfig = MemoryLocationConfig;\nexports.BrowserLocationConfig = BrowserLocationConfig;\nexports.splitHash = splitHash;\nexports.splitQuery = splitQuery;\nexports.splitEqual = splitEqual;\nexports.trimHashVal = trimHashVal;\nexports.keyValsToObjectR = keyValsToObjectR;\nexports.getParams = getParams;\nexports.parseUrl = parseUrl$1;\nexports.buildUrl = buildUrl;\nexports.locationPluginFactory = locationPluginFactory;\nexports.servicesPlugin = servicesPlugin;\nexports.hashLocationPlugin = hashLocationPlugin;\nexports.pushStateLocationPlugin = pushStateLocationPlugin;\nexports.memoryLocationPlugin = memoryLocationPlugin;\nexports.UIRouterPluginBase = UIRouterPluginBase;\nexports.watchDigests = watchDigests;\nexports.getLocals = getLocals;\nexports.getNg1ViewConfigFactory = getNg1ViewConfigFactory;\nexports.ng1ViewsBuilder = ng1ViewsBuilder;\nexports.Ng1ViewConfig = Ng1ViewConfig;\nexports.StateProvider = StateProvider;\nexports.UrlRouterProvider = UrlRouterProvider;\n\nObject.defineProperty(exports, '__esModule', { value: true });\n\n})));\n//# sourceMappingURL=angular-ui-router.js.map\n"]}